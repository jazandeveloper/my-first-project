(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[555],{1658:function(e,t,n){"use strict";n.r(t),n.d(t,"EngagementHelper",function(){return s}),n.d(t,"mergeEngagementData",function(){return c}),n.d(t,"EngagementPartType",function(){return i.a}),n.d(t,"EngagementPart",function(){return i.n}),n.d(t,"EngagementBuilder",function(){return i.t}),n.d(t,"ENGAGEMENT_ROOT",function(){return i.e}),n.d(t,"clickEngagementPart",function(){return l.e}),n.d(t,"keyPressEngagementPart",function(){return l.n}),n.d(t,"dropEngagementPart",function(){return l.t}),n.d(t,"getMostSpecificMatchingContext",function(){return u});var a=n(0),i=n(543),r=n(96),o=n(155),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.handlers,o=void 0===i?[]:i,s=n.logData,c=void 0===s?function(e){return r.e.logData(e)}:s;return a._handlers=o,a._logData=c,a}return Object(a.__extends)(t,e),t.prototype.logData=function(e){if(void 0===e&&(e={}),this.contexts.length||e.name){for(var t=this.contexts.map(function(e,t){return{context:e,order:t}}).sort(function(e,t){return e.context.part.type-t.context.part.type||e.order-t.order}).map(function(e){return e.context}),n=e.name,i=void 0===n?t.map(function(e){return e.part.name}).join("."):n,r=e.isIntentional,o=void 0!==r&&r,s=e.extraData,d=void 0===s?{}:s,l=Object(a.__rest)(d,[]),u=Object(a.__rest)(e,["name","isIntentional","extraData"]),f=Object(a.__assign)({name:i,isIntentional:o,extraData:l},u),p=0,m=t;p<m.length;p++){var _=m[p],h=_.part,b=_.extraData,g=void 0===b?{}:b,v={};for(var y in g)v["".concat(h.name,"_").concat(y)]=g[y];c(f,{extraData:v}),c(f,_.part.getEngagementData(_)||{})}for(var S=0,D=this._handlers;S<D.length;S++){var I=D[S],x=I.getEngagementData.apply(I,t);x&&c(f,x)}this._logData(f)}},t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},handlers:this._handlers,logData:this._logData})},t}(i.t);function c(e,t){var n=t.extraData,i=void 0===n?{}:n,r=t.experiment;d(e,Object(a.__rest)(t,["extraData","experiment"])),Object(o.e)(e.extraData,i),void 0!==r&&(e.experiment=r)}function d(e,t){for(var n in t){var a=t[n];if("object"==typeof a&&a){var i="object"==typeof e[n]&&e[n]||{};e[n]=i,d(i,a)}else void 0!==a&&(e[n]=a)}}var l=n(2754);function u(e,t){for(var n=t.length-1;n>=0;n--){var a=t[n];if(e.matches(a))return a}}},1870:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1110),i=n(119),r=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:a.e},e}(),o=Object(i.r)("ItemParentHelper",r)},1897:function(e,t,n){"use strict";var a;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(a||(a={})),t.e=a},1925:function(e,t,n){"use strict";var a=n(1138);n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t}),n.d(t,"n",function(){return a.n})},1948:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1925),i=new a.e("Item",a.t.subject)},2439:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("DarkModeHelper")},2686:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)({name:"".concat("IsOneUpResourceKey",".isOneUp"),factory:{dependencies:{},create:function(e){return{instance:{isOneUp:!1}}}}})},2754:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a=n(543),i=new a.n("Click",a.a.event),r=new a.n("KeyPress",a.a.event),o=new a.n("Drop",a.a.event)},3277:function(e,t,n){"use strict";var a=n(321),i=!n(8).t.isActivated("F7255B0A-2C6F-4886-A517-2E825C3282F1","03/03/2022","Log isMySiteOwner for engagement events"),r=function(){function e(e,t){void 0===e&&(e={}),this._pageContext=t.pageContext}return e.prototype.getEngagementData=function(){var e,t=this._pageContext,n={},r={siteId:a.e.normalizeLower(t.siteId),webId:a.e.normalizeLower(t.webId),webTemplateId:t.webTemplate,extraData:n};return t.groupId&&(r.groupId=a.e.normalizeLower(t.groupId)),t.listId&&(r.listId=a.e.normalizeLower(t.listId)),t.listBaseTemplate>-1&&(r.listTemplateId="".concat(t.listBaseTemplate)),t.CorrelationId&&(n.CorrelationId=t.CorrelationId),n.isTeamsChannelSite=t.isTeamsChannelSite,n.isTeamsConnectedSite=t.isTeamsConnectedSite,0!==t.teamsChannelType&&(n.teamsChannelType=t.teamsChannelType),i&&(n.isMySiteOwner=!t||!!(null==t?void 0:t.isMySiteOwner)),e=t.isAnonymousGuestUser?"anonymousGuest":t.isEmailAuthenticationGuestUser?"autheticatedGuest":t.isExternalGuestUser?"externalGuest":"authenticated",n.accountRelation=e,r},e}();t.e=r},4564:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return k});var a=n(7),i=n(3277),r=n(119),o=n(226),s=Object(r.r)("PageContextEngagementHandler",i.e,{pageContext:o.s}),c=n(93),d=n(2439),l=function(){function e(e,t){this._instrumentationProvider=t.instrumentationProvider,this._darkModeHelper=t.darkModeHelper}return e.prototype.getEngagementData=function(){var e,t=this._instrumentationProvider,n=null===(e=this._darkModeHelper)||void 0===e?void 0:e.isODBDarkMode;return{currentPage:t.currentPageName()||"NA",previousPage:t.previousPageName()||"NA",extraData:{isDarkMode:void 0!==n?n:"NA"}}},e.dependencies={instrumentationProvider:c.s,darkModeHelper:d.e},e}(),u=Object(r.r)("PageEngagementHandler",l),f=n(1052),p=function(){function e(e,t){this._searchSession=t.searchSession}return e.prototype.getEngagementData=function(){return{extraData:{olsSearchSessionId:this._searchSession}}},e.dependencies={searchSession:f.e},e}(),m=Object(r.r)("SearchEngagementHandler",p),_=n(1658),h=n(29),b=n(1948),g=n(474),v=n(230),y=n(1651),S=!n(8).e.isActivated("D76F6EE1-ABD2-4CE0-9CEB-87FFB7715239","08/25/2022","Perform extra sanitization prior to logging extension"),D=function(){function e(e,t){this._currentItem=t.currentItem}return e.prototype.getEngagementData=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=this._currentItem,i=Object(_.getMostSpecificMatchingContext)(b.e,t),r=null!==(e=Object(v.a)(null==i?void 0:i.item))&&void 0!==e?e:Object(v.a)(a);if(r){var o=r.list,s=S?Object(y.e)(r.extension):r.extension,c={extension:s,createdFromExcel:o&&o.createdFromExcel,createdFromExisting:o&&o.createdFromExisting},d=r.graph&&r.graph.itemId||r.itemId;d&&(c.itemGraphId=d);var l=r.graph&&r.graph.driveId;l&&(c.itemGraphDriveId=l);var u=r.tsTraceId;u&&(c.tsTraceId=u);var f,p=r.queryType;return p&&(c.queryType=p),Object(g.e)(r.queryType)&&(f=r.searchProperties.isMetadataSearch?"MetadataSearch":"DoclibSearch"),{scenario:f,extraData:c}}},e.dependencies={currentItem:h.r.optional},e}(),I=Object(r.r)("ItemEngagementHandler",D),x=n(1870),C=n(155),O=n(1897),w=n(2686),E=function(){function e(e,t){this._currentItem=t.currentItem,this._itemParentHelper=t.itemParentHelper,this._pageContext=t.pageContext,this._resources=t.resources,this._focusItem=t.focusItem}return e.prototype.getEngagementData=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=this._currentItem,i=Object(_.getMostSpecificMatchingContext)(b.e,t),r=null!==(e=Object(v.a)(null==i?void 0:i.item))&&void 0!==e?e:Object(v.a)(a);if(r){var o=this._itemParentHelper,s=o.getFacetedAncestorOrSelf(r,"list"),c=s&&s.peek(),d=o.getFacetedAncestorOrSelf(r,"subsite"),l=d&&d.peek(),u={docId:r.properties.uniqueId};if(c){var f=c.list,p=f.id,m=f.templateType;u.listId=p,u.listTemplateId="".concat(m)}if(l&&l.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){var h=l.subsite,g=(p=h.id,h.siteCollectionId),y=h.webTemplateId;u.webId=p,u.webTemplateId="".concat(y),u.siteId=g}var S=this._pageContext.userDisplayName,D=this._pageContext.userLoginName,I=D&&-1!==D.lastIndexOf("@")?D.substring(0,D.lastIndexOf("@")):void 0;u.extraData||(u.extraData={});var x=void 0;if(r&&r.sharingType){var E=r&&r.sharingType;x=E===O.e.Shared||E===O.e.Public||E===O.e.PublicUnlisted}var A=this._resources.consume(w.e.optional).isOneUp;return C.e(u.extraData,{isInODB:r.itemFromServer&&r.itemFromServer.SiteTitle&&S?-1!==r.itemFromServer.SiteTitle.indexOf(S):void 0,isInODBv2:r.openUrl&&I?-1!==r.openUrl.toLowerCase().indexOf(I.toLowerCase()):void 0,isItemShared:x,isOneUp:A||this._focusItem&&!!Object(v.a)(this._focusItem)}),u}},e.dependencies={currentItem:h.r.optional,itemParentHelper:x.e,pageContext:o.s,resources:a.r,focusItem:h.m.optional},e}(),A=Object(r.r)("ItemEngagementHandler",E),L={pageContext:s.optional,page:u.optional,search:m.optional,item:I.optional,sharePointItem:A.optional},k=new a.t({name:"LegacyKnockoutEngagementHandlers",factory:{dependencies:L,create:function(e){var t=[],n=e.pageContext,a=e.page,i=e.search,r=e.item,o=e.sharePointItem;return n&&t.push(n),a&&t.push(a),i&&t.push(i),r&&t.push(r),o&&t.push(o),{instance:t}}}})}}]);