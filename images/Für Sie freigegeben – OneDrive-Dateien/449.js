(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[449],Array(346).concat([function(e,t,n){"use strict";n.r(t),n.d(t,"getLocaleNumberString",function(){return r});var a=n(163),i=n(39);function r(e,t,n){var i=n,r=a.t.language;if(e)try{i=e.toLocaleString(r,t)}catch(n){i=e.toLocaleString([],t)}return i}n.d(t,"format",function(){return i.format}),n.d(t,"formatToArray",function(){return i.formatToArray}),n.d(t,"doesStringEndWith",function(){return i.doesStringEndWith}),n.d(t,"doesStringStartWith",function(){return i.doesStringStartWith}),n.d(t,"rightPad",function(){return i.rightPad}),n.d(t,"leftPad",function(){return i.leftPad}),n.d(t,"findOneOf",function(){return i.findOneOf}),n.d(t,"equalsCaseInsensitive",function(){return i.equalsCaseInsensitive}),n.d(t,"capitalize",function(){return i.capitalize}),n.d(t,"decapitalize",function(){return i.decapitalize}),n.d(t,"pluralSelect",function(){return i.pluralSelect}),n.d(t,"getLocalizedCountValue",function(){return i.getLocalizedCountValue}),n.d(t,"formatWithLocalizedCountValue",function(){return i.formatWithLocalizedCountValue}),n.d(t,"repeat",function(){return i.repeat}),n.d(t,"padData",function(){return i.padData}),n.d(t,"localeStringMatch",function(){return i.localeStringMatch}),n.d(t,"replaceAll",function(){return i.replaceAll})}],Array(1270),[function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(1852),r=n(7),o=function(){function e(e,t){this._componentType=e,this.dependencies=Object(a.__assign)(Object(a.__assign)({},e.dependencies||{}),t||{})}return e.prototype.create=function(e){return{instance:Object(i.t)(this._componentType,e)}},e}();function s(e,t,n){return new r.t({name:e,factory:new o(t,n)})}},,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a=n(1537),i=n(430),r=n(8);function o(e){return decodeURI(e)}function s(e){var t;try{t=decodeURI(e)}catch(n){t=e}return t===e?e=Object(a.e)(e,!0):(e=e.replace("#","%23"),r.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")||i.e.isFeatureEnabled({ECS:83959})||!e.indexOf("%25")||(e=Object(a.e)(e,!0))),e}function c(e){return e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23")),e}}],Array(180),[function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return!1!==t.valueAccessor()&&n.element.setAttribute("data-is-scrollable","true"),n}return Object(a.__extends)(t,e),t}(n(178).t);function r(e){for(var t=e;t&&t!==document.body;){if(t.getAttribute&&"true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}return t&&t!==document.body||(t=window),t}t.e=i},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(1116),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.dataRequestorType,s=void 0===o?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r})||this}return Object(a.__extends)(t,e),t}(i.t):o,c=e.dataSourceName,d=void 0===c?"DataSource":c;this.dataRequestor=new s({qosName:d})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_){void 0===i&&(i="POST");var h=e(),b=a&&a(),g=this.needsRequestDigest(h);return this.dataRequestor.getData({url:h,parseResponse:t,qosName:n,additionalPostData:b,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:g,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_})},e}();t.t=r},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(0),i=n(291),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n,r=Object(a.__spreadArray)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments,!0);return"".concat(r.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.e.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.e.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.__extends)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()},,function(e,t,n){"use strict";var a=n(0),i=n(24),r=n(178),o=n(1124),s=n(1127),c=n(1803),d=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a._focusTracker=a.resources.consume(s.e),a._hasFocus=a.createObservable(!1),a._hasChildFocus=a.createObservable(!1),a._isBodyActive=a.createObservable(!1),a._value=a.createPureComputed(a._computeValue),a._isEnabled=a.createPureComputed(a._computeIsEnabled),a._onlyRecoverFromBody=a.createPureComputed(a._computeOnlyRecoverFromBody),a._shouldRecoverFocus=a.createPureComputed(a._computeShouldRecoverFocus);var r=n.ChildFocusBinding,d=void 0===r?o.e:r,l=n.applyBindingsToNode,u=void 0===l?i.applyBindingsToNode:l,f=n.recoverFocusExtenders,p=void 0===f?{rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}:f;return new(a.managed(d))({element:a.element,bindingContext:a.bindingContext,allBindingsAccessor:a.allBindingsAccessor,valueAccessor:function(){return{isDescendantOrSelfActive:a._hasChildFocus,isBodyActive:a._isBodyActive}}}),u(a.element,{hasFocus:a._hasFocus},a.bindingContext),a._scrollContainer=Object(c.t)(a.element),a.createBackgroundComputed(a._computeRecoverFocus).extend(p),a}return Object(a.__extends)(t,e),t.prototype._computeValue=function(){return this.valueAccessor()||{}},t.prototype._computeIsEnabled=function(){var e=this._value().isEnabled,t=void 0===e||e;return this.unwrapObservable(t)},t.prototype._computeOnlyRecoverFromBody=function(){var e=this._value().onlyRecoverFromBody,t=void 0!==e&&e;return this.unwrapObservable(t)},t.prototype._computeShouldRecoverFocus=function(){return this._isEnabled()&&!this._hasChildFocus()&&(!this._onlyRecoverFromBody()||this._isBodyActive())&&this._focusTracker.isWindowActive.peek()},t.prototype._computeRecoverFocus=function(){this._shouldRecoverFocus()&&this._recoverFocus()},t.prototype._recoverFocus=function(){var e=this._scrollContainer,t=e.scrollTop,n=e.scrollLeft;this._hasFocus(!0),e.scrollTop!==t&&(e.scrollTop=t),e.scrollLeft!==n&&(e.scrollLeft=n)},t}(r.t);t.e=d},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"r",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"n",function(){return _});var a,i,r,o,s,c=n(534),d=n(1802);function l(e){a=Object(c.t)(90076,e),i=Object(c.t)(90022,e),r=Object(c.t)(90128,e),o=Object(c.t)(90127,e),s=Object(c.t)(90058,e)}function u(){try{if(sessionStorage.getItem("externalSharingConfirmationDialog"))return parseInt(sessionStorage.getItem("externalSharingConfirmationDialog"))}catch(e){}return s&&d.g()?(s.logExposure(),s.variantToDisplay):0}function f(){return a&&d.re()?(a.logExposure(),a.variantToDisplay):0}function p(){return i&&d.$()?(i.logExposure(),i.variantToDisplay):0}function m(){return d.q()&&r?(r.logExposure(),r.variantToDisplay):0}function _(){return o&&d.H()?(o.logExposure(),o.variantToDisplay):0}},,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return m}),n.d(t,"a",function(){return _}),n.d(t,"r",function(){return h}),n.d(t,"d",function(){return b}),n.d(t,"l",function(){return g}),n.d(t,"t",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"c",function(){return S}),n.d(t,"u",function(){return D}),n.d(t,"i",function(){return I}),n.d(t,"s",function(){return C}),n.d(t,"o",function(){return O});var a=n(2579),i=n(1098),r=n(2877),o=n(430),s=n(814),c=n(2576),d=n(1885),l=n(1802),u=n(1804),f={ODB:772},p={ODB:1935};function m(e){return"anyoneLinkAbilities"===e||"anonymousLinkAbilities"===e?a.e.anyone:"organizationLinkAbilities"===e?a.e.organization:"peopleSharingLinkAbilities"===e?a.e.specificPeopleFlex:void 0}function _(e,t){return e===a.e.anyone?t.anyoneLinkAbilities?t.anyoneLinkAbilities:t.anonymousLinkAbilities:e===a.e.organization?t.organizationLinkAbilities:e===a.e.specificPeopleFlex||e===a.e.customLabeledSpecificPeople?t.peopleSharingLinkAbilities:t.directSharingAbilities}function h(e,t){var n=_(e,t);return(null==n?void 0:n.canManageEditLink)?n.canManageEditLink.enabled:!!(null==n?void 0:n.canAddInternalPrincipal)&&n.canAddInternalPrincipal.enabled}function b(e,t){var n,a=_(e,t);return!!(null==a?void 0:a.canManageReadLink)&&(null===(n=null==a?void 0:a.canManageReadLink)||void 0===n?void 0:n.enabled)}function g(e,t,n){if(o.e.isFeatureEnabled(f)&&!s.t[n]){var a=_(e,t);return(null==a?void 0:a.canManageReviewLink)?a.canManageReviewLink.enabled:!!(null==a?void 0:a.supportsReviewPermission)&&a.supportsReviewPermission.enabled}return!1}function v(e){var t=e.sharingInformation,n=e.audience,r=e.mode,o=!1,s=!1,f=!1,p=!1,m=!0;Object(u.T)(t)||(o=t.sharedObjectType===d.e.list,s=function(e){var t=e.audience,n=e.sharingRole,i=_(t,e.sharingAbilities);return(null==i?void 0:i.canManageManageListLink)?i.canManageManageListLink.enabled:t===a.e.existing&&(n===c.e.manageList||n===c.e.owner)}({audience:n,sharingAbilities:t.sharingAbilities,sharingRole:t.userRole}),p=g(n,t.sharingAbilities,t.fileExtension),l.s()&&(p=p||S(n,t.sharingAbilities,t.fileExtension)),f=h(n,t.sharingAbilities),m=l.k()||b(n,t.sharingAbilities));var v=r===i.e.addPeople||r===i.e.manageAccess||f,y=m;return(n==a.e.specificPeople&&O(n,t.sharingAbilities)||t.requiresAccessApproval&&!l.ie())&&(v=y=!0),{fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:s,shouldDisplay:o},review:{enabled:p,shouldDisplay:p},edit:{enabled:v,shouldDisplay:!0},view:{enabled:y,shouldDisplay:y}}}function y(e){var t=e.sharingInformation,n=e.scenarioId,a=!1,i=!1,r=!1;return Object(u.T)(t)||(a=t.sharedObjectType===d.e.list,i=function(e){var t=e.sharingRole;return t===c.e.manageList||t===c.e.owner}({sharingRole:t.userRole}),r=function(e,t){return e.sharedObjectType===d.e.list&&e.userRole===c.e.owner}(t)),{fullControl:{enabled:r,shouldDisplay:r},manageList:{enabled:i,shouldDisplay:a},review:{enabled:!1,shouldDisplay:!1},edit:{enabled:!0,shouldDisplay:!0},view:{enabled:"SharePrivateDraft"!==n,shouldDisplay:"SharePrivateDraft"!==n}}}function S(e,t,n){if(s.s===s.t[n]){var a=_(e,t);return a.canManageReviewLink?a.canManageReviewLink.enabled:!!a.supportsReviewPermission&&a.supportsReviewPermission.enabled}return!1}function D(e,t){var n=_(e,t);return!!n.supportsRestrictedView&&n.supportsRestrictedView.enabled}function I(e,t){var n=[];if(o.e.isFeatureEnabled(p))for(var a=0,i=t;a<i.length;a++){var r=i[a];if(r.linkDetails&&r.linkDetails.shareId){var s=_(r.linkDetails.audience,e);s.canManageEditLink&&s.canManageEditLink.enabled||s.canManageReviewLink&&s.canManageReviewLink.enabled||s.canManageReadLink&&s.canManageReadLink.enabled||r.linkDetails.expiration&&r.linkDetails.expiration<new Date(Date.now())||n.push(r.linkDetails)}}return n}function x(e,t,n){var a;if(!e||!t)return!1;var i=_(e,t);for(var r in i)if((null===(a=i[r])||void 0===a?void 0:a.disabledReason)==n)return!0;return!1}function C(e,t){return x(e,t,r.e.sharingBlockedByVirusCheckStatus)}function O(e,t){return x(e,t,r.e.irmIsEnabled)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(325),r=n(1820),o=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return Object(a.__extends)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,r=this;return(n||t===i.a.crossSite)&&(r=r.method("SP.RemoteWeb",a)),r.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(r.e),s=function(e){function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,r=n.itemUrlHelper,s=n.pageContext,c=n.encodeWebAbsoluteUrl,d=n.apiUrlType,l=void 0===d?function(e){function t(){return e.call(this,{},{itemUrlHelper:r,pageContext:s,encodeWebAbsoluteUrl:c})||this}return Object(a.__extends)(t,e),t}(o):d;return i._apiUrlType=l,i}return Object(a.__extends)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(r.t)},,,,,,,,,,,,function(e,t,n){"use strict";var a=n(0),i=(n(1860),n(24)),r=n(253),o=n(154),s=n(29),c=n(1013),d=n(163),l=n(350),u=n(705),f=n(178),p=n(347),m=n(1108),_=n(1761),h=n(171),b=n(1119),g=function(e){function t(t){var n=e.call(this,t)||this;return n.events.on(n.element,"contextmenu",n._onContextMenu),new(n.managed(m.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{mappings:{ShiftF10:function(e,t){return n._onContextMenu(t),!0}},preventDefault:!0,context:n.bindingContext.$data}}}),n}return Object(a.__extends)(t,e),t.createContextMenu=function(e,t,n,a){var r=null,s=t.anchorElement||Object(b.e)(e.target,t.rootElementClass);if(s&&t.items&&t.items.length>0){var c=void 0;if(t.anchorElement||e.clientX<=0&&e.clientY<=0||!e.clientX&&!e.clientY){var f=(t.anchorElement?t.anchorElement:e.target).getBoundingClientRect();c=new l.t(f.left,f.bottom)}else c=new l.t(e.clientX,e.clientY);var p=i.observable(c.x+"px"),m=i.observable(c.y+"px"),h=t.alignment||o.e.Left|o.e.Top;d.t.isRightToLeft&&(h|=o.e.Right);var g=null;if(t.boundingElementClass){var v=Object(b.e)(e.target,t.boundingElementClass);g=new u.t(v.getBoundingClientRect())}var y=document.createElement("div");y.style.position="absolute",y.style.top="0px",y.style.left="0px",r=y,document.body.appendChild(y),Object(_.e)(y,s),a||(a=function(){r&&(i.removeNode(r),r=null)});var S={component:{name:"ms-contextual-menu",params:{items:t.items,left:p,top:m,alignment:i.observable(h),offset:i.observable(t.point||l.t.ORIGIN),launchEvent:e,target:e.target,bounds:g,hideIcons:t.shouldHideIcons,fromKeyboardEvent:0===e.pointerId,anchorElement:t.anchorElement,close:t.dismissOnClick?a:null,isOpen:t.isMenuOpen}}};i.applyBindingsToNode(y,S,n)}return r},t.prototype._onContextMenu=function(e){var n=this,a=i.utils.unwrapObservable(this.valueAccessor()),o=(a&&a.resources||c.e(this.bindingContext)).consume(s.C.optional),d=function(){t._contextMenu&&(i.removeNode(t._contextMenu),t._contextMenu=null)};d();var l=e.target,u=null,f=null,p=null;if(r.e.hasClass(l,"noContextMenu")||e.shiftKey&&e instanceof MouseEvent||!a)return!0;for(var m=a.anchorElement||Object(b.e)(l,a.rootElementClass);u!==m;){var _=i.dataFor(l);if(_&&(!p&&_.item&&(p=_.item),p))break;if((f=l?l.getAttribute("data-selection-index"):null)&&(p=o&&o.getItemByIndex(f)))break;u=l,l=Object(h.e)(l)}var g=!1,v=i.dataFor(l);if(o&&v){var y=null===o.maximumSelectedCount||void 0===o.maximumSelectedCount||o.maximumSelectedCount>0;if(!p||!o.isItemSelected(p)&&y){if(o.selectedCount()>0?(o.clear(),g=!0):p&&(v.isSelected||f)&&(g=!0),g)var S=o.selection.subscribe(function(){S.dispose(),m&&n._openMenu(e,a,d)});p&&(v.isSelected||f)&&(o.toggleItemSelected(p),o.setItemFocus(p))}else p&&o.maximumSelectedCount<=0&&o.setItemFocus(p)}return!a||(m&&!g&&this._openMenu(e,a,d),e.preventDefault(),e.stopPropagation(),!1)},t.prototype._openMenu=function(e,n,a){n.engagementSource&&this.resources.consume(p.e).logData({name:"RightClick.".concat(n.engagementSource,".Click"),isIntentional:!0}),t._contextMenu&&(i.removeNode(t._contextMenu),t._contextMenu=null),t._contextMenu=t.createContextMenu(e,n,this.bindingContext,a)},t}(f.t);t.e=g},,,function(e,t,n){"use strict";n.r(t),n.d(t,"UserPhotoSize",function(){return o}),n.d(t,"tryGetAlternativeUrl",function(){return f}),n.d(t,"isAlterantiveUrlFresh",function(){return p}),n.d(t,"updateMap",function(){return m}),n.d(t,"getUrlTable",function(){return _}),n.d(t,"getUserPhotoUrl",function(){return h}),n.d(t,"_testGetCDNUrlExpiryFromCache",function(){return b});var a=n(68),i=n(128),r=n(47),o={Small:1,Medium:2,Large:3},s="_oat_",c="UserPhotoAspx",d={},l={},u="TryGetAlternativeUrlFailure";function f(e){var t,n;function a(e){return p(window[e].userPhotoCdnBaseUrl)?window[e].userPhotoCdnBaseUrl:(delete window[e].userPhotoCdnBaseUrl,"")}try{var o=d&&d[e];if(o||c!==e||((null===(t=window._spPageContextInfo)||void 0===t?void 0:t.userPhotoCdnBaseUrl)?o=a("_spPageContextInfo"):(null===(n=window._spHomePageContext)||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(o=a("_spHomePageContext"))),!o)return;return p(o)?o:void delete d[e]}catch(e){new i.e({name:u}).end({resultType:r.e.Failure,resultCode:"Unexpected",extraData:{error:e}})}}function p(e){if(-1===e.indexOf(s))return!0;var t=l[e];if(t)return Date.now()/1e3<t;var n=new a.t(e),o=n.getQueryParameter(s);if(o){var c=o.split("_");if(2===c.length&&(t=Number(c[0])),!t)return new i.e({name:u}).end({resultType:r.e.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:o}}),l[e]=Date.now()/1e3+86400,!0;if(t-=30,l[e]=t,Date.now()/1e3>t)return!1}var d=n.getQueryParameter("P1");if(!d)return!0;var f=Number(d);return f-=30,l[e]=Math.min(f,l[e]),!(Date.now()/1e3>f)}function m(e){if(e)for(var t in e)d[t]=e[t]}function _(){return d}function h(e,t,n){var i;switch(n=n||f(c)||"/_layouts/15/userphoto.aspx",t){case o.Medium:i="M";break;case o.Large:i="L";break;default:i="S"}var r=new a.t(n);return r.setQueryParameter("size",i),r.setQueryParameter("accountname",e||""),r.toString()}function b(e){return l[e]}},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s});var a=n(0),i=n(1),r={dependencies:n(1800).object.isRequired};function o(e,t){var n=e,o={dependencies:Object(a.__assign)({},t||{})},s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getChildContext=function(){return o},t.prototype.render=function(){return i.createElement(n,Object(a.__assign)({},this.props))},t.childContextTypes=Object(a.__assign)({},r),t}(i.Component);return s}function s(e,t){var n=e.contextTypes,i=void 0===n?{}:n,r=(i.dependencies,Object(a.__rest)(i,["dependencies"])),o=function(n,i){return e(n,Object(a.__assign)(Object(a.__assign)({},i),{dependencies:t}))};return o.contextTypes=r,o}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a={};n.r(a),n.d(a,"localStorage",function(){return i}),n.d(a,"indexedDB",function(){return r}),n.d(a,"none",function(){return o});var i=0,r=1,o=2,s=a},,,function(e,t,n){"use strict";var a=n(60),i=n(24),r=n(1117),o=Object(r.e)("ms-contextual-menu","./react/ReactContextualMenu",function(){return a.n.resolve(n.e(150).then(n.bind(null,4639)))});o.template='\x3c!--ko component:{name:\'od-overlay\',params:{alignToParent:false}}--\x3e<div role="application" data-bind="react:reactBindingParams"></div>\x3c!--/ko--\x3e',i.components.isRegistered(o.tagName)||i.components.register(o.tagName,o)},function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n(58),r=n(104),o=n(64),s=n(119),c=n(67),d=n(61),l=n(1845),u=n(10),f=n(1321),p=n(8),m=n(60);function _(e,t){return e.preferences[(t||"").toLowerCase()]}function h(e){return!!(e=e&&e.toLowerCase().replace(".",""))&&!l.e[e]||"pdf"===e}function b(e,t,n,i){var r=_(e,t);if(r)for(var o=0,s=Object(a.__spreadArray)(Object(a.__spreadArray)([],r.preview,!0),r.open,!0).filter(g);o<s.length;o++){var c=s[o],d=n&&c[n]||i&&c.handler[i];if(d)return d}}function g(e){return!e.handler.isPromoted}function v(e){return e.filter(g)[0]}var y=function(e){function t(t,n){var a,i=e.call(this,t,n)||this,s=Object(u.isFeatureEnabled)(u.FileHandlersV2),l="data",_=new r.e("FileHandlers",o.e.session);if(s)try{var h=_.getValue(l);a=h&&JSON.parse(h)}catch(e){}var b=i.observables,g=i.data=b.create(a);return g.equalityComparer=f.e,a&&4===a.version&&s||(g({actions:{custom:[],create:[],open:[],preview:[]},preferences:{},version:4}),_.setValue(l,JSON.stringify(g.peek()))),s&&b.backgroundCompute(function(){i.trackPromise(m.n.resolve(i.resources.consumeAsync(c._.optional)).then(function(e){if(e)return e.getFileHandlerData({includePromotedApp:!0})}).then(function(e){return e||i.resources.consumeAsync(c.m.optional).then(function(e){if(e)return p.t.isActivated("a9c8b4cd-bc43-466c-aeeb-106eec05d057","07/07/2021","Will try to use cookie to get filehandler instead of tokens.")?e.getFileHandlerData({includePromotedApp:!0}):e.getFileHandlerData({includePromotedApp:!0,allowCookies:!0})})}).then(function(e){e&&(_.setValue(l,JSON.stringify(e)),g(e))},function(e){d.e.logError(e)}))}),i}return Object(a.__extends)(t,e),t.prototype.getFileTypeIconUrl=function(e,t){return h(e)?this.getIconUrl(b(this._getData(t),e||"","icon","fileTypeIcon")):void 0},t.prototype.getFileTypeName=function(e,t){return h(e)?b(this._getData(t),e||"",void 0,"fileTypeDisplayName"):void 0},t.prototype.getIconUrl=function(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)},t.prototype.getDefaultOpenHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.open)},t.prototype.getDefaultPreviewHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.preview)},t.prototype.isActionForExtension=function(e,t){var n=e.availableOn.file,a=n&&n.extensions;return!!n&&(!a||a.indexOf(t.toLowerCase())>=0||a.indexOf(".*")>=0)},t.prototype._getData=function(e){return e?this.data.peek():this.data()},t}(i.n),S=Object(s.r)("FileHandlerProvider",y)},,,,,,,,,,,,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-ImageFrame{display:block;position:absolute;top:0;left:0;bottom:0;right:0}"}]);var i=n(399),r=n(1937),o=Object(i.e)({tagName:"od-image-frame",template:'<span class="od-ImageFrame" data-bind="component:{name:$component.imageStackTagName,params:$component.imageStackParams}"></span>',viewModel:r.t,synchronous:!0});t.e=o},,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return f});var a=n(60),i=n(119),r=n(1151),o=n(0),s=n(104),c=n(64),d=n(1923),l=function(e){function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200,n._Version=7;var a=window._sharingContextInfo;a&&(t._StorageKey="".concat(t._StorageKey).concat(a.webAbsoluteUrl)),n._buffer=n.getValue(t._StorageKey),n._buffer&&n._buffer.version===n._Version||n._initializeBuffer(),n._data={};for(var i=0;i<n._buffer.dataArray.length;i++)n._data[n._buffer.dataArray[i].email]=n._buffer.dataArray[i];return n}return Object(o.__extends)(t,e),t.clear=function(){new s.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)},t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone},t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var a=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[a]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++,this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email],this._buffer.dataArray[this._buffer.index]=e}else this._buffer.dataArray.push(e),this._buffer.index++;this._data[e.email]=e,this.setValue(t._StorageKey,this._buffer)},t.prototype.getItems=function(e,t){for(var n=[],a=0;a<this._buffer.dataArray.length;a++){var i=(this._buffer.index-a+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&this._buffer.dataArray[i].entityType===d.e.externalUser||n.push(this._buffer.dataArray[i])}return n},t.prototype.containsItem=function(e){return!!this._data[e.email]},t.prototype._initializeBuffer=function(){this._buffer={},this._buffer.dataArray=[],this._buffer.index=-1,this._buffer.version=this._Version},t._Key="ClientPeoplePicker",t._StorageKey="MRU",t._DataStoreCachingType=c.e.local,t}(s.e),u=function(){function e(e,t){var n=(this._dataSource=t.dataSource).getCapabilities().supportsMruCaching;n&&(this._mruCache=new l),this.MaxCacheSuggestions=n?5:0}return e.prototype.search=function(e,t){var n,i,r=this,o={cached:null,promise:null},s=t.useGraph,c=t.useSubstrate;return!this._mruCache||t.groupID||s||c||(i=this._searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(o.cached=i),o.promise=new a.n(function(a,o){n=r._dataSource.search(e,t).then(function(e){if(e)if(i){i.length>0&&(i=r._removeStaleCacheResults(i,e));var t=i.map(function(e){return e.userId});a(e.filter(function(e){return t.indexOf(e.userId)<0}))}else a(e)},function(e){o(e)})},function(){n&&n.cancel()}),o},e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){return n._mruCache&&e.isResolved&&n.addToMruCache(e),e})},e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})},e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t)},e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)},e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)},e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)},e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper&&this._dataSource.getLivePersonaPickerHelper()},e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)},e.prototype._searchMruCache=function(e,t){var n=[],a=this._mruCache;if(a){n=a.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n},e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),a=[];return t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var r=e[i];l.isCacheEntryFresh(r,t)&&a.push(r)}}),a},e}(),f=(t.e=u,Object(i.r)("PeoplePickerProvider",u,{dataSource:r.e}))},,,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=3e5,i=864e5,r="odsp-ds-",o={useCacheAndUpdateInTheBackground:0,useCacheIfNotExpired:1,onlyCache:2,bypassCache:3,useCacheAndNoUpdate:4}},function(e,t,n){"use strict";n.r(t),n.d(t,"ConfirmationCode",function(){return h.e}),n.d(t,"ConfirmationDialog",function(){return b});var a=n(0),i=n(1),r=n(1774),o=n(582),s=n(1509),c=n(1176),d=n(1642),l=n(39),u=n(1806),f=n(1801),p=n(17);Object(p.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ConfirmationDialog-subText{font-size:.75rem}.od-ConfirmationDialog-subText.large-font{font-size:.875rem}.od-ConfirmationDialog-subText--nowrap{white-space:nowrap}.od-confirmationDialog .ms-Dialog-main{width:95%}.od-confirmationDialog .od-confirmationDialog-footer{display:inline-block}.od-confirmationDialog .od-confirmationDialog-footer .ms-Button{min-width:70px;max-width:70px}.od-confirmationDialog .od-confirmationDialog-footer .ms-Button.isIE{padding-left:0;padding-right:0}.od-confirmationDialog .ms-Dialog-title{font-weight:600}[dir=ltr] .od-confirmationDialog-discard{float:left}[dir=rtl] .od-confirmationDialog-discard{float:right}.od-confirmationDialog-saveCancel{display:inline}.od-confirmationDialog-saveCancel .ms-Button{margin:0 4px}[dir=ltr] .od-confirmationDialog-copyLinkInterruptButtons{padding-right:8px}[dir=rtl] .od-confirmationDialog-copyLinkInterruptButtons{padding-left:8px}.od-ConfirmationDialog-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var m=n(1802),_=n(1829),h=n(1991),b=function(e){function t(t,n){var a=e.call(this,t)||this;return a._useNewLinkDelete=(Object(m.R)()||Object(_.n)())&&a.props.confirmationCode===h.e.link,a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t,n,a=this.props,p=a.confirmationCode,m=a.participant,_="od-confirmationDialog",b=u.m(this.props.clientId)?"isIE":"";switch(this._useNewLinkDelete&&(p=h.e.linkV2),p){case h.e.link:e=f.lt,t=f.ct,n=f.De;break;case h.e.linkV2:e=f.pt,t=f.dt,n=f.De;break;case h.e.linkBundle:e=f.ut,t=f.dt,n=f.De;break;case h.e.linkInheritance:e=f.ft,t=f.dt,n=f.De;break;case h.e.linkSettings:e=f.xe,t=f.Ie,n=f.De;break;case h.e.direct:e=l.format(f.rt,m.name),t=f.$r,n=f.De;break;case h.e.participant:e=l.format(f.bt,m.name),t=f.$r,n=f.De;break;case h.e.back:e=f.Ln,t=f.vo,n=f.De;break;case h.e.shareDialogPasswordOnly:e=f.Bs,t=f.Ws,n=f.zs,_+=" shareDialog";break;case h.e.shareDialogExpirationOnly:e=f.Bs,t=f.Ks,n=f.Vs,_+=" shareDialog";break;case h.e.shareDialogPasswordAndExpiration:e=f.Bs,t=f.qs,n=f.Gs,_+=" shareDialog";break;case h.e.copyInterruptUpdate:e=f.ze,t=f.He,n=f.Re,_+=" shareDialog";break;case h.e.copyInterruptRemove:e=f.je,t=f.He,n=f.Be,_+=" shareDialog";break;case h.e.addressBarLinkOff:e=this.props.companyName?l.format(f.Cs,this.props.companyName):f.xs,t=f.Ds,n=f.De;break;case h.e.shareDialogExternalSharing:e=f.Wt,t=f.Zs,n=f.De}return i.createElement("div",null,i.createElement(r.e,{hidden:!1,className:_,onDismiss:this.props.onCancel,dialogContentProps:{type:o.e.close,title:e,subTextId:"dialogSubtext",styles:{topButton:{width:"2rem",height:"2rem",selectors:{".ms-Dialog-button--close .ms-Button-flexContainer .ms-Icon":{fontSize:"1rem"}}},title:{fontSize:"1.25rem",overflowWrap:"break-word"},innerContent:{},button:{},content:{},subText:{},header:{},inner:{selectors:{".ms-Dialog-action .ms-Button":{height:"2rem"},".ms-Dialog-action .ms-Button-textContainer .ms-Button-label":{fontSize:"0.875rem"}}}}},modalProps:{isDarkOverlay:!0,isBlocking:!0,subtitleAriaId:"dialogSubtext"}},this._getDialogSubText(),p===h.e.back?i.createElement(s.e,{className:"od-confirmationDialog-footer"},i.createElement(c.e,{className:"od-confirmationDialog-discard ".concat(b),onClick:this.props.onDiscard?this.props.onDiscard:this.props.onCancel,text:f.St}),i.createElement("div",{className:"od-confirmationDialog-saveCancel"},i.createElement(d.e,{onClick:this.props.onApply,text:t}),i.createElement(c.e,{className:"".concat(b),onClick:this.props.onCancel,text:n}))):p===h.e.copyInterruptUpdate||p===h.e.copyInterruptRemove?i.createElement(s.e,null,i.createElement(d.e,{className:"od-ConfirmationDialog-copyLinkInterruptButtons","data-automationid":"ConfirmationDialog-InterruptButtons-Apply",onClick:this.props.onApply,text:t}),i.createElement(c.e,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onDiscard||this.props.onCancel,text:n})):i.createElement(s.e,null,i.createElement(d.e,{onClick:this.props.onApply,text:t}),i.createElement(c.e,{onClick:this.props.onCancel,text:n}))))},t.prototype._getDialogSubText=function(){var e=this.props.confirmationCode;this._useNewLinkDelete&&(e=h.e.linkV2);var t="";switch(e){case h.e.link:return i.createElement("div",{className:"od-ConfirmationDialog-subText",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,i.createElement("strong",null,f.ht),f.mt));case h.e.linkV2:return i.createElement("div",{className:"od-ConfirmationDialog-subText large-font",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,f.gt));case h.e.linkInheritance:return i.createElement("div",{className:"od-ConfirmationDialog-subText large-font",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,f._t));case h.e.linkBundle:return i.createElement("div",{className:"od-ConfirmationDialog-subText large-font",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,f.st));case h.e.linkSettings:return i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,f.G));case h.e.direct:return i.createElement("div",{className:"od-ConfirmationDialog-subText large-font",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,f.ot));case h.e.participant:return;case h.e.shareDialogPasswordOnly:return t=l.format(f.ii,this.props.linkPasswordSetBy),i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,t));case h.e.shareDialogExpirationOnly:return t=l.format(f.ai,this.props.linkExpiration),i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,t));case h.e.shareDialogPasswordAndExpiration:return t=l.format(f.ri,this.props.linkExpiration,this.props.linkPasswordSetBy),i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,t));case h.e.copyInterruptUpdate:return t=f.Ve,i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,t));case h.e.copyInterruptRemove:return t=f.Ne,i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,t));case h.e.addressBarLinkOff:return t=f.Is,i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,t));case h.e.shareDialogExternalSharing:var n=l.formatToArray(f.Kt,this.props.participant.email),a=n[0],r=n[1],o=n[2];return i.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},i.createElement("span",null,a,i.createElement("b",null,r),o))}},t}(i.Component);t.default=b},,function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"u",function(){return f}),n.d(t,"m",function(){return p}),n.d(t,"r",function(){return m}),n.d(t,"i",function(){return _}),n.d(t,"s",function(){return h}),n.d(t,"p",function(){return b}),n.d(t,"l",function(){return g}),n.d(t,"o",function(){return S});var a=n(2014),i=12;function r(e,t){var n=new Date(e.getTime());return n.setDate(n.getDate()+t),n}function o(e,t){return r(e,7*t)}function s(e,t){var n=new Date(e.getTime()),a=n.getMonth()+t;return n.setMonth(a),n.getMonth()!==(a%i+i)%i&&(n=r(n,-n.getDate())),n}function c(e,t){var n=new Date(e.getTime());return n.setFullYear(e.getFullYear()+t),n.getMonth()!==(e.getMonth()%i+i)%i&&(n=r(n,-n.getDate())),n}function d(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)}function l(e){return new Date(e.getFullYear(),e.getMonth()+1,0,0,0,0,0)}function u(e){return new Date(e.getFullYear(),0,1,0,0,0,0)}function f(e){return new Date(e.getFullYear()+1,0,0,0,0,0,0)}function p(e,t){return s(e,t-e.getMonth())}function m(e,t){return!e&&!t||!(!e||!t)&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function _(e,t){return S(e)-S(t)}function h(e,t,n,i,o){void 0===o&&(o=1);var c,d=[],l=null;switch(i||(i=[a.n.Monday,a.n.Tuesday,a.n.Wednesday,a.n.Thursday,a.n.Friday]),o=Math.max(o,1),t){case a.t.Day:l=r(c=y(e),o);break;case a.t.Week:case a.t.WorkWeek:c=function(e,t){var n=t-e.getDay();return n>0&&(n-=7),r(e,n)}(y(e),n),l=r(c,7);break;case a.t.Month:l=s(c=new Date(e.getFullYear(),e.getMonth(),1),1);break;default:throw new Error("Unexpected object: "+t)}var u=c;do{(t!==a.t.WorkWeek||-1!==i.indexOf(u.getDay()))&&d.push(u),u=r(u,1)}while(!m(u,l));return d}function b(e,t){for(var n=0,a=t;n<a.length;n++)if(m(e,a[n]))return!0;return!1}function g(e,t,n,i){var r=i.getFullYear(),o=i.getMonth(),s=1,c=s+(t+7-1)-function(e,t){return e!==a.n.Sunday&&t<e?t+7:t}(t,new Date(r,o,s).getDay()),d=new Date(r,o,c);s=d.getDate();for(var l=[],u=0;u<e;u++)l.push(v(d,t,n)),s+=7,d=new Date(r,o,s);return l}function v(e,t,n){switch(n){case a.a.FirstFullWeek:return D(e,t,7);case a.a.FirstFourDayWeek:return D(e,t,4);default:return function(e,t){var n=I(e)-1,a=(e.getDay()-n%7-t+14)%7;return Math.floor((n+a)/7+1)}(e,t)}}function y(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function S(e){return e.getDate()+(e.getMonth()<<5)+(e.getFullYear()<<9)}function D(e,t,n){var i=I(e)-1,r=e.getDay()-i%7,o=I(new Date(e.getFullYear()-1,a.i.December,31))-1,s=(t-r+14)%7;0!==s&&s>=n&&(s-=7);var c=i-s;return c<0&&(0!=(s=(t-(r-=o%7)+14)%7)&&s+1>=n&&(s-=7),c=o-s),Math.floor(c/7+1)}function I(e){for(var t=e.getMonth(),n=e.getFullYear(),a=0,i=0;i<t;i++)a+=x(i+1,n);return a+e.getDate()}function x(e,t){return new Date(t,e,0).getDate()}},,,,,,,,,function(e,t,n){"use strict";var a=n(0),i=n(178),r=n(164),o=n(101),s=new r.e,c=new o.t(window),d=0,l=[],u={};function f(){for(var e in u)m(u[e])}function p(){for(;l.length;){var e=l.pop();e.isDisposed||(u[e.id]=e,m(e))}}function m(e){if(void 0!==e.element.getBoundingClientRect){var t=e.element.getBoundingClientRect(),n=t.top<window.innerHeight&&t.bottom>=0;(e.allowHiddenSizeUpdates||n)&&e.size&&e.size(e.includePosition?{bottom:t.bottom,left:t.left,right:t.right,top:t.top,height:t.height,width:t.width}:{height:t.height,width:t.width}),e.isOnScreen&&e.isOnScreen(n)}}c.onAll(window,{resize:s.debounce(f,50),scroll:s.throttle(f,50,{leading:!1})}),c.on(document,"transitionend",s.debounce(f,300),!0);var _=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i={id:d++,element:n.element,isDisposed:!1,size:a.size,isOnScreen:a.isOnScreen,allowHiddenSizeUpdates:a.allowHiddenSizeUpdates,includePosition:!!a.includePosition};return a.trigger&&n.createComputed(function(){a.trigger(),m(i)}),l.push(i),s.setTimeout(p,0),n.addDisposable({dispose:function(){i.isDisposed=!0,delete u[i.id]}}),n}return Object(a.__extends)(t,e),t}(i.t);t.e=_},,,,,,,,,,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.smallFluid=0]="smallFluid",e[e.smallFixedFar=1]="smallFixedFar",e[e.smallFixedNear=2]="smallFixedNear",e[e.medium=3]="medium",e[e.large=4]="large",e[e.largeFixed=5]="largeFixed",e[e.extraLarge=6]="extraLarge",e[e.custom=7]="custom",e[e.customNear=8]="customNear"}(a||(a={}))},,,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return s});var a=n(1116);n.d(t,"e",function(){return a.t});var i=n(472),r=n(1136),o=n(119),s=Object(o.o)("DataRequestor",a.t,{pageContext:i.e,offlineDetection:r.e});t.t=a.t},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(1526),i=n(0),r=n(1),o=n(109),s=n(809),c=Object(s.e)({cacheSize:100}),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,a=e.children,s=e.className,d=e.disabled,l=e.styles,u=e.required,f=e.theme,p=c(l,{className:s,disabled:d,required:u,theme:f});return r.createElement(n,Object(i.__assign)({},Object(o.s)(this.props,o.r),{className:p.root}),a)},t}(r.Component),l=n(21),u=Object(a.e)(d,function(e){var t,n=e.theme,a=e.className,r=e.disabled,o=e.required,s=n.semanticColors,c=l.r.semibold,d=s.bodyText,u=s.disabledBodyText,f=s.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:c,color:d,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},r&&{color:u,selectors:(t={},t[l.o]=Object(i.__assign)({color:"GrayText"},Object(l.x)()),t)},o&&{selectors:{"::after":{content:"' *'",color:f,paddingRight:12}}},a]}},void 0,{scope:"Label"})},,,function(e,t,n){"use strict";var a=n(0),i=n(58),r=n(24),o=n(171),s=function(e){function t(){var t=e.call(this)||this;return t._focusedIndex=-1,t._subscriptions=[],t._selectItemKeyToModel={},t.keyToIndexHash={},t.indexToKeyHash={},t.unresolvedSelectedIndices={},t._focusedIndex=-1,t._subscriptions=[],t._selectItemKeyToModel={},t.itemSet=r.observable(null),t.layout=r.observable(),t.selection=r.observableArray().extend({rateLimit:{timeout:200,method:"notifyWhenChangesStop"}}),t.selectionKeyHash=r.observable({}),t.focused=r.observable().extend({rateLimit:{timeout:50,method:"notifyWhenChangesStop"}}),t.items=r.observableArray(),t.focusedKeyHash=r.observable({}),t.isAllSelected=r.observable(!1),t.isActive=r.observable(!1),t.clearSelectionOnRemoval=!1,t.selectFirstItemOnActivate=!0,t}return Object(a.__extends)(t,e),t._set=function(e,t,n,a){(e=r.utils.unwrapObservable(e))&&e.hasOwnProperty(t)&&r.isObservable(e[t])&&e[t](n),e&&e.key&&(a()[e.key]=n,a.valueHasMutated())},t._setAll=function(e,n,a,i){for(var r=0;r<e.length;r++)t._set(e[r],n,a,i)},t._hasCssClass=function(e,t){return!!(e&&e.className&&-1!==e.className.indexOf(t)&&e.className.match("\\b"+t+"\\b"))},t._getParentElement=function(e){return e&&Object(o.e)(e)||null},t._insideElementWithClass=function(e,n,a){a=a||null;for(var i=e;i;){if(t._hasCssClass(i,n))return!0;if(i===a)return!1;i=t._getParentElement(i)}return!1},t.prototype.init=function(e){var n=this;if(!this.items)throw new Error("The selection binding can only be used together with `foreach`, `foreach: { data: ... }`, `template: { foreach: ... }` or like `selection: { data: ... }`.");if(!r.isObservable(this.selection))throw new Error("The selection binding should be bound to either an `observableArray` or a object containing a `selection` `observableArray`.");this.properties=e.properties,this._buildKeyIndexHash(),this.async.setTimeout(function(){n.cleanup(),n._updateFocused(e.properties.focused,!0)},0),this._subscriptions=[],this._subscriptions.push(this.focused.subscribe(function(e){var t;(t=(e=r.utils.unwrapObservable(e))?e.key:null)&&n._updateIsFocusedObservable(t,!1)},this,"beforeChange")),this._subscriptions.push(this.focused.subscribe(function(e){n._focusedIndex=e?n._findItemIndex(n.focused()):-1,n._focusedIndex>-1&&n._updateIsFocusedObservable(n.indexToKeyHash[n._focusedIndex],!0)})),this._subscriptions.push(this.selection.subscribe(function(a){t._setAll(n.selection(),e.properties.selected,!1,n.selectionKeyHash)},this,"beforeChange")),this._subscriptions.push(this.selection.subscribe(function(a){"single"===n.mode()&&a.length>1?n.selection([a.slice(-1)[0]]):t._setAll(a,e.properties.selected,!0,n.selectionKeyHash);var i=n.items().length,r=n.selection().length;n.isAllSelected(i>0&&i===r)})),this._subscriptions.push(this.items.subscribe(function(e){n._buildKeyIndexHash(),n.cleanup()})),t._setAll(this.selection.peek(),e.properties.selected,!0,this.selectionKeyHash),this._subscriptions.push(this.focused.subscribe(function(a){t._set(a,e.properties.focused,!1,n.focusedKeyHash)},this,"beforeChange")),this._subscriptions.push(this.focused.subscribe(function(a){t._set(a,e.properties.focused,!0,n.focusedKeyHash)})),this.focused()&&t._set(this.focused(),e.properties.focused,!0,this.focusedKeyHash)},t.prototype.cleanup=function(){var e=this;if(!this.itemSet.peek()||!this.itemSet.peek().isPlaceholder){var t=[];if(this.focused.peek()){var n=this._findItemIndex(this.focused.peek());-1===n?this.focused(null):this._focusedIndex=n}this.anchor.peek()&&-1===this._findItemIndex(this.anchor.peek())&&this.anchor(null),this.isAllSelected()?this.selectAll():(r.utils.arrayForEach(this.selection.peek(),function(n){-1!==e._findItemIndex(n)&&t.push(n)}),t.length!==this.selection.peek().length&&this.selection(t))}},t.prototype.clear=function(){this.focused&&this.focused(null),this.anchor&&this.anchor(null),this._focusedIndex=-1,this.removeSelection()},t.prototype.hasHorizontal=function(){return"horizontal"===this.direction.peek()},t.prototype.hasVertical=function(){return"vertical"===this.direction.peek()},t.prototype.hasCustom=function(){return"custom"===this.direction.peek()},t.prototype.toggleAllSelected=function(){this.selection.peek().length===this.items.peek().length?(this.selection([]),this._updateAllSelectItemViewModels(!1)):this.selectAll()},t.prototype.selectAll=function(){var e=this.items.peek().slice();this.unresolvedSelectedIndices={};for(var t=0;t<e.length;t++)e[t]||(this.unresolvedSelectedIndices[t]=!0);this.selection(this.items().slice()),this._updateAllSelectItemViewModels(!0)},t.prototype.selectItem=function(e){var t=[],n=r.utils.unwrapObservable(e);this._updateSelectItemViewModelInSelection(!1),e&&(t.push(e),this._updateIsSelectedObservable(n.key,!0)),this.selection(t),this.focused(e)},t.prototype.firstItem=function(){return this.items()[0]},t.prototype.lastItem=function(){return this.items()[this.items().length-1]},t.prototype.nextItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.min(t+1,this.items().length-1)]},t.prototype.previousItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.max(t-1,0)]},t.prototype.leftItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexLeft(t)]:this.hasHorizontal()?this.previousItem(e):null},t.prototype.aboveItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexAbove(t)]:this.hasVertical()?this.previousItem(e):null},t.prototype.rightItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexRight(t)]:this.hasHorizontal()?this.nextItem(e):null},t.prototype.belowItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexBelow(t)]:this.hasVertical()?this.nextItem(e):null},t.prototype.isAlreadySelected=function(e){var t=r.utils.unwrapObservable(e);return t.hasOwnProperty("key")?!0===this.selectionKeyHash()[t.key]:-1!==r.utils.arrayIndexOf(this.selection(),e)},t.prototype.toggleSelection=function(e,t){var n=r.utils.unwrapObservable(e);this.isAlreadySelected(e)?t||(this.selection.remove(e),this._updateIsSelectedObservable(n.key,!1)):!1!==t&&(this.selection.push(e),this._updateIsSelectedObservable(n.key,!0)),this.focused(e)},t.prototype.removeSelection=function(){this.unresolvedSelectedIndices={},this.selection([]),this._updateAllSelectItemViewModels(!1)},t.prototype.appendSelectionWithCurrentItem=function(e){if(e){if(this.anchor(e),!this.isAlreadySelected(e)){var t=r.utils.unwrapObservable(e);this.selection.push(e),this._updateIsSelectedObservable(t.key,!0)}this.focused(e)}},t.prototype.appendSelectionFromAnchor=function(e){if(e){var t=this.anchor.peek();t?this.selection.remove(t):this.anchor(e),this.selection.push.apply(this.selection,this._createRange(this.items,this.anchor(),e,!0)),this._updateSelectItemViewModelInSelection(!0),this.focused(e)}},t.prototype.replaceSelectionWithRangeFromAnchor=function(e){e&&(this.anchor.peek()||this.anchor(e),this._updateSelectItemViewModelInSelection(!1),this.selection(this._createRange(this.items,this.anchor.peek(),e)),this._updateSelectItemViewModelInSelection(!0),this.focused(e))},t.prototype.findItemData=function(e){var t=r.contextFor(e);if(!t||!t.$data)return null;for(var n=this._getItemFromContext(t)||t.$data;t;){if(n&&this._findItemIndex(n)>=0)return n;t=t.$parentContext,n=this._getItemFromContext(t)}return null},t.prototype.isClickOnToggleElement=function(e,n){var a=this.toggleClass;return!!a&&t._insideElementWithClass(n,a,e)},t.prototype.activate=function(){r.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!0),this.isActive(!0)},t.prototype.deactivate=function(){r.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!1),this.isActive(!1)},t.prototype.subscribeSelectItemViewModel=function(e,t){this._selectItemKeyToModel[e]?this._selectItemKeyToModel[e].push(t):this._selectItemKeyToModel[e]=[t]},t.prototype.disposeSelectItemViewModel=function(e,t){var n=this._selectItemKeyToModel[e],a=-1;n&&((a=n.indexOf(t))>-1&&n.splice(a,1),0===n.length&&delete this._selectItemKeyToModel[e])},t.prototype.getFocusedItemKey=function(){var e=null;return this._focusedIndex>-1&&(e=this.indexToKeyHash[this._focusedIndex]),e},t.prototype.ensureFocusedItemViewModel=function(){var e=this.getFocusedItemKey();this._updateIsFocusedObservable(e,!0)},t.prototype.setFocusItemByKey=function(e){var t=this.keyToIndexHash[e];void 0!==t&&this.focused(this.items.peek()[t])},t.prototype.getViewModelsForKey=function(e){return this._selectItemKeyToModel[e]},t.prototype._findItemIndex=function(e){var t=-1,n=r.utils.unwrapObservable(e);if(n)if(n.hasOwnProperty("key")){var a=this.keyToIndexHash[n.key];void 0!==a&&(t=a)}else t=r.utils.arrayIndexOf(this.items.peek(),e);return t},t.prototype._getKeyForItem=function(e){var t,n=r.utils.unwrapObservable(e);return n&&n.hasOwnProperty("key")&&(t=n.key),t},t.prototype._createRange=function(e,t,n,a){var i=this.selectionKeyHash(),r=e(),o=this._findItemIndex(t),s=this._findItemIndex(n),c=[];if(o>s){var d=o;o=s,s=d}for(var l=o;l<=s;l+=1){var u=this._getKeyForItem(r[l]);u?a&&i[u]||c.push(r[l]):this.unresolvedSelectedIndices[l]=!0}return c},t.prototype._updateFocused=function(e,t){for(var n=this.items.peek(),a=0;a<n.length;a++){var i=n[a];if(i&&i.hasOwnProperty(e)&&r.isObservable(i[e])&&i[e]()===t){this.focused(i);break}}},t.prototype._updateIsSelectedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isSelected(t)})},t.prototype._updateIsFocusedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isFocused(t)})},t.prototype._updateAllSelectItemViewModels=function(e){for(var t in this._selectItemKeyToModel)this._selectItemKeyToModel[t].forEach(function(t){t.isSelected(e)})},t.prototype._updateSelectItemViewModelInSelection=function(e){for(var t,n,a=this.selection.peek(),i=0;i<a.length;i++)(t=r.utils.unwrapObservable(a[i]))&&(n=t.key,this._updateIsSelectedObservable(n,e))},t.prototype._buildKeyIndexHash=function(){var e,t,n=this.items.peek();this.keyToIndexHash={},this.indexToKeyHash={};for(var a=0;a<n.length;a++)(t=r.utils.unwrapObservable(n[a]))&&t.hasOwnProperty("key")&&(e=t.key,this.keyToIndexHash[e]=a,this.indexToKeyHash[a]=e);this._checkUnresolvedIndicies()},t.prototype._checkUnresolvedIndicies=function(){var e,t=this.items.peek();for(var n in this.unresolvedSelectedIndices)t[Number(n)]&&(delete this.unresolvedSelectedIndices[n],(e=e||{})[n]=!0);if(e){for(var a=[],i=this.selectionKeyHash.peek(),r=0;r<t.length;r++){var o=t[r];(i[this._getKeyForItem(o)]||e[r]||this.unresolvedSelectedIndices[r])&&a.push(o)}this.selection(a)}},t.prototype._getItemFromContext=function(e){return e&&e.$data?"function"==typeof e.$data.getItem?e.$data.getItem():e.$data.isSelectable?e.$data:null:null},t}(i.n);t.e=s},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(21),r={root:"ms-TextField",description:"ms-TextField-description",errorMessage:"ms-TextField-errorMessage",field:"ms-TextField-field",fieldGroup:"ms-TextField-fieldGroup",prefix:"ms-TextField-prefix",suffix:"ms-TextField-suffix",wrapper:"ms-TextField-wrapper",revealButton:"ms-TextField-reveal",multiline:"ms-TextField--multiline",borderless:"ms-TextField--borderless",underlined:"ms-TextField--underlined",unresizable:"ms-TextField--unresizable",required:"is-required",disabled:"is-disabled",active:"is-active"};function o(e){var t=e.underlined,n=e.disabled,a=e.focused,r=e.theme,o=r.palette,s=r.fonts;return function(){var e;return{root:[t&&n&&{color:o.neutralTertiary},t&&{fontSize:s.medium.fontSize,marginRight:8,paddingLeft:12,paddingRight:0,lineHeight:"22px",height:32},t&&a&&{selectors:(e={},e[i.o]={height:31},e)}]}}}function s(e){var t,n,s,c,d,l,u,f,p,m,_,h,b=e.theme,g=e.className,v=e.disabled,y=e.focused,S=e.required,D=e.multiline,I=e.hasLabel,x=e.borderless,C=e.underlined,O=e.hasIcon,w=e.resizable,E=e.hasErrorMessage,A=e.inputClassName,L=e.autoAdjustHeight,k=e.hasRevealButton,M=b.semanticColors,P=b.effects,T=b.fonts,U=Object(i.I)(r,b),F={background:M.disabledBackground,color:v?M.disabledText:M.inputPlaceholderText,display:"flex",alignItems:"center",padding:"0 10px",lineHeight:1,whiteSpace:"nowrap",flexShrink:0,selectors:(t={},t[i.o]={background:"Window",color:v?"GrayText":"WindowText"},t)},H=[{color:M.inputPlaceholderText,opacity:1,selectors:(n={},n[i.o]={color:"GrayText"},n)}],R={color:M.disabledText,selectors:(s={},s[i.o]={color:"GrayText"},s)};return{root:[U.root,T.medium,S&&U.required,v&&U.disabled,y&&U.active,D&&U.multiline,x&&U.borderless,C&&U.underlined,i.H,{position:"relative"},g],wrapper:[U.wrapper,C&&[{display:"flex",borderBottom:"1px solid "+(E?M.errorText:M.inputBorder),width:"100%"},v&&{borderBottomColor:M.disabledBackground,selectors:(c={},c[i.o]=Object(a.__assign)({borderColor:"GrayText"},Object(i.x)()),c)},!v&&{selectors:{":hover":{borderBottomColor:E?M.errorText:M.inputBorderHovered,selectors:(d={},d[i.o]=Object(a.__assign)({borderBottomColor:"Highlight"},Object(i.x)()),d)}}},y&&[{position:"relative"},Object(i.w)(E?M.errorText:M.inputFocusBorderAlt,0,"borderBottom")]]],fieldGroup:[U.fieldGroup,i.H,{border:"1px solid "+M.inputBorder,borderRadius:P.roundedCorner2,background:M.inputBackground,cursor:"text",height:32,display:"flex",flexDirection:"row",alignItems:"stretch",position:"relative"},D&&{minHeight:"60px",height:"auto",display:"flex"},!y&&!v&&{selectors:{":hover":{borderColor:M.inputBorderHovered,selectors:(l={},l[i.o]=Object(a.__assign)({borderColor:"Highlight"},Object(i.x)()),l)}}},y&&!C&&Object(i.w)(E?M.errorText:M.inputFocusBorderAlt,P.roundedCorner2),v&&{borderColor:M.disabledBackground,selectors:(u={},u[i.o]=Object(a.__assign)({borderColor:"GrayText"},Object(i.x)()),u),cursor:"default"},x&&{border:"none"},x&&y&&{border:"none",selectors:{":after":{border:"none"}}},C&&{flex:"1 1 0px",border:"none",textAlign:"left"},C&&v&&{backgroundColor:"transparent"},E&&!C&&{borderColor:M.errorText,selectors:{"&:hover":{borderColor:M.errorText}}},!I&&S&&{selectors:(f={":before":{content:"'*'",color:M.errorText,position:"absolute",top:-5,right:-10}},f[i.o]={selectors:{":before":{color:"WindowText",right:-14}}},f)}],field:[T.medium,U.field,i.H,{borderRadius:0,border:"none",background:"none",backgroundColor:"transparent",color:M.inputText,padding:"0 8px",width:"100%",minWidth:0,textOverflow:"ellipsis",outline:0,selectors:(p={"&:active, &:focus, &:hover":{outline:0},"::-ms-clear":{display:"none"}},p[i.o]={background:"Window",color:v?"GrayText":"WindowText"},p)},Object(i.E)(H),D&&!w&&[U.unresizable,{resize:"none"}],D&&{minHeight:"inherit",lineHeight:17,flexGrow:1,paddingTop:6,paddingBottom:6,overflow:"auto",width:"100%"},D&&L&&{overflow:"hidden"},O&&!k&&{paddingRight:24},D&&O&&{paddingRight:40},v&&[{backgroundColor:M.disabledBackground,color:M.disabledText,borderColor:M.disabledBackground},Object(i.E)(R)],C&&{textAlign:"left"},y&&!x&&{selectors:(m={},m[i.o]={paddingLeft:11,paddingRight:11},m)},y&&D&&!x&&{selectors:(_={},_[i.o]={paddingTop:4},_)},A],icon:[D&&{paddingRight:24,alignItems:"flex-end"},{pointerEvents:"none",position:"absolute",bottom:6,right:8,top:"auto",fontSize:i.c.medium,lineHeight:18},v&&{color:M.disabledText}],description:[U.description,{color:M.bodySubtext,fontSize:T.xSmall.fontSize}],errorMessage:[U.errorMessage,i.e.slideDownIn20,T.small,{color:M.errorText,margin:0,paddingTop:5,display:"flex",alignItems:"center"}],prefix:[U.prefix,F],suffix:[U.suffix,F],revealButton:[U.revealButton,"ms-Button","ms-Button--icon",Object(i.D)(b,{inset:1}),{height:30,width:32,border:"none",padding:"0px 4px",backgroundColor:"transparent",color:M.link,selectors:{":hover":{outline:0,color:M.primaryButtonBackgroundHovered,backgroundColor:M.buttonBackgroundHovered,selectors:(h={},h[i.o]={borderColor:"Highlight",color:"Highlight"},h)},":focus":{outline:0}}},O&&{marginRight:28}],revealSpan:{display:"flex",height:"100%",alignItems:"center"},revealIcon:{margin:"0px 4px",pointerEvents:"none",bottom:6,right:8,top:"auto",fontSize:i.c.medium,lineHeight:18},subComponentStyles:{label:o(e)}}}},function(e,t,n){"use strict";var a=n(24),i=n(1930),r=function(){function e(){this.handlers=[]}return e.prototype.register=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length-1;n++)this.handlers.push({pattern:e[n],callback:e[e.length-1]})},e.prototype.match=function(e,t){for(var n=0;n<this.handlers.length;n++)if(this._compare(this.handlers[n].pattern,e)){var a=this.handlers[n].callback.call(this,e,t);return"boolean"!=typeof a||a}return!1},e.prototype._compare=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0},e}(),o=r,s=n(101),c=n(112),d=function(){function e(){}return e.init=function(t,n,r,o,c){var d,l=a.utils.unwrapObservable(n()),u=r(),f=new s.t(null),p={mode:"multi",direction:"custom",properties:{selected:"selected",focused:"focused",activeClass:"selection-active"}},m=l.selectionModel||new i.e;d=l.data?l.data:u.foreach&&u.foreach.data||u.foreach||u.template&&u.template.foreach,m.items=a.isObservable(d)?d:a.observableArray(d),m.rootElement=a.observable(t),l?(m.focused=l.focused||a.observable(null),m.anchor=l.anchor||a.observable(null),m.layout=l.layout||a.observable(null),m.toggleClass=m.layout()?m.layout().getToggleClass():l.toggleClass||null,m.clearSelectionOnRemoval=l.clearSelectionOnRemoval,m.selectFirstItemOnActivate="boolean"!=typeof l.selectFirstItemOnActivate||l.selectFirstItemOnActivate,a.isObservable(l.mode)?m.mode=l.mode:m.mode=a.observable(l.mode||p.mode),a.isObservable(l.direction)?m.direction=l.direction:m.direction=a.observable(l.direction||p.direction),a.utils.extend(p.properties,l.properties)):(m.selection=a.observableArray(l.data),m.focused=a.observable(null),m.anchor=a.observable(null),m.mode=a.observable(p.mode),m.direction=a.observable(p.direction),m.layout=null),m.init(p);var _=e.getMode(m.mode())(m,l.isReadyToBeSelected);e._registerEventHandlers(f,t,m,_,l.alwaysSelectFirst,l.isActive,l.allowInputEvents),a.utils.domNodeDisposal.addDisposeCallback(t,function(){m.clearSelectionOnRemoval&&m.clear(),f.dispose()})},e.getMode=function(t){var n=e.modes[t];if(!n)throw new Error('Unknown mode: "'+t+'"');return n},e._registerEventHandlers=function(e,t,n,a,i,r,o){function s(e){var t=e.target,i=t&&"A"===t.tagName,r=n.findItemData(e.target);e.hasItem=!!r,e.isClickOnToggleElement=n.isClickOnToggleElement(this,e.target),i||a.match(e,r)}e.on(t,"touchstart",s),e.on(t,"touchend",s),e.on(t,"touchmove",s),e.on(t,"click",s),e.on(t,"focusin",function(e){if(!(e.relatedTarget&&t.contains(e.relatedTarget)||n.isActive.peek())){if(i){var a=n.firstItem();n.focused(a),n.anchor(a)}else if(e.target===t){var r=n.focused.peek();0===n.selection.peek().length&&!r&&n.selectFirstItemOnActivate?(a=n.firstItem(),n.focused(a),n.anchor(a),n.selectItem(a)):r&&(n.selectItem(r),n.anchor(r))}n.activate()}}),e.on(t,"focusout",function(e){e.relatedTarget&&!t.contains(e.relatedTarget)&&n.deactivate()}),e.on(t,"keydown",function(e){var i=e.target,s=i&&("INPUT"===i.tagName||"TEXTAREA"===i.tagName);if(!o&&s||r&&!r())return!0;var d=n.focused.peek();e.hasItem=!!d,e.keyCode===c.e.tab&&e.shiftKey&&!e.ctrlKey&&t.focus(),a.match(e,d)&&(e.stopPropagation(),e.preventDefault())})},e._isItemReadyToBeSelected=function(e,t){var n=!1;return!e||t&&!t(e)||(n=!0),n},e._getSingleMatchers=function(t,n){t.focused()?t.selection([t.focused()]):t.selection.splice(1);var a=new o;return a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.end},function(e,n){var a=t.lastItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.space,hasItem:!0},function(e,t){}),(t.hasVertical()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.up,hasItem:!1},{type:"keydown",which:c.e.down,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.up,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),(t.hasHorizontal()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.left,hasItem:!1},{type:"keydown",which:c.e.right,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.left,hasItem:!0},{type:"keydown",which:c.e.tab,shiftKey:!0,hasItem:!0},function(a,i){var r=t.leftItem(i);if(i===t.firstItem())return!1;e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,hasItem:!0},{type:"keydown",which:c.e.tab,hasItem:!0},function(a,i){var r=t.rightItem(i);if(i===t.lastItem())return!1;e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),a},e._getMultiMatchers=function(t,n){var a=new o;return a.register({type:"click",which:1,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)}),a.register({type:"click",which:1,ctrlKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,hasItem:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"click",which:1,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)}),a.register({type:"click",which:1,hasItem:!1},function(e,n){t.removeSelection()}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.space,hasItem:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.end,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:c.e.end,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.lastItem())}),a.register({type:"keydown",which:c.e.end,ctrlKey:!0},{type:"keydown",which:c.e.end,metaKey:!0},function(e,n){var a=t.lastItem();t.focused(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.end,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.lastItem())}),a.register({type:"keydown",which:c.e.end},function(e,n){var a=t.lastItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:c.e.home,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.firstItem())}),a.register({type:"keydown",which:c.e.home,ctrlKey:!0},{type:"keydown",which:c.e.home,metaKey:!0},function(e,n){var a=t.firstItem();t.focused(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.firstItem())}),a.register({type:"keydown",which:c.e.home},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),(t.hasVertical()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.up,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.up,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.down,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.down,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.up,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.up,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(t.aboveItem(n))}),a.register({type:"keydown",which:c.e.up,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.up,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.up,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.aboveItem(n))}),a.register({type:"keydown",which:c.e.up,altKey:!1,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.down,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.down,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.down,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.down,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),(t.hasHorizontal()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.left,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.left,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.right,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.right,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.left,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.left,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.left,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.left,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.left,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.left,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.right,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.right,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.right,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.right,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),a.register({type:"keydown",which:c.e.a,ctrlKey:!0},{type:"keydown",which:c.e.a,metaKey:!0},function(e,n){t.selectAll()}),a},e.modes={single:e._getSingleMatchers,multi:e._getMultiMatchers},e}();t.e=d},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return v});var a=n(0),i=n(196),r=n(1859),o=n(39),s=n(1833),c=n(1855),d=n(1321);function l(e,t){return e===t||!e&&!t||!(!e||!t)&&e.url===t.url}var u=n(17);Object(u.n)([{rawString:".od-ImageStack{display:block;position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}.od-ImageStack-tile{display:block;position:absolute;top:0;left:0;bottom:0;right:0;opacity:0}.od-ImageStack-tile--isLoaded{opacity:1}.od-ImageStack--fade .od-ImageStack-tile--isLoaded{transition:opacity 217ms linear 50ms}"}]);var f=n(399),p=(n(813),n(58)),m=n(1972),_=function(e){function t(t){var n=e.call(this,t)||this,a=t.hasAnimated,i=t.fadeIn,r=t.image,o=t.referenceImage,s=t.referenceRotation;return n._fadeIn=i,n._image=r,n._referenceImage=o,n._referenceRotation=s,n.isLoaded=n.createObservable(!1),n._hasAnimated=n._getHasAnimated(),n.rotation=n.createPureComputed(n._computeRotation),n.createBackgroundComputed(function(){return a(n._hasAnimated())}),n}return Object(a.__extends)(t,e),t.prototype._getHasAnimated=function(){var e=this,t=this.createObservable(!1);return this.createPureComputed(function(){var n;return e.isLoaded.peek()?(n=t())||e.async.setTimeout(function(){return t(!0)},e._fadeIn.peek()?2e3:50):(e.isLoaded(),n=!1),n})},t.prototype._computeRotation=function(){var e=this.rotation.peek();return(l(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation()),e},t}(p.n),h=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageTileTagName=m.e.tagName;var i=t.image,r=t.rotation,o=t.desiredSize,s=t.scale,c=void 0===s?1:s,u=t.fadeIn,f=void 0===u||u,p=t.allowLoading,h=void 0===p||p,b=t.isLoaded,g=t.isCurrent,v=t.alignment,y=t.position,S=t.loadedImage,D=t.error,I=t.loadImageScenarioName,x=n.outputExtenders,C=void 0===x?{deferred:!0}:x,O=n.AnimationTracker,w=void 0===O?_:O;return a._animationTrackerType=w,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(r),a._desiredSize=o,a._scale=c,a.fadeIn=a.wrapObservable(f),a._allowLoading=a.wrapObservable(h),a._alignment=v,a._scenarioName=I,a._tileDefinitions=a.createPureComputed(a._computeTileDefinitions),a._position=a.createPureComputed(a._computePosition),a._position.equalityComparer=d.e,a._loadedImage=a.createPureComputed(a._computeLoadedImage),a._loadedImage.equalityComparer=l,a._error=a.createPureComputed(a._computeError),a._error.equalityComparer=d.e,a.tiles=a._getTiles(),y&&a.createBackgroundComputed(function(){return y(a._position())}).extend(C),S&&a.createBackgroundComputed(function(){return S(a._loadedImage())}).extend(C),b&&a.createBackgroundComputed(function(){return b(!!a._loadedImage())}).extend(C),g&&a.createBackgroundComputed(function(){return g(l(a._loadedImage(),a._image()))}).extend(C),D&&a.createBackgroundComputed(function(){return D(a._error())}).extend(C),a}return Object(a.__extends)(t,e),t.prototype._computeError=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.error;if(i())break;if(r()){e=r();break}}return e},t.prototype._computePosition=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.position;if(i()){e=r();break}}return e},t.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.image;if(i()){e=this.unwrapObservable(r);break}}return e},t.prototype._computeTileDefinitions=function(){var e=this._image(),t=this._tileDefinitions.peek(),n=void 0===t?[]:t;if(e){if(this._allowLoading()){var i=void 0,r=void 0,o=void 0,s=n[n.length-1];s?(i=l(s.image,e),r=s.hasAnimated.peek(),o=!!s.error.peek()):(i=!1,r=!1),i?r?n=[s]:s.hasAnimated():((!s||r||o)&&(s={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)},n=Object(a.__spreadArray)(Object(a.__spreadArray)([],n,!0),[s],!1)),s.hasAnimated(),s.error())}}else n=[];return n},t.prototype._getTiles=function(){var e=this,t=this.observables.createArray(),n=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=t.image,a=t.error,i=t.hasAnimated,r=new(e.managed(e._animationTrackerType))({hasAnimated:i,image:n,referenceRotation:e._rotation,referenceImage:e._image,fadeIn:e.fadeIn});return{mappedValue:{image:n,rotation:r.rotation,isLoaded:r.isLoaded,error:a,scale:e._scale,desiredSize:e._desiredSize,alignment:e._alignment,position:e.createObservable(),loadImageScenarioName:e._scenarioName},dispose:function(){r.dispose()}}}}));return this.createBackgroundComputed(function(){t.splice.apply(t,Object(a.__spreadArray)([0,t.peek().length],e._tileDefinitions(),!1))}),n},t}(i.t),b=Object(f.e)({tagName:"od-image-stack",template:'<span class="od-ImageStack" data-bind="css:{\'od-ImageStack--fade\':fadeIn},template:{foreach:tiles}"><span class="od-ImageStack-tile" data-bind="css:{\'od-ImageStack-tile--isLoaded\':$data.isLoaded},component:{name:$component.imageTileTagName,params:$data}"></span></span>',viewModel:h,synchronous:!0}),g=n(8),v=300,y=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageStackTagName=b.tagName;var i=t.image,o=t.rotation,u=void 0===o?r.e.none:o,f=t.alignment,p=t.desiredSize,m=t.isLoaded,_=t.isCurrent,h=t.error,g=t.coverage,v=void 0===g?{minimum:1,maximum:1}:g,y=t.scale,S=t.fadeIn,D=t.allowLoading,I=t.position,x=t.loadImageScenarioName,C=n.thumbnailCache,O=void 0===C?a.resources.consume(s.e):C,w=n.outputExtenders,E=void 0===w?{deferred:!0}:w;return a._thumbnailCache=O,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(u),a._alignment=c.t(f),a._desiredSize=a.wrapObservable(p),a._isLoaded=m,a._coverage=a.wrapObservable(v),a._loadedImage=a.createObservable(),a._effectiveDesiredSize=a.createPureComputed(a._computeEffectiveDesiredSize),a._effectiveDesiredSize.equalityComparer=d.e,a._idealSize=a.createPureComputed(a._computeIdealSize),a._idealSize.equalityComparer=d.e,a._idealImage=a.createPureComputed(a._computeIdealImage),a._idealImage.equalityComparer=l,a._fallbackImage=a.createPureComputed(a._computeFallbackImage),a._fallbackImage.equalityComparer=l,a._cachedImage=a.createPureComputed(a._computeCachedImage),a._cachedImage.equalityComparer=l,a._currentImage=a.createPureComputed(a._computeCurrentImage),a._currentImage.equalityComparer=l,a._isCurrent=a.createPureComputed(a._computeIsCurrent),a.imageStackParams={image:a._currentImage,rotation:a._rotation,desiredSize:a._desiredSize,loadedImage:a._loadedImage,isLoaded:a._isLoaded,error:h,scale:y,alignment:a._alignment,fadeIn:S,allowLoading:D,position:I,loadImageScenarioName:x},_&&a.createBackgroundComputed(function(){return _(a._isCurrent())}).extend(E),a}return Object(a.__extends)(t,e),t.prototype._computeIsCurrent=function(){return l(this._loadedImage(),this._idealImage())},t.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),n=this._cachedImage(),a=this._fallbackImage();return e?l(e,t)?this._currentImage.peek():t:n||a||t},t.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),n=window.devicePixelRatio||1;return t&&(e={width:t.width*n,height:t.height*n}),e},t.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var n=t.width,a=t.height,i=this._effectiveDesiredSize();if(i&&i.width&&i.height){if(n&&a){var r=this._alignment.getTransform(t,i);e={width:r.scale*t.width,height:r.scale*t.height}}}else e={width:n,height:a}}return e},t.prototype._computeIdealImage=function(){var e,t=this._image(),n=this._idealSize();return t&&(n?(e=this._getDerivedImage(t,n))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,n,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t,g.t.isActivated("0ECA92CE-9CE8-41A7-8AEA-ED7D0D862836","10/08/2022","fix secure thumbnail link and meta throttling issue")||(e=Object(a.__assign)(Object(a.__assign)({},t),e))),e},t.prototype._computeFallbackImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=(this._coverage()||{}).fallback,i=void 0===a?0:a;if(i){var r={width:n.width*i,height:n.height*i};(e=this._getDerivedImage(t,r))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,r,!1)}}return e},t.prototype._computeCachedImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=this._thumbnailCache.getCoveragePercent(t,n),i=this._coverage()||{},r=i.minimum,o=void 0===r?1:r,s=i.maximum,c=o*a,d=(void 0===s?1:s)*a;e=this._thumbnailCache.retrieve(t,d,c)}return e},t.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:o.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}},t}(i.t);t.t=y},,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(0),i=n(1),r=n(60);function o(e,t){return{definitionKey:e,props:t}}var s=function(e){function t(t){var n=e.call(this,t)||this,a=n.props,i=a.specification,r=a.placeholder,o=a.resources;return n.state={componentType:i&&(c(i)?i.componentType:o.consume(i.definitionKey.optional)),placeholderType:r&&(c(r)?r.componentType:o.consume(r.definitionKey.optional))},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.specification;this.state.componentType||t&&!c(t)&&(this._resolveSpecificationPromise=r.n.resolve(this.props.resources.consumeAsync(t.definitionKey)).then(function(t){e.setState({componentType:t})}))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.specification,n=e.placeholder,a=e.resources;t===this.props.specification&&a===this.props.resources||this.setState({componentType:t&&(c(t)?t.componentType:this.props.resources.consume(t.definitionKey.optional))}),n===this.props.placeholder&&a===this.props.resources||this.setState({placeholderType:n&&(c(n)?n.componentType:a.consume(n.definitionKey.optional))})},t.prototype.componentDidUpdate=function(e,t){var n=this,a=this.props,i=a.specification,o=a.resources;i===e.specification&&o===this.props.resources||(this._resolveSpecificationPromise&&(this._resolveSpecificationPromise.cancel(),this._resolveSpecificationPromise=void 0),this.state.componentType||i&&!c(i)&&(this._resolveSpecificationPromise=r.n.resolve(this.props.resources.consumeAsync(i.definitionKey)).then(function(e){n.setState({componentType:e})})))},t.prototype.componentWillUnmount=function(){this._resolveSpecificationPromise&&this._resolveSpecificationPromise.cancel()},t.prototype.render=function(){var e=this.state,t=e.componentType,n=e.placeholderType;return t?i.createElement(t,Object(a.__assign)({key:"content"},this.props.specification.props)):n?i.createElement(n,Object(a.__assign)({key:"placeholder"},this.props.placeholder.props)):null},t}(i.Component);function c(e){return!!e.componentType}},,,,,,,,function(e,t,n){"use strict";var a=n(1880);n.d(t,"t",function(){return a.t}),t.e=a.e},function(e,t,n){"use strict";var a;!function(e){e[e.button=0]="button",e[e.link=1]="link",e[e.copyLink=2]="copyLink"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(472),i=n(833),r=n(1836),o=n(7),s=n(119),c="ApiUrlHelper",d=new o.t({name:"".concat(c,".encodeWebAbsoluteUrl"),factory:new o.e(!0)}),l=Object(s.r)(c,r.e,{itemUrlHelper:i.t,pageContext:a.e,encodeWebAbsoluteUrl:d});r.e},function(e,t,n){"use strict";var a=n(0),i=n(1),r=n(17);Object(r.n)([{rawString:".od-Share-LivePeoplePicker{max-height:150px;min-height:32px;overflow-y:auto}.od-Share-LivePeoplePicker-lpp{display:grid;display:-ms-grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;row-gap:0;-ms-grid-columns:1fr auto;-ms-grid-rows:auto auto;-ms-row-gap:0}.od-Share-LivePeoplePicker-Adapter{grid-row:1;grid-column:1;-ms-grid-row:1;-ms-grid-column:1}.od-Share-LivePeoplePicker-RoleSelector{grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;align-self:end;-ms-grid-row-align:end}.od-Share-LivePeoplePicker-ErrorWarnings-wrapper{grid-row:2;grid-column:1;-ms-grid-row:2;-ms-grid-column:1}"}]);var o,s,c=n(1853),d=n(1923),l=n(1983),u=n(2379),f=n(1800),p=n(2578),m=n(2878),_=!1,h=i.forwardRef(function(e,t){var a=Object(i.useState)(null),r=a[0],o=a[1];Object(i.useEffect)(function(){r||n.e(307).then(n.t.bind(null,4395,7)).then(function(t){_||(t.initializeLivePersonaPicker(e.userPrincipalName,e.options),_=!0),o({LivePersonaPicker:t.getLivePersonaPickerWithRichTextInput(e.userPrincipalName),PersonaPillList:t.PersonaPillList})})},[r]);var s=Object(i.useState)(null),c=s[0],d=s[1],l=Object(i.useState)(!1),u=l[0],f=l[1];if(Object(i.useEffect)(function(){u&&c&&(c.focus(),f(!1))},[c,u]),Object(i.useImperativeHandle)(t,function(){return{focus:function(){f(!0)},getCurrentText:function(){return c.getCurrentText()}}}),!r)return e.fallback||null;var p=r.LivePersonaPicker,m=r.PersonaPillList;return i.createElement("div",{className:e.className},i.createElement(m,{personaItems:e.selectedPersonas,onRemoveItem:e.onRemovePersona}),e.entryDisabled||i.createElement(p,{componentRef:function(e){d(e)},strings:e.strings,maxHeight:200,maxWidth:300,onSuggestionSelected:e.onSuggestionSelected,selectedSuggestions:e.selectedPersonas}))}),b=n(1786),g=n(434),v=n(1806),y=n(1801),S=n(1831);!function(e){e.Person="Person",e.Group="Group"}(o||(o={})),function(e){e.OrganizationUser="OrganizationUser",e.LinkedIn="LinkedIn",e.UnifiedGroup="UnifiedGroup",e.PublicDistributionList="PublicDistributionList"}(s||(s={}));var D=function(e){function t(t,n){var r=e.call(this,t)||this;r._lppAdapterRef=Object(i.createRef)(),r._wrapperDivRef=Object(i.createRef)(),r._getHostAppSuggestions=function(e){return Object(a.__awaiter)(r,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=this.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0},[4,this._peoplePickerProvider.sharePointSearch(e,n)];case 1:return[2,a.sent().map(function(e){return{Id:e.userId,Name:e.name,UserPrincipalName:e.rawPersonData.userPrincipalName||e.email,SuggestionType:e.name,SuggestionSubtype:e.name,EmailAddresses:[e.email||""],HostAppSuggestion:e}})]}})})},r._onSelectedPersonasChanged=function(){var e=r.state.selectedPersonas.map(function(e){return r._personaPillListItemToIPerson(e)});r.props.onChange(e)},r._onRemovePersona=function(e){r.setState(function(t,n){var i=r.state.selectedPersonas.filter(function(t){return t.Id!==e.Id});return Object(a.__assign)(Object(a.__assign)({},t),{selectedPersonas:i})},r._onSelectedPersonasChanged)},r._onSuggestionSelected=function(e){var t=Object(a.__assign)(Object(a.__assign)({},e),{validationState:"Pending"});r.setState(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{selectedPersonas:Object(a.__spreadArray)(Object(a.__spreadArray)([],e.selectedPersonas,!0),[t],!1)})}),r._validateSuggestion(e).then(function(e){return r._onPersonaValidated(e)})},r._onKeyDown=function(e){"Backspace"===e.key&&r._lppAdapterRef.current&&""===r._lppAdapterRef.current.getCurrentText()&&r.setState(function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{selectedPersonas:e.selectedPersonas.slice(0,-1)})},r._onSelectedPersonasChanged)},r._validateSuggestion=function(e){return Object(a.__awaiter)(r,void 0,void 0,function(){var t,n,i;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return e.SuggestionSubtype===s.OrganizationUser?[2,Object(a.__assign)(Object(a.__assign)({},e),{validationState:"Valid"})]:(t=this.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0},[4,this._peoplePickerProvider.resolve(e.UserPrincipalName,n).then(function(e){return!e.email&&e.rawData&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails),!e.name&&e.rawData&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails),e})]);case 1:return i=r.sent(),e.HostAppSuggestion=i,[2,Object(a.__assign)(Object(a.__assign)({},e),{validationState:this._shouldShowErrorOnItem(i)?"Error":"Valid"})]}})})},r._peoplePickerProvider=n.peoplePickerProvider,r._resize=n.resize,r._platformDetection=n.platformDetection,r._hasTakenErrorFocus=!1,r._peoplePickerProvider=n.peoplePickerProvider;var c=t.defaultSelectedItems.map(function(e){return{Id:e.email,Name:e.name,UserPrincipalName:e.principalName,EmailAddresses:[e.email],SuggestionType:o.Person,SuggestionSubtype:s.OrganizationUser,HostAppSuggestion:e,Source:"HostApp",validationState:"Valid",SuggestionSource:"HostApp",SuggestionOrigin:"ZeroTerm"}});return r.state={selectedPersonas:c},r._livePeoplePickerHelper=r._peoplePickerProvider._dataSource.getLivePersonaPickerHelper(),r._resizeTracker=new S.e(n.resize),r}return Object(a.__extends)(t,e),t.prototype.render=function(){var e={emptyResults:y.va,loading:y.Vn,error:y.n,allResults:y.e,limitedResults:y.t,suggestionsCalloutAccessibilityOnShow:y.Jt,useThisAddress:y.a,pickerModePlaceholderText:this._computePlaceholderText()};if(!this.props.pickerSettings||0===Object.keys(this.props.pickerSettings).length)return i.createElement("div",{className:"od-Share-LivePeoplePicker-lpp"});var t=Object(a.__assign)(Object(a.__assign)({},this._livePeoplePickerHelper.getLppOptions()),{getHostAppSuggestions:this._getHostAppSuggestions}),n=this._livePeoplePickerHelper.getUserPrincipalName(),r=this.props.roleSelectorProps.roleSelectorAs;return i.createElement("div",{className:"od-Share-LivePeoplePicker-lpp",ref:this._wrapperDivRef,onKeyDown:this._onKeyDown},i.createElement(h,{className:"od-Share-LivePeoplePicker-Adapter",ref:this._lppAdapterRef,userPrincipalName:n,options:t,strings:e,entryDisabled:!1,selectedPersonas:this.state.selectedPersonas,onSuggestionSelected:this._onSuggestionSelected,onRemovePersona:this._onRemovePersona,fallback:i.createElement(b.e,{size:g.e.small})}),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-LivePeoplePicker-RoleSelector"},i.createElement(r,Object(a.__assign)({},this.props.roleSelectorProps))),i.createElement("div",{className:"od-Share-LivePeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))},t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isValidateInProgress())return v.r(this.props.clientId)||this._hasTakenErrorFocus||(this._focusInput(),this._hasTakenErrorFocus=!0),i.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert"},e)},t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[];if(!this.props.error)return this.state.selectedPersonas.length>=this.props.selectionLimit&&n.push(i.createElement(u.e,{key:"peoplePickerLimitMessage",ariaLabel:y.ji},y.ji)),e&&n.push(i.createElement(u.e,{key:"oversharingExternalsWarning",ariaLabel:e},e)),t&&n.push(i.createElement(u.e,{key:"oversharingGroupsWarning",ariaLabel:t},t)),n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0},t.prototype.componentDidUpdate=function(e,t){this._resizeTracker?this._resizeTracker.checkSizeChangeForRef(this._wrapperDivRef):null!==this.props.error&&null===e.error&&this._resize();var n=t.selectedPersonas.length>=this.props.selectionLimit&&this.state.selectedPersonas.length<this.props.selectionLimit;this._hasInitialFocus&&!n||this._focusInput()},t.prototype.componentDidMount=function(){var e=this._platformDetection.isIE;v.r(this.props.clientId)||e||this._focusInput()},t.prototype._focusInput=function(){this._lppAdapterRef.current&&(this._lppAdapterRef.current.focus(),this._hasInitialFocus=!0)},t.prototype._shouldShowErrorOnItem=function(e){var t=this._computeAllowExternalUsers(this.props.sharingLinkKind,this.props.sharingInformation.canAddExternalPrincipal),n=this.props.permissionsMap;return e.isExternal&&!t||this.props.sharingLinkKind===p.e.direct&&n&&(n[e.email]===m.e.none||n[e.userId]===m.e.none)||!e.isResolved&&!e.isResolving},t.prototype._computeAllowExternalUsers=function(e,t){var n=e===p.e.organizationView,a=e===p.e.organizationEdit;return!(n||a)&&t},t.prototype._onPersonaValidated=function(e){this.setState(function(t,n){var i=t.selectedPersonas.filter(function(t){return t.Id!==e.Id});return i.push(e),Object(a.__assign)(Object(a.__assign)({},t),{selectedPersonas:i})},this._onSelectedPersonasChanged)},t.prototype._convertPrincipalType=function(e){if(!e)return c.e.none;for(var t=c.e.none,n=0,a=e.split(",");n<a.length;n++){var i=a[n];"User"===i&&(t|=c.e.user),"DL"===i&&(t|=c.e.distributionList),"SecGroup"===i&&(t|=c.e.securityGroup),"SPGroup"===i&&(t|=c.e.sharePointGroup)}return t},t.prototype._lppSuggestionToIPerson=function(e){if(e.HostAppSuggestion&&e.HostAppSuggestion.hasOwnProperty("userId"))return e.HostAppSuggestion;var t=e.EmailAddresses[0],n=e.UserPrincipalName&&l.e.isValidEmailSyntax(e.UserPrincipalName,!1)?e.UserPrincipalName:t,a={Key:n,IsResolved:!1},i=e.SuggestionSubtype===s.OrganizationUser,r=e.SuggestionSubtype===s.LinkedIn,u=e.SuggestionType===o.Group&&e.SuggestionSubtype===s.UnifiedGroup,f=e.SuggestionSubtype===s.PublicDistributionList,p={rawData:a,rawPersonData:a,userId:n,name:e.Name,email:t,isExternal:!i,isResolved:!0};return i?(p.entityType=d.e.regularUser,p.principalType=c.e.user):u?(p.entityType=d.e.group,p.principalType=c.e.securityGroup):r?p.entityType=d.e.linkedinUser:(p.principalType=f?c.e.distributionList:c.e.none,p.entityType=e.SuggestionType===o.Group?d.e.group:d.e.externalUser,p.providerName=void 0),p},t.prototype._personaPillListItemToIPerson=function(e){return Object(a.__assign)(Object(a.__assign)({},this._lppSuggestionToIPerson(e)),{isResolved:"Pending"!==e.validationState})},t.prototype._isValidateInProgress=function(){for(var e=0,t=this.state.selectedPersonas;e<t.length;e++)if("Pending"===t[e].validationState)return!0;return!1},t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?y.Gi:y.Wi},t.contextTypes={peoplePickerProvider:f.object.isRequired,resize:f.func.isRequired,platformDetection:f.object.isRequired},t}(i.Component);Object(r.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePickerContainer{display:flex;justify-content:space-between;flex-direction:row;flex-wrap:nowrap}.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-ErrorWarnings-wrapper,.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-wrapper{max-width:calc(100% - (1.75rem + 34px));width:100%;flex-grow:1}#od-Share-PeoplePicker-wrapper-id .ms-BasePicker-text::after{content:none}.od-Share-PeoplePicker-RoleSelector{align-self:flex-end;grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-grid-row-align:end}.od-Share-PeoplePicker .ms-Callout{width:100%}.od-Share-PeoplePicker .ms-Callout .ms-Suggestions{width:100%;min-width:100%}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:block}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:.75rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";width:100%}[dir=ltr] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}@supports (font:-apple-system-body){.od-Share-PeoplePicker .ms-BasePicker-input{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker .ms-BasePicker-input::-ms-clear{display:none;width:0;height:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker input.ms-BasePicker-input::placeholder{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{font-size:.75rem;font:-apple-system-caption1}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{font-size:.75rem}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}@supports (font:-apple-system-body){.od-Share-PeoplePicker .ms-PickerItem-content{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:100%}.od-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}@media screen and (min-width:400px){.ms-Suggestions,.ms-Suggestions-none{width:370px!important}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px;width:100%}@supports (font:-apple-system-body){.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Suggestions-item,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container button.ms-Suggestions-itemButton{font:-apple-system-body;height:auto}}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container div.ms-PeoplePicker-personaContent{font:-apple-system-headline;height:auto}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button{font-size:.75rem;height:2.5rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button i.ms-Button-icon{font-size:1rem;width:1.5625rem;font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button span.ms-Button-label{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font-size:.75rem;line-height:1.875rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner{line-height:1.875rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-circle{width:1.25rem;height:1.25rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font-size:.75rem}@supports (font:-apple-system-caption1){.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font:-apple-system-caption1;height:auto}}.od-Share-PeoplePicker-error{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}[dir=ltr] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-left:5px}[dir=rtl] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-right:5px}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px;box-sizing:border-box}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir=rtl] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:RGBA("},{theme:"redDark",defaultValue:"#a4262c"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button.is-suggested .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-Share-PeoplePicker-Suggestions .ms-Button:hover .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona:hover,.od-Share-PeoplePicker-Suggestions .ms-Suggestions-item:hover{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:highlighttext;forced-color-adjust:none}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona,.od-Share-PeoplePicker-Suggestions .ms-Persona-secondaryText{color:inherit}}@media (forced-colors:active) and (prefers-color-scheme:dark){::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#fff!important;forced-color-adjust:none}}@media (forced-colors:active) and (prefers-color-scheme:light){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText,::placeholder{text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:#000!important;forced-color-adjust:none}}.od-RoleSelectorCompact-permissionButton:focus{outline:1px solid}.od-Share-PeoplePicker-selectedItem--error{display:flex}"}]);var I=n(1529),x=n(2182),C=n(2281),O=n(1098),w=n(39),E=n(1826),A=n(321),L=n(2452),k=n(1840),M=n(476),P=n(1839),T=n(1802),U=n(1817);function F(e){return i.createElement("div",{className:"od-Share-PeoplePickerErrorContainer",style:{backgroundColor:e.backgroundColor}},i.createElement(M.e,{iconName:e.iconName,className:e.className}),i.createElement("div",{className:"od-Share-PeoplePickerErrorDiv"},e.error))}Object(r.n)([{rawString:".od-Share-PeoplePickerErrorContainer{display:flex;padding:8px 32px 8px 12px}.od-Share-PeoplePickerErrorContainer .od-Share-PeoplePickerErrorDiv{padding:0 8px;font-size:.75rem;color:#323130}"}]);var H,R,N=n(1804),B=n(2135),j=n(593),V=n(1829),z=n(2004),G=n(307),K=n(1888),W=n(8);!function(e){e[e.None=0]="None",e[e.Family=1]="Family",e[e.FamilyMember=2]="FamilyMember"}(H||(H={})),W.e.isActivated("c0f33ab5-b308-47d6-9537-a4b510e6093f","09/14/2021","Fix for button label in high contrast mode cause by .ms-Button-flexContainer:hover in PeoplePicker.scss.")||((R=document.createElement("style")).innerHTML="\n  @media screen and (-ms-high-contrast: active) {\n    .ms-Button-flexContainer:hover {\n      font-size: inherit !important;\n      color: inherit !important;\n      forced-color-adjust: none;\n    }\n  }\n  ",document.head.insertAdjacentElement("beforeend",R));var q="peoplepicker",Q=W.e.isActivated("ae5c4aaa-bb38-4467-acbe-e98893341883","02/28/2022","Show default suggestions killswitch"),Y=function(e){function t(t,n){var r=e.call(this,t)||this;return r._inputs=[],r._onItemsChange=function(e){var t=r.state.selectedItems.concat(e);r.setState({selectedItems:t},function(){r.props.onChange(t)}),e.forEach(function(e){r._onAutoResolve(e)})},r._initRumone=function(e,t){if(void 0===t&&(t=!1),!r._inputStartTime&&!t&&e.length>1||!r._inputStartTime&&t&&0===e.length){r._inputStartTime=Date.now(),r._rumoneLogger||(r._rumoneLogger=new B.e(q)),r._rumoneLogger.resetRumOneApiMeasurement(),r._rumoneLogger.resetRumOne();var n=j.e.getRUMOneLogger(q),a=W.e.isActivated("882A3AE3-7D25-485F-B28D-658F339604DF")?"browser.pipe.aria.microsoft.com":"/Collector/3.0/";n.startAPIMeasurement({ignore:function(e){return e.indexOf(a)>=0},getAPIName:function(e){var t=e.toLowerCase();return-1!==t.indexOf("graph.microsoft.com/v1.0/me/people")&&-1!==t.indexOf("search")?"GraphSearch":-1!==t.indexOf("/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface.clientpeoplepickersearchuser")?"SPClientPeoplePickerSearchUser":-1!==t.indexOf("https://outlook.office.com/search/api/v1/suggestions")?"SubstrateSearch":void 0}})}},r._onInputChange=function(e){if(r._inputs.push(e),r._initRumone(e),r._hasTakenErrorFocus=!1,e&&e.indexOf(";")>-1){var t=e.split(";").map(function(e){var t=/<[^\]]*>/g.exec(e);if(t&&t[0]&&(e=t[0].substring(1,t[0].length-1)),e=e.trim())return r._createGenericPerson(e)}).filter(function(e){return e});return r._onItemsChange(t),r.props.onInputChange&&r.props.onInputChange(""),""}var n=/['"].*['"]/g.exec(e);return n&&n[0]?n[0].substring(1,n[0].length-1):(r.props.onInputChange&&r.props.onInputChange(e),e)},r._onGetMoreResults=function(e){var t=r.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:r._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!1,allowSharePointGroups:!1,forceResolve:!0,useSubstrate:!!r.props.sharingInformation.enforceIBSegmentFiltering,siteIBSegmentIDs:r.props.sharingInformation.siteIBSegmentIDs};return r._peoplePickerProvider.sharePointSearch(e,n)},r._onSuggestionSelected=function(e){var t=r.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:r._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};if(r._store.getEngagementHelper().log("PeoplePicker.SuggestionSelected",{clientId:r.props.clientId,mode:O.e.share,detailedGroupInfo:e.detailedGroupInfo,principalType:void 0===e.principalType?"unknown":c.e[e.principalType],entityType:void 0===e.entityType?"unknown":d.e[e.entityType],isDefaultSuggestion:!/\S/.test(r._inputs.join(""))}),T.S()&&v.b(r.props.clientId)){var a=r._store.getFamily(),i=r._store.getFamilyMembers();a&&i&&(e.userId===a.userId?r._store.getEngagementHelper().log("PeoplePicker.FamilyGroupSelected",{clientId:r.props.clientId,scenarioId:"",familySuggestionType:H[r.state.familyType],mode:O.e.share}):i.some(function(t){return t.userId===e.userId})&&r._store.getEngagementHelper().log("PeoplePicker.FamilyMemberSelected",{clientId:r.props.clientId,scenarioId:"",familySuggestionType:H[r.state.familyType],mode:O.e.share}))}if(!1===e.isExternal||e.isExternal&&e.providerName)return e;e.principalType===c.e.distributionList&&(n.isGraphDistributionList=!0,n.useGraph=!0);var o=Object(P.r)(e),s=Object(P.i)(e);return!e.isResolved||o?r._peoplePickerProvider.resolve(e.userId,n).then(function(t){return!t.email&&t.rawData&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails),!t.name&&t.rawData&&t.rawData.EntityData&&(t.name=t.rawData.EntityData.OtherMails),e.entityType===d.e.linkedinUser&&(t.entityType=e.entityType),Object(T.J)()||void 0!==t.isExternal||!o&&!s||(t.isExternal=!0),t}):e},r._onRenderItem=function(e){var t=r.props.permissionsMap,n=r._computeAllowExternalUsers(r.props.sharingLinkKind,r.props.sharingInformation.canAddExternalPrincipal),o=e.item.isExternal&&!n||r.props.sharingLinkKind===p.e.direct&&t&&(void 0!==t[e.item.email]&&t[e.item.email]===m.e.none||void 0!==t[e.item.userId]&&t[e.item.userId]===m.e.none)||!e.item.isResolved&&!e.item.isResolving,s=e.item.name;return e.removeButtonAriaLabel=w.format(y.io,s),e.item.imageAlt=w.format(y.Qs,s),o?i.createElement("div",{className:"od-Share-PeoplePicker-selectedItem--error"},i.createElement(x.t,Object(a.__assign)({},e))):e.item.isResolving?i.createElement(b.e,{className:"od-Share-PeoplePicker-resolve-spinner"}):i.createElement(x.t,Object(a.__assign)({},e))},r._onToggleGetMoreResults=function(e){r.state&&(e&&!r.state.searchForMoreText||!e&&r.state.searchForMoreText)&&r.setState({searchForMoreText:r._getSearchForMoreText(e)})},r._writeUserInputDataToRumoneLogger=function(e){if(void 0===e&&(e=!1),r._rumoneLogger){var t=r._rumoneLogger.breakdownData,n={modeName:"peoplePicker",startTime:r._inputStartTime,endTime:Date.now(),breakDownData:{customerInputs:t(r._inputs.length),isSearchFromCache:e}};r._rumoneLogger.logSharingPerformance(n)}r._inputs=[],r._inputStartTime=null},r._peoplePickerProvider=n.peoplePickerProvider,r._resize=n.resize,r._platformDetection=n.platformDetection,r._hasTakenErrorFocus=!1,r._store=n.sharingStore,r._clientId=n.clientId,r._rumoneLogger=null,r._sharingClientMessenger=n.sharingClientMessenger,r._persistentRequestCache=new z.e({id:"PeoplePickerSearch"},{pageContext:n}),r.state={selectedItems:t.defaultSelectedItems,searchForMoreText:r._getSearchForMoreText(t.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[],familyType:H.None,familyResolveEventFired:!1},r._resizeTracker=new S.e(n.resize),r}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.defaultSelectedItems,n=this.props.defaultSelectedItems,a=[];n.forEach(function(e){var n=t.filter(function(t){return t.name===e.name});n.length>0&&a.push({name:n[0].name,userId:n[0].userId})}),this.setState({selectedItems:t,addedUsers:a})},t.prototype.componentDidUpdate=function(e,t){this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;var n=t.addedUsers,a=this.state.addedUsers,i=this.state.removedUsers;this._resizeTracker?this._resizeTracker.checkSizeChange(this._peoplePicker):null!==this.props.error&&null===e.error&&this._resize(),n.length>a.length?(i=n.filter(function(e){return-1===a.indexOf(e)}),this.setState({removedUsers:i})):n.length!==a.length&&i.length>0&&this.setState({removedUsers:[]})},t.prototype.componentDidMount=function(){var e=this._platformDetection&&this._platformDetection.isIE;this._peoplePickerControl&&!e&&this._peoplePickerControl.focusInput()},t.prototype.render=function(){var e=this;this._peoplePickerControl=void 0;var t,n={placeholder:this._computePlaceholderText(),autoFocus:!0,onFocus:function(t){e._onFocus()},"aria-label":this._computeAddAnotherAriaLabel()},r=this.props.pickerSettings,o={principalSource:r.PrincipalSource,principalType:this._convertPrincipalType(r.PrincipalAccountType),querySettings:r.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:r.UseSubstrateSearch,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,useSubstrate:!!this.props.sharingInformation.enforceIBSegmentFiltering,onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:A.e.generate(),siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs,siteIBMode:W.e.isActivated("078e2fe2-3740-4368-9f64-61a7032577f7","04/26/2021","Pass SiteIBMode to 3S.")?"":this.props.sharingInformation.siteIBMode,useNew3Ssearch:r.useNew3Ssearch},s=this.props.error?"od-Share-PeoplePicker ms-Share-PeoplePicker--error":"od-Share-PeoplePicker",c=v.r(this.props.clientId)||this._platformDetection&&this._platformDetection.isMobile,d={preventDismissOnScroll:c,preventDismissOnResize:!0},l=c?y.Xt:y.Jt,u=this.props.roleSelectorProps&&this.props.roleSelectorProps.roleSelectorAs,f=document.body,p=f?parseInt(getComputedStyle(f).fontSize,10):null;return!(p&&p>16)||this._platformDetection&&this._platformDetection.isIE||(t={flexWrap:"wrap"}),i.createElement("div",{style:t},i.createElement("div",{id:"od-Share-PeoplePicker-wrapper-id",role:"presentation",ref:function(t){e._peoplePicker=t}},U.e(this._computePeopleAddOrRemoveMessage(),"assertive","alert",!0),i.createElement("div",{className:"od-Share-PeoplePickerContainer"},i.createElement("div",{className:"od-Share-PeoplePicker-wrapper"},i.createElement(C.e,{"aria-describedby":"inputErrorMessage",componentRef:function(t){e._peoplePickerControl=t},className:s,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:n,loadingText:y.Vn,noResultsFoundText:y.va,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:o,suggestionsClassName:"od-Share-PeoplePicker-Suggestions".concat(this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":""),onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions.bind(this),itemLimit:this.props.selectionLimit,onInputChange:this._onInputChange,onRenderSuggestionsItem:this._store&&this._store.showEmailsInSuggestions()?this._onRenderSuggestionsItem:null,onGetMoreResults:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider&&this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,suggestionsAvailableAlertText:l,enableSelectedSuggestionAlert:this._platformDetection&&this._platformDetection.isIE,role:"presentation",pickerCalloutProps:d,showDefaultSuggestion:!Q,peoplePickerImprovementsExperiment:!!V.a(),persistCachePeopleSearch:function(t){var n=e._persistentRequestCache.getRequestKey(t.key,"POST");return e._persistentRequestCache.getDataUtilizingCache({cachingStrategy:K.e.useCacheIfNotExpired,cacheTimeoutTime:G.e,cacheRequestKey:n,getData:t.getData,returnStatistics:!0})},writeUserInputDataToRumoneLogger:this._writeUserInputDataToRumoneLogger,initRumone:this._initRumone})),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-PeoplePicker-RoleSelector"},i.createElement(u,Object(a.__assign)({},this.props.roleSelectorProps)))),i.createElement("div",{className:"od-Share-PeoplePickerContainer"},i.createElement("div",{id:"inputErrorMessage",className:"od-Share-PeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))))},t.prototype._onResolvedSuggestions=function(e,t){var n=this;if(T.S()&&v.b(this.props.clientId)){var a=this._store.getFamily(),i=this._store.getFamilyMembers();if(a&&t.length>1){var r=0===y.Zt.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()),o=!1,s=H.None;r?(s=H.Family,o=!0,e=[a].concat(i,e)):(e.forEach(function(t,n){i.forEach(function(i){(!o&&t.userId===i.userId||t.email===i.email)&&(e.splice(n+1,0,a),o=!0)})}),o&&(s=H.FamilyMember)),this.setState({familyType:s}),o&&!this.state.familyResolveEventFired&&(this.setState({familyResolveEventFired:!0}),this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupResolved",{clientId:this.props.clientId,scenarioId:"",mode:O.e.share,familySuggestionType:H[s]}))}}var c=[],d=[this._store.getCurrentUserId()],l=[];e.forEach(function(e){Object(N.R)(e.image,n._clientId)&&(e.image=void 0),-1===d.indexOf(e.userId)&&-1===c.indexOf(e.email)&&(n.state.addedUsers.some(function(t){return t.name===e.name&&t.userId===e.userId})||l.push(e),e.userId&&d.push(e.userId),e.email&&c.push(e.email))});try{return this.props.onResolvedSuggestions(l)}catch(e){return l}},t.prototype._createGenericPerson=function(e){return{userId:e,name:e,email:e,isResolving:!0}},t.prototype._onRenderSuggestionsItem=function(e){var t={text:e.name||"",imageUrl:e.image||"",tertiaryText:e.email&&e.email!==e.name?e.email:"",secondaryText:e.email||"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(L.e,Object(a.__assign)({},t,{presence:k.t.none,size:k.n.size40,className:"ms-PeoplePicker-pickerPersona"})),e.entityType===d.e.linkedinUser&&i.createElement(M.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},t.prototype._onAutoResolve=function(e){var t=this,n=this.props.pickerSettings,i={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:n.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};this._peoplePickerProvider.resolve(e.email,i).then(function(n){!n.email&&n.rawData&&n.rawData.EntityData&&(n.email=n.rawData.EntityData.OtherMails),!n.name&&n.rawData&&n.rawData.EntityData&&(n.name=n.rawData.EntityData.OtherMails);var a=[];t.state.selectedItems.forEach(function(t){t.email===e.email?a.push(n):a.push(t)}),t.setState({selectedItems:a},function(){t.props.onChange(a)})}).catch(function(){var n=Object(a.__assign)(Object(a.__assign)({},e),{isResolving:!1}),i=[];t.state.selectedItems.forEach(function(t){t.email===e.email?i.push(n):i.push(t)}),t.setState({selectedItems:i},function(){t.props.onChange(i)})})},t.prototype._isResolveInProgress=function(){for(var e=0,t=this.state.selectedItems;e<t.length;e++)if(t[e].isResolving)return!0;return!1},t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?y.Gi:y.Wi},t.prototype._computePeopleAddOrRemoveMessage=function(){var e=this.state,t=e.addedUsers,n=e.removedUsers,a=[];return t.length>0&&(a=a.concat(t.map(function(e){return w.format(y.Vi,e)+". "+y.Wi}))),n.length>0&&(a=a.concat(n.map(function(e){return w.format(y.zi,e)}))),a.length>0?a.toString():""},t.prototype._convertPrincipalType=function(e){if(!e)return c.e.none;for(var t=c.e.none,n=0,a=e.split(",");n<a.length;n++){var i=a[n];"User"===i&&(t|=c.e.user),"DL"===i&&(t|=c.e.distributionList),"SecGroup"===i&&(t|=c.e.securityGroup),"SPGroup"===i&&(t|=c.e.sharePointGroup)}return t},t.prototype._computeAllowExternalUsers=function(e,t){var n=e===p.e.organizationView,a=e===p.e.organizationEdit;return!(n||a)&&t},t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isResolveInProgress())return this._peoplePickerControl&&!this._hasTakenErrorFocus&&(this._peoplePickerControl.focusInput(),this._hasTakenErrorFocus=!0),i.createElement(F,{error:e,iconName:"Blocked2",backgroundColor:"#FDE7E9",className:"od-Share-PeoplePicker-error"})},t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[],a={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}};if(!this.props.error)return this.state.selectedItems.length===this.props.selectionLimit&&n.push(i.createElement(u.e,{ariaLabel:y.ji,styles:a},y.ji)),e&&n.push(i.createElement(u.e,{ariaLabel:e,styles:a},e)),t&&n.push(i.createElement(u.e,{ariaLabel:t,styles:a},t)),n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0},t.prototype._getSearchForMoreText=function(e){return e?y.yo:void 0},t.prototype._onFocus=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendPeoplePickerFocused():E.g()},t.prototype._computeAddAnotherAriaLabel=function(){return 0===this.props.defaultSelectedItems.length?y.Do:y.So},t.contextTypes={peoplePickerProvider:f.object.isRequired,resize:f.func.isRequired,platformDetection:f.object.isRequired,sharingStore:f.object.isRequired,clientId:f.number.isRequired,sharingClientMessenger:f.object},t}(I.e),J=n(2209),X=n(61),Z=n(47),$=n(110);function ee(e){e.onError;var t=e.componentName,n=Object($.e)(function(e,n){X.e.logError(e,{"react.componentStack":n.componentStack,"react.component":t},{eventName:"ReactRenderError",resultCode:"",resultType:Z.e.Failure})});return i.createElement(J.e,Object(a.__assign)({},e,{onError:n}))}var te=function(e){function t(t,n){var a=e.call(this,t)||this;return a._peoplePickerProvider=n.peoplePickerProvider,a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t;return(null===(e=this._peoplePickerProvider)||void 0===e?void 0:e.getLivePersonaPickerHelper)&&(null===(t=this._peoplePickerProvider)||void 0===t?void 0:t.getLivePersonaPickerHelper())?i.createElement(D,Object(a.__assign)({},this.props,{selectionLimit:100})):W.t.isActivated("2898c580-055c-49c6-888b-10e3506606ad","04/10/2021","Error boundary for PeoplePicker.")?i.createElement(Y,Object(a.__assign)({},this.props,{selectionLimit:100})):i.createElement(ee,{componentName:"peoplePicker.peoplePickerWrapper"},i.createElement(Y,Object(a.__assign)({},this.props,{selectionLimit:100})))},t.contextTypes={peoplePickerProvider:f.object.isRequired},t}(i.Component);t.e=te},,,,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;n.items=t.items.filter(r),n.rootElementClass=t.rootElementClass||null,n.boundingElementClass=t.boundingElementClass||null,n.shouldHideIcons=!!t.shouldHideIcons,n.engagementSource=t.engagementSource||null,n.alignment=t.alignment,n.point=t.point,n.anchorElement=t.anchorElement,n.isMenuOpen=t.isMenuOpen;var a=t.dismissOnClick,i=void 0===a||a;return n.dismissOnClick=i,n}return Object(a.__extends)(t,e),t}(n(58).n);function r(e){return 8==(8&e.location)}t.e=i}],Array(15),[function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return p});var a=n(60),i=n(128),r=n(47),o=n(1121),s=n(104),c=n(64),d=n(234),l="DisableSubstrateSearch",u="https://outlook.office.com/search",f={ODB:1286},p=function(){function e(e,t){this._dataRequestor=new o.e({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation=t.sharingContextInformation,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}return e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&d.n.isFeatureEnabled(f)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue(l,c.e.session))),e},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(l,!0,c.e.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return a.n.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(u).then(function(e){return t.end({resultType:r.e.Success}),e},function(n){return a.n.isCanceled(n)?(t.end({resultType:r.e.ExpectedFailure,resultCode:"Canceled"}),a.n.reject(n)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:r.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.init=function(e){var t,n,a="".concat(u,"/api/v1/init?scenario=").concat("documentshare");this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:a,headers:{Authorization:"Bearer "+e,"X-AnchorMailbox":"OID:".concat(null===(t=this._pageContext)||void 0===t?void 0:t.aadUserId,"@").concat(null===(n=this._pageContext)||void 0===n?void 0:n.aadTenantId)},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.e("PeoplePicker",c.e.session))},e}()},,,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-Persona-image{display:inline-block;width:3.125rem;height:3.125rem;border-radius:50%;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:';font-size:1.3125rem;position:relative;overflow:hidden;text-align:center;vertical-align:middle}.od-Persona-image.ms-Icon{line-height:3.125rem}.od-Persona-image>img{display:none;position:absolute;left:0;top:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.od-Persona-image--isLoaded>img{display:block;border-radius:50%}.od-Persona-userInitials{font-family:"Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;position:absolute;font-size:.875rem;font-weight:400;color:'},{theme:"white",defaultValue:"#fff"},{rawString:";width:100%;height:100%;top:0;left:0;border-radius:50%}"}]);var i=n(0),r=n(24),o=n(196),s=n(1977),c=n(39),d=n(1835),l=n(10),u=n(2045),f=function(e){function t(t){var n=e.call(this,t)||this;return n.charsWithinParenthesisRegex=/\(([^)]*)\)/gi,n.excludedCharactersRegex=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,n.multipleSpacesRegex=/\s+/gi,n.isImageLoaded=r.observable(!1),n.addBindingHandlers({imageLoader:d.e}),n.person=r.isObservable(t.person)?t.person:r.observable(t.person),n.disablePictrueAlt=t.disablePictrueAlt,n.pictureAlt=n.createComputed(n._computePictureAlt),n._iconType=t.iconType,n.isNewHasAccessControlEnabled=l.isFeatureEnabled(l.EnableNewHasAccessControl),n}return Object(i.__extends)(t,e),t.prototype.getIconType=function(e){if(this._iconType)return this._iconType;switch(e?e.type:3){case 1:return"Contact";case 0:return"Mail";default:return"People"}},t.prototype.getInitial=function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(this.charsWithinParenthesisRegex,"")).replace(this.excludedCharactersRegex,"")).replace(this.multipleSpacesRegex," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!==n.length&&(t+=n[0].charAt(0).toUpperCase()),t},t.prototype.getTextBoyColor=function(e){return Object(u.e)({text:e})},t.prototype._computePictureAlt=function(){var e=c.format(s.s,r.utils.unwrapObservable(this.person().name));return this.disablePictrueAlt?"":e},t}(o.t),p=n(399).e({tagName:"od-persona-image",template:'<div class="od-Persona-image ms-Icon" role="img" data-bind="icon:true,class:\'ms-Icon--\'+getIconType(person().sharingInfo),css:{\'od-Persona-image--isLoaded\':isImageLoaded},attr:{\'aria-label\':person().name}">\x3c!--ko if:isNewHasAccessControlEnabled--\x3e<div class="od-Persona-userInitials" data-bind="style:{\'background-color\':getTextBoyColor(person().name)},text:getInitial(person().name)"></div>\x3c!--/ko--\x3e\x3c!--ko if:person().image--\x3e<img data-bind="imageLoader:{src:person().image,isLoaded:isImageLoaded,scenarioName:\'personaImage\'},attr:{alt:pictureAlt}">\x3c!--/ko--\x3e</div>',viewModel:f});t.e=p},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return f});var a=n(60),i=n(234),r=n(128),o=n(47),s=n(104),c=n(64),d={ODB:387},l="https://graph.microsoft.com",u="DisableGraph",f=function(){function e(e,t){this._pageContext=t.pageContext,this._sharingContextInformation=t.sharingContextInformation,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken),this.initializeDataStore()}return e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.n.isFeatureEnabled(d);return this._dataStore&&(e=e&&!this._dataStore.getValue(u,c.e.session)),e},e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(u,!0,c.e.session)},e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return a.n.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new r.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){return t.end({resultType:o.e.Success}),e},function(n){return a.n.isCanceled(n)?(t.end({resultType:o.e.ExpectedFailure,resultCode:"Canceled"}),a.n.reject(n)):(t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:o.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableGraphCallsForPicker(),null)})}return null},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.e("PeoplePicker",c.e.session))},e}()},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"a",function(){return u});var a,i=n(0),r=n(276),o=n(47),s=n(1801),c=n(2577);function d(e,t,n,r){var o=e?Object(i.__assign)({},e):null,d=n;switch(t){case a.generic:case a.render:o.error=d.message,o.errorCategory=c.e.generic,o.errorMessage=s.Rs,o.rawError=n,o.debugErrorMessage=r?r.toString():(d.stack?d.stack:d.toString()).substring(0,1024);break;case a.api:if(!e){var l=c.t.generic,u=null==n?void 0:n.code,f=null==n?void 0:n.status,p=s.ln,m=JSON.stringify(n||{});u?u.indexOf("-2147024809")>-1&&m&&m.indexOf("Item does not exist")>-1&&(l=c.t.invalidItem):f&&parseInt(f,10)>=500&&(l=c.t.serverFailure),o={error:l,errorCategory:c.e.getSharingInformation,errorMessage:p,debugErrorMessage:m,rawError:n,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0}}}return o}function l(e){var t,n=e.customerPromise,o=e.rawErrorMessage,s=e.engagementExtraData,c=e.errorType,d=e.sharingStore;if(n){var l=o,u=Object(r.e)(l);n.end({resultType:u.resultType,errorCode:(t=u.resultCode,t&&t.split(",").join("_")),extraData:Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},null==d?void 0:d.getEngagementHelper().getEngagementExtraData()),s),u.extraData),{error:u.error,rawErrorMessage:o,errorType:c||a.generic})})}}function u(e){var t=e.customerPromise,n=e.engagementExtraData,a=e.sharingStore;t&&t.end({resultType:o.e.Success,extraData:Object(i.__assign)(Object(i.__assign)({},null==a?void 0:a.getEngagementHelper().getEngagementExtraData()),n)})}!function(e){e[e.render=0]="render",e[e.api=1]="api",e[e.generic=2]="generic"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a,i=n(2690),r=((a={})[i.e.anyone]="Globe",a[i.e.onlyYou]="Lock",a[i.e.specificPeople]="PeopleAdd",a[i.e.workGroup]="Work",a[i.e.existing]="SecurityGroup",a[i.e.chat]="Chat",a[i.e.mail]="Mail",a)},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.none=0]="none",e[e.link=1]="link",e[e.linkV2=2]="linkV2",e[e.linkInheritance=3]="linkInheritance",e[e.linkBundle=4]="linkBundle",e[e.direct=5]="direct",e[e.participant=6]="participant",e[e.linkSettings=7]="linkSettings",e[e.back=8]="back",e[e.shareDialogPasswordOnly=9]="shareDialogPasswordOnly",e[e.shareDialogExpirationOnly=10]="shareDialogExpirationOnly",e[e.shareDialogPasswordAndExpiration=11]="shareDialogPasswordAndExpiration",e[e.copyInterruptUpdate=12]="copyInterruptUpdate",e[e.copyInterruptRemove=13]="copyInterruptRemove",e[e.addressBarLinkOff=14]="addressBarLinkOff",e[e.shareDialogExternalSharing=15]="shareDialogExternalSharing"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return L});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHint{background:0 0;margin:0 16px;position:relative}.od-ShareHint.new{margin:0;padding:0;flex:1}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;display:none}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:1rem}.od-ShareHint .ms-Label{font-size:.75rem;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:.625rem;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:flex;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:.875rem;background:0 0;padding:10px 10px 10px 0;margin:0;opacity:0;transition:opacity .2s;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";border:0}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:.625rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:14px 10px;background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 0, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";background-clip:content-box;background-repeat:no-repeat;animation:2s ease-in-out infinite placeholderShimmer;transition:opacity .2s,visibility .2s}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:2.25rem;height:1.5rem}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:1.5rem;border-bottom:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:#fff}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}"}]),Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHintDetail-status{padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{display:inline-block;font-size:.875rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font:-apple-system-body;word-break:break-word}[dir=ltr] .od-ShareHintDetail-statusText{margin-right:4px}[dir=rtl] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusText.unHealthy{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-statusText:hover{cursor:default}.od-ShareHintDetail-statusText:hover.clickable{cursor:pointer}.od-ShareHintDetail{height:100%;background-color:transparent;border:none}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover{cursor:pointer}.od-ShareHintDetail.od-ShareHintDetail--clickable:hover .od-ShareHintDetail-statusText{text-decoration:underline}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir=ltr] .od-ShareHintDetail-statusDetails{right:-36px}[dir=rtl] .od-ShareHintDetail-statusDetails{left:-36px}[dir=ltr] .od-ShareHintDetail-statusDetails{text-align:right}[dir=rtl] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:.625rem;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-ShareHintDetail-item{margin-left:4px}[dir=rtl] .od-ShareHintDetail-item{margin-right:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareHintDetail-item-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir=ltr] .od-ShareHintDetail-description{text-align:left}[dir=rtl] .od-ShareHintDetail-description{text-align:right}.od-ShareHintDetail-chevron{margin-left:4px;font-size:.5rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareHintDetail-iconTooltipContent{font-size:.875rem}"}]);var r=n(476),o=n(2579),s=n(2578),c=n(2576),d=n(1673),l=n(1),u=n(39),f=n(1801),p=n(1807),m=n(1804),_=n(814),h=n(1802),b=n(1806),g=n(163),v=n(1624),y=function(e){function t(t,n){var a=e.call(this,t)||this;return a._renderStatusIcons=a._renderStatusIcons.bind(a),a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this._getLabel(this.props.currentSettings),t="od-ShareHintDetail ".concat(this.props.isClickable?"od-ShareHintDetail--clickable":""),n=e+", "+f.ko;return l.createElement(v.e,{className:t,onClick:this.props.isClickable?this.props.onClickCallback:void 0,"aria-label":n},l.createElement("div",{className:"od-ShareHintDetail-description"},l.createElement("div",{className:"od-ShareHintDetail-status"},l.createElement("span",{className:"od-ShareHintDetail-statusText"},e,this._renderStatusIcons(),this._renderChevron(this.props.isClickable)))))},t.prototype._renderStatusIcons=function(){if(this.props.currentSettings){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.hasPassword,n=this.props.currentSettings.preventDownload,a=[];e&&e.getTime()!==new Date(0).getTime()&&a.push({icon:"Calendar",tooltip:"".concat(u.format(f.Vt,Object(p.d)(e)))}),t&&a.push({icon:"Lock",tooltip:f.To}),n&&a.push({icon:"Blocked2",tooltip:f.Ir}),this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.isReview&&_.t[this.props.sharingInformation.fileExtension]&&a.push({icon:"Feedback",tooltip:f.Ga}),this.props.currentSettings.audience===o.e.anyone&&this.props.currentSettings.trackLinkUsers&&a.push({icon:"ReminderPerson",tooltip:h.se()&&b.n(this.props.clientId)?f.po:f._o});var i=a.map(function(e,t){var n={onRenderContent:function(){return l.createElement("div",{className:"od-ShareHintDetail-iconTooltipContent"},e.tooltip)}};return l.createElement("i",{className:"od-ShareHintDetail-item"},l.createElement(d.e,{id:e.icon,tooltipProps:n},l.createElement(r.e,{iconName:e.icon,"aria-describedby":e.icon,styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})))});return l.createElement("div",{className:"od-ShareHintDetail-iconsList"},i)}},t.prototype._renderChevron=function(e){if(e)return l.createElement(r.e,{iconName:g.t.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHintDetail-chevron",styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})},t.prototype._getLabel=function(e){var t=this.props.companyName,n=this.props.sharingInformation.addressBarLinkSettings,a=this.props.sharingInformation.sharingAbilities;if(this.props.isAddressBarLinkHint&&n)return n.linkDisabled||!Object(m.i)(a)?f.nr:u.format(f.Ze,t);if(!e)return"";if(e.preventDownload){if(e.audience===o.e.anyone)return f.j;if(e.audience===o.e.organization)return u.format(f.$e,t);if(e.audience===o.e.specificPeopleFlex)return f.ys}switch(e.sharingLinkKind){case s.e.direct:return e.audience===o.e.specificPeople?this.props.sharingInformation.requiresAccessApproval?f.oo:e.sharingRole?Object(m.P)(e.sharingRole)?f._s:e.sharingRole===c.e.review?_.t[this.props.sharingInformation.fileExtension]?f.bs:f.gs:f.vs:e.isEdit?f._s:f.vs:f.Lt;case s.e.organizationView:return u.format(f.Ze,t);case s.e.organizationEdit:return u.format(f.Qe,t);case s.e.anonymousView:return f.B;case s.e.anonymousEdit:return f.M;case s.e.flexible:return this._getFlexibleLabel(e,t);default:return""}},t.prototype._getFlexibleLabel=function(e,t){return e.audience===o.e.existing?f.Lt:e.audience===o.e.specificPeopleFlex?e.sharingRole?e.sharingRole==c.e.manageList?f.hs:Object(m.P)(e.sharingRole)?f._s:e.sharingRole===c.e.review?_.t[this.props.sharingInformation.fileExtension]?f.bs:f.gs:f.vs:e.isEdit?f._s:f.vs:e.audience===o.e.customLabeledSpecificPeople?e.sharingRole===c.e.review?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.format(f.nt,this.props.customLabeledAudienceConfig.entityName):Object(m.d)(this.props.clientId,"review",this.props.customLabeledAudienceConfig,this.props.sharingInformation.fileExtension):e.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.format(f.tt,this.props.customLabeledAudienceConfig.entityName):Object(m.d)(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.format(f.at,this.props.customLabeledAudienceConfig.entityName):Object(m.d)(this.props.clientId,"view",this.props.customLabeledAudienceConfig):e.audience===o.e.organization?e.sharingRole===c.e.review?_.t[this.props.sharingInformation.fileExtension]?u.format(f.Je,t):u.format(f.Xe,t):e.sharingRole==c.e.manageList?u.format(f.Ye,t):e.isEdit?u.format(f.Qe,t):u.format(f.Ze,t):e.audience===o.e.anyone?e.sharingRole===c.e.review?_.t[this.props.sharingInformation.fileExtension]?f.T:f.N:e.sharingRole==c.e.manageList?f.P:e.isEdit?f.M:f.B:""},t}(l.Component),S=n(2152),D=n(2690),I=n(2376),x=n(2033),C=n(129),O=n(234),w=n(131),E=n(1800),A={ODB:1176},L=function(e){function t(t,n){var a=e.call(this,t)||this;if(a._targetDiv=Object(l.createRef)(),a._odShareHintchevron=Object(l.createRef)(),a._onDismiss=function(){a.setState({isCoachmarkVisible:!1})},a._platformDetection=n.platformDetection,a._isOnExperiment=!1,O.n.isFeatureEnabled(A)){var i=new w.t({name:"CoachMark",startDate:"08/2/2018",version:w.e.v2});a._isOnExperiment=i.IsExperimentOn()}return a.state={isCoachmarkVisible:a._isOnExperiment},a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t,n=this.props,i=!!this.props.onShareHintClick,r="od-ShareHint ".concat(Object(m.T)(n.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"," new"),s="od-ShareHint-data ".concat(i?"od-ShareHint--clickable":"");if(e=l.createElement("div",{className:"od-ShareHint-shimmer"},l.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},l.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},l.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),l.createElement("div",{className:"od-ShareHint-text-shimmer"})),n.isAddressBarLinkHint){var c=this.props.sharingInformation.addressBarLinkSettings,d=this.props.sharingInformation.sharingAbilities,p=(_=c.linkDisabled||!Object(m.i)(d)?D.e.existing:D.e.workGroup)===D.e.existing?f.nr:u.format(f.$i,this.props.companyName);t=l.createElement("div",{className:s,ref:this._targetDiv},l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(S.e,{label:p,permissionsType:_,showLabel:!1})),l.createElement(y,{clientId:n.clientId,companyName:n.companyName,currentSettings:null,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:n.addressBarLink,isClickable:i,onClickCallback:this._openLinkPermissions.bind(this)}))}else{var _=this._getFileShareTypeFromAudience(),h=(p=this._getLabelFromPermissionsType(_),this.props.currentSettings.audience===o.e.customLabeledSpecificPeople&&this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl);t=n.onShareHintClick?l.createElement("div",{className:s,ref:this._targetDiv},l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(S.e,{label:p,permissionsType:_,iconUrl:h,showLabel:!1})),l.createElement(y,{clientId:n.clientId,companyName:n.companyName,currentSettings:n.currentSettings,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:n.customLabeledAudienceConfig,isClickable:i,onClickCallback:this._openLinkPermissions.bind(this)})):l.createElement("div",Object(a.__assign)({className:s},{autoFocus:!0}),l.createElement("div",{className:"od-ShareHint-iconHolder"},l.createElement(S.e,{label:p,permissionsType:_,iconUrl:h,showLabel:!1})),l.createElement(y,{clientId:n.clientId,companyName:n.companyName,currentSettings:n.currentSettings,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:n.customLabeledAudienceConfig,isClickable:i}))}return l.createElement("div",{"aria-label":f.Zn,className:r},t,e,this.state.isCoachmarkVisible&&l.createElement(I.e,{target:this._odShareHintchevron.current,positioningContainerProps:{directionalHint:g.t.isRightToLeft?C.e.bottomLeftEdge:C.e.bottomRightEdge}},l.createElement(x.e,{calloutProps:{directionalHint:g.t.isRightToLeft?C.e.bottomLeftEdge:C.e.bottomRightEdge,gapSpace:0},headline:f.Zn,hasCondensedHeadline:!0,hasCloseIcon:!0,closeButtonAriaLabel:f.Le,onDismiss:this._onDismiss},f.Hn,l.createElement("br",null),f.Rn)))},t.prototype._renderChevron=function(e){if(e)return l.createElement("div",{ref:this._odShareHintchevron},l.createElement(r.e,{iconName:g.t.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron",styles:{root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}}}))},t.prototype._openLinkPermissions=function(){var e=this.props.onShareHintClick;e&&e()},t.prototype._getFileShareTypeFromAudience=function(){var e=this.props.currentSettings.audience;return e===o.e.anyone?D.e.anyone:e===o.e.organization?D.e.workGroup:e===o.e.existing?D.e.existing:e===o.e.customLabeledSpecificPeople?D.e.chat:D.e.specificPeople},t.prototype._getLabelFromPermissionsType=function(e){return e===D.e.anyone?f.Yi:e===D.e.workGroup?u.format(f.$i,this.props.companyName):e===D.e.existing?f.nr:e===D.e.specificPeople?f.br:void 0},t.contextTypes={platformDetection:E.object.isRequired},t}(l.Component)},function(e,t,n){"use strict";var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendButton{font-size:.875rem;font:-apple-system-title1;margin:0;padding:0;border-radius:.25rem;min-height:2rem;height:fit-content}.od-SendButton .ms-Button-label{font:-apple-system-body}@media screen and (-ms-high-contrast:active){.od-SendButton.send:focus,.od-SendButton.send:hover{background:highlight}}"}]);var r=n(1),o=n(1642),s=n(1176),c=n(1782),d=n(2579),l=n(1952),u=n(1804),f=n(1800),p=n(21),m=n(1802),_=function(e){function t(t,n){var a=e.call(this,t)||this;return a._buttonRef=r.createRef(),a._onSendLinkClicked=function(){a.props.onSendLinkClicked(a.props.messageText,a.props.subjectText)},a._platformDetection=n.platformDetection,a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._buttonRef&&this.props.shouldBeFocused&&this._buttonRef.current.focus()},t.prototype.render=function(){if(!this.props.ctaLabel)return null;var e=!1;if(this.props.currentSettings.audience===d.e.existing&&this.props.linkRecipients)for(var t=0,n=this.props.linkRecipients;t<n.length;t++){var a=n[t];if(void 0===this.props.permissionsMap[a.email]&&void 0===this.props.permissionsMap[a.userId]){e=!0;break}}var i=!!this.props.errorMessage||Object(u.T)(this.props.sharingInformation)||e||Object(u.p)(this.props.messageText)>this.props.maximumMessageLength||Object(u.p)(this.props.subjectText)>this.props.maximumSubjectLength;switch(this.props.sendButtonType){case l.e.button:return r.createElement(o.e,{className:"od-SendButton send",disabled:i,onClick:this._onSendLinkClicked,componentRef:this._buttonRef},this.props.ctaLabel);case l.e.link:return r.createElement("div",{className:"od-SendButton link"},r.createElement(c.e,{disabled:i,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel));case l.e.copyLink:var f=Object(p.L)(),_={color:f.palette.themeDarker,backgroundColor:f.palette.neutralLighter,borderColor:f.palette.neutralSecondary},h={root:{color:f.palette.themePrimary,backgroundColor:f.palette.white,borderColor:f.palette.neutralTertiary},rootHovered:_,rootFocused:_,rootDisabled:{color:f.palette.themeTertiary,backgroundColor:f.palette.white,borderColor:f.palette.neutralTertiary}};return m.u()&&this.context.sharingStore.isConsumer()&&this.props.currentSettings.audience!==d.e.specificPeople&&(i=!1),r.createElement(s.e,{className:"od-SendButton copy",onClick:this._onSendLinkClicked,styles:h,disabled:i},this.props.ctaLabel)}},t.contextTypes={platformDetection:f.object.isRequired,sharingStore:f.object.isRequired},t}(r.Component);t.e=_},,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(0),i=n(1851),r=n(1802);function o(e,t){return function(n){var a=Object(i.getUserPhotoUrl)(n,t||i.UserPhotoSize.Small);return 0===a.indexOf("https://")||0===a.indexOf("http://")?a:a&&e?e+a:void 0}}function s(e){r.ce()||!e||window._spPageContextInfo&&window._spPageContextInfo.userPhotoCdnBaseUrl||(window._spPageContextInfo=Object(a.__assign)(Object(a.__assign)({},window._spPageContextInfo),{userPhotoCdnBaseUrl:e}))}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s});var a,i=n(267),r=n(1851);function o(e,t){var n;switch(e.size){case a.Large:n=r.UserPhotoSize.Large;break;case a.Medium:n=r.UserPhotoSize.Medium;break;default:n=r.UserPhotoSize.Small}return Object(r.getUserPhotoUrl)(e.userLoginName,n,t)}function s(e,t,n){var a=Object(r.getUserPhotoUrl)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new i.e(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(a||(a={}))},,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(60),r=n(8),o=n(1857),s=n(2303),c=n(128),d=n(1888),l=!r.e.isActivated("32DD9EE9-56B8-4C7C-BC57-67F6BCAD585E","09/27/2022","Fix PersistentRequestCache to always clear cached promise once it resolves/rejects"),u=function(){function e(e,t){this._getDataPromises={};var n=e.id,i=e.dataSourceName,r=e.cacheType,d=void 0===r?o.e.indexedDB:r,l=(t.pageContext||{}).aadUserId;this._id=n,this._userId=l;var u=i||n,f=c.e.withData(function(e){return e.name&&u&&!e.name.startsWith(u)?Object(a.__assign)(Object(a.__assign)({},e),{name:"".concat(u,".").concat(e.name)}):e});this._cache=new s.e({cacheType:d,telemetry:{qos:f}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,r=n.cachingStrategy,o=void 0===r?d.e.useCacheAndUpdateInTheBackground:r,s=n.cacheTimeoutTime,c=void 0===s?d.a:s,u=n.getData,f=n.returnStatistics,p=void 0!==f&&f,m=n.cacheRequestParentKey,_={key:a,user:this._userId,parentKey:m},h=function(){if(l){var e=t._getDataPromises[a];return e||(e=t._getDataPromises[a]=u()).then(function(e){return t._cache.update(_,e),delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e}),e.then(function(e){return p?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})}return t._getDataPromises[a]||(t._getDataPromises[a]=u().then(function(e){return delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})),t._getDataPromises[a].then(function(e){return t._cache.update(_,e),p?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return o===d.e.onlyCache?i.n.resolve(this._cache.read(_)).then(function(e){var t=e||(l?{}:void 0),n=t.data,a=t.cacheStats;return null==n?null:p?{data:n,cacheStats:a}:n}).catch(function(){return null}):i.n.resolve(this._cache.read(_)).then(function(e){var n=e||(l?{}:void 0),a=n.data,i=n.cacheStats;if(null==a)return h();var r=p?{data:a,cacheStats:i}:a,s=t._isCacheExpired(i.lastModified,c);switch(o){case d.e.useCacheAndNoUpdate:return r;case d.e.useCacheAndUpdateInTheBackground:return s&&h(),r;case d.e.useCacheIfNotExpired:return s?h():r;case d.e.bypassCache:default:return h()}}).catch(function(){return h()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e,t){var n={key:e,user:this._userId,parentKey:t};delete this._cache[e],this._cache.remove(n)},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update(n,t)},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}()},,,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:"@keyframes commandBarBoxShadowAnimation{0%{box-shadow:none}100%{box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,.132),0 .6px 1.8px 0 rgba(0,0,0,.108)}}@keyframes commandBarDividerAnimation{0%{opacity:1}100%{opacity:0}}.od-PanelHost{display:none}.SPPageChrome .od-Panel{top:0}.od-Panel{outline:1px solid transparent;position:absolute;top:48px;bottom:0;width:100%;max-width:100%;background:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box;transition:width .3s ease-out;box-shadow:-30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";box-shadow:0 25.6px 57.6px 0 rgba(0,0,0,.22),0 4.8px 14.4px 0 rgba(0,0,0,.18)}[dir=ltr] .od-Panel{right:0}[dir=rtl] .od-Panel{left:0}.od-Panel.od-Panel--reactSuiteNav{top:48px}html[dir=rtl] .od-Panel{box-shadow:30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:"}.od-BasePage--noSuiteNav .od-Panel{top:0}.od-Panel.od-Panel--sm{width:100%}.lg .od-Panel.od-Panel--sm,.md .od-Panel.od-Panel--sm,.xlg .od-Panel.od-Panel--sm,.xxlg .od-Panel.od-Panel--sm,.xxxlg .od-Panel.od-Panel--sm,.xxxxlg .od-Panel.od-Panel--sm{width:340px}.lg .od-Panel.od-Panel--lg,.lg .od-Panel.od-Panel--xlg,.xlg .od-Panel.od-Panel--lg,.xlg .od-Panel.od-Panel--xlg,.xxlg .od-Panel.od-Panel--lg,.xxlg .od-Panel.od-Panel--xlg,.xxxlg .od-Panel.od-Panel--lg,.xxxlg .od-Panel.od-Panel--xlg,.xxxxlg .od-Panel.od-Panel--lg,.xxxxlg .od-Panel.od-Panel--xlg{width:auto}[dir=ltr] .lg .od-Panel.od-Panel--lg,[dir=ltr] .lg .od-Panel.od-Panel--xlg,[dir=ltr] .xlg .od-Panel.od-Panel--lg,[dir=ltr] .xlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:48px}[dir=rtl] .lg .od-Panel.od-Panel--lg,[dir=rtl] .lg .od-Panel.od-Panel--xlg,[dir=rtl] .xlg .od-Panel.od-Panel--lg,[dir=rtl] .xlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:48px}.lg .od-Panel.od-Panel--md,.xlg .od-Panel.od-Panel--md,.xxlg .od-Panel.od-Panel--md,.xxxlg .od-Panel.od-Panel--md,.xxxxlg .od-Panel.od-Panel--md{width:643px}[dir=ltr] .lg .od-Panel.od-Panel--md,[dir=ltr] .xlg .od-Panel.od-Panel--md,[dir=ltr] .xxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxxlg .od-Panel.od-Panel--md{left:auto}[dir=rtl] .lg .od-Panel.od-Panel--md,[dir=rtl] .xlg .od-Panel.od-Panel--md,[dir=rtl] .xxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxxlg .od-Panel.od-Panel--md{right:auto}.lg .od-Panel.od-panel-md-listform,.xlg .od-Panel.od-panel-md-listform,.xxlg .od-Panel.od-panel-md-listform,.xxxlg .od-Panel.od-panel-md-listform,.xxxxlg .od-Panel.od-panel-md-listform{width:800px}[dir=ltr] .lg .od-Panel.od-panel-md-listform,[dir=ltr] .xlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxxlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxxxlg .od-Panel.od-panel-md-listform{left:auto}[dir=rtl] .lg .od-Panel.od-panel-md-listform,[dir=rtl] .xlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxxlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxxxlg .od-Panel.od-panel-md-listform{right:auto}[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:428px}[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:428px}[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:980px}[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:980px}[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:1620px}[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:1620px}[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:176px}[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:176px}.lg .od-Panel.od-Panel--fullScreen,.md .od-Panel.od-Panel--fullScreen,.xlg .od-Panel.od-Panel--fullScreen,.xxlg .od-Panel.od-Panel--fullScreen,.xxxlg .od-Panel.od-Panel--fullScreen,.xxxxlg .od-Panel.od-Panel--fullScreen{width:100%}.sm .od-Panel.od-Panel--lightDismiss{width:272px}.od-Panel--FullPagePanel{top:0;width:100%;height:100%}.od-Panel--hasPadding{padding:74px 16px 20px}.lg .od-Panel--hasPadding,.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding-top:74px}.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.od-Panel--autoScroll{overflow:auto}.od-Panel--hiddenScroll{overflow:hidden}.od-Panel--alwaysScroll{overflow-y:scroll}.od-Panel-title{margin-bottom:19px;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:";max-width:240px}html[dir=ltr] .od-Panel-title{margin-right:26px}html[dir=rtl] .od-Panel-title{margin-left:26px}.lg .od-Panel-title,.md .od-Panel-title,.sm .od-Panel-title{line-height:normal}.od-Panel--hidden{visibility:hidden}.od-Panel-content--titleFill{width:100%;height:calc(100% - 48px - 8px)}.od-Panel-content--noTitleFill{width:100%;height:100%}.od-Panel-button--close{position:absolute;outline:0;margin:0;border:0;background:0 0;cursor:pointer;height:32px;width:32px;line-height:32px;padding:0;top:16px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:"}[dir=ltr] .od-Panel-button--close{right:16px}[dir=rtl] .od-Panel-button--close{left:16px}.od-Panel-button--close:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluentVNext .od-Panel-button--close:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Panel-button--close:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Panel-button--close .ms-Icon--Cancel{font-size:16px;margin-top:0;color:inherit}.md .od-Panel-button--close .ms-Icon--Cancel,.sm .od-Panel-button--close .ms-Icon--Cancel{font-size:16px}.od-Panel--hasCommandBar .od-Panel-button--close{z-index:600;padding:0;top:6px}[dir=ltr] .od-Panel--hasCommandBar .od-Panel-button--close{right:8px}[dir=rtl] .od-Panel--hasCommandBar .od-Panel-button--close{left:8px}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-button--close{right:20px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-button--close{left:20px}[dir=ltr] .md .od-Panel-button--close,[dir=ltr] .sm .od-Panel-button--close{right:20px}[dir=rtl] .md .od-Panel-button--close,[dir=rtl] .sm .od-Panel-button--close{left:20px}[dir=ltr] .sm .od-Panel-button--close{right:12px}[dir=rtl] .sm .od-Panel-button--close{left:12px}.od-Panel-button--close:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Panel--stickyCloseButton .od-Panel-content{position:absolute;top:0;bottom:0;left:0;right:0;overflow:auto}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-content{padding-right:40px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-content{padding-left:40px}.od-OverlayHost-overlay .od-Panel{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{opacity:1}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation-name:ms-fadeIn,ms-slideLeftIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation-name:ms-fadeIn,ms-slideRightIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation:none}}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation-name:ms-fadeOut,ms-slideRightOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(0.1,0.25,0.75,0.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation-name:ms-fadeOut,ms-slideLeftOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(0.1,0.25,0.75,0.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation:none}}.od-PanelOverlay.ms-ModalOverlay{top:48px}.od-BasePage--noSuiteNav .od-PanelOverlay.ms-ModalOverlay{top:0}.SPPageChrome .od-PanelOverlay.ms-ModalOverlay{top:0}[dir=ltr] .od--hasFlexPane .od-Panel{right:320px}[dir=rtl] .od--hasFlexPane .od-Panel{left:320px}"}])},,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-FolderCoverTile{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden}.od-FolderCoverTile-image{position:absolute;left:0;right:0;top:0;bottom:0;opacity:0;transition:opacity .6s linear .6s;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FolderCoverTile-watermark{position:absolute;left:50%;top:38%;transform:translate(-50%,-50%);max-width:64px;max-height:64px}.od-FolderCoverTile-item0 .od-FolderCoverTile-image,.od-FolderCoverTile-item1 .od-FolderCoverTile-image{opacity:1}.od-FolderCoverTile>div{position:absolute;bottom:0}.od-FolderCoverTile-empty{left:2px;right:2px;top:8px;box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-FolderCoverTile-item0{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";transform:translateY(100%)}.od-FolderCoverTile-item1{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";transition:transform .6s cubic-bezier(.1, .9, .2, 1)}.od-FolderCoverTile-item2,.od-FolderCoverTile-item3{transition:left .6s cubic-bezier(.1, .9, .2, 1),right .6s cubic-bezier(.1, .9, .2, 1),top .6s cubic-bezier(.1, .9, .2, 1)}.od-FolderCoverTile-item2{left:5px;right:5px;top:5px;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FolderCoverTile-item3,.od-FolderCoverTile-item4{left:8px;right:8px;top:2px;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FolderCoverTile-item4{opacity:0}.is-tag .od-FolderCoverTile-item1,.is-tag .od-FolderCoverTile-item2,.is-tag .od-FolderCoverTile-item3{box-shadow:none}.is-tag .od-FolderCoverTile-item1{left:0;right:0;top:0}.is-tag .od-FolderCoverTile-item2{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";transition:left .6s cubic-bezier(.1, .9, .2, 1),right .6s cubic-bezier(.1, .9, .2, 1),top .6s cubic-bezier(.1, .9, .2, 1)}"}]);var i,r=n(0),o=n(196),s=n(1873),c=n(1855),d=n(215),l=function(e){function t(t){var n=e.call(this,t)||this;n.thumbnailTagName=s.e.tagName;var a=n.observables,r=n.resources;i||(i=r.consume(d.e).isRetinaSupported?"64_2x":"64"),n.imageRect=t.imageRect,n._item=t.item,n._lastThumbnails=-1,n._thumbnailIndex=-1,n._isPulsingEnabled=!0,n.pulseRecords=a.createArray(),a.compute(n._computeRecords);var o=t.pulseTarget;return o&&o(n),n}return Object(r.__extends)(t,e),t.prototype.canPulse=function(){var e=this._item();return!!(e&&e.folder&&e.folder.covers&&e.folder.covers.length>1)},t.prototype.enablePulsing=function(e){this._isPulsingEnabled=e},t.prototype.pulse=function(){this.canPulse()&&this._isPulsingEnabled&&(this._pushNextRecord(),this.pulseRecords.shift(),this._updatePulseClasses())},t.prototype.getThumbnailParams=function(e){return{image:e.thumbnail,desiredSize:this.imageRect,alignment:c.e.cover}},t.prototype._computeRecords=function(){var e=this._item();if(e){var t=e.key||"",n=e.folder&&e.folder.covers?e.folder.covers.length:-1;t===this._lastKey&&n===this._lastThumbnails||(this._lastKey=t,this._lastThumbnails=n,this.pulseRecords.removeAll(),this._thumbnailIndex=-1,0===(e.folder&&e.folder.totalCount)?this._pushFolderRecord(!0):this._initializeRecord(),this._updatePulseClasses())}},t.prototype._pushFolderRecord=function(e){var t=this.observables;this.pulseRecords.push({className:t.create("od-FolderCoverTile-empty"),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create(""),isEmpty:e,thumbnail:t.create(null)})},t.prototype._initializeRecord=function(){var e;for(e=0;e<3;e++)this._pushFolderRecord(!1);for(e=0;e<2;e++)this._pushNextRecord()},t.prototype._pushNextRecord=function(){var e=this._getNextThumbnail(),t=this.observables;this.pulseRecords.push({className:t.create(),thumbnail:t.create(e),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create("")})},t.prototype._updatePulseClasses=function(){for(var e=this.pulseRecords(),t=0;t<e.length;t++){var n=e[t],a=e.length-t-1;n.isEmpty||n.className("od-FolderCoverTile-item"+a),n.isThumbnailVisible(!(!n.thumbnail()||!(n.isThumbnailVisible()||a<2)));var i=this.unwrapObservable(this._item),r=!i.tagInfo&&!n.isThumbnailVisible()&&(1===a||i.isAlbum||i.isDocSet);n.isWatermarkVisible(r),n.watermarkUrl(r?this._getFolderWatermarkUrl():null)}},t.prototype._getFolderWatermarkUrl=function(){var e=this._item(),t="genericfolder";switch(e.isAlbum&&(t="photofolder"),e.isSpecialFolder&&e.specialFolderCanonicalName){case"Music":t="musicfolder";break;case"Documents":t="documentfolder";break;case"Photos":t="photofolder"}return e.isDocSet&&(t="Docset"),window.require.toUrl("odsp-media/images/watermarks/".concat(i,"/").concat(t.toLowerCase(),".png"))},t.prototype._getNextThumbnail=function(){var e=this._item(),t=e&&e.folder&&e.folder.covers,n=t&&t.length;if(n)return t[this._thumbnailIndex=(this._thumbnailIndex+1)%n]},t}(o.t),u=n(399).e({tagName:"od-folder-cover-tile",template:'<div class="od-FolderCoverTile" data-bind="foreach:pulseRecords"><div data-bind="attr:{class:className}">\x3c!--ko if:isThumbnailVisible--\x3e<div class="od-FolderCoverTile-image" data-bind="component:{name:$component.thumbnailTagName,params:$component.getThumbnailParams($data)}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isWatermarkVisible--\x3e<img class="od-FolderCoverTile-watermark" role="presentation" data-bind="attr:{src:watermarkUrl}">\x3c!--/ko--\x3e</div></div>',viewModel:l,synchronous:!0});t.e=u},,,,,function(e,t,n){"use strict";var a,i,r,o;n.d(t,"n",function(){return a}),n.d(t,"i",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s}),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(a||(a={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(i||(i={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(r||(r={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(o||(o={}));var s=7},function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i});var a=n(2590).e,i={leftNavigation:"Up",rightNavigation:"Down",closeIcon:"CalculatorMultiply"}},,function(e,t,n){"use strict";n.d(t,"e",function(){return b}),n.d(t,"t",function(){return g}),n.d(t,"i",function(){return v}),n.d(t,"n",function(){return y}),n.d(t,"a",function(){return S});var a=n(24),i=n(2369),r=n(96),o=n(2048),s=n(60),c=n(290),d=n(1137),l=n(26),u=n(2032),f=n(2066),p=n(39),m=n(1875),_=n(1807),h=n(1977);function b(e,t,n,d){var l=a.observable(!0);return n.requestDialog({title:i.n,size:"Medium",customCssClasses:"od-ConfirmationDialog",component:{name:o.e.tagName,params:{message:i.t}},actions:[{name:i.e,execute:function(){r.e.logData({name:"Confirm.DisableLink."+d+".Click",isIntentional:!0}),l(!1);var n=e().then(function(e){return s.n.wrap(e?2:3)});return t(n),n},isDefault:!0,isAvailable:l,icon:new c.e("Save"),automationId:"UnshareConfirm"},{name:i.a,execute:function(){return r.e.logData({name:"KeepExisting.DisableLink."+d+".Click",isIntentional:!0}),s.n.wrap(3)},isDefault:!1,icon:new c.e("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})}function g(e,t,n){return n.requestDialog({title:t,size:"Small",component:{name:d.e.tagName,params:{text:e}},actions:[{name:l.Close,execute:function(){return s.n.wrap(2)},isAvailable:a.observable(!0),icon:new c.e("Save"),isDefault:!0}],executeDefaultAction:!1}).wait()}function v(e,t){for(var n=0,a=0,i=!1,r=0,o=e.people;r<o.length;r++){var s=o[r];s.entityType===u.e.group?a++:s.sharingInfo.role!==m.e.Owner&&(n++,s.entityType===u.e.externalUser&&(i=!0))}var c="";return a>0&&n>0?c=a>1?p.format(i?f.I:f.S,t,a,n):p.format(i?f.D:f.y,t,n):1===a?c=p.format(f.h,t):a>1?c=p.format(f.b,t,a):n>0&&i?c=p.format(f.v,t,n):n>1?c=p.format(f.g,t,n):1===n&&(c=p.format(f.x,t)),c}function y(e){if(!e)return 0;var t=e.getTime()-(new Date).getTime();return Math.ceil(t/864e5)}function S(e,t){if(e||t&&this._item){var n=(null==t?void 0:t.expiration)?Object(_.d)(new Date(t.expiration)):null;switch(e){case m.e.View:return n?p.format(h.p,n):h.f;case m.e.Edit:return n?p.format(h.a,n):h.n;case 6:return h.c;case m.e.CoOwner:return h.t;case m.e.Owner:return h.o;case m.e.Custom:return t.customRole}}return""}},,,,,,,,,,,function(e,t,n){"use strict";n(2077);var a=n(17);Object(a.n)([{rawString:".ms-Presence{display:inline-block;width:.75rem;height:.75rem;z-index:1;margin:3px;border-radius:50%;border:2px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";text-align:center;vertical-align:bottom}.ms-Presence.ms-Presence--Online{background-color:#7dbc00}.ms-Presence.ms-Presence--Busy{background-color:#e9001b}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Busy{background-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Busy{background-color:#37006e}}.ms-Presence.ms-Presence--DoNotDisturb{background-color:#eb0615}.ms-Presence.ms-Presence--BeRightBack{background-color:#f9ce15}.ms-Presence.ms-Presence--Away{background-color:#f9ce15}.ms-Presence.ms-Presence--Offline{background-color:#bd2eae}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"black",defaultValue:"#000"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#fff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000"},{rawString:" inset}}.ms-Presence.ms-Presence--Hidden{background-color:#f1f1f1}.ms-Presence::before{font-size:8px;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";line-height:.75rem;vertical-align:top;position:relative}@media screen and (-ms-high-contrast:active){.ms-Presence{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:";box-shadow:0 0 0 1px #1aebff inset;color:"},{theme:"black",defaultValue:"#000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence{border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-shadow:0 0 0 1px #37006e inset;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";background-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}.od-Persona.od-Persona--lg .ms-Presence{width:1.25rem;height:1.25rem;border-width:3px}.od-Persona.od-Persona--lg .ms-Presence::before{line-height:1.25rem;font-size:14px}.od-Persona.od-Persona--xl .ms-Presence{width:1.75rem;height:1.75rem;border-width:4px}.od-Persona.od-Persona--xl .ms-Presence::before{line-height:1.75rem;font-size:21px}.od-focus--enabled a.ms-Presence{box-shadow:none}.od-focus--enabled .ms-Presence:focus:before{position:absolute;top:0;bottom:0;left:0;right:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';content:"";border-radius:50%}'}]);var i=n(0),r=n(196),o=n(24),s=n(1951),c=n(2403),d=n(21),l=function(e){function t(t){var n=e.call(this)||this;return n.strings=c,n.sip=o.isObservable(t.sip)?t.sip:o.observable(t.sip||""),n.presenceType=o.observable(0),n._dataProvider=n.resources.consume(s.t),n.registerPresence(n.sip()),n.isVisible=!!n._presenceDisposable,n._sipSubscriptionOld=n.sip.subscribe(function(e){n.unRegisterPresence(e)},n,"beforeChange"),n._sipSubscriptionNew=n.sip.subscribe(function(e){n.registerPresence(e)},n),n.presenceClass=n.createComputed(n._computePresenceClass),n.presenceTypeText=n.createComputed(n._computePresenceTypeText),n}return Object(i.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.unRegisterPresence(this.sip()),this._sipSubscriptionOld&&this._sipSubscriptionOld.dispose(),this._sipSubscriptionNew&&this._sipSubscriptionNew.dispose()},t.prototype.registerPresence=function(e){var t=this;this._dataProvider&&e&&(this._presenceDisposable=this._dataProvider.subscribePresence(e,function(e){t._presenceCallback(e)}))},t.prototype.unRegisterPresence=function(e){this._presenceDisposable&&this._presenceDisposable.dispose()},t.prototype._presenceCallback=function(e){!this.isDisposed&&this.presenceType&&this.presenceType(e)},t.prototype._computePresenceTypeText=function(){var e="";switch(this.presenceType()){case 1:e=this.strings.online;break;case 2:e=this.strings.busy;break;case 3:e=this.strings.doNotDisturb;break;case 4:e=this.strings.beRightBack;break;case 5:e=this.strings.away;break;case 6:e=this.strings.offline}return e},t.prototype._computePresenceClass=function(){var e="";switch(this.presenceType()){case 1:e="ms-Presence--Online ".concat(Object(d.O)("SkypeCheck"));break;case 2:e="ms-Presence--Busy";break;case 3:e="ms-Presence--DoNotDisturb ".concat(Object(d.O)("SkypeMinus"));break;case 4:e="ms-Presence--BeRightBack";break;case 5:e="ms-Presence--Away ".concat(Object(d.O)("SkypeClock"));break;case 6:e="ms-Presence--Offline";break;default:e="ms-Presence--Hidden"}return"ms-Presence "+e},t}(r.t),u=n(399),f=(u.e({tagName:"ms-presence",template:'<a data-bind="css:presenceClass,visible:isVisible,attr:{title:presenceTypeText,\'aria-label\':presenceTypeText}" class="od-Persona-presence"></a>',viewModel:l}),n(1978)),p=n(444),m=n(1848),_=n(1959),h=n(347),b=n(1872),g=n(1977),v=n(1875),y=n(1113),S=n(60),D=n(47),I=n(7),x=n(119),C=new I.t({name:"SharingProvider.key",loader:new x.t(function(){return n.e(291).then(n.bind(null,1964)).then(function(e){return e.resourceKey})})}),O=function(e){function t(t){var n=e.call(this,t)||this;return n.name="UpdatePermissions",n._item=t.item,n._person=t.person,n._role=t.role,n._isExecuting=t.isExecuting,n._callback=t.callback,n._expiration=t.expiration,n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this;return this._isExecuting&&this._isExecuting(!0),S.n.resolve(this.resources.consumeAsync(C)).then(function(e){return e.updatePermissions([n._person],n._item,n._role,n._expiration)}).then(function(e){return n._callback(e.people[0]),n._isExecuting(!1),{resultType:D.e.Success}},function(e){return n._isExecuting(!1),{resultType:D.e.Failure}})},t}(y.e),w=n(1139),E=n(10),A=n(67),L=n(29),k=n(1108),M=n(1109),P=n(39),T=n(2017),U=function(e){function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=b.e.tagName,n.personaImageTagName=f.e.tagName,n.addBindingHandlers({tooltip:w.e,keyboard:k.e,element:M.e}),n.updateSharingRole=function(e){if(e.sharingInfo.role===v.e.None)n._removePerson(n.person());else{var t=n.person();t.sharingInfo=e.sharingInfo,n.person(t),n.updatingPermissions(!1)}},n._item=t.item,n.openContextMenu=t.openContextMenu||n.observables.create(!1),n.inputEvent=t.inputEvent||n.observables.create(null),n.sharingRoleElement=n.createObservable(),n.disableTab=n.createObservable(t.disableTab),n.showEmail=Object(E.isFeatureEnabled)(E.ShowEmailInPeoplePicker),n.person=o.isObservable(t.person)?t.person:o.observable(t.person),n.updatingPermissions=o.observable(!1),n.nameEmail=n.person().email?P.format(g.r,n.person().name,n.person().email):n.person().name,n._removePerson=t.removePerson||function(e){},n.showName=void 0===t.showName||!!t.showName,n.showProfileLink=!!t.profileLinkOn,n.showPresence=!!t.showPresence,n._includeComma=!!t.includeComma,n._sharingRoleMenuRootElementClass=t.sharingRoleMenuRootElementClass||"od-Dialog-main",n._urlDataSource=n.resources.consume(A.Se),t.personaSize?n.personaSize=o.isObservable(t.personaSize)?t.personaSize:o.observable(t.personaSize):n.personaSize=o.observable(3),n.personaImageParams={person:n.person,disablePictrueAlt:t.disablePictrueAlt,iconType:t.iconType},n.createComputed(function(){if(n.openContextMenu()&&n.canChangePermissions()&&n.canManagePermissions()){var e=n._createContextMenuCommands(),t=n._createContextMenuHelper(e),a=n.inputEvent.peek();m.e.createContextMenu(a,t,n),13===a.keyCode&&a.preventDefault(),n.openContextMenu(!1)}}),n.personaClass=n.createComputed(function(){var e=void 0===n.person().isResolved||n.person().isResolved?"":"od-Persona-unresolved ";switch(n._includeComma&&(e+="od-Persona--comma "),e+="od-Persona",n.personaSize()){case 7:return e+" od-Persona--mini";case 1:return e+" od-Persona--tiny";case 2:return e+" od-Persona--xs";case 3:return e+" od-Persona--sm";case 5:return e+" od-Persona--lg";case 6:return e+" od-Persona--xl";case 8:return e+" od-Persona--xxl";default:return e}}),n.hasSharingInfo=n.createComputed(function(){return!!n.person().sharingInfo});var a=n.resources.isExposed(L.T)?n.resources.consume(L.T):null;return n.personIsCurrentUser=n.createPureComputed(function(){return a&&n.person().userId&&n._urlDataSource.getOwnerId("",a()).toLowerCase()===n.person().userId.toLowerCase()},{deferEvaluation:!0}),n.canChangePermissions=n.createPureComputed(function(){return!!n.person().sharingInfo&&n.person().sharingInfo.role!==v.e.Owner&&!n.personIsCurrentUser()}),n.canManagePermissions=n.createObservable(t.canManagePermissions),n.presenceVisible=n.createComputed(function(){return n.showPresence&&!!n.person().sip}),n.tooltip=n.person().email,n.updatingText=g.u,n.person().providerName&&(n.tooltip+="\n"+n.person().providerName),n}return Object(i.__extends)(t,e),t.prototype.getSharingRole=function(e){return T.a(null==e?void 0:e.role,e)},t.prototype.onSharingRoleClick=function(e,t){this.resources.consume(h.e).logData({name:"UpdatePermissionsMenu.SharingDialog.Click",isIntentional:!0});var n=this._createContextMenuCommands(),a=this._createContextMenuHelper(n,t);return m.e.createContextMenu(t,a,this),n},t.prototype._createContextMenuCommands=function(){var e,t=[],n="";if(Object(E.isFeatureEnabled)(E.ReviewPermissionUI)&&this._item.appMap&&"ms-word"===this._item.appMap){var a,i="";this.person().sharingInfo.role===v.e.View?(n=g.e,e=v.e.Edit,i=g.d,a=v.e.Review):this.person().sharingInfo.role===v.e.Review?(n=g.e,e=v.e.Edit,i=g.m,a=v.e.View):this.person().sharingInfo.role===v.e.Edit&&(n=g.d,e=v.e.Review,i=g.m,a=v.e.View),t[0]=new p.e({text:n,isToggleable:!1,action:new(this.managed(O))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})}),t[1]=new p.e({text:i,isToggleable:!1,action:new(this.managed(O))({person:this.person(),role:a,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})}),t[2]=new p.e({text:g.l,isToggleable:!1,action:new(this.managed(O))({person:this.person(),role:v.e.None,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}else this.person().sharingInfo.role===v.e.View?(n=g.e,e=v.e.Edit):(n=g.m,e=v.e.View),t[0]=new p.e({text:n,isToggleable:!1,action:new(this.managed(O))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})}),t[1]=new p.e({text:g.l,isToggleable:!1,action:new(this.managed(O))({person:this.person(),role:v.e.None,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})});return t},t.prototype._createContextMenuHelper=function(e,t){return new _.e({items:e,rootElementClass:this._sharingRoleMenuRootElementClass,anchorElement:t&&t.target||this.sharingRoleElement.peek()})},t}(r.t),F=u.e({tagName:"od-persona",template:'<div data-bind="tooltip:{content:nameEmail,\'aria-label\':person().name},css:personaClass"><div class="od-Persona-imageArea"><div class="od-Persona-imageCircle">\x3c!--ko component:{name:personaImageTagName,params:personaImageParams}--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:presenceVisible--\x3e\x3c!--ko component:{name:\'ms-presence\',params:{sip:person().sip}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="od-Persona-details">\x3c!--ko if:showProfileLink--\x3e\x3c!--ko if:person().profilePage--\x3e<a class="od-Persona-link od-Persona-primaryText" target="_blank" data-bind="attr:{href:person().profilePage},text:person().name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:person().profilePage--\x3e<span class="od-Persona-link od-Persona-primaryText" data-bind="text:person().name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!showProfileLink&&showName--\x3e<div class="od-Persona-primaryText od-persona-link" data-bind="text:person().name"></div>\x3c!--/ko--\x3e<div class="od-Persona-secondaryText" data-bind="visible:!!person().job,text:person().job"></div><div class="od-Persona-tertiaryText" data-bind="visible:!!person().department,text:person().department"></div><div class="od-Persona-optionalText" data-bind="visible:!!person().office,text:person().office"></div><div class="od-Persona-emailText" data-bind="visible:showEmail,text:person().email"></div>\x3c!--ko if:canChangePermissions()&&canManagePermissions()--\x3e<div class="od-Persona-sharingContainer" data-bind="visible:!updatingPermissions()&&getSharingRole(person().sharingInfo)&&personaSize()>3"><button class="od-Persona-sharingRole" aria-haspopup="true" data-bind="click:onSharingRoleClick,keyboard:{Space:onSharingRoleClick},attr:{\'aria-label\':getSharingRole(person().sharingInfo),tabindex:!disableTab?\'0\':\'-1\'},element:sharingRoleElement"><div class="od-Persona-sharingRole-Text"><span data-bind="text:getSharingRole(person().sharingInfo)"></span><span class="od-Persona-sharingRole-Chevron" data-bind="visible:!personIsCurrentUser()"><i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i></span></div></button></div>\x3c!--ko if:updatingPermissions()--\x3e<div class="od-Persona-sharingSpinner" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:updatingText}},visible:updatingPermissions()"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:hasSharingInfo&&(!canChangePermissions()||!canManagePermissions())--\x3e<div class="od-Persona-sharingRole-Text" data-bind="text:getSharingRole(person().sharingInfo)"></div>\x3c!--/ko--\x3e</div></div>',viewModel:U});t.e=F},function(e,t,n){"use strict";n.d(t,"e",function(){return C});var a=n(1526),i=n(21),r=n(525),o=n(435),s=n(404),c=n(1125),d=n(1115),l={root:"ms-GroupHeader",compact:"ms-GroupHeader--compact",check:"ms-GroupHeader-check",dropIcon:"ms-GroupHeader-dropIcon",expand:"ms-GroupHeader-expand",isCollapsed:"is-collapsed",title:"ms-GroupHeader-title",isSelected:"is-selected",iconTag:"ms-Icon--Tag",group:"ms-GroupedList-group",isDropping:"is-dropping"},u="cubic-bezier(0.390, 0.575, 0.565, 1.000)",f=n(0),p=n(1),m=n(809),_=n(112),h=n(1103),b=n(587),g=n(108),v=n(1340),y=n(476),S=n(1786),D=Object(m.e)(),I=function(e){function t(t){var n=e.call(this,t)||this;return n._toggleCollapse=function(){var e=n.props,t=e.group,a=e.onToggleCollapse,i=e.isGroupLoading,r=!n.state.isCollapsed,o=!r&&i&&i(t);n.setState({isCollapsed:r,isLoadingVisible:o}),a&&a(t)},n._onKeyUp=function(e){var t=n.props,a=t.group,i=t.onGroupHeaderKeyUp;if(i&&i(e,a),!e.defaultPrevented){var r=n.state.isCollapsed&&e.which===Object(o.t)(_.e.right,n.props.theme);(!n.state.isCollapsed&&e.which===Object(o.t)(_.e.left,n.props.theme)||r)&&(n._toggleCollapse(),e.stopPropagation(),e.preventDefault())}},n._onToggleClick=function(e){n._toggleCollapse(),e.stopPropagation(),e.preventDefault()},n._onHeaderClick=function(){var e=n.props,t=e.group,a=e.onGroupHeaderClick;a&&a(t)},n._onRenderTitle=function(e){if(!e.group)return null;var t=e.onRenderName?Object(h.e)(e.onRenderName,n._onRenderName):n._onRenderName;return p.createElement("div",{className:n._classNames.title,id:n._id,onClick:n._onHeaderClick,role:"gridcell","aria-colspan":n.props.ariaColSpan,"data-selection-invoke":!0},t(e))},n._onRenderName=function(e){var t=e.group;return t?p.createElement(p.Fragment,null,p.createElement("span",null,t.name),p.createElement("span",{className:n._classNames.headerCount},"(",t.count,t.hasMoreData&&"+",")")):null},n._id=Object(b.e)("GroupHeader"),n.state={isCollapsed:n.props.group&&n.props.group.isCollapsed,isLoadingVisible:!1},n}return Object(f.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){if(e.group){var n=e.group.isCollapsed,a=e.isGroupLoading,i=!n&&a&&a(e.group);return Object(f.__assign)(Object(f.__assign)({},t),{isCollapsed:n||!1,isLoadingVisible:i||!1})}return t},t.prototype.render=function(){var e=this.props,t=e.group,n=e.groupLevel,a=void 0===n?0:n,i=e.viewport,r=e.selectionMode,s=e.loadingText,l=e.isSelected,u=void 0!==l&&l,m=e.selected,_=void 0!==m&&m,b=e.indentWidth,v=e.onRenderGroupHeaderCheckbox,I=e.isCollapsedGroupSelectVisible,x=void 0===I||I,C=e.expandButtonProps,O=e.expandButtonIcon,w=e.selectAllButtonProps,E=e.theme,A=e.styles,L=e.className,k=e.compact,M=e.ariaLevel,P=e.ariaPosInSet,T=e.ariaSetSize,U=e.ariaRowIndex,F=e.useFastIcons,H=this.props.onRenderTitle?Object(h.e)(this.props.onRenderTitle,this._onRenderTitle):this._onRenderTitle,R=F?this._fastDefaultCheckboxRender:this._defaultCheckboxRender,N=v?Object(h.e)(v,R):R,B=this.state,j=B.isCollapsed,V=B.isLoadingVisible,z=r===g.n.multiple,G=z&&(x||!(t&&t.isCollapsed)),K=_||u,W=Object(o.e)(E);return this._classNames=D(A,{theme:E,className:L,selected:K,isCollapsed:j,compact:k}),t?p.createElement("div",{className:this._classNames.root,style:i?{minWidth:i.width}:{},role:"row","aria-level":M,"aria-setsize":T,"aria-posinset":P,"aria-rowindex":U,"data-is-focusable":!0,onKeyUp:this._onKeyUp,"aria-label":t.ariaLabel,"aria-labelledby":t.ariaLabel?void 0:this._id,"aria-expanded":!this.state.isCollapsed,"aria-selected":z?K:void 0,"data-selection-index":t.startIndex,"data-selection-span":t.count},p.createElement("div",{className:this._classNames.groupHeaderContainer,role:"presentation"},G?p.createElement("div",{role:"gridcell"},p.createElement("button",Object(f.__assign)({"data-is-focusable":!1,type:"button",className:this._classNames.check,role:"checkbox",id:this._id+"-check","aria-checked":K,"aria-labelledby":this._id+"-check "+this._id,"data-selection-toggle":!0},w),N({checked:K,theme:E},N))):r!==g.n.none&&p.createElement(d.e,{indentWidth:c.e,count:1}),p.createElement(d.e,{indentWidth:b,count:a}),p.createElement("div",{className:this._classNames.dropIcon,role:"presentation"},p.createElement(y.e,{iconName:"Tag"})),p.createElement("div",{role:"gridcell"},p.createElement("button",Object(f.__assign)({"data-is-focusable":!1,"data-selection-disabled":!0,type:"button",className:this._classNames.expand,onClick:this._onToggleClick,"aria-expanded":!this.state.isCollapsed},C),p.createElement(y.e,{className:this._classNames.expandIsCollapsed,iconName:O||(W?"ChevronLeftMed":"ChevronRightMed")}))),H(this.props),V&&p.createElement(S.e,{label:s}))):null},t.prototype._defaultCheckboxRender=function(e){return p.createElement(v.e,{checked:e.checked})},t.prototype._fastDefaultCheckboxRender=function(e){return p.createElement(x,{theme:e.theme,checked:e.checked})},t.defaultProps={expandButtonProps:{"aria-label":"expand collapse group"}},t}(p.Component),x=p.memo(function(e){return p.createElement(v.e,{theme:e.theme,checked:e.checked,className:e.className,useFastIcons:!0})}),C=Object(a.e)(I,function(e){var t,n,a,f,p,m=e.theme,_=e.className,h=e.selected,b=e.isCollapsed,g=e.compact,v=s.e.cellLeftPadding,y=g?40:48,S=m.semanticColors,D=m.palette,I=m.fonts,x=Object(i.I)(l,m),C=[Object(i.D)(m),{cursor:"default",background:"none",backgroundColor:"transparent",border:"none",padding:0}];return{root:[x.root,Object(i.D)(m),m.fonts.medium,{borderBottom:"1px solid "+S.listBackground,cursor:"default",userSelect:"none",selectors:(t={":hover":{background:S.listItemBackgroundHovered,color:S.actionLinkHovered}},t["&:hover ."+x.check]={opacity:1},t["."+r.e+" &:focus ."+x.check]={opacity:1},t[":global(."+x.group+"."+x.isDropping+")"]={selectors:(n={},n["& > ."+x.root+" ."+x.dropIcon]={transition:"transform "+i.n.durationValue4+" cubic-bezier(0.075, 0.820, 0.165, 1.000) opacity "+i.n.durationValue1+" "+u,transitionDelay:i.n.durationValue3,opacity:1,transform:"rotate(0.2deg) scale(1);"},n["."+x.check]={opacity:0},n)},t)},h&&[x.isSelected,{background:S.listItemBackgroundChecked,selectors:(a={":hover":{background:S.listItemBackgroundCheckedHovered}},a[""+x.check]={opacity:1},a)}],g&&[x.compact,{border:"none"}],_],groupHeaderContainer:[{display:"flex",alignItems:"center",height:y}],headerCount:[{padding:"0px 4px"}],check:[x.check,C,{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:1,marginTop:-1,opacity:0,width:c.e,height:y,selectors:(f={},f["."+r.e+" &:focus"]={opacity:1},f)}],expand:[x.expand,C,{display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",fontSize:I.small.fontSize,width:d.t,height:y,color:h?D.neutralPrimary:D.neutralSecondary,selectors:{":hover":{backgroundColor:h?D.neutralQuaternary:D.neutralLight},":active":{backgroundColor:h?D.neutralTertiaryAlt:D.neutralQuaternaryAlt}}}],expandIsCollapsed:[b?[x.isCollapsed,{transform:"rotate(0deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}]:{transform:Object(o.e)(m)?"rotate(-90deg)":"rotate(90deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}],title:[x.title,{paddingLeft:v,fontSize:g?I.medium.fontSize:I.mediumPlus.fontSize,fontWeight:b?i.r.regular:i.r.semibold,cursor:"pointer",outline:0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}],dropIcon:[x.dropIcon,{position:"absolute",left:-26,fontSize:i.c.large,color:D.neutralSecondary,transition:"transform "+i.n.durationValue2+" cubic-bezier(0.600, -0.280, 0.735, 0.045), opacity "+i.n.durationValue4+" "+u,opacity:0,transform:"rotate(0.2deg) scale(0.65)",transformOrigin:"10px 10px",selectors:(p={},p[":global(."+x.iconTag+")"]={position:"absolute"},p)}]}},void 0,{scope:"GroupHeader"})},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(1),i=n(407);function r(e,t,n){var r=a.useState(t),o=r[0],s=r[1],c=Object(i.e)(void 0!==e),d=c?e:o,l=a.useRef(d),u=a.useRef(n);a.useEffect(function(){l.current=d,u.current=n});var f=Object(i.e)(function(){return function(e,t){var n="function"==typeof e?e(l.current):e;u.current&&u.current(t,n),c||s(n)}});return[d,f]}},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return U}),n.d(t,"e",function(){return le});var a=n(0),i=(n(2139),n(2137),n(1)),r=n(1800),o=n(1801),s=n(1941),c=n(2579),d=n(2578),l=n(2576),u=n(2580),f=n(1644),p=n(1176),m=n(2112),_=n(1782),h=n(2255),b=n(238),g=n(1677),v=n(476),y=n(998),S=n(17);Object(S.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-LinkMember-Persona{width:32px}.od-LinkMember-tooltip{padding:8px}"}]);var D=n(1312),I=n(129),x=n(2452),C=n(1840),O=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onShowCallout=function(){i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{isCalloutVisible:!0}))},i._onDismissCallout=function(){i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{isCalloutVisible:!1}))},i.state={isCalloutVisible:!1},i._uniqueId="j".concat(Math.random().toString().replace(".","")),i}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=this.state;return i.createElement("div",{className:"od-LinkMember"},i.createElement(x.e,{className:"od-LinkMember-Persona",primaryText:e.primaryText,initialsColor:C.e.blue,size:C.n.extraExtraSmall,onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,id:this._uniqueId,imageUrl:e.imageUrl}),t.isCalloutVisible&&i.createElement(D.e,{directionalHint:I.e.topCenter,onDismiss:this._onDismissCallout,target:"#".concat(this._uniqueId," "),setInitialFocus:!0},i.createElement("div",{className:"od-LinkMember-tooltip"},i.createElement("span",null,e.primaryText))))},t}(i.Component),w=n(1804),E=n(1991),A=n(1889),L=n(39),k=n(1802),M=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onCancel=function(){i.setState(function(){return Object(a.__assign)(Object(a.__assign)({},i.state),{showDetailsPanel:!1,showConfirmationDialog:!1,participants:i.state.participants,hasPeopleChange:!1})})},i._onConfirmationDeleteParticipant=function(){k.a()?i.state.confirmationCode===E.e.participant&&(i._onLinkParticipantDelete(),i.setState({showConfirmationDialog:!1,confirmationCode:E.e.none})):i.state.confirmationCode===E.e.participant&&(i.props.removeParticipant(i.state.participant),i.setState({showConfirmationDialog:!1,confirmationCode:E.e.none}))},i.state={participants:i.props.participants,showConfirmationDialog:!1,confirmationCode:E.e.none,hasPeopleChange:!1},i}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this;return i.createElement("ul",{className:"od-ShareLink-participants",key:this.props.showDetailsPanel?"Panel-ul-"+this.props.link.shareId:this.props.link.shareId},this.props.participants.map(function(t){return i.createElement("li",{className:"od-ShareLink-personaItem",key:e.props.showDetailsPanel?"Panel-li-"+t.email:t.email},i.createElement(x.e,{imageUrl:t.image,primaryText:t.name,secondaryText:t.isExternal?o.Yt:t.job,size:C.n.size32,showSecondaryText:!(!t.job&&!t.isExternal)}),e.props.link.sharingLinkKind===d.e.flexible&&!e.props.link.isAddressBarLink&&i.createElement(f.e,{"data-is-focusable":!0,ariaLabel:L.format(o.io,t.name),className:"od-ShareLink-actionButton",iconProps:{iconName:"Cancel"},onClick:function(){e.context.sharingStore.getEngagementHelper().onLinkParticipantOpenDelete(e.props.engagementExtraData),e.setState({showConfirmationDialog:!0,confirmationCode:E.e.participant,participant:t})}}))}),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,a=t.participants,r=t.participant;return i.createElement(A.ConfirmationDialog,{confirmationCode:n,participants:a,participant:r,onApply:this._onConfirmationDeleteParticipant,onCancel:this.state.confirmationCode===E.e.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:E.e.none})}})},t.prototype._onLinkParticipantDelete=function(){var e=this.state.participant,t=[];this.context.sharingStore.getEngagementHelper().onLinkParticipantDelete(this.props.engagementExtraData),this.props.showDetailsPanel?(t=!0!==e.isExternal&&e.principalName?this.props.participants.filter(function(t){return t.principalName!==e.principalName}):this.props.participants.filter(function(t){return t.email!==e.email}),this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{participants:t,hasPeopleChange:!0})),this.props.onRemoveParticipant(e,t)):this.props.updateLinkSettings(e)},t.contextTypes={sharingStore:r.object.isRequired},t}(i.Component),P=n(2629),T=n(2252);Object(S.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDetails--div{top:0;left:0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";width:100%;height:100%;padding:0 20px;box-sizing:border-box;overflow-y:auto}.od-ShareLinkDetails--div .od-ShareLinkDetails--header{height:2.5rem;display:flex;align-items:center;flex-shrink:0;font-size:.875rem;margin:10px -20px 0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";position:relative}[dir=ltr] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-left:20px}[dir=rtl] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLinkDetails--div .od-ShareLinkDetails--changeSettings{padding:22px 0 12px;margin-bottom:50px}.od-ShareLinkDetails--div .od-ShareLinkDetails--footer{position:absolute;width:100%;right:0;bottom:0;left:0}.od-ShareLinkDetails--absolute{position:absolute}.od-ShareLinkDetails--settingIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:1.125rem}[dir=ltr] .od-ShareLinkDetails--settingIcon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--settingIcon{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--settingIcon{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--settingIcon{padding-left:12px}.od-ShareLinkDetails--setting{margin-bottom:12px;display:block;align-items:center}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-bottom:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-left:0}[dir=rtl] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-right:0}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-caretDownWrapper{display:none}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-right:8px}.od-ShareLinkDetails--setting .od-RoleSelector-wrapper{display:flex}.od-ShareLinkDetails--setting .od-RoleSelector-rolesDropdown{width:100%}[dir=ltr] .od-ShareLinkDetails--setting .od-RoleSelector-rolesDropdown{margin-left:13px}[dir=rtl] .od-ShareLinkDetails--setting .od-RoleSelector-rolesDropdown{margin-right:13px}.od-ShareLinkDetails--setting .od-canUploadIcon{margin-top:9px}[dir=ltr] .od-ShareLinkDetails--setting .od-canUploadIcon{margin-left:2px}[dir=rtl] .od-ShareLinkDetails--setting .od-canUploadIcon{margin-right:2px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker{width:100%}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{display:flex}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-left:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-right:0}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-left:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-right:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{font-size:1.125rem}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:12px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-right:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-left:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-left:37px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-right:37px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-RequireVerificationToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:1.125rem}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-left:12px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PreventDownloadToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:1.125rem}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:12px}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordFieldWrapper{width:100%}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField{width:100%;align-items:center}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-shareLinkDetails--passwordFieldMainContent{display:flex}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLink-passwordFieldContent{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField{display:flex;width:100%;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField{width:100%;margin:0;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField-field{width:100%;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:1.125rem}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:12px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-right:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-left:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-Toggle-label{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:.75rem;line-height:0}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-left:auto}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-right:auto}.od-ShareLinkDetails--passwordCreatedByLabel{font-size:.75rem;font-style:italic;margin-top:-5px;padding:0}[dir=ltr] .od-ShareLinkDetails--passwordCreatedByLabel{margin-left:37px}[dir=rtl] .od-ShareLinkDetails--passwordCreatedByLabel{margin-right:37px}.od-ShareLinkDetails--sectionHeader{position:relative;padding:12px 20px;margin:10px -20px 0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";font-size:.875rem}.od-ShareLinkDetails--sectionHeader .ms-Button:not(:hover){background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.od-ShareLinkDetails--sectionHeader .ms-Button:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareLinkDetails--sectionHeaderV2{position:relative;padding:12px 20px;margin:10px -20px 0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.875rem;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";font-weight:600}.od-ShareLink--detailsPanel{top:50px}.od-ShareLink--detailsPanel .od-ShareLinkDetails--header{height:2.5rem;display:flex;align-items:center;flex-shrink:0;font-size:.875rem}[dir=ltr] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-left:10px}[dir=rtl] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-right:10px}.od-ShareLink--detailsPanel .ms-Panel-content{padding:0}.od-ShareLink--detailsPanel .ms-Panel-content .od-ShareLinkDetails--content{max-height:100%;overflow-y:auto;overflow-x:hidden;padding:0 20px 0}.od-ShareLink--detailsPanel .ms-Panel-content .od-Share-PeoplePicker-wrapper{padding-top:20px}.od-ShareLinkDetails--content.manageAccessV3{max-height:520px}.od-ShareLinkDetails--actions{display:flex;align-items:center;justify-content:flex-end;flex-shrink:0;margin-top:auto;height:3.5rem;margin:10px -20px 0}[dir=ltr] .od-ShareLinkDetails--actions{padding-right:35px}[dir=rtl] .od-ShareLinkDetails--actions{padding-left:35px}.od-ShareLinkDetails--actions.manageAccessV3{position:absolute;bottom:10px}[dir=ltr] .od-ShareLinkDetails--actions.manageAccessV3{right:20px}[dir=rtl] .od-ShareLinkDetails--actions.manageAccessV3{left:20px}.od-ShareLinkDetails--actions.shadeBackground{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:'}.od-ShareLinkDetails--actions button.ms-Button{font-size:.875rem;height:2rem;border-width:.0625rem}.od-ShareLinkDetails--actions .ms-Button--default{outline:transparent;position:relative}.od-ShareLinkDetails--actions .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLinkDetails--actions .ms-Button--default:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}[dir=ltr] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-left:10px}[dir=rtl] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-right:10px}.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button--primary::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast:active){.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button:focus::after{left:-2px;right:-2px;top:-2px;bottom:-2px}}.od-ShareLinkDetails--noParticipants{font-size:.75rem;padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";min-height:50px}.od-ShareLinkDetails-addressBarChoiceGroup{padding-top:10px}.od-ShareLinkDetails-addressBarChoiceGroupLabel{font-weight:600;font-size:.75rem}.od-ShareLinkDetails--sectionHeader-share button.ms-Button-flexContainer{font-size:.875rem}.od-ShareLinkDetails-Label{padding-left:8px}"}]);var U,F=n(2690),H=n(1990),R=n(1954),N=n(1839),B=n(2304),j=n(2343),V=n(2146),z=n(2138),G=n(1642),K=n(2156),W=n(2149),q=n(2155),Q=n(342),Y=n(1806),J=n(1834),X=n(2157),Z=n(1817),$=n(1829),ee=n(21),te=function(e){function t(t,n){var i=e.call(this,t)||this;i._onPeoplePickerChange=function(e){if(k.a()){var t,n=N.o({selectedItems:i.state.participants,sharingLinkKind:i._link.sharingLinkKind,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation,permissionsMap:i._store.getPermissionsMap()}),a=e[0];t=!0===a.isExternal?i.state.participants.filter(function(e){return e.email===a.email}):i.state.participants.filter(function(e){return e.userId===a.userId}),i.setState({participants:0===t.length?i.state.participants.concat(e):i.state.participants,hasPeopleChange:0===t.length,peoplePickerError:n}),i.props.onPeoplePickerChange(t,e)}else n=N.o({selectedItems:i.props.participants,sharingLinkKind:i._link.sharingLinkKind,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation,permissionsMap:i._store.getPermissionsMap()}),i.props.addParticipant(e[0]),i.setState({peoplePickerError:n})},i._onRemoveParticipant=function(e,t){i.setState({participants:t,participantRemovedText:L.format(o.ro,e.name),hasPeopleChange:!0}),i.props.updateLinkSettings(e)},i._onRoleChange=function(e){var t=i.state.selectedPermissions,n=Object(w.v)(t.audience,Object(w.P)(e));i.setState({hasSettingsChange:!0,selectedPermissions:k.a()?i.state.selectedPermissions:Object(a.__assign)(Object(a.__assign)({},t),{sharingRole:e,isEdit:Object(w.P)(e),sharingLinkKind:n})}),i.props.onRoleChange(e)},i._onAudienceChange=function(e){var t=e===c.e.organization;i.setState(function(){return Object(a.__assign)(Object(a.__assign)({},i.state),{isAddressBarLinkEnabled:t,hasSettingsChange:e!==i._selectedAudience,currentAudience:e,confirmationCode:E.e.addressBarLinkOff})},function(){i.props.onOptionChange(e!==i._selectedAudience)})},i._onPasswordChange=function(e){i.setState(function(){return Object(a.__assign)(Object(a.__assign)({},i.state),{hasSettingsChange:e.length>0})}),i.props.onPasswordChange(e)},i._onConfirmationSave=function(){i.props.addressBarLinkDetails?(i.state.confirmationCode===E.e.addressBarLinkOff?(i._store.setAddressBarLinkCapability(!1),i._link&&i._store.unshareLink(i._link.sharingLinkKind,i._link.shareId)):i._store.setAddressBarLinkCapability(!0),i.setState(function(){return Object(a.__assign)(Object(a.__assign)({},i.state),{isAddressBarLinkEnabled:!1,showConfirmationDialog:!1,hasSettingsChange:!1,confirmationCode:E.e.none})})):(k.a()?i.props.updateLinkSettings(null):i.props.applyParticipants(),i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{showConfirmationDialog:!1,confirmationCode:E.e.none,hasSettingsChange:!1,hasPeopleChange:!1})))},i._onCancel=function(){i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{showConfirmationDialog:!1,confirmationCode:E.e.none})),k.a()&&i.props.onCancel()},i._onSave=function(){if(k.a())if(i.state.hasSettingsChange){var e=i.props.addressBarLinkDetails&&i.state.currentAudience===c.e.existing?E.e.addressBarLinkOff:E.e.linkSettings;i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{confirmationCode:e,showConfirmationDialog:!0}))}else i.state.hasPeopleChange&&(i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{hasPeopleChange:!1}),i.props.showPermissionsList),i.props.updateLinkSettings(null));else i.state.hasSettingsChange?(e=i.props.addressBarLinkDetails&&i.state.currentAudience===c.e.existing?E.e.addressBarLinkOff:E.e.linkSettings,i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{confirmationCode:e,showConfirmationDialog:!0}))):i.props.applyParticipants()},i._onBack=function(){k.a()?i.state.hasPeopleChange||i.state.hasSettingsChange?i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{showConfirmationDialog:!0,confirmationCode:E.e.back})):i.props.onCancel():i.props.hasPeopleChange||i.props.hasSettingsChange?i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{showConfirmationDialog:!0,confirmationCode:E.e.back})):i.props.onCancel()},i._onSelectDate=function(e){var t=i.props.sharingInformation.anonymousLinkExpirationRestrictionDays;i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{expirationErrorCode:Object(w._)(e,t)}),function(){i._updateExpirationErrorCode(Object(w._)(e,t))}),i._onExpirationChange(e)},i._store=n.sharingStore,i._link=i.props.link;var r=i.props.sharingInformation.sharingAbilities;return i._canManageAddressBarLink=Object(w.i)(r),i._odcHideNonPremiumLinkFeatures=k.z()&&i._store.isConsumer()&&!i._store.isPremiumExperienceAllowed(),i._useUpdatedLinkDetails=k.R()||$.n(),i._isNewManageAccess=k.R()||1===$.n()&&k.H(),i.state={expirationErrorCode:w.e.none,hasSettingsChange:i.props.hasSettingsChange||!1,hasPeopleChange:!1,showConfirmationDialog:!1,confirmationCode:E.e.none,participants:i.props.participants,participantRemovedText:"",selectedPermissions:i.props.selectedPermissions,currentAudience:i._getCurrentAudience(),peoplePickerError:N.o({selectedItems:Object(a.__assign)({},i.props.participants),sharingLinkKind:d.e.direct,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation})},i._audienceOptions=i._getAudienceOptions(),i}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;k.a()||this._store.addListener(function(){e.setState(function(){var t=e._store.getSharingInformation().sharingLinks.filter(function(t){return t.shareId===e._link.shareId});if(t&&t.length>0)return e._link=t[0],{link:e._link,participants:e._link.sharingLinkKind===d.e.flexible||e._link.isPartialRedeem?Object(w.S)(e._link):[],selectedPermissions:e._getLinkSettings(e._link)}})})},t.prototype._getLinkSettings=function(e){return{allowEditing:!0,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,isManageList:e.isManageList,isCreateOnlyLink:e.isCreateOnlyLink,sharingLinkKind:e.sharingLinkKind,specificPeople:Object(w.S)(e),updatePassword:e.updatePassword,password:e.password,sharingRole:this._getSharingRoleFromLink(),preventDownload:e.blockDownload,hasPassword:e.hasPassword,description:e.description,trackLinkUsers:e.trackLinkUsers}},t.prototype._getSharingRoleFromLink=function(){return this._link.isManageList?l.e.manageList:this._link.isEdit?Object(w.f)(this.props.clientId,this.props.sharingInformation):this._link.isReview?l.e.review:l.e.view},t.prototype.render=function(){var e=!this.props.inlineInDialog&&Y.o(this.props.clientId)?" od-ShareLinkDetails--absolute":"";return i.createElement("div",{className:"od-ShareLinkDetails--div"+e},this._renderDetailsPanelHeader(),this._renderDetailsPanelContent(),this._renderDetailsPanelActions())},t.prototype._renderDetailsPanelContent=function(){var e=J.a(this.props.link.audience,this.props.sharingInformation.sharingAbilities),t=!k.b||!this.props.link.isCreateOnlyLink||e.canManageSubmitOnlyLink.enabled;return this.props.addressBarLinkDetails?this._renderAddressBarLinkDetails():i.createElement("div",{className:"od-ShareLinkDetails--content ".concat(this._isNewManageAccess?"manageAccessV3":"")},this._renderShareLink(),this._useUpdatedLinkDetails?i.createElement("div",{role:"heading","aria-level":2,className:"od-ShareLinkDetails--sectionHeaderV2","data-is-focusable":!0,"aria-label":o.ea},o.ea):i.createElement("div",{role:"heading","aria-level":2,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.Zn},o.Zn),i.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":o.Zn},this.props.link.isCreateOnlyLink?this._renderRequestFileEntry():this._renderChangePermission(),this._renderOfficeReviewModeToggle(),this._renderExpirationDatePicker(t),this.props.sharingInformation.anyoneLinkTrackUsers&&this._renderRequireVerificationToggle(),this._renderPasswordField(),this._renderPreventDownloadToggle()),this.props.selectedPermissions.audience!==c.e.specificPeopleFlex&&this.state.participants.length>0&&i.createElement("div",{role:"heading","aria-level":2,className:this._useUpdatedLinkDetails?"od-ShareLinkDetails--sectionHeaderV2":"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.Sa},o.Sa),this.props.selectedPermissions.audience===c.e.specificPeopleFlex&&i.createElement("div",{role:"heading","aria-level":2,className:this._useUpdatedLinkDetails?"od-ShareLinkDetails--sectionHeaderV2":"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.rn},o.rn),this._renderPeoplePicker(),this._renderParticipantsList(),Z.e(this.state.participantRemovedText,"assertive","alert"),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype._renderRequireVerificationToggle=function(){var e=this.state.selectedPermissions.trackLinkUsers,t=k.se()&&Y.n(this.props.clientId);return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--requireVerification"},i.createElement("div",{className:"od-RequireVerificationToggle"},i.createElement("div",{className:"od-ShareLinkDetails-setting--RequireVerification-Icon"},i.createElement(v.e,Object(a.__assign)({iconName:"ReminderPerson"},{alt:o.gn}))),i.createElement(j.e,{"aria-disabled":!0,role:"checkbox",checked:e,disabled:!0,label:t?o.mo:o.ho}))))},t.prototype._renderAddressBarLinkDetails=function(){return i.createElement("div",{className:"od-ShareLinkDetails--content"},i.createElement("span",{className:"od-ShareLinkDetails-addressBarChoiceGroupLabel"},o.Ae),i.createElement("div",{className:"od-ShareLinkDetails-addressBarChoiceGroup"},i.createElement(q.e,{items:this._audienceOptions,onAudienceChange:this._onAudienceChange,companyName:this.props.companyName,clientId:this.props.clientId,engagementExtraData:this.props.engagementExtraData})),this._useUpdatedLinkDetails?i.createElement("div",{role:"heading","aria-level":2,className:"od-ShareLinkDetails--sectionHeaderV2","data-is-focusable":!0,"aria-label":o.ea},o.ea):i.createElement("div",{role:"heading","aria-level":2,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.Zn},o.Zn),i.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":o.Zn},this._renderChangePermission()),this.state.participants.length>0&&i.createElement("div",{role:"heading","aria-level":2,className:this._useUpdatedLinkDetails?"od-ShareLinkDetails--sectionHeaderV2":"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":o.Sa},o.Sa),this._link&&this._renderParticipantsList(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype._renderShareLink=function(){return i.createElement(le,{index:0,link:this._link,companyName:this.props.companyName,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this.props.enableLinkSettings,showMoreOptions:!1,showPermissionsList:this.props.showPermissionsList,onRemoveLink:this.props.onRemoveLink,engagementExtraData:this.props.engagementExtraData})},t.prototype._renderDetailsPanelHeader=function(){return i.createElement("div",{className:"od-ShareLinkDetails--header"},Z.t(i.createElement(f.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton back",iconProps:{iconName:"Back"},onClick:this._onBack,ariaLabel:o.ie}),o.ie,{position:I.e.bottomLeftEdge}),i.createElement("span",{className:"od-ShareLinkDetails-Label",role:"heading","aria-level":1,"data-is-focusable":!0},o.Kn),Y._(this.props.clientId)&&Z.t(i.createElement(f.e,{id:"od-ShareLink-CancelButton","data-is-focusable":!0,className:"od-ShareLink-actionButton cancel",iconProps:{iconName:"Cancel"},onClick:this.context.onDismiss,ariaLabel:o.Le}),o.Le,{position:I.e.bottomLeftEdge,targetElementId:"od-ShareLink-CancelButton"}))},t.prototype._renderDetailsPanelActions=function(){var e=!(this.state.hasPeopleChange||this.state.hasSettingsChange)||this.state.expirationErrorCode!==w.e.none;k.a()||(e=!(this.props.hasPeopleChange||this.props.hasSettingsChange)||this.state.expirationErrorCode!==w.e.none);var t="od-ShareLinkDetails--actions "+(this._isNewManageAccess?"manageAccessV3 ":"")+(this._useUpdatedLinkDetails?"":"shadeBackground"),n=Object(ee.L)();return i.createElement("div",{className:t},i.createElement(G.e,{id:"od-ShareLinkDetails-save",onClick:this._onSave,disabled:e,styles:{labelDisabled:n.semanticColors.primaryButtonTextDisabled}},k.ee()?o.vo:o.z),i.createElement(p.e,{onClick:this.props.showPermissionsList,disabled:e},o.De))},t.prototype._renderParticipantsList=function(){var e=k.a()?this.state.participants:this.props.participants;return e.length>0?i.createElement(M,{link:this._link,showDetailsPanel:!0,participants:e,removeParticipant:this.props.removeParticipant,updateLinkSettings:this.props.updateLinkSettings,onRemoveParticipant:this._onRemoveParticipant,engagementExtraData:this.props.engagementExtraData}):this._link.audience===c.e.specificPeopleFlex?i.createElement("div",{className:"od-ShareLinkDetails--noParticipants"},o._a):void 0},t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state,n=N.n(t.participants),a=N.a(t.participants,this.props.groupsMemberCount);if(this.props.selectedPermissions.audience===c.e.specificPeopleFlex)return i.createElement(R.e,{defaultSelectedItems:[],onChange:this._onPeoplePickerChange,oversharingExternalsWarning:n,oversharingGroupsWarning:a,pickerSettings:e.sharingInformation.peoplePickerSettings,error:t.peoplePickerError,sharingInformation:e.sharingInformation,sharingLinkKind:e.link.sharingLinkKind,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),inputTextPlaceholder:o.Ki,onResolvedSuggestions:null})},t.prototype._renderChangePermission=function(){var e=this.props,t=e.selectedPermissions.audience,n=t==c.e.organization||t==c.e.anyone||t===c.e.existing,a=e.getLinkSettings();return k.D()&&(a=this.props.selectedPermissions),k.a()||(a=this.state.selectedPermissions),i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},i.createElement(z.e,{clientId:e.clientId,mode:e.mode,selectedPermissions:a,onRoleChange:this._onRoleChange,canChangePermission:n,sharingInformation:this.props.sharingInformation})))},t.prototype._renderRequestFileEntry=function(){var e=[{key:o.be,text:o.be,data:o.be,ariaLabel:o.be}];return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},i.createElement("div",{className:"od-RoleSelector-wrapper"},Z.t(i.createElement(v.e,{className:"od-RoleSelector-settingIcon od-canUploadIcon",iconName:"Upload"}),o.be),i.createElement(B.e,{className:"od-RoleSelector-rolesDropdown",disabled:!0,label:"",defaultSelectedKey:o.be,calloutProps:{className:"od-RoleSelector-rolesDropdownOptionsCallout"},responsiveMode:Q.e.large,ariaLabel:o.be,options:e}),this.props.children)))},t.prototype._getCurrentAudience=function(){var e=this.props.addressBarLinkSettings;return e&&e.linkDisabled||!this._canManageAddressBarLink?c.e.existing:c.e.organization},t.prototype._getAudienceOptions=function(){var e=[],t={icon:H.e[F.e.workGroup],isChecked:!1,isDisabled:!1,key:c.e.existing,label:o.nr,linkKinds:[d.e.direct],permissionsType:F.e.existing},n={disabledText:o.yt,icon:H.e[F.e.workGroup],isChecked:!1,isDisabled:!this._canManageAddressBarLink,key:c.e.organization,label:L.format(o.$i,this.props.companyName),linkKinds:[d.e.organizationView,d.e.organizationEdit],permissionsType:F.e.workGroup};return this._canManageAddressBarLink&&this.state.currentAudience!==c.e.existing?(n.isChecked=!0,t.isChecked=!1,this._selectedAudience=c.e.organization):(n.isChecked=!1,t.isChecked=!0,this._selectedAudience=c.e.existing),e.push(n,t),e},t.prototype._renderExpirationDatePicker=function(e){var t=this.state.selectedPermissions;if(e&&t.audience===c.e.anyone&&!this._odcHideNonPremiumLinkFeatures||!e)return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--datePicker",style:e?{}:{pointerEvents:"none"}},i.createElement(V.e,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:this.props.sharingInformation.anonymousLinkExpirationRestrictionDays,disabled:!e})),this._renderExpirationDatePickerErrorMessage())},t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode,t=Object(w.m)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);if(""!==t)return i.createElement("span",{className:"od-ShareLinkDetails--expirationError",role:"alert","aria-live":"assertive"},t)},t.prototype._renderPasswordField=function(){if(this.state.selectedPermissions.hasPassword){var e="",t=this._link.passwordLastModifiedBy;return t&&(e=t.primaryText?t.primaryText:t.email?t.email:""),i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLink-detailsPanel-passwordFieldWrapper"},i.createElement("div",{className:"od-ShareLink-detailsPanel-passwordField"},i.createElement(W.e,{onPasswordChange:this._onPasswordChange,detailsPane:!0,lastModifiedBy:e,engagementExtraData:this.props.engagementExtraData}))))}},t.prototype._renderPreventDownloadToggle=function(){var e=this.state.selectedPermissions.preventDownload;if(e)return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--preventDownloadToggle"},i.createElement(K.e,{isToggled:e,disablePreventDownload:!0,detailsPane:!0,clientId:this.props.clientId,mode:this.props.mode})))},t.prototype._renderOfficeReviewModeToggle=function(){var e=this.props,t=e.selectedPermissions.audience;if(J.c(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)){var n=e.selectedPermissions.isReview||e.selectedPermissions.sharingRole===l.e.review;return i.createElement("li",{className:"od-ShareLinkDetails--setting"},i.createElement("div",{className:"od-ShareLinkDetails--officeReviewModeToggle"},i.createElement(X.e,{isToggled:n,disableOfficeReviewMode:!0,detailsPane:!0,clientId:this.props.clientId,mode:this.props.mode})))}},t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,a=t.participants,r=t.participant;return i.createElement(A.ConfirmationDialog,{confirmationCode:n,participants:a,participant:r,companyName:this.props.companyName,clientId:this.props.clientId,onApply:this._onConfirmationSave,onCancel:this.state.confirmationCode===E.e.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:E.e.none})},onDiscard:this.props.showPermissionsList})},t.prototype._onExpirationChange=function(e){var t=this;this.setState(function(){return Object(a.__assign)(Object(a.__assign)({},t.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},t.state.selectedPermissions),{expiration:e}),hasSettingsChange:e!==t.state.selectedPermissions.expiration||t.state.hasSettingsChange})}),this.props.onExpirationChange(e)},t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{expirationErrorCode:e}))},t.contextTypes={sharingStore:r.object.isRequired,onDismiss:r.func},t}(i.Component),ne=n(1807),ae=n(1673),ie=n(1750),re=n(814),oe=n(321),se=n(112),ce="requestAccessInfo-icon",de="requestAccessInfo-calloutContent";!function(e){e[e.legacy=0]="legacy",e[e.standard=1]="standard",e[e.compact=2]="compact"}(U||(U={}));var le=function(e){function t(t,n){var i,r=this;return(r=e.call(this,t)||this)._addParticipant=function(e){if(0===r.state.participants.filter(function(t){return t.email===e.email}).length){var t=Object(a.__spreadArray)(Object(a.__spreadArray)([],r.state.participants,!0),[e],!1);r.setState({participants:t,hasPeopleChange:r._checkHasPeopleChange(r._originalParticipants,t)})}},r._removeParticipant=function(e){var t=r.state.participants.filter(function(t){return t.email!==e.email}),n=Object(a.__spreadArray)([],t,!0);r.setState({participants:n,hasPeopleChange:r._checkHasPeopleChange(r._originalParticipants,n)})},r._checkHasPeopleChange=function(e,t){if(t.length!==e.length)return!0;for(var n=function(e){if(0===t.filter(function(t){return t.email===e.email}).length)return{value:!0}},a=0,i=e;a<i.length;a++){var r=n(i[a]);if("object"==typeof r)return r.value}return!1},r._removeOneParticipant=function(e){var t=r.state.participants.filter(function(t){return t.email!==e.email});r._store.shareLink({settings:r.state.selectedPermissions,recipients:[],copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:r._link.shareId,inviteesToRemove:[Object(w.o)(e)]}),r._originalParticipants=t},r._applyParticipants=function(){for(var e=r.state.participants.filter(function(e){return 0===r._originalParticipants.filter(function(t){return e.email===t.email}).length}),t=r._originalParticipants.filter(function(e){var t=r.state.participants.filter(function(t){return t.email===e.email});return 0===t.length}),n=[],a=0,i=t;a<i.length;a++){var o=i[a];n.push(Object(w.o)(o))}(0!==e.length||0!==n.length||r.state.hasSettingsChange)&&(r._originalParticipants=r.state.participants,r._store.shareLink({settings:r.state.selectedPermissions,recipients:e,copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:r._link.shareId,inviteesToRemove:n}),r.setState({hasPeopleChange:!1,hasSettingsChange:!1,addressBarDetailsView:!1},r._showPermissionsList))},r._onOptionChange=function(e){r.setState(function(){return Object(a.__assign)(Object(a.__assign)({},r.state),{hasSettingsChange:!!k.X()||e})}),r._engagementHelper.manageAccessAddressBarLinkTypeClicked(r.props.engagementExtraData)},r._onChevronClick=function(){r._linkInviteesExpanded=!r._linkInviteesExpanded,r._engagementHelper.manageAccessLinkInviteesToggled(r._linkInviteesExpanded,r.props.engagementExtraData),r.setState({linkMemberExpanded:!r.state.linkMemberExpanded})},r._onCancel=function(){r.setState(function(){return Object(a.__assign)(Object(a.__assign)({},r.state),{showConfirmationDialog:!1,participants:r._link?Object(w.S)(r._link):[],expirationErrorCode:w.e.none,selectedPermissions:r._getLinkSettings(),hasSettingsChange:!1,hasPeopleChange:!1})}),!k.a()||r.state.hasSettingsChange||r.state.hasPeopleChange,r._showPermissionsList()},r._showPermissionsList=function(){k.a()&&r.setState(function(){return Object(a.__assign)(Object(a.__assign)({},r.state),{hasSettingsChange:!1,hasPeopleChange:!1,addressBarDetailsView:!1})});var e=r.props.showPermissionsList;e&&e()},r._onConfirmationDeleteLink=function(){var e=r.state.confirmationCode;e!==E.e.link&&e!==E.e.linkInheritance&&e!==E.e.linkBundle||(r._onShareLinkDelete(),r.setState({showConfirmationDialog:!1,confirmationCode:E.e.none,hasSettingsChange:!1,linkDetailsView:!1})),r._showPermissionsList()},r._showLinkDetails=function(){r._engagementHelper.manageAccessLinkDetailsClicked(r.props.engagementExtraData);var e=r.props.onShowLinkDetailsClicked;e&&e(r._link)},r._onShareLinkDelete=function(){r._engagementHelper.onShareLinkDelete(r.props.engagementExtraData);var e=r._link;r.props.onRemoveLink&&r.props.onRemoveLink(),r._store.unshareLink(e.sharingLinkKind,e.shareId)},r._onLinkClicked=function(e){try{var t=e.target;t.focus(),t.setSelectionRange(0,t.value.length)}catch(e){}},r._copySharingLinkToClipboard=function(){var e=r.props,t=e.clientId,n=e.sharingInformation,a=r._link.url,i=r._textField;Object(w.s)(t,i,a,n.item.name).then(function(e){r.setState({copyLinkToClipboardSuccess:e,copyLinkAlert:o.xa}),r._copyButton.focus(),e&&(r._engagementHelper.manageAccessLinkCopyButtonClicked(r.props.engagementExtraData),r._engagementHelper.shareCompleted(r.props.engagementExtraData),setTimeout(function(){r.setState({copyLinkToClipboardSuccess:!1,copyLinkAlert:""})},2e3))})},r._updateLinkSettings=function(e){var t,n,a=[],i=[],s=r.state.participants;if(e){for(var d=0,l=s;d<l.length;d++)if((b=l[d]).principalName&&b.principalName===e.principalName||(null===(t=null==e?void 0:e.email)||void 0===t?void 0:t.length)>0&&(null===(n=null==b?void 0:b.email)||void 0===n?void 0:n.length)>0&&b.email===e.email){a.push(Object(w.o)(b)),r.setState({participantRemovedText:L.format(o.ro,b.name)}),r._chevronButton&&r._chevronButton.focus();break}}else{for(var u=function(e){var t;t=!0===e.isExternal?s.filter(function(t){return t.email===e.email}):s.filter(function(t){return t.userId===e.loginName}),0===t.length&&a.push(e)},f=0,p=r._link.invitees;f<p.length;f++)u(p[f]);for(var m=function(e){if(!0===e.isExternal&&r.state.selectedPermissions.audience===c.e.organization)return"continue";0===(!0===e.isExternal?r._link.invitees.filter(function(t){return t.email===e.email}):r._link.invitees.filter(function(t){return t.loginName===e.userId})).length&&!0===e.isResolved&&i.push(e)},_=0,h=s;_<h.length;_++){var b;m(b=h[_])}}(a.length>0||i.length>0||r.state.hasSettingsChange)&&r._store.shareLink({settings:r.state.selectedPermissions,recipients:i,copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:r._link.shareId,inviteesToRemove:a})},r._onPeoplePickerChange=function(e,t){r.setState(Object(a.__assign)(Object(a.__assign)({},r.state),{selectedPermissions:r.state.selectedPermissions,participants:0===e.length?r.state.participants.concat(t):r.state.participants,hasPeopleChange:0===e.length}))},r._onRoleChange=function(e){var t=r.state.selectedPermissions,n=Object(w.v)(t.audience,Object(w.P)(e));r.setState(Object(a.__assign)(Object(a.__assign)({},r.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},t),{sharingRole:e,isEdit:Object(w.P)(e),sharingLinkKind:n}),hasSettingsChange:!k.a()||e!==r._getSharingRole()||r.state.hasSettingsChange}))},r._onExpirationChange=function(e){e||r._link.expiration||(e=Object(w.u)(r.props.sharingInformation.anonymousLinkExpirationRestrictionDays)),r.setState(function(){return Object(a.__assign)(Object(a.__assign)({},r.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},r.state.selectedPermissions),{expiration:e,shareId:r._link.shareId}),hasSettingsChange:e!==r.state.selectedPermissions.expiration||r.state.hasSettingsChange})})},r._onPasswordChange=function(e){r.setState(function(){return Object(a.__assign)(Object(a.__assign)({},r.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},r.state.selectedPermissions),{password:e,updatePassword:e.length>0,shareId:r._link.shareId}),hasSettingsChange:!0})})},r._getLinkSettings=function(){return r._link?{allowEditing:!0,audience:r._link.audience,expiration:r._link.expiration,isEdit:r._link.isEdit,isReview:r._link.isReview,isManageList:r._link.isManageList,isCreateOnlyLink:r._link.isCreateOnlyLink,sharingLinkKind:r._link.sharingLinkKind,specificPeople:Object(w.S)(r._link),updatePassword:r._link.updatePassword,password:r._link.password,sharingRole:r._getSharingRoleFromLink(),preventDownload:r._link.blockDownload,hasPassword:r._link.hasPassword,description:r._link.description,trackLinkUsers:r._link.trackLinkUsers}:r.props.isAddressBarLink?{allowEditing:!0,audience:r.props.addressBarLinkSettings.linkDisabled?c.e.existing:c.e.organization,expiration:null,isEdit:r.props.addressBarLinkSettings.linkPermission===l.e.edit,sharingLinkKind:d.e.flexible,specificPeople:r._link?Object(w.S)(r._link):[],updatePassword:!1,password:""}:void 0},r._store=n.sharingStore,r._resize=n.resize,r._link=r.props.link,r._engagementHelper=r._store.getEngagementHelper(),r._linkInviteesExpanded=!1,r._isConsumer=r._store.isConsumer(),r._originalParticipants=r._link?Object(w.S)(r._link):[],r.state={linkRemovedText:"",copyLinkToClipboardSuccess:!1,copyLinkAlert:"",link:r._link,allowPasswordChange:!1,linkMemberExpanded:!1,hasSettingsChange:!1,hasPeopleChange:!1,participants:r._link?Object(w.S)(r._link):[],showConfirmationDialog:!1,confirmationCode:E.e.none,selectedPermissions:r._getLinkSettings(),expirationErrorCode:w.e.none,linkDetailsView:r.props.linkDetailsView,addressBarDetailsView:!1,participantRemovedText:"",isRATCalloutVisible:!1,isRATCalloutFocused:!1},(k.R()||$.n())&&(r._useUpdatedIcons=!0,r._hideInvalidExpirationIcons=!0),r._isInherited=!!(null===(i=r._link.inheritedLinkInfo)||void 0===i?void 0:i.path),r._isBundle=!!r._link.inheritedLinkInfo&&!r._isInherited,r}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this;if(this.props.enableLinkSettings&&(this.state.linkDetailsView||this.props.isAddressBarLink))return this._renderLinkDetails();var t=this._useUpdatedIcons?"Delete":"Cancel",n=this.props.link,a=n.url,r=Object(w.b)(this.props.link),s=Object(w.y)(this.props.link,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension,this.props.isAccessSummaryLink),d=n.principals&&n.principals.length>0||n.invitees&&n.invitees.length>0,l="od-ShareLink flightOff ",u="";switch(this.props.spacing){case U.compact:u="compact";break;case U.standard:u="updatedSpacing";break;case U.legacy:default:u=""}l+=u;var p=void 0!==this.props.spacing?"od-ShareLink-container "+u:"",_="od-ShareLink--inviteesHolder "+(this.props.spacing>0?"no-separator":""),h=this._link.audience===c.e.specificPeopleFlex||this._link.isPartialRedeem;return this.props.enableLinkSettings?i.createElement("div",{className:p},this.props.showLinkHeader&&this._renderShareLinkHeader(),this._renderShareLink(),Z.e(this.state.copyLinkAlert,"assertive","alert",!0),!n.isUnhealthy&&this.props.showMoreOptions&&d&&i.createElement("div",{"aria-label":o.Mn,className:_,"data-is-focusable":!h,"aria-expanded":h?void 0:this.state.linkMemberExpanded},i.createElement("div",{className:"od-ShareLink--inviteesHolder-header",onClick:this._onChevronClick.bind(this)},!this.state.linkMemberExpanded&&(this._link.audience===c.e.specificPeopleFlex||this._link.isPartialRedeem)&&this._renderLinkMembersForEditPanel(),!!this.state.linkMemberExpanded&&i.createElement("div",{className:"od-ShareLink--inviteesHolder-headerExpanded"},this._link.isPartialRedeem?o.si:o.Cn),h&&this._renderChevron()),this.state.linkMemberExpanded&&this._renderParticipantsList(),Z.e(this.state.participantRemovedText,"assertive","alert",!0)),this.state.showConfirmationDialog&&this._renderConfirmationDialogDeleteLink()):i.createElement("div",null,i.createElement("div",{className:l},i.createElement("div",{className:"od-ShareLink-main"},i.createElement("div",{className:"od-ShareLink-icon"},i.createElement(v.e,{iconName:r})),i.createElement("div",{className:"od-ShareLink-details","aria-live":"assertive","aria-relevant":"all",dir:"ltr"},i.createElement(m.e,{"data-is-focusable":!0,autoFocus:!0,onClick:this._onLinkClicked,className:"od-ShareLink-url",defaultValue:a,readOnly:!0,ariaLabel:s,componentRef:function(t){return e._textField=t}})),i.createElement(ae.e,{content:o.no,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(f.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._onShareLinkDelete,iconProps:{iconName:t},ariaLabel:o.no}))),i.createElement("div",{className:"od-ShareLink-description flightOff"},s)),d&&this._renderLinkMembers())},t.prototype.componentDidUpdate=function(){this._resize()},t.prototype.componentDidMount=function(){var e=this;this._store.addListener(function(){e.setState(function(){var t=e._store.getSharingInformation().sharingLinks.filter(function(t){return t.shareId===e._link.shareId});if(t&&t.length>0)return e._link=t[0],{link:e._link,participants:e._link.sharingLinkKind===d.e.flexible||e._link.isPartialRedeem?Object(w.S)(e._link):[]}})})},t.prototype._renderLinkDetails=function(){return i.createElement(te,Object(a.__assign)({link:this._link,participants:this.state.participants,originalParticipants:this._originalParticipants,addParticipant:this._addParticipant,removeParticipant:this._removeParticipant,applyParticipants:this._applyParticipants,updateLinkSettings:this._updateLinkSettings,getLinkSettings:this._getLinkSettings,selectedPermissions:this.state.selectedPermissions,onRoleChange:this._onRoleChange,onExpirationChange:this._onExpirationChange,onPasswordChange:this._onPasswordChange,onPeoplePickerChange:this._onPeoplePickerChange,hasPeopleChange:this.state.hasPeopleChange,hasSettingsChange:this.state.hasSettingsChange,onCancel:this._onCancel,showPermissionsList:this._showPermissionsList,addressBarLinkDetails:this.props.isAddressBarLink,onOptionChange:this._onOptionChange},this.props))},t.prototype._renderParticipantsList=function(){return this.state.participants.length>0?i.createElement(M,{link:this._link,showDetailsPanel:!1,participants:this.state.participants,updateLinkSettings:this._updateLinkSettings,removeParticipant:this._removeOneParticipant,engagementExtraData:this.props.engagementExtraData}):i.createElement(i.Fragment,null)},t.prototype._renderLinkMembersForEditPanel=function(){var e=this.state.participants.map(function(e){return{personaName:e.name,imageUrl:e.image}});return i.createElement(P.e,{personas:e,personaSize:C.n.size24,maxDisplayablePersonas:4,overflowButtonType:T.e.descriptive,overflowButtonProps:{ariaLabel:o.ni}})},t.prototype._renderChevron=function(){var e=this;return i.createElement(ae.e,{content:o.xn,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(f.e,{ariaLabel:o.xn,"aria-expanded":this.state.linkMemberExpanded,className:"od-ShareLink--inviteesHolder-headerChevron",iconProps:!0===this.state.linkMemberExpanded?{iconName:"ChevronUp"}:{iconName:"ChevronDown"},componentRef:function(t){return e._chevronButton=t}}))},t.prototype._renderConfirmationDialogDeleteLink=function(){var e=this,t=this.state,n=t.confirmationCode,a=t.participants,r=t.participant;return i.createElement(A.ConfirmationDialog,{confirmationCode:n,participants:a,participant:r,onApply:this._onConfirmationDeleteLink,onCancel:this.state.confirmationCode===E.e.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:E.e.none})}})},t.prototype._showRATCallout=function(){this.state.isRATCalloutVisible||this.setState({isRATCalloutVisible:!0})},t.prototype._hideRATCallout=function(){this.state.isRATCalloutVisible&&!this.state.isRATCalloutFocused&&this.setState({isRATCalloutVisible:!1})},t.prototype._ratInfoKeyPressed=function(e){if(e&&e.charCode===se.e.enter||e.charCode===se.e.space){e.preventDefault();var t=this.state.isRATCalloutVisible;this.setState({isRATCalloutVisible:!t})}},t.prototype._setCalloutFocused=function(){this.setState({isRATCalloutFocused:!0})},t.prototype._setCalloutUnfocused=function(){this.setState({isRATCalloutFocused:!1,isRATCalloutVisible:!1})},t.prototype._renderShareLinkHeader=function(){var e=this._link;if(e.inheritedLinkInfo){var t,n=void 0,a=void 0;return this._isInherited?(n=s.T,t=e.inheritedLinkInfo.name,a=this._getInheritedTooltipContent(e)):this._isBundle&&(n=s.c,t=e.inheritedLinkInfo.name.toLowerCase(),a={onRenderContent:function(){return i.createElement(h.e,{className:"od-PrincipalDetails-textTooltipContent"},i.createElement("span",null,L.format(s.d,t)))}}),i.createElement("div",{className:"od-ShareLink-header"},i.createElement("span",null,n," ",i.createElement("span",{className:"od-ShareLink-header-itemname"},t)),i.createElement(ae.e,{tooltipProps:a,id:"od-ShareLink-header-tooltip"},i.createElement("span",{tabIndex:0,role:"note",className:"od-ShareLink-header-iconWraper"},i.createElement(v.e,{"aria-describedby":"od-ShareLink-header-tooltip","data-is-focusable":!0,iconName:"Info"}))))}},t.prototype._getInheritedTooltipContent=function(e){var t=this,n=this.props.sharingInformation.item,r=e.inheritedLinkInfo.path,o={size:16,type:b.e.folder},c={size:16,type:this.props.fileIcon},d=e.inheritedLinkInfo.name||r.substring(r.lastIndexOf("/")+1),l=n.parentName?d!==n.parentName:r.replace(n.parentPath,"").split("/").length>1;return{onRenderContent:function(){return i.createElement(h.e,{className:"od-PrincipalDetails-inheritedTooltipContent"},i.createElement("div",{className:"od-PrincipalDetails-inheritedTooltipContent-description"},s.U),i.createElement("span",null,i.createElement("span",null,i.createElement(v.e,Object(a.__assign)({className:"od-PrincipalDetails-tooltipFileIcon","aria-hidden":"true","data-is-focusable":!1},Object(g.n)(o))),d),i.createElement(v.e,{className:"od-PrincipalDetails-tooltipChevron","aria-hidden":"true","data-is-focusable":!1,iconName:"ChevronRight"}),l&&i.createElement("span",null,i.createElement("span",null,"..."),i.createElement(v.e,{className:"od-PrincipalDetails-tooltipChevron","aria-hidden":"true","data-is-focusable":!1,iconName:"ChevronRight"})),i.createElement("span",{className:"od-PrincipalDetails-inheritedTooltipContent-secondFilename"},i.createElement(v.e,Object(a.__assign)({className:"od-PrincipalDetails-tooltipFileIcon","aria-hidden":"true","data-is-focusable":!1},Object(g.n)(c))),t.props.fileName)))}}},t.prototype._renderShareLink=function(){var e,t=this,n=this._link,a=n.url,r=this.state.copyLinkToClipboardSuccess,s=Object(w.b)(this.props.link),c=Object(w.y)(n,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension,this.props.isAccessSummaryLink),l=this._canManageLink(n),u=this._useUpdatedIcons?"Settings":"More",h=this._useUpdatedIcons?"Delete":"Cancel",b=this.props.showMainDeleteOption,g=n.sharingLinkKind===d.e.requestAccess,S={maxWidth:"300px",onRenderContent:function(){return i.createElement("p",null,o.uo,i.createElement(_.e,{className:"od-SharingLink-learnMoreText",target:"_blank",href:"https://go.microsoft.com/fwlink/?linkid=2150444"},o.An))}};switch(this.props.spacing){case U.compact:e="od-ShareLink compact";break;case U.standard:e="od-ShareLink updatedSpacing";break;case U.legacy:default:e="od-ShareLink"}var x=this._isInherited?E.e.linkInheritance:this._isBundle?E.e.linkBundle:E.e.link,C="od-ShareLink-description "+(g?"compact":""),O=oe.e.generate();return i.createElement("div",{className:e},i.createElement("div",{className:"od-ShareLink-main"},i.createElement("div",{className:"od-ShareLink-icon2 icon-".concat(s)},i.createElement(v.e,{iconName:s,"aria-hidden":!0})),i.createElement("div",{className:"od-ShareLink-details"},g?i.createElement("div",null,o.lo,k.te()?i.createElement(ae.e,{content:o.ra,calloutProps:{gapSpace:0},tooltipProps:S},i.createElement(y.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info od-SharingLink-requestAccessInfo"})):i.createElement("span",{tabIndex:0,onMouseOver:this._showRATCallout.bind(this),onMouseLeave:this._hideRATCallout.bind(this),onKeyPress:this._ratInfoKeyPressed.bind(this)},i.createElement(y.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info od-SharingLink-requestAccessInfo",id:ce+""+O,style:{paddingLeft:"2px"}}),this.state.isRATCalloutVisible&&i.createElement(D.e,{id:"requestAccessInfo-callout",ariaLabelledBy:de,ariaDescribedBy:de,role:"dialog",gapSpace:0,target:"#".concat(ce+""+O),onDismiss:this._hideRATCallout.bind(this),onMouseOver:this._setCalloutFocused.bind(this),onMouseLeave:this._setCalloutUnfocused.bind(this),directionalHint:I.e.topCenter,setInitialFocus:!0,style:{maxWidth:"300px",padding:"12px 16px",fontSize:"0.75rem"}},i.createElement("div",{id:de},i.createElement("div",{className:"od-ShareLink-requestAccessTooltip-text"},o.uo),i.createElement(_.e,{id:"requestAccessInfo-calloutContentLink",style:{fontSize:"0.875rem"},tabIndex:0,className:"od-SharingLink-learnMoreText",target:"_blank",href:"https://go.microsoft.com/fwlink/?linkid=2150444"},o.An))))):i.createElement("div",{dir:"ltr"},i.createElement(m.e,{autoFocus:0===this.props.index,"data-is-focusable":!0,className:"od-ShareLink-url",defaultValue:a,readOnly:!0,ariaLabel:this._getAriaLabel(),componentRef:function(e){return t._textField=e}}))),!g&&i.createElement(p.e,{onClick:this._copySharingLinkToClipboard,"data-is-focusable":!0,ariaLabel:r?o.xa:o.Ge,componentRef:function(e){return t._copyButton=e}},r?o.Ue:o.Fe),this.props.showMoreOptions&&l?i.createElement("span",null,!g&&i.createElement(ae.e,{content:o.ra,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(f.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._showLinkDetails.bind(this),iconProps:{iconName:u},ariaLabel:o.ia})),b?i.createElement(ae.e,{content:o.no,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(f.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:function(){return t.setState({showConfirmationDialog:!0,confirmationCode:x})},iconProps:{iconName:h},ariaLabel:o.no})):null):l?i.createElement(ae.e,{content:o.no,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},i.createElement(f.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:function(){return t.setState({showConfirmationDialog:!0,confirmationCode:x})},iconProps:{iconName:h},ariaLabel:o.no})):null),l?i.createElement("div",{className:C,onClick:this._showLinkDetails.bind(this)},this._renderShareLinkDescriptionLabel(c)):i.createElement("div",{className:"od-ShareLink-description"},this._renderShareLinkDescriptionLabel(c)))},t.prototype._renderShareLinkDescriptionLabel=function(e){var t=this.props.isAccessSummaryLink;return i.createElement("div",{className:"od-ShareLink-description-label"},this._link.isUnhealthy?i.createElement("span",{className:"od-ShareHintDetail-statusText unHealthy"},o.Ss):i.createElement("span",{className:"od-ShareHintDetail-statusText ".concat(t||!1!==this.props.linkDetailsView?"":"clickable")},e,t&&this._renderHowCanUserModifyTooltip()),!t&&this._renderStatusIcons())},t.prototype._renderHowCanUserModifyTooltip=function(){var e=this._getTooltipText(),t={onRenderContent:function(){return i.createElement("div",null,e)}};return""!==e&&i.createElement(ae.e,{tooltipProps:t,id:"od-ShareLink-howCanUserModifyTooltip"},i.createElement("div",{tabIndex:0,role:"note",className:"od-ShareLink-howCanUserModifyTooltip"},i.createElement(v.e,{"aria-describedby":"od-ShareLink-howCanUserModifyTooltip",iconName:"Info"})))},t.prototype._getTooltipText=function(){switch(this.props.link.sharingScope){case u.e.organization:return o.ba;case u.e.specificPeople:return o.ga;case u.e.anyone:case u.e.existing:default:return""}},t.prototype._renderStatusIcons=function(){if(!this._link.isUnhealthy){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,a=this._link.isCreateOnlyLink,r=this._link.trackLinkUsers,s=[],c=this.props;e&&(e.getFullYear&&0!==e.getFullYear()||!this._hideInvalidExpirationIcons)&&(e<new Date(Date.now())?s.push({icon:"EventDateMissed12",tooltip:"".concat(L.format(o.Bt,Object(ne.d)(e)))}):e.getTime&&e.getTime()!==new Date(0).getTime()&&s.push({icon:"Calendar",tooltip:"".concat(L.format(o.Vt,Object(ne.d)(e)))})),t&&s.push({icon:"Lock",tooltip:o.To}),n&&!a&&s.push({icon:"Blocked2",tooltip:o.Ir}),this._link.isReview&&re.t[this.props.sharingInformation.fileExtension]&&s.push({icon:"Feedback",tooltip:o.Ga}),r&&s.push({icon:"ReminderPerson",tooltip:k.se()&&Y.n(c.clientId)?o.po:o._o});var d=s.map(function(e,t){return i.createElement("i",{key:t,className:"EventDateMissed12"!==e.icon?"od-ShareHintDetail-item":"od-ShareHintDetail-item od-ShareHintDetail-item-expired"},i.createElement(ae.e,{content:e.tooltip,id:e.icon},i.createElement(v.e,{iconName:e.icon,"aria-describedby":e.icon})))});return i.createElement("div",{className:"od-ShareHintDetail-iconsList"},d)}},t.prototype._getAriaLabel=function(){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,a=Object(w.y)(this._link,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);return e&&(e.getFullYear&&0!==e.getFullYear()||!this._hideInvalidExpirationIcons)&&(e<new Date(Date.now())?a+=" "+L.format(o.Bt,Object(ne.d)(e))+".":e.getTime&&e.getTime()!==new Date(0).getTime()&&(a+=" "+L.format(o.Vt,Object(ne.d)(e))+".")),t&&(a+=" "+o.To+"."),n&&(a+=" "+o.Ir+"."),a},t.prototype._renderLinkMembers=function(){var e=this.props.link.principals.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}).concat(this.props.link.invitees.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}})),t="od-ShareLink--inviteesHolder flightOff "+(this.props.spacing>0?"no-separator":"");return i.createElement(ie.e,null,i.createElement("ul",{"aria-label":o.Mn,className:t,"data-is-focusable":!0},e.map(function(e){return i.createElement("li",{className:"od-ShareLink-linkMember",key:e.primaryText,"data-is-focusable":!0,tabIndex:0},i.createElement(O,{primaryText:e.primaryText,imageUrl:e.imageUrl}))})))},t.prototype._getSharingRole=function(){return this.state.selectedPermissions.isManageList?l.e.manageList:this.state.selectedPermissions.isEdit?Object(w.f)(this.props.clientId,this.props.sharingInformation):this.state.selectedPermissions.isReview?l.e.review:l.e.view},t.prototype._getSharingRoleFromLink=function(){return this._link.isManageList?l.e.manageList:this._link.isEdit?Object(w.f)(this.props.clientId,this.props.sharingInformation):this._link.isReview?l.e.review:l.e.view},t.prototype._canManageLink=function(e){if(this._isConsumer)return!0;var t=J.a(e.audience,this.props.sharingInformation.sharingAbilities);return e.isEdit?k.m&&e.isCreateOnlyLink?!!t.canManageSubmitOnlyLink.enabled||t.canDeleteSubmitOnlyLink.enabled:!!t.canManageEditLink&&t.canManageEditLink.enabled:e.isReview?!!t.canManageReviewLink&&t.canManageReviewLink.enabled:!!t.canManageReadLink&&t.canManageReadLink.enabled},t.contextTypes={sharingStore:r.object.isRequired,resize:r.func.isRequired},t}(i.Component)},function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-Confirmation-message{padding:0;box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content{line-height:1.25rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content .od-Dialog-button.od-Dialog-button--close{width:2rem;height:2rem;line-height:2rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content .od-Dialog-button.od-Dialog-button--close i.ms-Icon.ms-Icon--Cancel{font-size:1rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions{height:2rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions button.od-Dialog-action{height:2rem;font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions button.od-Dialog-action .od-Button-label{font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main #od-Dialog-title{font-size:1.25rem}"}]);var i=n(0),r=function(e){function t(t){var n=e.call(this,t)||this;return n.message=t.message,n}return Object(i.__extends)(t,e),t}(n(196).t),o=n(399).e({tagName:"ms-confirmation",template:'<div class="od-Confirmation"><p class="od-Confirmation-message" data-bind="text:message"></p></div>',viewModel:r});t.e=o},function(e,t,n){"use strict";n.r(t),n.d(t,"ShareNotification",function(){return E});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareNotification{text-align:center;position:relative;display:flex;align-items:center;flex-direction:column}.od-ShareNotification.new{text-align:inherit;position:inherit;display:inherit;align-items:inherit;flex-direction:inherit}.od-ShareNotification-successPadding{padding-top:4px}.od-ShareNotification-failPadding{padding-top:50px}[dir=ltr] .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:left}[dir=rtl] .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:right}[dir=ltr] .od-ShareNotification-failPadding .ms-TextField{margin-right:8px}[dir=rtl] .od-ShareNotification-failPadding .ms-TextField{margin-left:8px}.od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;transform:translateX(-50%) scale(.5,.5);transform-origin:50% 50%;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.3125rem;border-radius:50%;width:2.75rem;height:2.75rem;animation:bounce .45s;animation-fill-mode:both;display:flex;align-items:center;justify-content:center;margin-left:2.75rem;background-color:"},{theme:"shareSuccessIcon",defaultValue:"#498205"},{rawString:"}.od-ShareNotification-content{width:90%}[dir=ltr] .od-ShareNotification-content{padding-left:16px}[dir=rtl] .od-ShareNotification-content{padding-right:16px}[dir=ltr] .od-ShareNotification-content{padding-right:16px}[dir=rtl] .od-ShareNotification-content{padding-left:16px}.od-ShareNotification-content .ms-font-l{font-weight:500;font-size:1.25rem}.od-ShareNotification-content.new{padding:0;width:100%}.od-ShareNotification-section{padding:24px}.od-ShareNotification-section.copy{padding-top:0}.od-ShareNotification-content-tooltip{margin:5px;word-wrap:break-word}.od-ShareNotification-permissionText{margin-bottom:24px;padding:0 20px}.od-ShareNotification-urlText{display:flex;padding:12px 6px}.od-ShareNotification-urlText.new{padding:0}.od-ShareNotification-urlText .ms-TextField{padding-right:4px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding:0;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:"}[dir=ltr] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-left:8px}[dir=rtl] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-right:8px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-fieldGroup{height:2rem}.od-ShareNotification-close{position:absolute;top:16px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.75rem;width:.75rem;height:.75rem;cursor:pointer}[dir=ltr] .od-ShareNotification-close{right:12px}[dir=rtl] .od-ShareNotification-close{left:12px}.od-ShareNotification-footer{width:90%;margin-top:0}[dir=ltr] .od-ShareNotification-footer{padding-left:16px}[dir=rtl] .od-ShareNotification-footer{padding-right:16px}[dir=ltr] .od-ShareNotification-footer{padding-right:16px}[dir=rtl] .od-ShareNotification-footer{padding-left:16px}.od-ShareNotification-footer.new{padding:0}@keyframes bounce{0%{transform:translateX(-50%) scaleX(.8) scaleY(.8);opacity:0}60%{transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;animation-timing-function:ease-out}100%{transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;animation-timing-function:ease-in}}.od-ShareNotification .od-ShareHint{margin:0;padding:6px;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareNotification .od-ShareHint.new{padding:0}.od-ShareNotification .od-ShareHint--clickable{width:100%}.od-ShareNotification-copyCta{font-size:.75rem}.od-ShareNotification-copyButton{height:2rem;min-width:fit-content;width:auto;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:"}[dir=ltr] .teams .od-ShareNotification-copyButton{margin-left:5px}[dir=rtl] .teams .od-ShareNotification-copyButton{margin-right:5px}.od-ShareNotification-urlTextField{width:100%}.od-ShareNotification-accessRequestIcon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin-top:24px}.od-ShareNotification-accessRequestHeader{font-size:1.25rem;margin-bottom:8px}.od-ShareNotification-accessRequestBody{font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 8px 24px 8px;text-align:left}.od-ShareNotification-SharedWith{align-self:stretch;display:flex;flex-direction:column;padding:16px}.od-ShareNotification-SharedWith .od-SharedWith-List>:not(:last-child){margin-right:4px}.od-ShareNotification-SharedWith.new{padding:0}"}]);var r,o=n(2150),s=n(2876);!function(e){e[e.default=0]="default",e[e.powerpoint=1]="powerpoint"}(r||(r={}));var c=n(1992),d=n(1818),l=n(2050),u=n(2112),f=n(1),p=n(1800),m=n(39),_=n(1804),h=n(1176),b=n(1642),g=n(1312),v=n(129),y=n(476),S=n(1801),D=n(1806),I=n(1802),x=n(1998),C=n(1830),O=n(2051),w={root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}},E=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onShowNameTooltip=function(){i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{isNameTooltipVisible:!0}))},i._onHideNameTooltip=function(){i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{isNameTooltipVisible:!1}))},i._copySharingLinkToClipboard=function(){return Object(a.__awaiter)(i,void 0,void 0,function(){var e=this;return Object(a.__generator)(this,function(t){return _.s(this.props.clientId,this._textField,this.props.linkUrl,this.props.itemName).then(function(t){e.setState(Object(a.__assign)(Object(a.__assign)({},e.state),{successfullyCopied:t}))}),[2]})})},i._onNotificationLabel=function(e){i._notificationLabel=e},i.state={successfullyCopied:!1,isNameTooltipVisible:!1},i._resize=n.resize,i._sharingStore=n.sharingStore,i._platformDetection=n.platformDetection,i._isSharedWithFeatureOn=!I.y()&&n.sharingStore&&n.sharingStore.isConsumer&&!n.sharingStore.isConsumer(),i}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this._platformDetection,n=t.isEdge,a=t.isIE,i=this.props.shareType===s.e.copy&&this.props.shouldCopyLinkToClipboard,r=a&&!D.m(this.props.clientId);i&&!r&&this._copySharingLinkToClipboard(),(n||r)&&setTimeout(function(){e._textField.focus()},500),this.props.onRenderComplete&&this.props.onRenderComplete()},t.prototype.componentDidUpdate=function(){this._resize()},t.prototype.render=function(){var e=this,t=this._getNotificationLabel(),n=this._getNotificationLabel(!0),i=this._getNotificationAriaLabel(),r=this.props.shareType===s.e.copy,c=!!this._sharingStore&&this._sharingStore.hasAccessRequestBeenCreated(),l=this.props.shareType,p=l===s.e.share||l===s.e.moreApps||l===s.e.copy&&this.state.successfullyCopied,m=p?"od-ShareNotification-successPadding":"",_=this.props.generatedFromTargetClick?"assertive":"off";if(c)return f.createElement("div",{className:"od-ShareNotification"},f.createElement(o.e,Object(a.__assign)({},Object(C.e)(this.props),{viewState:d.e.linkSuccess})),f.createElement("div",{className:"od-ShareNotification-content ms-font-su"},f.createElement(y.e,{iconName:"PeopleAlert",className:"od-ShareNotification-accessRequestIcon",styles:w}),f.createElement("div",{className:"od-ShareNotification-accessRequestHeader ms-fontWeight-regular"},S.o),f.createElement("div",{className:"od-ShareNotification-accessRequestBody"},S.r)));if(I.j()){var D=[],x=null;r&&(D.push(f.createElement("div",{className:"od-ShareNotification-urlText new"},f.createElement(u.e,{autoFocus:!0,"aria-live":"polite",ariaLabel:i,onClick:this._copySharingLinkToClipboard,readOnly:!0,componentRef:function(t){e._textField=t},type:"text",value:this.props.linkUrl,className:"od-ShareNotification-urlTextField",styles:{field:{fontSize:"0.875rem"}}}),f.createElement(h.e,{className:"od-ShareNotification-copyButton",text:S.Fe,onClick:this._copySharingLinkToClipboard,styles:{label:{fontSize:"0.875rem"},root:{padding:"0px 1rem"}}}))),this.props.sharingHintProps&&D.push(this._renderShareHint()));var E=this._renderSharedWith();return E&&D.push(E),D.length&&(x=f.createElement(f.Fragment,null,!r&&f.createElement(O.e,null),f.createElement("div",{className:"od-ShareNotification-section"+(r?" copy":"")},D))),f.createElement("div",{className:"od-ShareNotification new","aria-live":_},f.createElement("div",{className:"od-ShareNotification-content new"},f.createElement("div",{className:"od-ShareNotification-section"},f.createElement(o.e,Object(a.__assign)({},Object(C.e)(this.props),{viewState:d.e.linkSuccess,title:t,titleAria:n}))),x))}return f.createElement("div",{className:"od-ShareNotification ".concat(m),"aria-live":_},f.createElement(o.e,Object(a.__assign)({},Object(C.e)(this.props),{viewState:d.e.linkSuccess})),this._renderCheckMark(p),f.createElement("div",{className:"od-ShareNotification-content"},f.createElement("h1",{className:"ms-font-l",ref:this._onNotificationLabel,onFocus:this._onShowNameTooltip,onBlur:this._onHideNameTooltip,onMouseEnter:this._onShowNameTooltip,onMouseLeave:this._onHideNameTooltip,"aria-label":n},t),this.state.isNameTooltipVisible&&t!==n&&f.createElement(g.e,{directionalHint:v.e.topCenter,gapSpace:2,onDismiss:this._onHideNameTooltip,target:this._notificationLabel,calloutWidth:300},f.createElement("div",{className:"od-ShareNotification-content-tooltip"},n)),r&&this._renderCopyCta(),r&&f.createElement("div",{className:"od-ShareNotification-urlText"},f.createElement(u.e,{autoFocus:!0,"aria-live":"polite",ariaLabel:i,onClick:this._copySharingLinkToClipboard,readOnly:!0,componentRef:function(t){e._textField=t},type:"text",value:this.props.linkUrl,className:"od-ShareNotification-urlTextField",styles:{field:{fontSize:"0.875rem"}}}),f.createElement(b.e,{className:"od-ShareNotification-copyButton",text:S.Fe,onClick:this._copySharingLinkToClipboard,styles:{label:{fontSize:"0.875rem"},root:{padding:"0px 1rem"}}}))),r&&this.props.sharingHintProps&&this._renderShareHint(),this._renderSharedWith())},t.prototype._renderCheckMark=function(e){if(e)return f.createElement("div",{className:"od-ShareNotification-icon"},f.createElement(y.e,{iconName:"CheckMark",styles:w}))},t.prototype._renderCopyCta=function(){var e=this.props,t=this.state;if(e.shareType===s.e.copy&&!t.successfullyCopied)return f.createElement("span",{className:"od-ShareNotification-copyCta"},S.Oa)},t.prototype._renderSharedWith=function(){if(this._isSharedWithFeatureOn&&this.props.sharingHintProps&&this.props.sharingHintProps.linkRecipients){var e=this.props.sharingHintProps.linkRecipients.map(function(e){return{email:e.email,loginName:e.email,primaryText:e.name,type:e.principalType,imageUrl:e.image}});if(e&&e.length){var t=I.j()?" new":"";return f.createElement("div",{className:"od-ShareNotification-SharedWith"+t},f.createElement(l.e,{label:S.Ho,getPhotoUrl:Object(x.t)(this.props.webUrl),sharingLinks:[],sharingPrincipals:e}))}}return null},t.prototype._renderShareHint=function(){var e=this.props.sharingHintProps,t=I.j()?" new":"";return f.createElement("div",{className:"od-ShareNotification-footer"+t},f.createElement(c.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:e.sharingInformation,onShareHintClick:e.sharingInformation.requiresAccessApproval?void 0:e.onShareHintClick,linkRecipients:e.linkRecipients,customLabeledAudienceConfig:e.customLabeledAudienceConfig}))},t.prototype._getContextualSharingPrompt=function(e){return e===r.powerpoint?S.Te+" ":""},t.prototype._getNotificationLabel=function(e){var t=e?this.props.itemName:_.B(this.props.itemName),n=this.props.shareType,a=this._sharingStore.getContextualSharingInformation(),i=this._sharingStore.getNavId();I.l()&&a&&i&&(t="".concat(this._getContextualSharingPrompt(a.context)).concat(a.location));var r=S.xa;t&&I.l()&&a&&i?r=m.format(S.Pe,t):t&&(r=m.format(S.Ia,t));var o=t?m.format(S.Ca,t):S.wa,c=t?m.format(S.Ea,t):S.Aa;return n===s.e.copy?this.state.successfullyCopied?r:o:n===s.e.share?c:n===s.e.moreApps?o:""},t.prototype._getNotificationAriaLabel=function(){var e=this.props.shareType;return e===s.e.copy?this.state.successfullyCopied?S.xa:S.wa:e===s.e.share?S.Aa:e===s.e.moreApps?S.wa:""},t.contextTypes={resize:p.func.isRequired,sharingStore:p.object.isRequired,platformDetection:p.object.isRequired},t}(f.Component);t.default=E},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharedWith{align-items:center;display:flex}.od-SharedWith .label{font-size:.875rem;font-weight:600;font:-apple-system-body;margin:0}[dir=ltr] .od-SharedWith .label{padding-right:4px}[dir=rtl] .od-SharedWith .label{padding-left:4px}.od-SharedWith-Facepile{display:flex;position:relative}.od-SharedWith-Facepile button.compact{height:auto;padding:2px;width:auto}.od-SharedWith-Facepile button.compact:hover{background-color:transparent}.od-SharedWith-Facepile li{display:flex}.od-SharedWith-List{display:flex}.od-SharedWith-List li{flex-shrink:0}.od-SharedWith-Persona{display:flex;position:relative}.od-SharedWith-Persona-measure{left:0;position:absolute;visibility:hidden}.od-SharedWith-Persona .od-SharedWith-Persona-measure{margin-left:0}.od-SharedWith-Link .ms-Persona-initials{background-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SharedWith-Link .ms-Persona-initials i{font-weight:400}.od-SharedWith-More .ms-Persona-initials{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var r=n(1853),o=n(1801),s=n(39),c=n(1),d=n(122),l=n(1840),u=n(476),f=n(2452),p=n(1644),m=n(1673),_=n(1802),h=n(1804),b=n(1800);function g(e,t){var n=e.ariaLabel,a=e.label,i=e.getPhotoUrl,l=e.onClick,u=e.sharingPrincipals,f=e.sharingLinks,p=c.useRef(null),m=c.useRef(null),b=c.useRef(null),g=c.useState(!0),y=g[0],S=g[1],D=c.useState(0),I=D[0],x=D[1],C=c.useMemo(function(){var e=[],a={},d=0;if(f.length)for(var p=0,m=f;p<m.length;p++){var b=m[p];if(b.principals.length||b.invitees.length){for(var g=0,y=b.principals;g<y.length;g++)a[(L=y[g]).loginName||L.email]=L;if(b.isActive&&(!b.expiration||b.expiration.getTime()>Date.now()))for(var S=0,D=b.invitees;S<D.length;S++)a[(L=D[S]).loginName||L.email]=L}d++}for(var I=0,x=u;I<x.length;I++)a[(L=x[I]).loginName||L.email]=L;if(d){var C=1===d?o.Bo:Object(s.format)(o.No,d),O=C+(n?", "+n:"");e.push(c.createElement(v,{ariaLabel:O,className:"od-SharedWith-Link",iconName:"Link",key:".link",onClick:l,title:C}))}for(var w=0,E=Object.keys(a);w<E.length;w++){var A=E[w],L=a[A],k=void 0;k=!Object(_.de)()&&L.imageUrl?L.imageUrl:L.type===r.e.user&&i?i(A):void 0,Object(h.R)(k,t.clientId)&&(k=void 0);var M=L.primaryText+(n?", "+n:"");e.push(c.createElement(v,{ariaLabel:M,imageUrl:k,key:L.primaryText,onClick:l,text:L.primaryText,title:L.email?"".concat(L.primaryText," <").concat(L.email,">"):L.primaryText}))}return e},[u,f]);return c.useEffect(function(){return p.current=new IntersectionObserver(O,{root:b.current,threshold:1}),function(){return p.current.disconnect()}},[]),c.useEffect(function(){if(p.current&&m.current){for(var e=[],n=0;n<m.current.children.length;n++){var a=m.current.children[n];p.current.observe(a),e.push(a)}return function(){for(var n,a=0,i=e;a<i.length;a++){var r=i[a];p.current.unobserve(r)}null===(n=t.resize)||void 0===n||n.call(t)}}}),c.createElement("div",{className:"od-SharedWith",ref:b},a&&c.createElement("h2",{className:"label"},a),c.createElement("div",{"aria-label":a,className:"od-SharedWith-Facepile"},!y&&c.createElement("ul",{className:"od-SharedWith-List"},C.slice(0,I<C.length-1?I:void 0),I<C.length-1?c.createElement(v,{ariaLabel:n,className:"od-SharedWith-More",iconName:"More",key:".more",onClick:l,title:o.jo}):null),c.createElement("ul",{"aria-hidden":!0,className:"od-SharedWith-List od-SharedWith-Persona-measure",ref:m,role:"presentation"},C)));function O(e){var t=0,n=1e3;if(m.current){for(var a=0,i=e;a<i.length;a++)for(var r=i[a],o=0;o<m.current.children.length;o++)if(m.current.children[o]===r.target){r.intersectionRect.width===r.boundingClientRect.width?t=Math.max(t,o):n=Math.min(n,o);break}0===t&&1e3!==n&&(t=Math.max(0,n-1)),Object(d.unstable_batchedUpdates)(function(){x(function(e){return e!==t?t:e}),S(!1)})}}}function v(e){var t=e.ariaLabel,n=e.className,i=e.iconName,r=e.imageUrl,o=e.onClick,s=e.text,d=e.title,_={text:s,imageUrl:r,hidePersonaDetails:!0,showInitialsUntilImageLoads:!0,size:l.n.size24,onRenderInitials:i?function(){return c.createElement(u.e,{iconName:i})}:void 0,coinProps:{styles:{coin:{width:"1.5rem",height:"1.5rem"},image:{width:"1.5rem !important",height:"1.5rem !important"},imageArea:{width:"1.5rem",height:"1.5rem"},initials:{width:"1.5rem",height:"1.5rem",fontSize:"0.625rem",lineHeight:"1.5rem"}}},styles:{root:{height:"1.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},h=c.createElement(f.e,Object(a.__assign)({},_));return h=o?c.createElement(p.e,{"aria-haspopup":!0,ariaLabel:t,className:"compact",onClick:o,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}},h):c.createElement("span",{className:"od-SharedWith-noninteractivePersona",tabIndex:0,"aria-label":t,"data-is-focusable":!0,role:"img"},h),c.createElement("li",{className:n},c.createElement(m.e,{hostClassName:"od-SharedWithPersona-tooltip",calloutProps:{gapSpace:0},content:d},h))}!function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=function(e){for(var t=window.document,n=o(t);n;)n=o(t=n.ownerDocument);return t}(),t=[],n=null,a=null,i=function(e){this.time=e.time,this.target=e.target,this.rootBounds=l(e.rootBounds),this.boundingClientRect=l(e.boundingClientRect),this.intersectionRect=l(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,a=this.intersectionRect,i=a.width*a.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0},r=function(){function r(e,t){this.THROTTLE_TIMEOUT=100,this.POLL_INTERVAL=null,this.USE_MUTATION_OBSERVER=!0;var n,a,i,r=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(r.root&&1!=r.root.nodeType&&9!=r.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),a=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n(),i=null},a))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(r.rootMargin),this.thresholds=this._initThresholds(r.threshold),this.root=r.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}return r.prototype._setupCrossOriginUpdater=function(){return n||(n=function(e,n){a=e&&n?u(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach(function(e){e._checkForIntersections()})}),n},r.prototype._resetCrossOriginUpdater=function(){n=null,a=null},r.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},r.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},r.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},r.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},r.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]})},r.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},r.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var a=this._checkForIntersections,i=null,r=null;this.POLL_INTERVAL?i=n.setInterval(a,this.POLL_INTERVAL):(s(n,"resize",a,!0),s(t,"scroll",a,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(r=new n.MutationObserver(a)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push(function(){var e=t.defaultView;e&&(i&&e.clearInterval(i),c(e,"resize",a,!0)),c(t,"scroll",a,!0),r&&r.disconnect()});var d=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=d){var l=o(t);l&&this._monitorIntersections(l.ownerDocument)}}},r.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var a=this.root&&(this.root.ownerDocument||this.root)||e,i=this._observationTargets.some(function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=a;){var i=o(n);if((n=i&&i.ownerDocument)==t)return!0}return!1});if(!i){var r=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),r(),t!=a){var s=o(t);s&&this._unmonitorIntersections(s.ownerDocument)}}}},r.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},r.prototype._checkForIntersections=function(){if(this.root||!n||a){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(a){var r=a.element,o=d(r),s=this._rootContainsTarget(r),c=a.entry,l=e&&s&&this._computeTargetAndRootIntersection(r,o,t),u=null;this._rootContainsTarget(r)?n&&!this.root||(u=t):u={top:0,bottom:0,left:0,right:0,width:0,height:0};var f=a.entry=new i({time:window.performance&&performance.now&&performance.now(),target:r,boundingClientRect:o,rootBounds:u,intersectionRect:l});c?e&&s?this._hasCrossedThreshold(c,f)&&this._queuedEntries.push(f):c&&c.isIntersecting&&this._queuedEntries.push(f):this._queuedEntries.push(f)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},r.prototype._computeTargetAndRootIntersection=function(t,i,r){if("none"!=window.getComputedStyle(t).display){for(var o,s,c,l,f,m,_,h,b=i,g=p(t),v=!1;!v&&g;){var y=null,S=1==g.nodeType?window.getComputedStyle(g):{};if("none"==S.display)return null;if(g==this.root||9==g.nodeType)if(v=!0,g==this.root||g==e)n&&!this.root?!a||0==a.width&&0==a.height?(g=null,y=null,b=null):y=a:y=r;else{var D=p(g),I=D&&d(D),x=D&&this._computeTargetAndRootIntersection(D,I,r);I&&x?(g=D,y=u(I,x)):(g=null,b=null)}else{var C=g.ownerDocument;g!=C.body&&g!=C.documentElement&&"visible"!=S.overflow&&(y=d(g))}if(y&&(o=y,s=b,c=Math.max(o.top,s.top),l=Math.min(o.bottom,s.bottom),f=Math.max(o.left,s.left),h=l-c,b=(_=(m=Math.min(o.right,s.right))-f)>=0&&h>=0&&{top:c,bottom:l,left:f,right:m,width:_,height:h}||null),!b)break;g=g&&p(g)}return b}},r.prototype._getRootRect=function(){var t;if(this.root&&!m(this.root))t=d(this.root);else{var n=m(this.root)?this.root:e,a=n.documentElement,i=n.body;t={top:0,left:0,right:a.clientWidth||i.clientWidth,width:a.clientWidth||i.clientWidth,bottom:a.clientHeight||i.clientHeight,height:a.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(t)},r.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100}),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3],height:0,width:0};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},r.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,a=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==a)for(var i=0;i<this.thresholds.length;i++){var r=this.thresholds[i];if(r==n||r==a||r<n!=r<a)return!0}},r.prototype._rootIsInDom=function(){return!this.root||f(e,this.root)},r.prototype._rootContainsTarget=function(t){var n=this.root&&(this.root.ownerDocument||this.root)||e;return f(n,t)&&(!this.root||n==t.ownerDocument)},r.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},r.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},r}();window.IntersectionObserver=r,window.IntersectionObserverEntry=i}function o(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function s(e,t,n,a){"function"==typeof e.addEventListener?e.addEventListener(t,n,a||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function c(e,t,n,a){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,a||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function d(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function l(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function u(e,t){var n=t.top-e.top,a=t.left-e.left;return{top:n,left:a,height:t.height,width:t.width,bottom:n+t.height,right:a+t.width}}function f(e,t){for(var n=t;n;){if(n==e)return!0;n=p(n)}return!1}function p(t){var n=t.parentNode;return 9==t.nodeType&&t!=e?o(t):(n&&n.assignedSlot&&(n=n.assignedSlot.parentNode),n&&11==n.nodeType&&n.host?n.host:n)}function m(e){return e&&9===e.nodeType}}(),g.contextTypes={clientId:b.number.isRequired,resize:b.func.isRequired}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(1),i=n(17);function r(){return a.createElement("div",{className:"separator"})}Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.separator{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(1),r=n(2225),o=n(2304),s=n(476),c=n(2576),d=n(1804),l=n(1801),u=n(39),f=n(17);Object(f.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelectorLarge-wrapper{position:relative;display:flex;align-items:center;width:100%}.od-RoleSelectorLarge-wrapper .ms-TooltipHost{position:absolute;top:9px;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-RoleSelectorLarge-wrapper .ms-TooltipHost{right:0}[dir=rtl] .od-RoleSelectorLarge-wrapper .ms-TooltipHost{left:0}.od-RoleSelectorLarge-wrapper .ms-Dropdown-container{width:100%}.od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{margin:0;height:auto}[dir=ltr] .od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-left:0}[dir=rtl] .od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-right:0}.od-RoleSelectorLarge-rolesDropdown{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{border:none;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";height:2rem;line-height:1.875rem}[dir=ltr] .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{padding-left:0}[dir=rtl] .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{padding-right:0}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font-size:.875rem;line-height:1.3}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title.ms-Dropdown-titleIsPlaceHolder{text-align:center}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown:focus::after{border:none;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:0}.od-RoleSelectorLarge-rolesDropdown.is-open,.od-RoleSelectorLarge-rolesDropdown:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.is-open .ms-Dropdown-title,.od-RoleSelectorLarge-rolesDropdown.is-open:hover .ms-Dropdown-title{border-bottom-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{right:32px}[dir=rtl] .od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{left:32px}.od-RoleSelector-infoTooltipContent{font-size:.875rem}.od-changePermissions--info i{vertical-align:middle}.od-RoleSelectorLarge-roleDropdownOption{display:flex;align-items:center;margin:8px 0 8px 12px}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent{display:flex;flex-direction:column}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent.od-RoleSelectorLarge-option-0{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font-weight:600;font-size:.875rem;line-height:1.3}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{font-size:.75rem;line-height:1.3}[dir=ltr] .od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{text-align:left}[dir=rtl] .od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{text-align:right}.od-RoleSelectorLarge-settingIcon{font-size:.875rem}[dir=ltr] .od-RoleSelectorLarge-settingIcon{padding-left:4px}[dir=rtl] .od-RoleSelectorLarge-settingIcon{padding-right:4px}[dir=ltr] .od-RoleSelectorLarge-settingIcon{padding-right:12px}[dir=rtl] .od-RoleSelectorLarge-settingIcon{padding-left:12px}.ms-Dropdown .ms-Dropdown-title:focus{outline:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}]);var p=n(342),m=n(1673),_=n(1802),h=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onRenderTitle=function(e){var t=Object(d.x)(e[0].key);return i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOptionMainContent"},i.createElement(s.e,{iconName:t.name,"aria-hidden":"true",title:t.name,className:"od-RoleSelectorLarge-settingIcon"}),i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionText"}," ",e[0].text," "))},a._onRenderOption=function(e){var t=Object(d.x)(e.key);e.key==c.e.review&&a.props.showDropdownWithOfficeReview&&(t.title=l.pe);var n={maxWidth:"300px",onRenderContent:function(){return i.createElement("div",{className:"od-RoleSelector-infoTooltipContent"},t.title)}},r="od-RoleSelectorLarge-roleDropdownOptionMainContent od-RoleSelectorLarge-option-".concat(e.key);return i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOption"},i.createElement(m.e,{calloutProps:{gapSpace:0},tooltipProps:n},i.createElement(s.e,{className:"od-RoleSelectorLarge-settingIcon",iconName:t.name})),i.createElement("div",{className:r},i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionText"}," ",e.text," "),i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionSubtext"},e.data)))},a._onAllowRoleChange=function(e,t){a.props.onRoleChange(t.key,a.props.permissionId||"")},a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,n=e.menuPermissionOptions,a=(e.showLinkSettings,e.showStopSharing),u=e.showRemoveDirectAccess,f=e.sharingRole,h=e.showGrantAccess,b=!this.props.showCollapsedRoleIcon||this.props.showCollapsedRoleIcon,g=Object(d.x)(f),v=f;v!==c.e.review||n.review.enabled||(v=c.e.edit),v!==c.e.owner||n.fullControl.enabled||(v=c.e.edit);var y={key:"divider_1",text:"-",itemType:r.e.Divider},S=[];if(n.fullControl.shouldDisplay){var D=t._fullControlDropdownOption;D.disabled=!n.fullControl.enabled,S.push(D)}if(n.manageList.shouldDisplay){var I=t._manageListDropdownOption;I.disabled=!n.manageList.enabled,S.push(I)}if(n.manageList.shouldDisplay&&n.manageList.enabled)S.push(t._editDropDownOptionForLists);else{var x=t._editDropDownOption;x.disabled=!n.edit.enabled,S.push(x)}if(n.review.shouldDisplay){var C=_.s()&&this.props.showDropdownWithOfficeReview?t._officeReviewDropdownOption:t._reviewDropdownOption;C.disabled=!n.review.enabled,S.push(C)}if(n.manageList.shouldDisplay&&n.manageList.enabled?S.push(t._viewDropdownOptionForLists):n.view.shouldDisplay&&n.view.enabled&&S.push(t._viewDropdownOption),a){var O=t._stopSharingDropdownOption;S.push(y,O)}if(u){var w=t._removeDirectAccessDropdownOption;S.push(y,w)}var E={maxWidth:"300px",onRenderContent:function(){return i.createElement("div",{className:"od-RoleSelector-infoTooltipContent"},g.title)}};return i.createElement("div",{className:"od-RoleSelectorLarge-wrapper"},b&&i.createElement(m.e,{calloutProps:{gapSpace:0},tooltipProps:E},i.createElement(s.e,{className:"od-RoleSelectorLarge-settingIcon",iconName:g.name})),i.createElement(o.e,{className:"od-RoleSelectorLarge-rolesDropdown",disabled:this.props.disabled,label:"",onRenderTitle:this._onRenderTitle,onRenderOption:this._onRenderOption,onChange:this._onAllowRoleChange,defaultSelectedKey:h?void 0:v,calloutProps:{className:"od-RoleSelectorLarge-rolesDropdownOptionsCallout"},responsiveMode:p.e.large,options:S,ariaLabel:this.props.ariaLabel,placeholder:h?l.ms:""}),this.props.children)},t._editDropDownOption={key:c.e.edit,text:l.de,data:l.ue,ariaLabel:u.format(l.bo,l.de,l.ue),title:u.format(l.bo,l.de,l.ue)},t._editDropDownOptionForLists=Object(a.__assign)(Object(a.__assign)({},t._editDropDownOption),{text:l.le,data:l.fe,title:u.format(l.bo,l.le,l.fe)}),t._reviewDropdownOption={key:c.e.review,text:l._e,data:l.he,ariaLabel:u.format(l.bo,l._e,l.he),title:u.format(l.bo,l._e,l.he)},t._officeReviewDropdownOption={key:c.e.review,text:l.pe,data:l.me,ariaLabel:u.format(l.bo,l.pe,l.me),title:u.format(l.bo,l.pe,l.me)},t._viewDropdownOption={key:c.e.view,text:l.ve,data:l.ye,ariaLabel:u.format(l.bo,l.ve,l.ye),title:u.format(l.bo,l.ve,l.ye)},t._viewDropdownOptionForLists=Object(a.__assign)(Object(a.__assign)({},t._viewDropdownOption),{data:l.Se,title:u.format(l.bo,l.ve,l.Se)}),t._fullControlDropdownOption={key:c.e.owner,text:l.cn,data:l.dn,ariaLabel:u.format(l.bo,l.cn,l.dn),title:u.format(l.bo,l.cn,l.dn)},t._manageListDropdownOption={key:c.e.manageList,text:l.se,data:l.ce,ariaLabel:u.format(l.bo,l.se,l.ce),title:u.format(l.bo,l.se,l.ce)},t._stopSharingDropdownOption={key:c.e.none,text:l.Ds,ariaLabel:l.Ds,title:l.Ds},t._removeDirectAccessDropdownOption={key:c.e.none,text:l.eo,ariaLabel:l.eo,title:l.eo},t}(i.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(1),r=n(2576),o=n(266),s=n(129),c=n(1644),d=n(39),l=n(1801),u=n(17);Object(u.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-RoleSelectorCompact-permissionButton{margin-left:8px}[dir=rtl] .od-RoleSelectorCompact-permissionButton{margin-right:8px}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-permissionButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton span.ms-Button-flexContainer{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font-size:.75rem;height:1rem;line-height:1rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton .od-RoleSelectorCompact-permissionButton-Chevron{font:-apple-system-body;height:auto}}@supports (font:-apple-system-body){.od-RoleSelectorCompact-permissionButton i.ms-Button-icon{font:-apple-system-body;height:auto}}.od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{display:flex;flex-direction:column;margin:8px}[dir=ltr] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:left}[dir=rtl] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:right}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";line-height:2.25rem;height:3.25rem;font-size:.875rem}@supports (font:-apple-system-body){.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{font:-apple-system-body;height:auto!important}}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link.is-disabled{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:transparent;font-size:1rem;width:1rem;max-height:unset}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-itemText{font-size:.875rem;line-height:1.25rem;font:-apple-system-body}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{font-size:.75rem;line-height:1rem;font:-apple-system-caption1}.od-RoleSelectorCompact-menuItem.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}.od-RoleSelectorCompact-menuItem-stopSharing .ms-ContextualMenu-link{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}@media screen and (-ms-high-contrast:active){.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover{background-color:highlight;border-color:highlight;color:highlighttext;forced-color-adjust:none}button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-icon,button.od-RoleSelectorCompact-permissionButton.ms-Button.ms-Button--icon:hover i.ms-Icon.ms-Button-menuIcon.od-RoleSelectorCompact-permissionButton-Chevron{color:highlighttext;font-weight:600;forced-color-adjust:none}}"}]);var f,p=n(1800),m=n(1817),_=n(1802);!function(e){e.edit="edit",e.view="view",e.review="comment",e.fullControl="full-control",e.manageList="manage-list",e.divider="divider",e.stopSharing="stop-sharing",e.linkSettings="linkSettings"}(f||(f={}));var h=function(e){function t(t,n){var a=e.call(this,t)||this;return a._linkSettingsClickedInRoleSelector=function(){a.context.sharingStore.getEngagementHelper().linkSettingsInCompactRoleSelectorClicked({clientId:a.props.clientId,scenarioId:"",mode:a.props.mode}),a.props.onLinkSettingsClicked()},a._onItemClicked=function(e,t){var n;switch(t.key){case f.fullControl:n=r.e.owner;break;case f.manageList:n=r.e.manageList;break;case f.edit:n=r.e.edit;break;case f.view:n=r.e.view;break;case f.review:n=r.e.review;break;default:n=r.e.none}a._selectedRole!==n&&a.props.onRoleChange(n,a.props.permissionId||"")},a._selectedRole=a._parseRole(t.sharingRole),a._menuOpen=!1,a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this;this._selectedRole=this._parseRole(this.props.sharingRole);var n,a=this.props,u=a.menuPermissionOptions,f=a.showLinkSettings,p=a.showStopSharing,_=this._getMenuItems({menuPermissionOptions:u,showLinkSettings:f,showStopSharing:p}),h=_.filter(function(e){return e.itemType!==o.e.Divider}).length;switch(this.props.sharingRole){case r.e.owner:n=l.cn;break;case r.e.edit:n=l.de;break;case r.e.review:n=l._e,this.props.showDropdownWithOfficeReview&&(n=l.pe);break;case r.e.view:n=l.ve;break;case r.e.manageList:n=l.se;break;case r.e.none:n="";break;default:return null}var b={directionalHint:s.e.bottomRightEdge,shouldFocusOnMount:!0,items:_,isBeakVisible:!1,onItemClick:this._onItemClicked,onMenuOpened:function(){e._logRoleSelectorClicked(e.context.sharingStore),e._menuOpen=!0},onMenuDismissed:function(){e._menuOpen=!1},styles:t.menuItemStyles},g={iconName:"ChevronDown",className:"od-RoleSelectorCompact-permissionButton-Chevron"};if(this.props.shimmer)return i.createElement(c.e,{menuIconProps:g,iconProps:{iconName:"Stop"},className:"od-RoleSelectorCompact-permissionButton",menuProps:b,disabled:!0,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}});var v=this._menuOpen?d.format(l.Pn,this.props.ariaLabel,n,h):d.format(l.Tn,this.props.ariaLabel,n,h);return m.t(i.createElement(c.e,{menuIconProps:g,iconProps:this.getRoleIconName(this.props.sharingRole),className:"od-RoleSelectorCompact-permissionButton",menuProps:b,disabled:this.props.disabled,ariaLabel:v,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}}),n,{position:s.e.bottomRightEdge})},t.prototype._renderContent=function(e,t){return i.createElement(i.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),i.createElement("div",{className:"od-RoleSelectorCompact-menuItem-textWrapper"},t.renderItemName(e),t.renderSecondaryText(e)),t.renderSubMenuIcon(e))},t.prototype._parseRole=function(e){return e===r.e.review&&!this.props.menuPermissionOptions.review.enabled||e===r.e.owner&&!this.props.menuPermissionOptions.fullControl.enabled?r.e.edit:e===r.e.restrictedview?r.e.view:e},t.prototype._addRenderContent=function(e){var t=this;return e.map(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{onRenderContent:t._renderContent})})},t.prototype._getMenuItems=function(e){var t=[],n=e.menuPermissionOptions,a=e.showLinkSettings,i=e.showStopSharing,r=n.fullControl,s=(r.enabled,r.shouldDisplay),c=void 0!==s&&s,u=n.review,p=(u.enabled,u.shouldDisplay),m=void 0!==p&&p,h=n.edit,b=h.enabled,g=void 0===b||b,v=h.shouldDisplay,y=void 0===v||v,S=n.view,D=(S.enabled,S.shouldDisplay),I=void 0===D||D,x=n.manageList,C=x.enabled,O=void 0!==C&&C,w=x.shouldDisplay,E=void 0!==w&&w,A={key:f.edit,text:E?l.le:l.de,disabled:!g,secondaryText:E?l.fe:l.ue,ariaLabel:d.format(l.bo,E?l.le:l.de,E?l.fe:l.ue),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Edit"}},L={key:f.view,text:l.ve,secondaryText:E?l.Se:l.ye,ariaLabel:d.format(l.bo,l.ve,E?l.Se:l.ye),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Uneditable2"}},k={key:f.fullControl,text:l.cn,secondaryText:l.dn,ariaLabel:d.format(l.bo,l.cn,l.dn),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Signin"}},M={key:f.manageList,text:l.se,disabled:!O,secondaryText:l.ce,ariaLabel:d.format(l.bo,l.se,l.ce),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"EditListPencil"}},P={key:f.review,text:l._e,secondaryText:l.he,ariaLabel:d.format(l.bo,l._e,l.he),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"}},T={key:f.review,text:l.pe,secondaryText:l.me,ariaLabel:d.format(l.bo,l.pe,l.me),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"}},U={key:f.divider,itemType:o.e.Divider},F={key:f.stopSharing,text:l.Ds,ariaLabel:l.Ds,canCheck:!1,onClick:this.props.onStopSharing,className:"od-RoleSelectorCompact-menuItem od-RoleSelectorCompact-menuItem-stopSharing",iconProps:{iconName:"Delete"}},H={key:"linkSettings",text:l.Zn,onClick:this._linkSettingsClickedInRoleSelector,iconProps:{iconName:"Settings"},className:"od-RoleSelectorCompact-menuItem",ariaLabel:l.Zn};return c&&t.push(k),E&&t.push(M),y&&t.push(A),m&&(_.s()&&this.props.showDropdownWithOfficeReview?t.push(T):t.push(P)),I&&t.push(L),i&&t.push(U,F),a&&t.push(U,H),this._addRenderContent(t)},t.prototype._logRoleSelectorClicked=function(e){e.getEngagementHelper().compactRoleSelectorClicked({clientId:this.props.clientId,scenarioId:"",mode:this.props.mode})},t.prototype.getRoleIconName=function(e){var t;switch(e=this._parseRole(e)){case r.e.owner:t="Signin";break;case r.e.edit:t="Edit";break;case r.e.view:t="Uneditable2";break;case r.e.review:t="Feedback";break;case r.e.manageList:t="EditListPencil";break;case r.e.none:t="";break;default:throw new Error("Sharing role does not exist")}return{iconName:t}},t.contextTypes={sharingStore:p.object.isRequired},t.menuItemStyles={subComponentStyles:{menuItem:{root:{height:"auto !important"},label:{margin:"0",fontSize:"0.875rem",fontWeight:"600",lineHeight:"1.3"},secondaryText:{paddingLeft:"0",fontSize:"0.75rem",lineHeight:"1.3",textAlign:"left",whiteSpace:"normal"}}}},t}(i.Component)},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(119),i=n(2191),r=n(1132),o=n(2076),s=n(1985),c=n(1975),d=n(60),l=n(90),u=function(){function e(e,t){this._getIdentityDataSource=t.getIdentityDataSource}return e.prototype.getToken=function(e,t){return this.getInstrumentedToken(e,t).then(function(e){return e.tokenInfo.token})},e.prototype.getInstrumentedToken=function(e,t){var n=Date.now();return d.n.resolve(this._getIdentityDataSource().then(function(t){return e===s.e&&t.getGraphToken?t.getGraphToken({resource:e}):e===c.e&&t.getSubstrateToken?t.getSubstrateToken(o.e.Default):"ocps"===e&&t.getOCPSToken?t.getOCPSToken():t.getOAuthSessionToken?t.getOAuthSessionToken(e):void 0}).then(function(e){var t=null==e?void 0:e.accessToken;if(!e||!t)throw new l.e({code:"UnableToResolveToken"});return{tokenInfo:{token:t,isGuest:!1,expirationTimeMs:e.tokenExpiry},spRequestId:e.correlationId||"",spRequestTimestamp:n}}))},e}(),f=Object(a.r)("OAuthTokenDataSource",u,{getIdentityDataSource:r.e.async.lazy}),p=Object(a.r)("OAuthTokenProviderBase",i.e,{oAuthTokenDataSource:f})},,function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a="role:1073741827",i="role:1073741826",r="role:1073741829",o="role:1073741830"},,,,function(e,t,n){"use strict";var a=n(0),i=n(178),r=n(24),o=n(1803),s=function(e){function t(t){var n=e.call(this,t)||this,a=Object(o.t)(n.element),i=n.element;return n.createBackgroundComputed(function(){var e=r.unwrap(n.valueAccessor());if(e.isSelected()){var t=e.top,o=e.containerToTop,s=e.smooth,c=a.scrollTop,d=c+a.offsetHeight,l=a.scrollHeight-a.clientHeight,u=i.offsetTop,f=u+i.offsetHeight,p=c;if(o?p=0:u<c||t?p=u:f>d&&(p=f-a.offsetHeight),(p=Math.min(p,l))===c)return;s?n.smoothScroll(a,p,c):a.scrollTop=p}}),n}return Object(a.__extends)(t,e),t.prototype.smoothScroll=function(e,t,n,a){var i=this;if(void 0===a&&(a=0),!(a>100)){var r,o=1*a/100;r=o<=.5?2*o*o:1-2*(o=1-o)*o,e.scrollTop=n+r*(t-n),this.async.setTimeout(function(){i.smoothScroll(e,t,n,a+1)},5)}},t}(i.t);t.e=s},,,,,,,,,function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return i}),function(e){e.Msa="msa_auth:",e.Graph="graph_auth:",e.MsaStrongAuth="msa_strong_auth:",e.PhoneLink="phone_link:",e.Substrate="substrate_auth:"}(a||(a={})),function(e){e[e.STI=1]="STI",e[e.Default=2]="Default"}(i||(i={}))},function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-Persona{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:.875rem;line-height:1;position:relative;width:100%}.od-Persona .od-Persona-imageArea{position:relative;display:inline-block;background-color:transparent;width:3rem;height:3rem;overflow:visible}[dir=ltr] .od-Persona .od-Persona-imageArea{margin-right:.5rem}[dir=rtl] .od-Persona .od-Persona-imageArea{margin-left:.5rem}.od-Persona .od-Persona-imageCircle{width:3rem;height:3rem;margin:0;border-radius:50%;overflow:hidden;position:absolute;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-imageCircle{left:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{right:0}[dir=ltr] .od-Persona .od-Persona-imageCircle{right:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{left:0}.od-Persona .od-Persona-initials{border-radius:50%}.od-Persona .od-Persona-placeholder{color:"},{theme:"white",defaultValue:"#fff"},{rawString:';position:absolute;font-size:2.9375rem;top:.4375rem}[dir=ltr] .od-Persona .od-Persona-placeholder{right:0}[dir=rtl] .od-Persona .od-Persona-placeholder{left:0}[dir=ltr] .od-Persona .od-Persona-placeholder{left:0}[dir=rtl] .od-Persona .od-Persona-placeholder{right:0}.od-Persona .od-Persona-image{width:3rem;height:3rem;line-height:3rem}.od-Persona .od-Persona-image[src=""]{display:none}.od-Persona .od-Persona-presence{position:absolute;height:.75rem;width:.75rem;border-radius:50%;top:auto;bottom:-.375rem;border:.125rem solid '},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-presence{left:auto}[dir=rtl] .od-Persona .od-Persona-presence{right:auto}[dir=ltr] .od-Persona .od-Persona-presence{right:-.125rem}[dir=rtl] .od-Persona .od-Persona-presence{left:-.125rem}.od-Persona .od-Persona-row{white-space:nowrap;clear:both;display:inline-block}.od-Persona.od-Persona-unresolved .od-Persona-image{display:none}.od-Persona .od-Persona-details{vertical-align:top;display:inline-block;margin-top:.25rem}.od-Persona .od-persona-link{display:inline-block;padding-bottom:.1875rem}.od-Persona .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400;font-size:1.125rem;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis;padding-bottom:.1875rem}.od-Persona .od-Persona-emailText,.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-secondaryText,.od-Persona .od-Persona-sharingRole-Text,.od-Persona .od-Persona-sharingSpinner,.od-Persona .od-Persona-tertiaryText{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-weight:400;font-size:.75rem;padding-bottom:.1875rem;white-space:nowrap;height:auto;overflow:hidden;text-overflow:ellipsis}.od-Persona .od-Persona-sharingRole-Text{margin:.125rem 0}.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-tertiaryText{display:none}.od-Persona .od-Persona-sharingRole{cursor:pointer;background:0 0;border:none;padding:0}.od-Persona .od-Persona-sharingRole .ms-Icon--ChevronDown{position:relative;top:.125rem}.od-Persona.od-Persona--mini{width:1.5rem;height:1.5rem;display:inline-block}.od-Persona.od-Persona--mini .od-Persona-image,.od-Persona.od-Persona--mini .od-Persona-imageArea,.od-Persona.od-Persona--mini .od-Persona-imageCircle{width:1.5rem;height:1.5rem;margin:0}.od-Persona.od-Persona--mini .od-Persona-details{display:none}.od-Persona.od-Persona--tiny{padding:0;display:inline-block}[dir=ltr] .od-Persona.od-Persona--tiny{margin-left:4px}[dir=rtl] .od-Persona.od-Persona--tiny{margin-right:4px}.od-Persona.od-Persona--tiny .od-Persona-image,.od-Persona.od-Persona--tiny .od-Persona-imageArea,.od-Persona.od-Persona--tiny .od-Persona-imageCircle{display:none}.od-Persona.od-Persona--tiny .od-Persona-presence{vertical-align:text-bottom;padding-top:0}.od-Persona.od-Persona--tiny .od-Persona-details{height:.875rem;margin-top:0;line-height:.875rem;overflow:visible}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-details{padding-left:.9375rem}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-details{padding-right:.9375rem}.od-Persona.od-Persona--tiny .od-Persona-presence{height:.625rem;width:.625rem;top:.625rem;border:0}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-presence{right:auto}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-presence{left:auto}.od-Persona.od-Persona--tiny .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';font-weight:400;font-size:.75rem;padding-top:.125rem}.od-Persona.od-Persona--tiny .od-Persona-optionalText,.od-Persona.od-Persona--tiny .od-Persona-secondaryText,.od-Persona.od-Persona--tiny .od-Persona-sharingRole-Text,.od-Persona.od-Persona--tiny .od-Persona-sharingSpinner,.od-Persona.od-Persona--tiny .od-Persona-tertiaryText{display:none}.od-Persona.od-Persona--tiny.od-Persona--comma{padding:0;background-color:transparent}.od-Persona.od-Persona--tiny.od-Persona--comma .od-Persona-primaryText:after{content:","}.od-Persona.od-Persona--xs .od-Persona-image,.od-Persona.od-Persona--xs .od-Persona-imageArea,.od-Persona.od-Persona--xs .od-Persona-imageCircle{width:2rem;height:2rem}.od-Persona.od-Persona--xs .od-Persona-imageArea{margin-bottom:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-right:.5rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-left:.5rem}.od-Persona.od-Persona--xs .od-Persona-image{line-height:2rem}.od-Persona.od-Persona--xs .od-Persona-placeholder{font-size:1.75rem;top:.25rem}.od-Persona.od-Persona--xs .od-Persona-presence{bottom:-.0625rem}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-presence{right:-.0625rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-presence{left:-.0625rem}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:0}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:.25rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:.25rem}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{margin-right:.25rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{margin-left:.25rem}.od-Persona.od-Persona--xs .od-Persona-primaryText{font-size:.875rem;padding-top:.1875rem}.od-Persona.od-Persona--xs .od-Persona-secondaryText{display:none}.od-Persona.od-Persona--sm .od-Persona-image,.od-Persona.od-Persona--sm .od-Persona-imageArea,.od-Persona.od-Persona--sm .od-Persona-imageCircle{width:2.5rem;height:2.5rem}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-left:.25rem}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-right:.25rem}.od-Persona.od-Persona--sm .od-Persona-image{line-height:2.5rem}.od-Persona.od-Persona--sm .od-Persona-placeholder{font-size:2.375rem;top:.3125rem}.od-Persona.od-Persona--sm .od-Persona-presence{bottom:-.0625rem;margin:0}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-presence{right:-.0625rem}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-presence{left:-.0625rem}.od-Persona.od-Persona--sm .od-Persona-primaryText{font-size:.875rem;padding:0}.od-Persona.od-Persona--sm .od-Persona-secondaryText{padding:0;margin-top:.3125rem}.od-Persona.od-Persona--lg .od-Persona-image,.od-Persona.od-Persona--lg .od-Persona-imageArea,.od-Persona.od-Persona--lg .od-Persona-imageCircle{width:4.5rem;height:4.5rem}.od-Persona.od-Persona--lg .od-Persona-imageArea{height:4.875rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:.75rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:.75rem}.od-Persona.od-Persona--lg .od-Persona-image{line-height:4.5rem;font-size:1.75rem}.od-Persona.od-Persona--lg .od-Persona-details{padding-top:.375rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:.625rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:.625rem}.od-Persona.od-Persona--lg .od-Persona-placeholder{font-size:4.25rem;top:.625rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-placeholder{left:-.3125rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-placeholder{right:-.3125rem}.od-Persona.od-Persona--lg .od-Persona-presence{height:1.25rem;width:1.25rem;bottom:.25rem;border-width:.1875rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-presence{right:-.125rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-presence{left:-.125rem}.od-Persona.od-Persona--lg .od-Persona-primaryText{font-weight:400;line-height:.75rem}.od-Persona.od-Persona--lg .od-Persona-tertiaryText{display:block}.od-Persona.od-Persona--lg .od-Persona-optionalText,.od-Persona.od-Persona--lg .od-Persona-secondaryText,.od-Persona.od-Persona--lg .od-Persona-sharingRole-Text,.od-Persona.od-Persona--lg .od-Persona-tertiaryText{line-height:.75rem;margin-top:.5rem;margin-bottom:0}.od-Persona.od-Persona--xl .od-Persona-image,.od-Persona.od-Persona--xl .od-Persona-imageArea,.od-Persona.od-Persona--xl .od-Persona-imageCircle{width:6.25rem;height:6.25rem}[dir=ltr] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-right:1.25rem}[dir=rtl] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-left:1.25rem}.od-Persona.od-Persona--xl .od-Persona-image{line-height:6.25rem;font-size:1.75rem}.od-Persona.od-Persona--xl .od-Persona-placeholder{font-size:5.9375rem;top:.75rem}.od-Persona.od-Persona--xl .od-Persona-presence{height:1.75rem;width:1.75rem;border-width:.25rem}.od-Persona.od-Persona--xl .od-Persona-primaryText{font-size:1.25rem;font-weight:300;margin-top:.125rem}.od-Persona.od-Persona--xl .od-Persona-secondaryText{padding-top:.4375rem}.od-Persona.od-Persona--xl .od-Persona-optionalText,.od-Persona.od-Persona--xl .od-Persona-tertiaryText{padding-top:.5rem;display:block}.od-Persona.od-Persona--xxl .od-Persona-image,.od-Persona.od-Persona--xxl .od-Persona-imageArea,.od-Persona.od-Persona--xxl .od-Persona-imageCircle{width:7.5rem;height:7.5rem}[dir=ltr] .od-Persona.od-Persona--xxl .od-Persona-imageArea{margin-right:1.25rem}[dir=rtl] .od-Persona.od-Persona--xxl .od-Persona-imageArea{margin-left:1.25rem}.od-Persona.od-Persona--xxl .od-Persona-image{line-height:7.5rem;font-size:1.75rem}.od-Persona.od-Persona--xxl .od-Persona-placeholder{font-size:5.9375rem;top:.75rem}.od-Persona.od-Persona--xxl .od-Persona-presence{height:1.75rem;width:1.75rem;border-width:.25rem}.od-Persona.od-Persona--xxl .od-Persona-primaryText{font-size:1.75rem;font-weight:300;margin-top:.125rem}.od-Persona.od-Persona--xxl .od-Persona-secondaryText{padding-top:.4375rem}.od-Persona.od-Persona--xxl .od-Persona-optionalText,.od-Persona.od-Persona--xxl .od-Persona-tertiaryText{padding-top:.5rem;display:block}.od-Persona.od-Persona--darkText .od-Persona-primaryText{color:'},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-Persona.od-Persona--darkText .od-Persona-optionalText,.od-Persona.od-Persona--darkText .od-Persona-secondaryText,.od-Persona.od-Persona--darkText .od-Persona-tertiaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}])},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return C});var a=n(0),i=n(1923),r=n(531),o=n(234),s=n(321),c=n(1816),d=n(1853),l=n(60),u=n(1975),f=n(1836),p=n(438),m=n(2001),_=n(1121),h=n(189),b=n(8),g=n(1983),v=n(68),y=n(128),S=n(47),D={ODB:60307},I=!b.t.isActivated("9e533ba5-9804-4d07-b199-3c62f8065367","04/05/2022","enable substrate search for spo search")&&!o.n.isFeatureEnabled({ECS:1009981}),x=!b.t.isActivated("b7426b02-fdf6-4c5e-9809-e0c21db41db7","07/10/2022","remove hard code graph endpoint and read from spPageContextInfo")&&!o.n.isFeatureEnabled({ECS:1026572}),C=function(e){function t(t,n){var a=this,i=O(t)?t:n.pageContext;a=e.call(this,{dataSourceName:"PeoplePickerDataSource"},{pageContext:i})||this;var r=O(t)?t.apiUrlHelper:n.apiUrlHelper;return a._apiUrlHelper=r||new f.e({},{itemUrlHelper:new p.e({},{pageContext:i}),pageContext:i}),a._capabilities={supportsMruCaching:!0},n&&(a._dataRequestor=n.dataRequestor,a._graphPeoplePickerHelper=n.graphPeoplePickerHelper,a._substratePeoplePickerHelper=n.substratePeoplePickerHelper,a._livePeoplePickerHelper=n.livePeoplePickerHelper,a._getAuthToken=n.getAuthToken),a._webAbsoluteUrl=i.webAbsoluteUrl,a}return Object(a.__extends)(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},a=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:n(a.Primary),managerChain:a.ManagerChain.results.map(n),directReports:a.DirectReports.results.map(n)};return i.personDetails.profilePage=Object(r.o)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard",i}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===d.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var a=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:a,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var n=this;return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:a,additionalHeaders:r,parseResponse:function(e){var a=JSON.parse(e),r=JSON.parse(a.d.ClientPeoplePickerResolveUser),o=[];o[0]=r,r.IsResolved||r.EntityData.IsBlockedOnODB&&"true"===r.EntityData.IsBlockedOnODB.toLowerCase()||(o[0].DisplayText=r.Key);var s=(o=n._transformData(o,t.filterExternalUsers))[0];return t.filterExternalUsers&&s&&s.entityType===i.e.externalUser?(s.isResolved=!1,s.entityType=i.e.regularUser):t.blockViaPolicy&&!t.filterExternalUsers&&s&&!s.isResolved&&0===s.multipleMatches.length&&(s.isResolved=!0,s.isExternal=!0,s.entityType=i.e.externalUser),t.isGraphDistributionList&&t.useGraph&&s.isExternal&&(s.entityType=i.e.group,s.principalType=d.e.distributionList),s}})})},t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();return t&&!this._dataRequestor&&(this._dataRequestor=new _.t({},{})),t},t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();return t&&!this._dataRequestor&&(this._dataRequestor=new _.t({},{})),t},t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper},t.prototype.search=function(e,t){return this.canUseSubstrate(t)||t.useNew3Ssearch?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):(I&&0===t.groupID&&(t.useSubstrateSearch=!0),this.sharePointSearch(e,t))},t.prototype.sharePointSearch=function(e,t){var n=this;return t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1),l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"ClientPeoplePickerSearchUser",additionalHeaders:r,authToken:a,parseResponse:function(a){var r=t.allowSharePointGroups,o=void 0===r||r,s=t.filterExternalUsers,c=JSON.parse(a),l=JSON.parse(c.d.ClientPeoplePickerSearchUser),u=n._transformData(l,s);return s&&(u=u.filter(function(e){return e.entityType!==i.e.externalUser})),u=u.filter(function(e){return e.principalType===d.e.sharePointGroup?o:e.principalType===d.e.securityGroup?o||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)}),n._handleZeroSearchResult(u,e,t,i.t.sharepointSearch)}})})},t.prototype.subscribePresence=function(e,t){var n=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var a=function(e){try{switch(e){default:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,a),{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,a)}catch(e){}}}}catch(e){}return null},t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,n){var a=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(r){var o;if(!r)return a.sharePointSearch(e,n);var s=x&&a._pageContext&&a._pageContext.msGraphEndpointUrl?null===(o=a._pageContext)||void 0===o?void 0:o.msGraphEndpointUrl:"https://graph.microsoft.com",c=new v.t("".concat(s,"/v1.0/me/people"));if(e)if(c.setQueryFromObject({$search:'"'.concat(e,'"'),$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"}),b.t.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&c.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var l=t._getPersonTypeFilter(n);l&&c.setQueryParameter("$filter",l)}var u=new y.e({name:"PeoplePickerGraphSearch"});return a._dataRequestor.send({apiName:"Graph.PeopleSearch",path:c.toString(),headers:{Authorization:"Bearer "+r,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){if(n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0),t&&t.value&&0!==t.value.length)u.end({resultType:S.e.Success});else if(u.end({resultType:S.e.Failure,extraData:{error:"graph search return empty results"}}),e)return a.sharePointSearch(e,n);var r=t.value,o=[];return r.forEach(function(e){if(!e.personType.subclass||!a._isIgnorablePeopleSubType(e.personType.subclass)){var t,r=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",s=e.userPrincipalName&&a._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:r,c={Key:s,IsResolved:!1},l="ImplicitContact"===e.personType.subclass,u="OrganizationUser"===e.personType.subclass,f="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,p="PublicDistributionList"===e.personType.subclass,_=Object(m.n)(a._webAbsoluteUrl,r);p&&(t=i.n.PublicDistributionList),f&&(t=i.n.unified);var h={department:e.department,email:r,image:l?void 0:_,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||r,name:e.displayName,providerName:u?"Provider":void 0,userId:s,rawData:c,rawPersonData:c,isExternal:!u,aadObjectId:e.id,fromDataSource:i.t.graph,detailedGroupInfo:t};u?(h.entityType=i.e.regularUser,h.principalType=d.e.user,h.isResolved=!0):f?(h.entityType=i.e.group,h.principalType=d.e.securityGroup,h.isResolved=!1,h.userId=e.id):(h.principalType=p?d.e.distributionList:d.e.none,h.entityType="Group"===e.personType.class?i.e.group:i.e.externalUser,h.isResolved=!1,h.providerName=void 0),h.userId&&o.push(h)}}),a._handleZeroSearchResult(o,e,n,i.t.graph)},function(t){if(u.end({resultType:S.e.Failure,extraData:{error:t}}),Object(h.r)(t))switch(t.status){case 400:case 401:case 403:case 404:return a._graphPeoplePickerHelper.disableGraphCallsForPicker(),a.sharePointSearch(e,n);default:return a.sharePointSearch(e,n)}else"Canceled"!==t.name&&a._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:a.sharePointSearch(e,n)})})},t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(a){if(!a)return n.sharePointSearch(e,t);var r=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(r=t.siteIBSegmentIDs);var c=t.useNew3Ssearch?["Mailbox","Directory","SecurityGroups"]:["Mailbox","Directory"],l={Authorization:"Bearer "+a},f="";if(o.n.isFeatureEnabled(D)){var p=t.useNew3Ssearch?["OrganizationUser","Guest","UnifiedGroup","MailUniversalSecurityGroup"]:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"],_=s.e.isValidGuid(e),g={Or:p.map(function(e){return{Term:{PeopleSubtype:e}}})},v=r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null,I=_?{Or:{Term:{ExternalDirectoryObjectId:e}}}:null,x=r||_?_?r?{And:[g,v,I]}:{And:[g,I]}:{And:[g,v]}:g;f=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:_?null:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:x}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}else f=o.n.isFeatureEnabled(D)&&!b.t.isActivated("0576d3d3-42b4-4c60-a920-0e10e34a19a0","05/13/2021","Pass SiteIBMode to 3S.")?JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}):JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}});var C=new y.e({name:"PeoplePickerSubstrateSearch"});return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:u.e+"/api/v1/suggestions",headers:l,needsAuthorization:!1,requestType:"POST",postData:f}).then(function(a){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var r=a.Groups[0]?a.Groups[0].Suggestions:[];if(0===r.length){if(C.end({resultType:S.e.Failure,extraData:{error:"substrate search return empty results"}}),e)return n.sharePointSearch(e,t)}else C.end({resultType:S.e.Success});var o=[];return r.forEach(function(e){if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var a=e.EmailAddresses[0]||e.QueryText||"",r=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:a;t.useNew3Ssearch&&!r&&e.Id&&e.Id.indexOf("@")&&(r=e.Id.substring(0,e.Id.indexOf("@")));var s,c={Key:r,IsResolved:!1},l="ImplicitContact"===e.PeopleSubtype,u="OrganizationUser"===e.PeopleSubtype,f="LinkedIn"===e.PeopleSubtype,p="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,_="PublicDistributionList"===e.PeopleSubtype,h=Object(m.n)(n._webAbsoluteUrl,a);_&&(s=i.n.PublicDistributionList),p&&(s=i.n.unified);var b={department:e.Department,office:e.OfficeLocation,email:a,image:l?void 0:h,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||a,name:e.DisplayName,providerName:"Provider",userId:r,rawData:c,rawPersonData:c,isExternal:!u,detailedGroupInfo:s};u?(b.entityType=i.e.regularUser,b.principalType=d.e.user,b.isResolved=!0):p?(b.entityType=i.e.group,b.principalType=d.e.securityGroup,b.isResolved=!1,b.providerName=void 0):f?b.entityType=i.e.linkedinUser:(b.principalType=_?d.e.distributionList:d.e.none,b.entityType="Group"===e.PeopleType?i.e.group:i.e.externalUser,b.isResolved=!1,b.providerName=void 0),b.userId&&o.push(b)}}),n._handleZeroSearchResult(o,e,t,i.t.substrate)},function(a){if(C.end({resultType:S.e.Failure,extraData:{error:a}}),Object(h.r)(a))switch(a.status){case 400:case 401:case 403:case 404:return n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else"Canceled"!==a.name&&(n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t));return null})})},t.prototype._handleZeroSearchResult=function(e,t,n,a){if(!t)return e;if(!1!==n.resolveEmailIfNoResults&&0===e.length&&this._isValidEmail(t,!1)){var r={Key:t,IsResolved:!1};e.push({email:t,entityType:i.e.externalUser,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:t,name:t,userId:t,rawData:r,rawPersonData:r,isExternal:!0,fromDataSource:a})}return e},t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&g.e.isValidEmailSyntax(e,!1):!t},t._getPersonTypeFilter=function(e){var t="";return e.principalType&d.e.user&&(t+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'"),e.principalType&d.e.securityGroup&&(t&&(t+=" or "),t+="personType/subclass eq 'UnifiedGroup'"),e.principalType&d.e.distributionList&&null!==e.filterPublicDistributionList&&e.filterPublicDistributionList!==!b.t.isActivated("18c99317-6e4f-4859-85bf-b127709b6eff","01/28/2022","Include public distribuition list in filter by default")&&(t&&(t+=" or "),t+="personType/subclass eq 'PublicDistributionList'"),t},t.prototype._isIgnorablePeopleSubType=function(e){return!!e&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})},t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var a=e.EntityData,r={name:e.DisplayText,email:a.Email,userId:e.Key,job:a.Title,department:a.Department,phone:a.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};r.multipleMatches.length>0&&(r.multipleMatches=n._transformData(r.multipleMatches,t),t&&(r.multipleMatches=r.multipleMatches.filter(function(e){return e.entityType!==i.e.externalUser})));var o=r.email;r.isResolved&&(r.image=o?Object(m.n)(n._webAbsoluteUrl,o):null);var s=a.PrincipalType||e.EntityType;switch(s){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":r.entityType=i.e.externalUser,r.principalType=d.e.user,r.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":case"SecurityGroup":if(!b.t.isActivated("5bcee89c-f8f5-4973-82d2-ab06c37b03e0","1/25/2025","Fix bug: SharePointSearch result principleType of SecurityGroup was treated as user type")||"SecurityGroup"!==s){r.entityType=i.e.group,r.principalType="SharePointGroup"===s?d.e.sharePointGroup:d.e.securityGroup,r.detailedGroupInfo="SharePointGroup"===s?i.n.SPGroup:i.n.securityGroup;break}default:r.entityType=i.e.regularUser,r.principalType=d.e.user}return r})},t}(c.t);function O(e){return!!e.webAbsoluteUrl}},,,,,,,,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.valid=0]="valid",e[e.warning=1]="warning",e[e.invalid=2]="invalid"}(a||(a={}))},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(232),r=Object(i.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(536).then(n.bind(null,2497))];case 1:return[2,e.sent().default]}})})})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(111),i=function(){var e,t=Object(a.e)();return!!(null===(e=null==t?void 0:t.navigator)||void 0===e?void 0:e.userAgent)&&t.navigator.userAgent.indexOf("rv:11.0")>-1}},,function(e,t,n){"use strict";var a=n(101),i=n(188),r={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},o={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},s=function(){function e(e,t){this._scope=new i.e,this._events=new(this._scope.attached(a.t))(this),this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n},this._windowWidth=0,this._windowHeight=0,this._onContainerResize()}return e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}},e.determineWindowSize=function(e,t){if(void 0===t&&(t=o),0===e)return"Medium";for(var n in o)if(e<t[n])return n},e.determineCssClass=function(e){return r[e]},e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden",n.width="100px",n.msOverflowStyle="scrollbar",n.overflow="scroll",t.style.width="100%",document.body.appendChild(e),e.appendChild(t);var a=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var r=a-i;return this.getScrollbarWidth=function(){return r},r},Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._scope.dispose()},e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]},e.prototype._afterContainerResize=function(){},e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,a=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,r=this._formFactorSize=e.determineWindowSize(a,this._breakpoints());this._cssClass=e.determineCssClass(r);var s=this._isHamburgerVisible;this._isHamburgerVisible=a<o.Large;var c=this._showLabels;this._showLabels=this.compareSize(r,"Medium")>0,i&&r!==i&&this._events.raise("formFactorChange"),"boolean"==typeof s&&s!==this._isHamburgerVisible&&this._events.raise("hamburgerVisibilityChange"),"boolean"==typeof c&&c!==this._showLabels&&this._events.raise("showCommandLabelsChange"),this._afterContainerResize()},e.DEFAULT_BREAKPOINTS=o,e.MAC_SCROLL_BAR_WIDTH=8,e}();t.e=s},function(e,t,n){"use strict";var a=n(24),i=n(1108),r=function(){function e(){}return e.init=function(e,t,n,r,o){var s=t(),c={Enter:function(e){return s(!s()),!1}},d=new i.e({element:e,bindingContext:o,allBindingsAccessor:n,valueAccessor:function(){return c}});a.applyBindingsToNode(e,d,o),a.applyBindingsToNode(e,{click:function(){return s(!s())}},o)},e}();t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a,i=n(1526),r=n(0),o=n(1),s=n(1927),c=n(476),d=n(809),l=n(1104),u=n(524),f=n(587),p=n(1749),m=n(823),_=n(109),h=n(111),b=n(2107),g=Object(d.e)(),v=function(e){function t(t){var n=e.call(this,t)||this;n._textElement=o.createRef(),n._onFocus=function(e){n.props.onFocus&&n.props.onFocus(e),n.setState({isFocused:!0},function(){n.props.validateOnFocusIn&&n._validate(n.value)})},n._onBlur=function(e){n.props.onBlur&&n.props.onBlur(e),n.setState({isFocused:!1},function(){n.props.validateOnFocusOut&&n._validate(n.value)})},n._onRenderLabel=function(e){var t=e.label,a=e.required,i=n._classNames.subComponentStyles?n._classNames.subComponentStyles.label:void 0;return t?o.createElement(s.e,{required:a,htmlFor:n._id,styles:i,disabled:e.disabled,id:n._labelId},e.label):null},n._onRenderDescription=function(e){return e.description?o.createElement("span",{className:n._classNames.description},e.description):null},n._onRevealButtonClick=function(e){n.setState(function(e){return{isRevealingPassword:!e.isRevealingPassword}})},n._onInputChange=function(e){var t,a,i=e.target.value,r=y(n.props,n.state)||"";void 0!==i&&i!==n._lastChangeValue&&i!==r?(n._lastChangeValue=i,null===(a=(t=n.props).onChange)||void 0===a||a.call(t,e,i),n._isControlled||n.setState({uncontrolledValue:i})):n._lastChangeValue=void 0},Object(l.e)(n),n._async=new u.e(n),n._fallbackId=Object(f.e)("TextField"),n._descriptionId=Object(f.e)("TextFieldDescription"),n._labelId=Object(f.e)("TextFieldLabel"),n._prefixId=Object(f.e)("TextFieldPrefix"),n._suffixId=Object(f.e)("TextFieldSuffix"),n._warnControlledUsage();var a=t.defaultValue,i=void 0===a?"":a;return"number"==typeof i&&(i=String(i)),n.state={uncontrolledValue:n._isControlled?void 0:i,isFocused:!1,errorMessage:""},n._delayedValidate=n._async.debounce(n._validate,n.props.deferredValidationTime),n._lastValidation=0,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return y(this.props,this.state)},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this._adjustInputHeight(),this.props.validateOnLoad&&this._validate(this.value)},t.prototype.componentWillUnmount=function(){this._async.dispose()},t.prototype.getSnapshotBeforeUpdate=function(e,t){return{selection:[this.selectionStart,this.selectionEnd]}},t.prototype.componentDidUpdate=function(e,t,n){var a=this.props,i=(n||{}).selection,r=void 0===i?[null,null]:i,o=r[0],s=r[1];!!e.multiline!=!!a.multiline&&t.isFocused&&(this.focus(),null!==o&&null!==s&&o>=0&&s>=0&&this.setSelectionRange(o,s)),e.value!==a.value&&(this._lastChangeValue=void 0);var c=y(e,t),d=this.value;c!==d&&(this._warnControlledUsage(e),this.state.errorMessage&&!a.errorMessage&&this.setState({errorMessage:""}),this._adjustInputHeight(),S(a)&&this._delayedValidate(d))},t.prototype.render=function(){var e=this.props,t=e.borderless,n=e.className,i=e.disabled,s=e.invalid,d=e.iconProps,l=e.inputClassName,u=e.label,f=e.multiline,m=e.required,_=e.underlined,v=e.prefix,y=e.resizable,S=e.suffix,D=e.theme,I=e.styles,x=e.autoAdjustHeight,C=e.canRevealPassword,O=e.revealPasswordAriaLabel,w=e.type,E=e.onRenderPrefix,A=void 0===E?this._onRenderPrefix:E,L=e.onRenderSuffix,k=void 0===L?this._onRenderSuffix:L,M=e.onRenderLabel,P=void 0===M?this._onRenderLabel:M,T=e.onRenderDescription,U=void 0===T?this._onRenderDescription:T,F=this.state,H=F.isFocused,R=F.isRevealingPassword,N=this._errorMessage,B="boolean"==typeof s?s:!!N,j=!!C&&"password"===w&&function(){if("boolean"!=typeof a){var e=Object(h.e)();if(null==e?void 0:e.navigator){var t=/Edg/.test(e.navigator.userAgent||"");a=!(Object(b.e)()||t)}else a=!0}return a}(),V=this._classNames=g(I,{theme:D,className:n,disabled:i,focused:H,required:m,multiline:f,hasLabel:!!u,hasErrorMessage:B,borderless:t,resizable:y,hasIcon:!!d,underlined:_,inputClassName:l,autoAdjustHeight:x,hasRevealButton:j});return o.createElement("div",{ref:this.props.elementRef,className:V.root},o.createElement("div",{className:V.wrapper},P(this.props,this._onRenderLabel),o.createElement("div",{className:V.fieldGroup},(void 0!==v||this.props.onRenderPrefix)&&o.createElement("div",{className:V.prefix,id:this._prefixId},A(this.props,this._onRenderPrefix)),f?this._renderTextArea():this._renderInput(),d&&o.createElement(c.e,Object(r.__assign)({className:V.icon},d)),j&&o.createElement("button",{"aria-label":O,className:V.revealButton,onClick:this._onRevealButtonClick,"aria-pressed":!!R,type:"button"},o.createElement("span",{className:V.revealSpan},o.createElement(c.e,{className:V.revealIcon,iconName:R?"Hide":"RedEye"}))),(void 0!==S||this.props.onRenderSuffix)&&o.createElement("div",{className:V.suffix,id:this._suffixId},k(this.props,this._onRenderSuffix)))),this._isDescriptionAvailable&&o.createElement("span",{id:this._descriptionId},U(this.props,this._onRenderDescription),N&&o.createElement("div",{role:"alert"},o.createElement(p.e,null,this._renderErrorMessage()))))},t.prototype.focus=function(){this._textElement.current&&this._textElement.current.focus()},t.prototype.blur=function(){this._textElement.current&&this._textElement.current.blur()},t.prototype.select=function(){this._textElement.current&&this._textElement.current.select()},t.prototype.setSelectionStart=function(e){this._textElement.current&&(this._textElement.current.selectionStart=e)},t.prototype.setSelectionEnd=function(e){this._textElement.current&&(this._textElement.current.selectionEnd=e)},Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._textElement.current?this._textElement.current.selectionStart:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._textElement.current?this._textElement.current.selectionEnd:-1},enumerable:!1,configurable:!0}),t.prototype.setSelectionRange=function(e,t){this._textElement.current&&this._textElement.current.setSelectionRange(e,t)},t.prototype._warnControlledUsage=function(e){this._id,this.props,null!==this.props.value||this._hasWarnedNullValue||(this._hasWarnedNullValue=!0,Object(m.e)("Warning: 'value' prop on 'TextField' should not be null. Consider using an empty string to clear the component or undefined to indicate an uncontrolled component."))},Object.defineProperty(t.prototype,"_id",{get:function(){return this.props.id||this._fallbackId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isControlled",{get:function(){return void 0!==(e=this.props).value&&null!==e.value;var e},enumerable:!1,configurable:!0}),t.prototype._onRenderPrefix=function(e){var t=e.prefix;return o.createElement("span",{style:{paddingBottom:"1px"}},t)},t.prototype._onRenderSuffix=function(e){var t=e.suffix;return o.createElement("span",{style:{paddingBottom:"1px"}},t)},Object.defineProperty(t.prototype,"_errorMessage",{get:function(){var e=this.props.errorMessage;return(void 0===e?this.state.errorMessage:e)||""},enumerable:!1,configurable:!0}),t.prototype._renderErrorMessage=function(){var e=this._errorMessage;return e?"string"==typeof e?o.createElement("p",{className:this._classNames.errorMessage},o.createElement("span",{"data-automation-id":"error-message"},e)):o.createElement("div",{className:this._classNames.errorMessage,"data-automation-id":"error-message"},e):null},Object.defineProperty(t.prototype,"_isDescriptionAvailable",{get:function(){var e=this.props;return!!(e.onRenderDescription||e.description||this._errorMessage)},enumerable:!1,configurable:!0}),t.prototype._renderTextArea=function(){var e=this.props.invalid,t=void 0===e?!!this._errorMessage:e,n=Object(_.s)(this.props,_.y,["defaultValue"]),a=this.props["aria-labelledby"]||(this.props.label?this._labelId:void 0);return o.createElement("textarea",Object(r.__assign)({id:this._id},n,{ref:this._textElement,value:this.value||"",onInput:this._onInputChange,onChange:this._onInputChange,className:this._classNames.field,"aria-labelledby":a,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:this.props["aria-describedby"],"aria-invalid":t,"aria-label":this.props.ariaLabel,readOnly:this.props.readOnly,onFocus:this._onFocus,onBlur:this._onBlur}))},t.prototype._renderInput=function(){var e=this.props,t=e.ariaLabel,n=e.invalid,a=void 0===n?!!this._errorMessage:n,i=e.onRenderPrefix,s=e.onRenderSuffix,c=e.prefix,d=e.suffix,l=e.type,u=void 0===l?"text":l,f=[];e.label&&f.push(this._labelId),(void 0!==c||i)&&f.push(this._prefixId),(void 0!==d||s)&&f.push(this._suffixId);var p=Object(r.__assign)(Object(r.__assign)({type:this.state.isRevealingPassword?"text":u,id:this._id},Object(_.s)(this.props,_.f,["defaultValue","type"])),{"aria-labelledby":this.props["aria-labelledby"]||(f.length>0?f.join(" "):void 0),ref:this._textElement,value:this.value||"",onInput:this._onInputChange,onChange:this._onInputChange,className:this._classNames.field,"aria-label":t,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:this.props["aria-describedby"],"aria-invalid":a,onFocus:this._onFocus,onBlur:this._onBlur}),m=function(e){return o.createElement("input",Object(r.__assign)({},e))};return(this.props.onRenderInput||m)(p,m)},t.prototype._validate=function(e){var t=this;if(this._latestValidateValue!==e||!S(this.props)){this._latestValidateValue=e;var n=this.props.onGetErrorMessage,a=n&&n(e||"");if(void 0!==a)if("string"!=typeof a&&"then"in a){var i=++this._lastValidation;a.then(function(n){i===t._lastValidation&&t.setState({errorMessage:n}),t._notifyAfterValidate(e,n)})}else this.setState({errorMessage:a}),this._notifyAfterValidate(e,a);else this._notifyAfterValidate(e,"")}},t.prototype._notifyAfterValidate=function(e,t){e===this.value&&this.props.onNotifyValidationResult&&this.props.onNotifyValidationResult(t,e)},t.prototype._adjustInputHeight=function(){if(this._textElement.current&&this.props.autoAdjustHeight&&this.props.multiline){var e=this._textElement.current;e.style.height="",e.style.height=e.scrollHeight+"px"}},t.defaultProps={resizable:!0,deferredValidationTime:200,validateOnLoad:!0},t}(o.Component);function y(e,t){var n=e.value,a=void 0===n?t.uncontrolledValue:n;return"number"==typeof a?String(a):a}function S(e){return!(e.validateOnFocusIn||e.validateOnFocusOut)}var D=n(1932),I=Object(i.e)(v,D.e,void 0,{scope:"TextField"})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=n(0),i=n(21),r=n(525),o={root:"ms-Suggestions-item",itemButton:"ms-Suggestions-itemButton",closeButton:"ms-Suggestions-closeButton",isSuggested:"is-suggested"};function s(e){var t,n,s,c,d,l,u=e.className,f=e.theme,p=e.suggested,m=f.palette,_=f.semanticColors,h=Object(i.I)(o,f);return{root:[h.root,{display:"flex",alignItems:"stretch",boxSizing:"border-box",width:"100%",position:"relative",selectors:{"&:hover":{background:_.menuItemBackgroundHovered},"&:hover .ms-Suggestions-closeButton":{display:"block"}}},p&&{selectors:(t={},t["."+r.e+" &"]={selectors:(n={},n["."+h.closeButton]={display:"block",background:_.menuItemBackgroundPressed},n)},t[":after"]={pointerEvents:"none",content:'""',position:"absolute",left:0,top:0,bottom:0,right:0,border:"1px solid "+f.semanticColors.focusBorder},t)},u],itemButton:[h.itemButton,{width:"100%",padding:0,border:"none",height:"100%",minWidth:0,overflow:"hidden",selectors:(s={},s[i.o]={color:"WindowText",selectors:{":hover":Object(a.__assign)({background:"Highlight",color:"HighlightText"},Object(i.x)())}},s[":hover"]={color:_.menuItemTextHovered},s)},p&&[h.isSuggested,{background:_.menuItemBackgroundPressed,selectors:(c={":hover":{background:_.menuDivider}},c[i.o]=Object(a.__assign)({background:"Highlight",color:"HighlightText"},Object(i.x)()),c)}]],closeButton:[h.closeButton,{display:"none",color:m.neutralSecondary,padding:"0 4px",height:"auto",width:32,selectors:(d={":hover, :active":{background:m.neutralTertiaryAlt,color:m.neutralDark}},d[i.o]={color:"WindowText"},d)},p&&(l={},l["."+r.e+" &"]={selectors:{":hover, :active":{background:m.neutralTertiary}}},l.selectors={":hover, :active":{background:m.neutralTertiary,color:m.neutralPrimary}},l)]}}},,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:'.od-DialogOverlay{display:none}.od-Dialog{background-color:transparent;position:absolute;top:48px;bottom:0;width:100%;display:block;font-size:0;line-height:100vh;text-align:center;display:flex;align-items:center}[dir=ltr] .od-Dialog{left:0}[dir=rtl] .od-Dialog{right:0}.od-Dialog::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.sm .od-Dialog{align-items:flex-start;box-sizing:border-box;padding:0}.od-Dialog-main{vertical-align:middle;display:inline-block;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box;line-height:normal;width:100%;min-height:100px;outline:0;visibility:hidden;box-shadow:0 25.6px 57.6px 0 rgba(0,0,0,.22),0 4.8px 14.4px 0 rgba(0,0,0,.18);border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";overflow:hidden}.sm .od-Dialog-main{height:100%}html[dir=ltr] .od-Dialog-main{text-align:left}html[dir=rtl] .od-Dialog-main{text-align:right}@media screen and (-ms-high-contrast:active){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"white",defaultValue:"#fff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"black",defaultValue:"#000"},{rawString:" inset}}.od-Dialog-main:focus{outline:0}.od-Dialog-main--dialog{margin:auto;position:relative}.od-Dialog-main--callout{position:absolute}.od-Dialog-main--visible{visibility:visible}.od-Dialog-main--sm{width:360px}.od-Dialog-main--sm.od-Dialog-main-style--blocker{width:340px}.od-Dialog-main--sm.od-Dialog-main-style--vaultBlocker{width:620px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel{top:0;width:auto;position:absolute;bottom:0;left:0;right:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button{display:inline-flex;align-items:center}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary{border:none}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled:before,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled:before{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label{display:inline-block;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog-main--md{max-width:480px}.od-Dialog-main--lg{max-width:640px}.od-Dialog-main--xlg{max-width:1024px}.od-Dialog-main--xxlg{max-width:1366px}.od-Dialog-main--xxxlg{max-width:1920px}.isFluentVNext .od-Dialog-main{border-radius:4px;box-shadow:0 6.4px 14.4px 0 rgba(0,0,0,.132),0 1.2px 3.6px 0 rgba(0,0,0,.108)}.od-Dialog-button.od-Dialog-button--close{display:none}.sm .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{display:block;position:absolute;margin:0;border:0;background:0 0;cursor:pointer;top:5px;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";line-height:32px;height:32px;width:32px;padding:0;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{right:5px}[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{left:5px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:16px;color:inherit}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px;line-height:20px}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:20px}.od-Dialog-subText{margin:0 0 20px 0;font-weight:300;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Dialog-subText.od-Dialog-subText--s{font-size:12px}.od-Dialog-subText.od-Dialog-subText--m{font-size:14px}.od-Dialog-subText.od-Dialog-subText--l{font-size:17px}.od-Dialog-content{position:relative;width:100%}.sm .od-Dialog-content{height:100%}.od-Dialog-content .od-Button.od-Button--compound:not(:last-child){margin-bottom:20px}.ms-ModalOverlay{display:block;position:absolute;cursor:pointer;left:0;right:0;top:0;bottom:0;background-color:"},{theme:"whiteTranslucent40",defaultValue:"rgba(255,255,255,.4)"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-ModalOverlay{display:none}}.od-Dialog--multiline{width:95%}[dir=ltr] .od-Dialog-button--close{right:14px}[dir=rtl] .od-Dialog-button--close{left:14px}[dir=ltr] .od-Dialog-button--close{left:auto}[dir=rtl] .od-Dialog-button--close{right:auto}.od-Dialog-content{font-size:14px;line-height:20px}.od-OverlayHost-overlay .ms-ModalOverlay{animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay .ms-ModalOverlay{animation:none}}.od-OverlayHost-overlay .od-Dialog-main{animation-name:ms-fadeIn,ms-slideDownIn10;animation-duration:167ms;animation-timing-function:cubic-bezier(0.1,0.25,0.75,0.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay .od-Dialog-main{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{animation-name:ms-fadeOut;animation-duration:167ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog-main{animation-name:ms-fadeOut,ms-slideUpOut10;animation-duration:167ms;animation-timing-function:cubic-bezier(0.1,0.25,0.75,0.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog-main{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog{visibility:hidden;transition:visibility 0s linear 267ms}"}])},function(e,t,n){"use strict";function a(e){return e}n.d(t,"e",function(){return a})},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return y});var a=n(1526),i=n(0),r=n(1),o=n(1754),s=n(1600),c=n(2034),d=n(809),l=n(1002),u=n(476),f=Object(d.e)(),p=r.forwardRef(function(e,t){var n=e.disabled,a=e.required,d=e.inputProps,p=e.name,m=e.ariaLabel,_=e.ariaLabelledBy,h=e.ariaDescribedBy,b=e.ariaPositionInSet,g=e.ariaSetSize,v=e.title,y=e.checkmarkIconProps,S=e.styles,D=e.theme,I=e.className,x=e.boxSide,C=void 0===x?"start":x,O=Object(o.e)("checkbox-",e.id),w=r.useRef(null),E=Object(s.e)(w,t),A=r.useRef(null),L=Object(c.e)(e.checked,e.defaultChecked,e.onChange),k=L[0],M=L[1],P=Object(c.e)(e.indeterminate,e.defaultIndeterminate),T=P[0],U=P[1];Object(l.n)(w);var F=f(S,{theme:D,className:I,disabled:n,indeterminate:T,checked:k,reversed:"start"!==C,isUsingCustomLabelRender:!!e.onRenderLabel}),H=r.useCallback(function(e){T?(M(!!k,e),U(!1)):M(!k,e)},[M,U,T,k]),R=r.useCallback(function(e){return e&&e.label?r.createElement("span",{className:F.text,title:e.title},e.label):null},[F.text]),N=r.useCallback(function(e){if(A.current){var t=!!e;A.current.indeterminate=t,U(t)}},[U]);!function(e,t,n,a,i){r.useImperativeHandle(e.componentRef,function(){return{get checked(){return!!t},get indeterminate(){return!!n},set indeterminate(e){a(e)},focus:function(){i.current&&i.current.focus()}}},[i,t,n,a])}(e,k,T,N,A),r.useEffect(function(){return N(T)},[N,T]);var B=e.onRenderLabel||R,j=T?"mixed":void 0,V=Object(i.__assign)(Object(i.__assign)({className:F.input,type:"checkbox"},d),{checked:!!k,disabled:n,required:a,name:p,id:O,title:v,onChange:H,"aria-disabled":n,"aria-label":m,"aria-labelledby":_,"aria-describedby":h,"aria-posinset":b,"aria-setsize":g,"aria-checked":j});return r.createElement("div",{className:F.root,title:v,ref:E},r.createElement("input",Object(i.__assign)({},V,{ref:A,title:v,"data-ktp-execute-target":!0})),r.createElement("label",{className:F.label,htmlFor:O},r.createElement("div",{className:F.checkbox,"data-ktp-target":!0},r.createElement(u.e,Object(i.__assign)({iconName:"CheckMark"},y,{className:F.checkmark}))),B(e,R)))});p.displayName="CheckboxBase";var m=n(21),_=n(525),h={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"},b="20px",g="200ms",v="cubic-bezier(.4, 0, .23, 1)",y=Object(a.e)(p,function(e){var t,n,a,r,o,s,c,d,l,u,f,p,y,S,D,I,x,C,O=e.className,w=e.theme,E=e.reversed,A=e.checked,L=e.disabled,k=e.isUsingCustomLabelRender,M=e.indeterminate,P=w.semanticColors,T=w.effects,U=w.palette,F=w.fonts,H=Object(m.I)(h,w),R=P.inputForegroundChecked,N=U.neutralSecondary,B=U.neutralPrimary,j=P.inputBackgroundChecked,V=P.inputBackgroundChecked,z=P.disabledBodySubtext,G=P.inputBorderHovered,K=P.inputBackgroundCheckedHovered,W=P.inputBackgroundChecked,q=P.inputBackgroundCheckedHovered,Q=P.inputBackgroundCheckedHovered,Y=P.inputTextHovered,J=P.disabledBodySubtext,X=P.bodyText,Z=P.disabledText,$=[(t={content:'""',borderRadius:T.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:L?z:j,transitionProperty:"border-width, border, border-color",transitionDuration:g,transitionTimingFunction:v},t[m.o]={borderColor:"WindowText"},t)];return{root:[H.root,{position:"relative",display:"flex"},E&&"reversed",A&&"is-checked",!L&&"is-enabled",L&&"is-disabled",!L&&[!A&&(n={},n[":hover ."+H.checkbox]=(a={borderColor:G},a[m.o]={borderColor:"Highlight"},a),n[":focus ."+H.checkbox]={borderColor:G},n[":hover ."+H.checkmark]=(r={color:N,opacity:"1"},r[m.o]={color:"Highlight"},r),n),A&&!M&&(o={},o[":hover ."+H.checkbox]={background:q,borderColor:Q},o[":focus ."+H.checkbox]={background:q,borderColor:Q},o[m.o]=(s={},s[":hover ."+H.checkbox]={background:"Highlight",borderColor:"Highlight"},s[":focus ."+H.checkbox]={background:"Highlight"},s[":focus:hover ."+H.checkbox]={background:"Highlight"},s[":focus:hover ."+H.checkmark]={color:"Window"},s[":hover ."+H.checkmark]={color:"Window"},s),o),M&&(c={},c[":hover ."+H.checkbox+", :hover ."+H.checkbox+":after"]=(d={borderColor:K},d[m.o]={borderColor:"WindowText"},d),c[":focus ."+H.checkbox]={borderColor:K},c[":hover ."+H.checkmark]={opacity:"0"},c),(l={},l[":hover ."+H.text+", :focus ."+H.text]=(u={color:Y},u[m.o]={color:L?"GrayText":"WindowText"},u),l)],O],input:(f={position:"absolute",background:"none",opacity:0},f["."+_.e+" &:focus + label::before"]=(p={outline:"1px solid "+w.palette.neutralSecondary,outlineOffset:"2px"},p[m.o]={outline:"1px solid WindowText"},p),f),label:[H.label,w.fonts.medium,{display:"flex",alignItems:k?"center":"flex-start",cursor:L?"default":"pointer",position:"relative",userSelect:"none"},E&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[H.checkbox,(y={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:b,width:b,border:"1px solid "+B,borderRadius:T.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:g,transitionTimingFunction:v,overflow:"hidden",":after":M?$:null},y[m.o]=Object(i.__assign)({borderColor:"WindowText"},Object(m.x)()),y),M&&{borderColor:j},E?{marginLeft:4}:{marginRight:4},!L&&!M&&A&&(S={background:W,borderColor:V},S[m.o]={background:"Highlight",borderColor:"Highlight"},S),L&&(D={borderColor:z},D[m.o]={borderColor:"GrayText"},D),A&&L&&(I={background:J,borderColor:z},I[m.o]={background:"Window"},I)],checkmark:[H.checkmark,(x={opacity:A&&!M?"1":"0",color:R},x[m.o]=Object(i.__assign)({color:L?"GrayText":"Window"},Object(m.x)()),x)],text:[H.text,(C={color:L?Z:X,fontSize:F.medium.fontSize,lineHeight:"20px"},C[m.o]=Object(i.__assign)({color:L?"GrayText":"WindowText"},Object(m.x)()),C),E?{marginRight:4}:{marginLeft:4}]}},void 0,{scope:"Checkbox"})},,,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.normal=0]="normal",e[e.listBelow=1]="listBelow"}(a||(a={}))},,,,function(e,t){var n,a,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var c,d=[],l=!1,u=-1;function f(){l&&c&&(l=!1,c.length?d=c.concat(d):u=-1,d.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=d.length;t;){for(c=d,d=[];++u<t;)c&&c[u].run();u=-1,t=d.length}c=null,l=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new m(e,t)),1!==d.length||l||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(593),r=n(229),o=n(536),s=n(216),c=n(534),d="ShareControl",l=function(){function e(e){void 0===e&&(e="sharedialog");var t=this;this.resetRumOneApiMeasurement=function(){t._rumone.undoAPIInstrument()},this.computeRenderTime=function(e){return e&&e.startTime&&e.endTime?e.endTime-e.startTime:0},this.checkRenderTimeRequiredDataAvailable=function(e){return!!e&&!!e.startTime&&!!e.endTime},this._rumone=i.e.getRUMOneLogger(e)}return e.prototype.logSharingPerformance=function(e,t){var n=this;if(this._rumone&&this._rumone.isRunning()){var i=this.breakdownData;this._rumone.writeScenarioId("ShareDialog.".concat(e.modeName)),this._rumone.addExpectedControl(d),this._rumone.writePageTransitionType(t||r.e.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();var s=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0;s&&(this._rumone.collectSPClientFlights(window._spPageContextInfo),this._evaluateExperiments(window._spPageContextInfo)),this._rumone.setSettings({TTISettings:{TTIPolyfillSettings:{enabled:!0,calculateTTI:function(t,a,i){var r=n._regulateTime(t)-n._regulateTime(e.startTime);return n._rumone.addEUPLBreakdown("ttiAbsoluteTime_".concat(i),{data:t,needFlatten:!1}),n._rumone.addEUPLBreakdown("transactionStartTime_".concat(i),{data:e.startTime,needFlatten:!1}),n._rumone.addEUPLBreakdown(i,{data:r,needFlatten:!1}),r},options:Object(a.__assign)({useMutationObserver:!1,trackNetworkRequests:!1},{requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3})},FCIMeasurementSettings:{disabled:!0}}});var c=new o.e({controlId:d,startTime:e.startTime,endTime:e.endTime,renderTimeCalculator:this.computeRenderTime,renderTimeRequiredDataChecker:this.checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(c);var l=e.breakDownData,u=this._getResponseEnd();l=Object(a.__assign)(Object(a.__assign)({},l),{waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),herf:i(location.href),isShareDialogASPXHosted:i(s),w3cResponseEnd:i(u-performance.timing.navigationStart),appStart:i(this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart"))-this._regulateTime(u)),render:i(this._regulateTime(e.endTime)-this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")))}),this._rumone.writeEUPLBreakdown(JSON.stringify(l))}},e.prototype.resetRumOne=function(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)},e.prototype.breakdownData=function(e){return{data:e,needFlatten:!0}},e.prototype._isDateTime=function(e){var t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()},e.prototype._regulateTime=function(e){return this._isDateTime(e)&&s.e?e-performance.timing.navigationStart:e},e.prototype._getResponseEnd=function(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN},e.prototype._evaluateExperiments=function(e){e&&Object(c.n)(90089,e)},e}()},function(e,t,n){"use strict";var a=n(0),i=n(1),r=n(2150),o=n(1993),s=n(1952),c=n(1830),d=n(1818),l=n(1992),u=n(1801),f=n(1919);t.e=function(e){var t={hideItemName:!e.singleComponent,doNotrenderHeaderButtons:!e.singleComponent,titleIsSubLevel:!0,sendButtonType:e.singleComponent?s.e.button:s.e.copyLink,shouldBeFocused:e.singleComponent,hostOptions:e.hostOptions};return i.createElement("div",{className:"od-ShareMain-section new"},i.createElement(r.e,Object(a.__assign)({},Object(c.e)(e),{item:e.sharingInformation.item,viewState:d.e.copyLinkShortcut,title:u.Ke,hideItemName:t.hideItemName,doNotrenderHeaderButtons:t.doNotrenderHeaderButtons,titleIsSubLevel:t.titleIsSubLevel,hostOptions:t.hostOptions})),i.createElement("div",{className:"od-ShareMain-copyLink shareType-section"},i.createElement(l.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:function(){e.onShareHintClick(f.t.CopyLinkSettingsHint,!0)},sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig}),i.createElement("div",{className:"od-ShareMain-copyLink copyLink-button"},i.createElement(o.e,{ctaLabel:u.We,currentSettings:e.currentSettings,linkRecipients:null,onSendLinkClicked:e.onSendLinkClicked,permissionsMap:null,sharingInformation:e.sharingInformation,sendButtonType:t.sendButtonType,shouldBeFocused:t.shouldBeFocused}))))}},function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsSettings .ms-Checkbox{min-height:0}.od-PermissionsSettings .ms-Checkbox-label{margin-top:0}.od-PermissionsSettings .ms-Checkbox-label::before{width:1.25rem;height:1.25rem}.od-PermissionsSettings .ms-Checkbox-label::after{font-size:1rem;line-height:1.25rem;width:1.25rem}.od-PermissionsSettings .ms-PeoplePicker{margin-top:5px}.od-PermissionsSettings-section{padding-bottom:1.25rem}.od-PermissionsSettings-section.new{padding:0;margin:0}.od-PermissionsSettings-section.other-settings{padding-top:24px}.od-PermissionsSettings-description.header{padding-bottom:8px;font-size:.875rem;font-weight:600;font:-apple-system-body}[dir=ltr] .od-PermissionsSettings-description.header .od-PermissionsSettings-description-textpart{margin-right:3px}[dir=rtl] .od-PermissionsSettings-description.header .od-PermissionsSettings-description-textpart{margin-left:3px}.od-PermissionsSettings-description.header.new{padding:0 0 8px 0!important;margin:0}.od-PermissionsSettings-otherSettings{margin:0}.od-PermissionsSettings-linksFromTemplateHeader{font-weight:400}.od-PermissionsSetting-specificPeople-container{margin-top:5px;font-size:.875rem}[dir=ltr] .od-PermissionsSetting-specificPeople-container{margin-left:27px}[dir=rtl] .od-PermissionsSetting-specificPeople-container{margin-right:27px}[dir=ltr] .od-PermissionsSetting-specificPeople-container{margin-right:10px}[dir=rtl] .od-PermissionsSetting-specificPeople-container{margin-left:10px}.od-PermissionsSetting-specificPeople-list{max-height:60px;overflow-y:auto;padding-bottom:2px}.od-PermissionsSetting-specificPeople-list a{text-decoration:none;outline:transparent;position:relative}.od-PermissionsSetting-specificPeople-list a::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSetting-specificPeople-list a:focus:after{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{margin:0}[dir=ltr] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-left:20px}[dir=rtl] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-right:20px}.od-PermissionsSettings-setting{margin-bottom:12px}.od-PermissionsSettings-setting span.ms-Checkbox-text{font:-apple-system-caption1}.od-PermissionsSettings-expirationError{font-size:.625rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:'}.od-PermissionsSettings-PeoplePicker{margin-top:6px}.od-PermissionsSettings-prompt{font:-apple-system-body}[dir=ltr] .od-PermissionsSettings-prompt{padding-right:.25em}[dir=rtl] .od-PermissionsSettings-prompt{padding-left:.25em}#od-PermissionsSettings-learnMore{text-decoration:underline;outline:transparent;position:relative;white-space:nowrap;font:-apple-system-caption2}#od-PermissionsSettings-learnMore::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible #od-PermissionsSettings-learnMore:focus:after{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}#od-PermissionsSettings-learnMore i{font-size:.875rem;width:.875rem;height:.875rem;margin:0 5px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{vertical-align:top}[dir=ltr] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-left:3px}[dir=rtl] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-right:3px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionIcon{display:inline-block}.od-PermissionsSettings-changePermission{margin-bottom:12px;display:flex;align-items:center}.od-PermissionsSettings-setting--RequireVerification{width:100%;height:2rem}[dir=ltr] .od-PermissionsSettings-setting--RequireVerification{margin-right:0}[dir=rtl] .od-PermissionsSettings-setting--RequireVerification{margin-left:0}[dir=ltr] .od-PermissionsSettings-setting--RequireVerification{padding-right:0}[dir=rtl] .od-PermissionsSettings-setting--RequireVerification{padding-left:0}.od-RequireVerificationToggle{vertical-align:top;height:100%;display:flex;line-height:2rem}.od-RequireVerificationToggle .ms-Toggle{width:100%}.od-RequireVerificationToggle .ms-Toggle-slider{position:absolute;top:.375rem}[dir=ltr] .od-RequireVerificationToggle .ms-Toggle-slider{right:30px}[dir=rtl] .od-RequireVerificationToggle .ms-Toggle-slider{left:30px}[dir=ltr] .od-RequireVerificationToggle .ms-Toggle-slider{float:right}[dir=rtl] .od-RequireVerificationToggle .ms-Toggle-slider{float:left}.od-RequireVerificationToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 12px;font-size:.875rem;cursor:pointer;width:calc(100% - 4.4rem)}[dir=rtl] .od-RequireVerificationToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-RequireVerificationToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:400}.od-RequireVerificationToggle .ms-Toggle-innerContainer{line-height:2rem;margin-top:.25rem}[dir=ltr] .od-RequireVerificationToggle .ms-Toggle-innerContainer{float:right}[dir=rtl] .od-RequireVerificationToggle .ms-Toggle-innerContainer{float:left}.od-PermissionsSettings-setting--RequireVerification-Icon{display:inline-block;font-size:1rem}.od-PermissionsSettings-setting--RequireVerification-Icon .ms-Icon{display:inline-block;font-size:1rem;margin:0 14px 0 8px;position:relative;height:2rem;line-height:2rem}[dir=rtl] .od-PermissionsSettings-setting--RequireVerification-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-setting--PreventDownload{width:100%;height:2rem}[dir=ltr] .od-PermissionsSettings-setting--PreventDownload{margin-right:0}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload{margin-left:0}[dir=ltr] .od-PermissionsSettings-setting--PreventDownload{padding-right:0}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload{padding-left:0}.od-PermissionsSettings-setting--PreventDownload-Icon{display:inline-block;font-size:1rem}.od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{display:inline-block;font-size:1rem;margin:0 14px 0 8px;position:relative;height:2rem;line-height:2rem}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-setting--OfficeReviewMode{width:100%;height:2rem}[dir=ltr] .od-PermissionsSettings-setting--OfficeReviewMode{margin-right:0}[dir=rtl] .od-PermissionsSettings-setting--OfficeReviewMode{margin-left:0}[dir=ltr] .od-PermissionsSettings-setting--OfficeReviewMode{padding-right:0}[dir=rtl] .od-PermissionsSettings-setting--OfficeReviewMode{padding-left:0}.od-PermissionsSettings-setting--OfficeReviewMode-Icon{display:inline-block;font-size:1rem}.od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{display:inline-block;font-size:1rem;margin:0 14px 0 8px;position:relative;height:2rem;line-height:2rem}[dir=rtl] .od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-wrapper{width:100%;outline:transparent;position:relative}.od-PermissionsSettings-wrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-wrapper:focus:after{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-PermissionsSettings-wrapper :hover{cursor:pointer}.od-PermissionsSettings-blocker{pointer-events:none}.ms-Callout-container .od-PermissionsSettings-teachingBubble{max-width:300px}.od-PermissionsSettings-teachingBubbleIcon{font-size:1.5rem;position:absolute;top:1.5625rem;z-index:1}[dir=ltr] .od-PermissionsSettings-teachingBubbleIcon{padding-left:.3125rem}[dir=rtl] .od-PermissionsSettings-teachingBubbleIcon{padding-right:.3125rem}.od-PermissionsSettings-teachingBubble .ms-TeachingBubble-headline{padding-top:3.125rem}@media screen and (-ms-high-contrast:active){.ms-TeachingBubble-primaryButton:focus,.ms-TeachingBubble-primaryButton:hover{outline:2px solid #fff;background:highlight}}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(0),i=n(1),r=n(2576),o=n(2052),s=n(1801),c=n(476),d=n(1673),l=n(129),u=n(1834),f=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onAllowRoleChange=function(e){a.setState({selectedRole:e},function(){a.props.onRoleChange(e)})},a.state={selectedRole:a._getSelectedKey(t)},a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=this._getRoleSelectorProps();return i.createElement(o.e,Object(a.__assign)({},t),e.canChangePermission&&this._renderInfoIcon())},t.prototype._getRoleSelectorProps=function(){var e=Object(u.t)({sharingInformation:this.props.sharingInformation,mode:this.props.mode,audience:this.props.selectedPermissions.audience}),t=this._getSelectedKey(this.props),n=this.props.onRoleChange;return{disabled:this.props.canChangePermission,menuPermissionOptions:e,sharingRole:t,mode:this.props.mode,clientId:this.props.clientId,ariaLabel:s.Un,onRoleChange:n,roleSelectorAs:o.e,showDropdownWithOfficeReview:this.props.showDropdownWithOfficeReview}},t.prototype._getSelectedKey=function(e){var t,n;return(null===(t=e.selectedPermissions)||void 0===t?void 0:t.sharingRole)?e.selectedPermissions.sharingRole:(null===(n=e.selectedPermissions)||void 0===n?void 0:n.isEdit)?r.e.edit:r.e.view},t.prototype._renderInfoIcon=function(){var e={maxWidth:"320px",onRenderContent:function(){return i.createElement("div",{className:"od-RoleSelector-infoTooltipContent"},s.qe)}};return i.createElement("div",{className:"od-changePermissions--info","aria-label":s.qe,"aria-haspopup":!0},i.createElement(d.e,{id:"od-changePermissions--tooltip",directionalHint:l.e.topLeftEdge,calloutProps:{gapSpace:0},tooltipProps:e},i.createElement(c.e,{iconName:"Info","data-is-focusable":!0,"aria-describedby":"od-changePermissions--tooltip"})))},t}(i.Component)},function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLink-container{padding-bottom:16px}.od-ShareLink-container.compact{padding-bottom:2px}.od-ShareLink{padding:26px 0 12px}.od-ShareLink.flightOff{padding:0}.od-ShareLink.compact{padding:2px 0 0}.od-ShareLink.updatedSpacing{padding:16px 0 0}.od-ShareLink .od-ShareLink-main{display:flex;flex-wrap:wrap;align-items:center;position:relative}.od-ShareLink .od-ShareLink-main .ms-Button--default{outline:transparent;position:relative;border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';min-width:3.375rem;height:2rem;margin:0;padding:0}.od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareLink-howCanUserModifyTooltip{padding-left:4px;display:inline;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ShareLink-header{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";font-size:.875rem;padding:12px 24px}.od-ShareLink-header .od-ShareLink-header-itemname{font-weight:600}.od-ShareLink-header .od-ShareLink-header-iconWraper{padding:0 4px 0 2px;display:inline}.od-ShareLink-icon{position:relative;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.5625rem;border-radius:50%;width:3.125rem;min-width:3.125rem;height:3.125rem}[dir=ltr] .od-ShareLink-icon{margin-right:10px}[dir=rtl] .od-ShareLink-icon{margin-left:10px}.od-ShareLink-icon i{position:absolute;top:50%}[dir=ltr] .od-ShareLink-icon i{left:50%}[dir=rtl] .od-ShareLink-icon i{right:50%}[dir=ltr] .od-ShareLink-icon i{transform:translate(-50%,-50%)}[dir=rtl] .od-ShareLink-icon i{transform:translate(50%,-50%)}.od-ShareLink-icon2{position:relative;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.125rem;border-style:solid;border-width:.0625rem;border-radius:50%;box-sizing:border-box;width:2rem;min-width:2rem;height:2rem}[dir=ltr] .od-ShareLink-icon2{margin-right:10px}[dir=rtl] .od-ShareLink-icon2{margin-left:10px}.od-ShareLink-icon2 i{font-size:1.125rem;position:absolute;top:50%}[dir=ltr] .od-ShareLink-icon2 i{left:50%}[dir=rtl] .od-ShareLink-icon2 i{right:50%}[dir=ltr] .od-ShareLink-icon2 i{transform:translate(-50%,-50%)}[dir=rtl] .od-ShareLink-icon2 i{transform:translate(50%,-50%)}.od-ShareLink-icon2.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLink-icon2.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLink-icon2.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLink-icon2.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLink-icon2.icon-FileRequest{color:#333;background:#fff;border:#fff;font-size:20px}.od-ShareLink-icon2.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLink-icon2.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLink-details{flex:1}.od-ShareLink-details .ms-TextField-field{font-size:.875rem;min-width:100px}.od-ShareLink-details .ms-TextField-fieldGroup{height:2rem}.od-ShareLink-url{font-size:.875rem}.od-ShareLink-actionButton{outline:transparent;position:relative;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';font-size:1rem;width:2rem;height:2rem}.od-ShareLink-actionButton::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-actionButton:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareLink-actionButton .ms-Button-icon{font-size:1rem}.od-ShareLink-actionButton.cancel{position:absolute;top:0}[dir=ltr] .od-ShareLink-actionButton.cancel{right:10px}[dir=rtl] .od-ShareLink-actionButton.cancel{left:10px}[dir=ltr] .od-ShareLink-actionButton.back{left:0}[dir=rtl] .od-ShareLink-actionButton.back{right:0}[dir=rtl] .od-ShareLink-actionButton.back{transform:scale(-1,1)}.od-SharingLink-requestAccessInfo{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:'}.od-ShareLink-description{padding-top:.5rem;font-size:.75rem}[dir=ltr] .od-ShareLink-description{padding-left:42px}[dir=rtl] .od-ShareLink-description{padding-right:42px}.od-ShareLink-description.flightOff{padding-top:0}[dir=ltr] .od-ShareLink-description.flightOff{padding-left:60px}[dir=rtl] .od-ShareLink-description.flightOff{padding-right:60px}.od-ShareLink-description.compact{padding-top:0}.od-PermissionsList .od-ShareLink-description{cursor:pointer}.od-ShareLink-description .od-ShareLink-description-label{display:inline-block;font-size:.6875rem}[dir=ltr] .od-ShareLink-description .od-ShareLink-description-label{margin-right:4px}[dir=rtl] .od-ShareLink-description .od-ShareLink-description-label{margin-left:4px}.od-ShareLink--inviteesHolder{display:flex;flex-wrap:wrap;align-items:center;outline:transparent;position:relative}[dir=ltr] .od-ShareLink--inviteesHolder{padding-left:42px}[dir=rtl] .od-ShareLink--inviteesHolder{padding-right:42px}[dir=ltr] .od-ShareLink--inviteesHolder{padding-right:38px}[dir=rtl] .od-ShareLink--inviteesHolder{padding-left:38px}.od-ShareLink--inviteesHolder::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink--inviteesHolder:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}[dir=ltr] .od-ShareLink--inviteesHolder.flightOff{padding-left:60px}[dir=rtl] .od-ShareLink--inviteesHolder.flightOff{padding-right:60px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header{display:flex;align-items:center;width:100%}[dir=ltr] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-right:10px}[dir=rtl] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-left:10px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Persona-details{display:none}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerExpanded{font-size:.75rem;font-weight:600}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:'}[dir=ltr] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-left:auto}[dir=rtl] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-right:auto}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron .ms-Button-icon{font-size:.75rem}.od-ShareLink--inviteesHolder .od-ShareLink-participants{width:100%}ul.od-ShareLink-participants{cursor:default;list-style:none;padding:0}.od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{content:"";background-color:'},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";display:block;height:.4375rem}[dir=ltr] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-62px}[dir=rtl] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-62px}[dir=ltr] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-58px}[dir=rtl] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-58px}.od-ShareLink--inviteesHolder.no-separator ul.od-ShareLink-participants::after{height:0}.od-ShareLink-personaItem{padding:18px 8px;display:flex;align-items:center}.od-ShareLink-personaItem .ms-Persona{width:100%}.od-ShareLink-personaItem .ms-Persona .ms-Persona-optionalText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-tertiaryText{overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText{font-size:1rem;font:-apple-system-body}.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{font-size:.625rem;color:"},{theme:"bodySubtext",defaultValue:"#605e5c"},{rawString:';font:-apple-system-caption1;height:1rem;line-height:1rem}.od-ShareLink-personaItem .ms-Button-icon{outline:transparent;position:relative;font-size:.75rem}.od-ShareLink-personaItem .ms-Button-icon::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-personaItem .ms-Button-icon:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}.od-ShareLink-personaItem .ms-Persona-image{height:2rem;width:2rem}.od-ShareLink-details-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-ShareLink-linkMember{outline:transparent;position:relative}.od-ShareLink-linkMember::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-linkMember:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareLink-requestAccessTooltip-text{padding-bottom:10px}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(1),r=n(582),o=n(1774),s=n(1509),c=n(1642),d=n(1176),l=n(1801),u=function(e){function t(t){return e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e={type:r.e.close,title:l.ws,subText:l.Os};return i.createElement(o.e,{onDismiss:this.props.onDismiss,hidden:!this.props.showStopSharingDialog,dialogContentProps:e},i.createElement(s.e,null,i.createElement(c.e,{onClick:this.props.stopSharing,text:l.Ds,autoFocus:!0}),i.createElement(d.e,{onClick:this.props.onDismiss,text:l.De})))},t}(i.PureComponent)},,,function(e,t,n){"use strict";var a='<div class="od-DialogHost">\x3c!--ko with:dialog--\x3e\x3c!--ko component:{name:$component.dialogOverlayTagName,params:{dialog:$component.dialog}}--\x3e\x3c!--ko if:$component.isStandard--\x3e\x3c!--ko component:{name:$component.standardDialogTagName,params:{}}--\x3e\x3c!--ko if:!!component--\x3e\x3c!--ko with:component--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!!control--\x3e\x3c!--ko control:control--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:$component.isStandard--\x3e\x3c!--ko with:component--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>',i=n(17);Object(i.n)([{rawString:".od-DialogHost{display:none}"}]);var r=n(1825),o=n(0),s=n(196),c=(n(2118),n(24)),d=n(350),l=n(163),u=n(705),f=n(1157),p=n(1812),m=n(812),_=n(530),h=n(1828),b=n(1109),g=n(1822),v=n(1841),y=n(1017),S=n(811),D=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({dismiss:m.e,automation:y.e,element:b.e,focusTrap:h.e,interactionScope:S.t,preserveFocus:v.e,recoverFocus:g.e,host:p.e}),n.dialog=t.dialog,n.overlayComponent=n.createPureComputed(n._computeOverlayComponent),n.contentRoot=c.observable(),n._launchPoint=new d.t(-1,-1),n.isVisible=c.observable(!1),n.title=n.createObservable(n.dialog().title()),n.dialogStyle=n.createComputed(n._computeDialogStyle),n.sizeClass=n.createComputed(n._computeSizeClass),n.styleClass=n.createComputed(n._computeStyleClass),n}return Object(o.__extends)(t,e),t.prototype.dismiss=function(){var e=this.dialog();return!e||!e.isDismissable||(e.dismiss(),!1)},t.prototype._computeOverlayComponent=function(){var e=this.dialog();return{name:r.e.tagName,params:{animation:{beforeRemove:500},alignToParent:e.isCallout}}},t.prototype._computeDialogStyle=function(){var e=this.dialog(),t={};return e?this.unwrapObservable(e.calloutHeight)&&e.isCallout&&(this.ensureLaunchPointCalculated(),t.left=this._launchPoint.x+"px",t.top=this._launchPoint.y+"px"):(t.left="-1000px",t.top="-1000px"),e.isCallout&&!this.unwrapObservable(e.calloutHeight)||this.isVisible(!0),t},t.prototype.ensureLaunchPointCalculated=function(){var e=this.dialog.peek().invokerEvent;if(e&&this.contentRoot()){var t=this.contentRoot().getBoundingClientRect(),n=e.clientX,a=e.clientY;if(n<=0&&a<=0||!n&&!a){var i=e.target.getBoundingClientRect();n=i.left,a=i.bottom}var r=l.t.isRightToLeft?n-t.width:n,o=a,s=new u.t(r,o,t.width,t.height),c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,f=new u.t(0,0,c,d),p=s.nudge(f);this._launchPoint.x=p.getLeft(),this._launchPoint.y=p.getTop()}},t.prototype._computeSizeClass=function(){return _.e.determineCssClass(this.dialog().size)},t.prototype._computeStyleClass=function(){return f.e[this.dialog().style]},t}(s.t),I=n(399),x=I.e({tagName:"od-dialog-overlay",template:"<div class=\"od-DialogOverlay\" data-bind=\"css:{'is-active':dialog}\">\x3c!--ko with:dialog--\x3e\x3c!--ko component:$component.overlayComponent--\x3e<div class=\"od-Dialog\" data-bind=\"css:{'od-Dialog--close':isDismissable},focusTrap:{}\"><div class=\"ms-ModalOverlay\" data-bind=\"visible:!isCallout&&!isOverlayHidden,style:{backgroundColor:overlayColor}\"></div><div class=\"od-Dialog-main\" tabindex=\"-1\" role=\"dialog\" data-bind=\"interactionScope:{isScope:true},preserveFocus:shouldPreserveFocus,recoverFocus:{isEnabled:$host.isOpen},dismiss:{isEnabled:isSoftDismissable,close:isDismissable&&$component.dismiss.bind($component),dismissOnScroll:isDismissableOnScroll,dismissOnResize:isDismissableOnResize},class:'od-Dialog-main--'+$component.sizeClass()+' '+'od-Dialog-main-style--'+$component.styleClass()+(customCssClasses?' '+customCssClasses:''),css:{'od-Dialog-main--allowPanel':!stayAsPopup,'od-Dialog-main--callout':isCallout,'od-Dialog-main--dialog':!isCallout,'od-Dialog-main--visible':$component.isVisible()},automation:automationId,style:$component.dialogStyle,attr:{'aria-labelledby':'od-Dialog-title','aria-describedby':'od-Dialog-content'},element:$parent.contentRoot\"><div class=\"od-Dialog-content\" data-bind=\"host:{}\"></div></div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>",viewModel:D,synchronous:!0}),C=n(1114);Object(i.n)([{rawString:".od-Link{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;outline:0}.od-Link:focus,.od-Link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Link[disabled]{cursor:default;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Dialog-actionsLoading{display:inline-block;padding-bottom:7px;vertical-align:bottom}[dir=ltr] .od-Dialog-actionsLoading{padding-right:5px}[dir=rtl] .od-Dialog-actionsLoading{padding-left:5px}.od-Dialog-main--callout .od-Dialog-inner{padding:0}.od-Dialog-main--callout .od-Dialog-header{padding:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{position:absolute;top:0;left:0;right:0;margin-top:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";padding:0 10px 0 0;height:44px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{padding:0 0 0 10px}html[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:left}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:right}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save{font-size:20px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{background:0 0;height:44px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon{display:inline-block;margin-top:5px;margin-right:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label{font-weight:400;font-size:14px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action:hover,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-inner,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-inner{padding:16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-icon,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-icon{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-label{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 10px 5px 0;background:0 0;border:0;cursor:pointer}html[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 0 5px 10px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back .ms-Icon.ms-Icon--Back{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:16px}.ms-Dialog-button--close{position:absolute;top:12px;background:0 0;border:none;cursor:pointer}[dir=ltr] .ms-Dialog-button--close{right:8px}[dir=rtl] .ms-Dialog-button--close{left:8px}.ms-Dialog-button--close .ms-Icon{font-size:16px}.od-Dialog-header{position:relative;width:100%;box-sizing:border-box;word-wrap:break-word;padding:24px 40px 0 24px}.od-Dialog-header .od-Dialog-title{margin:0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:inline;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:'}.od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{content:""}[dir=ltr] .od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{margin-right:16px}[dir=rtl] .od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{margin-left:16px}.od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon .od-IconGlyph{display:inline-block;top:8px;font-size:28px}.od-Dialog-header.od-Dialog-header--large{padding:30px 20px;margin-bottom:10px;background-color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-header.od-Dialog-header--large .od-Dialog-title{font-weight:100;font-size:28px;color:"},{theme:"white",defaultValue:"#fff"},{rawString:'}.od-Dialog-inner{height:100%;padding:18px 24px 24px}.od-Dialog-actions{position:relative;width:100%;height:32px;margin-top:24px;zoom:1}.od-Dialog-actions::after,.od-Dialog-actions::before{display:table;content:"";line-height:0}.od-Dialog-actions::after{clear:both}.od-Dialog-action .od-Button-icon{display:none}.od-Dialog-action.od-Dialog-action--link{border:0;cursor:pointer;box-sizing:border-box;box-shadow:none;margin:0;padding:0;color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;outline:0;padding:0 0 0 4px;background:0 0}.od-Dialog-action.od-Dialog-action--link:focus,.od-Dialog-action.od-Dialog-action--link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-action.od-Dialog-action--link[disabled]{cursor:default;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}html[dir=rtl] .od-Dialog-action.od-Dialog-action--link{padding:0 4px 0 0}.od-Dialog-action.od-Dialog-action--link .od-Button-label{font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:hover .od-Button-label{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.sm .od-Dialog-action .od-Button-label{font-size:12px}html[dir=ltr] .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:8px}[dir=rtl] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:8px}html[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:15px}[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:15px}"}]);var O=n(1108),w=n(244),E=n(33),A=Object(w.e)({eventName:"DialogAction,",shortEventName:"DialogAction"},{dialogName:E.e.String,actionName:E.e.String}),L=n(2275),k=n(1872),M=n(1999),P=function(e){function t(t){var n=e.call(this,t)||this;return n.loadingSpinnerTagName=k.e.tagName,n.iconGlyphTagName=M.e.tagName,n.addBindingHandlers({keyboard:O.e,automation:y.e,host:p.e,element:b.e}),n.closeLabel=L.e,n.dialog=n.resources.consume(C.e).currentDialog,n.actionButton=n.observables.create(null),n.createComputed(function(){var e=n.actionButton();e&&n.dialog.peek().focusOnPrimaryAction&&e.focus()}),n}return Object(o.__extends)(t,e),t.prototype.dismiss=function(){var e=this.dialog();return!e||!e.isDismissable||(e.dismiss(),!1)},t.prototype.executeDefaultAction=function(){var e=this.dialog();if(e&&e.executeDefaultAction){var t=c.utils.arrayFirst(e.actions,function(e){return e.isDefault});if(t)return this._logEvent(t),this.execute(t)}return!0},t.prototype.execute=function(e){var t=this.dialog();return!t||!e.isAvailable()||(e.isExecuting(!0),this._logEvent(e),e.execute().done(function(n){e.isExecuting(!1),t.state(n)}),!1)},t.prototype._logEvent=function(e){var t=this.dialog.peek();e.instrumentationId&&t.instrumentationId&&A.logData({actionName:e.instrumentationId,dialogName:t.instrumentationId})},t}(s.t),T=I.e({tagName:"od-standard-dialog",template:'\x3c!--ko with:dialog--\x3e<div data-bind="keyboard:{allowInputEvents:true,allowButtonEvents:false,mappings:{Enter:$component.executeDefaultAction.bind($component)}},css:\'od-StandardDialog\'"><div class="od-Dialog-header od-Dialog-header--s"><p class="od-Dialog-title" id="od-Dialog-title" data-bind="attr:{\'aria-label\':title}" role="heading" aria-level="1">\x3c!--ko if:titleAction&&titleAction.isVisible()--\x3e<button class="od-Dialog-button od-Dialog-button--back" data-bind="attr:{\'aria-label\':titleAction.name,title:titleAction.name},click:titleAction.execute">\x3c!--ko if:titleAction.icon--\x3e<span data-bind="component:{name:$component.iconGlyphTagName,params:{icon:titleAction.icon}}"></span>\x3c!--/ko--\x3e</button>\x3c!--/ko--\x3e\x3c!--ko if:titleIcon&&!titleAction--\x3e<span class="od-Dialog-titleIcon" data-bind="component:{name:$component.iconGlyphTagName,params:{icon:titleIcon}},attr:{\'aria-label\':titleIconAriaLabel}"></span>\x3c!--/ko--\x3e\x3c!--ko text:title--\x3e\x3c!--/ko--\x3e</p></div><div class="od-Dialog-inner"><div class="od-Dialog-content" id="od-Dialog-content" data-bind="host:{}"></div>\x3c!--ko if:actions.length&&actionsVisible--\x3e<div class="od-Dialog-actions" data-bind="automation:\'actionsSection\'"><div class="od-Dialog-actionsRight" data-bind="foreach:actions">\x3c!--ko if:isVisible--\x3e<button class="od-Dialog-action" data-bind="css:{\'od-Button--primary\':isDefault,\'od-Button\':!isLink,\'od-Dialog-action--link\':isLink},click:$component.execute.bind($component),enable:isAvailable,automation:automationId,element:$component.actionButton">\x3c!--ko if:icon--\x3e<span class="od-Button-icon" data-bind="component:{name:$component.iconGlyphTagName,params:{icon:icon}}"></span>\x3c!--/ko--\x3e<span class="od-Button-label" data-bind="text:name"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:isVisible()&&isExecuting()--\x3e<div class="od-Dialog-actionsLoading" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div><button class="od-Dialog-button od-Dialog-button--close" data-bind="attr:{\'aria-label\':$component.closeLabel,title:$component.closeLabel},click:isDismissable&&$component.dismiss.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e',viewModel:P}),U=n(179),F=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.addBindingHandlers({control:U.n}),a.dialog=a.resources.consume(C.e).currentDialog,a.dialogOverlayTagName=x.tagName,a.standardDialogTagName=T.tagName,a.isStandard=a.createPureComputed(a._computeIsStandard),a.hasDialog=a.createPureComputed(a._computeHasDialog),a}return Object(o.__extends)(t,e),t.prototype._computeIsStandard=function(){var e=this.dialog();return e&&1===e.template},t.prototype._computeHasDialog=function(){return!!this.dialog()},t}(s.t),H=I.e({tagName:"od-dialog-host",template:a,viewModel:F,synchronous:!0});t.e=H,Object(U.t)({name:"DialogHost",template:a,automationName:"od-dialog-host",viewModelType:F})},function(e,t,n){"use strict";n.d(t,"e",function(){return te}),n.d(t,"t",function(){return ne});var a=n(0),i=n(17);Object(i.n)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-ShareMain.wide{min-width:480px}@media (max-width:480px){.od-ShareMain.wide{min-width:320px}}.od-ShareMain-section{padding:16px 16px 0}.od-ShareMain-section.new{padding:24px;padding-top:14px}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-section.separator-top{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}.od-ShareMain-section.od-ShareMain-SharedWith{align-self:stretch;padding-bottom:20px;height:2.25rem}.od-ShareMain-section .od-ShareMain-ShareHint.animation{animation:highlight 2s ease-in-out}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-targets-newPadding{clear:both;padding:10px}.od-ShareMain-footer{outline:transparent;position:relative;font-size:12px;font-weight:400;display:flex!important;align-items:center;justify-content:flex-start;padding:0 16px!important;width:100%;height:44px!important;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";cursor:pointer!important;border:none!important;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:'!important;font:-apple-system-subheadline;bottom:0}.od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir=ltr] .od-ShareMain-attachIcon{margin-right:4px}[dir=rtl] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}@media screen and (-ms-high-contrast:active){.od-ShareMain-footer:focus,.od-ShareMain-footer:hover{outline:2px solid}}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-ShareMain-section-body{margin-bottom:0}}.od-ShareMain-copyLink.shareType-section{display:flex;align-items:center;justify-content:space-between}[dir=ltr] .od-ShareMain-Header-backBtnAdjust{margin-left:16px}[dir=rtl] .od-ShareMain-Header-backBtnAdjust{margin-right:16px}@keyframes highlight{from{background:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}35%{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}to{background:0 0}}"}]);var r=n(1863),o=n(2579),s=n(2578),c=n(2876),d=n(1646),l=n(1098),u=n(2577);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:.0625rem solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-method{display:flex;justify-content:space-between;align-items:center}.od-SendLink-message .od-SendLink-message-TextField{margin-bottom:12px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding:.375rem 0;font-size:.875rem;font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font:-apple-system-body}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}#od-SendLink-message-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast:active){#od-SendLink-message-id .ms-Button::after{outline-color:window}}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir=ltr] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir=rtl] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir=ltr] .od-SendLink-ITPolicy{right:0}[dir=rtl] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons{float:right}[dir=rtl] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir=ltr] .od-SendLink-emailButtons-allCaps{float:right}[dir=rtl] .od-SendLink-emailButtons-allCaps{float:left}[dir=ltr] div.od-SendLink-emailButtons-left{text-align:right}[dir=rtl] div.od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons-rounded{float:right}[dir=rtl] .od-SendLink-emailButtons-rounded{float:left}[dir=ltr] .od-SendLink-emailButtons-roleSelector{float:right}[dir=rtl] .od-SendLink-emailButtons-roleSelector{float:left}.od-SendLink-emailButtons-roleSelector .ms-Button{border-radius:2px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:4.0625rem;padding-bottom:30px;font-size:.75rem}[dir=ltr] .od-SendLink-email .ms-TextField-field{padding-left:0}[dir=rtl] .od-SendLink-email .ms-TextField-field{padding-right:0}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:.875rem;height:2rem;width:100%}@supports (font:-apple-system-footnote){.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font:-apple-system-body;height:auto}}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.875rem;font:-apple-system-body}.od-SendLink-sendContainer{justify-content:flex-end}.od-SendLink-characterCounter{font-size:.75rem}[dir=ltr] .od-SendLink-characterCounter{float:right}[dir=rtl] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:flex;flex-direction:row}.od-SendLink-peoplePicker{margin-bottom:12px;flex-grow:2;width:100%}"}]);var f=n(2112),p=n(1839),m=n(1),_=n(1800),h=n(1954),b=n(1993),g=n(1952),v=n(1801),y=n(1804),S=n(1786),D=n(434),I=n(1806),x=n(1831),C=n(1834),O=n(2053);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir=ltr] .od-ShareTargets-items{margin-right:-10px}[dir=rtl] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir=ltr] .od-ShareTargets-item{margin-right:10px}[dir=rtl] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item.new{margin:0}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";cursor:pointer;display:inline-block;height:3rem;margin-bottom:8px;width:3rem}.od-ShareTargets-itemImage.new{height:2rem;width:2rem;margin-bottom:0;display:flex;align-items:center;justify-content:center}.od-ShareTargets-icon{font-size:1.625rem;padding-top:.6875rem}.od-ShareTargets-icon.new{padding:0;height:24px;width:24px;font-size:24px}.od-ShareTargets-itemImage--border{border:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';font:-apple-system-short-caption2;font-size:.625rem}.od-ShareTargets-target{outline:transparent;position:relative;background:0 0;border:none}.od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ShareTargets-target.new{padding:0 8px 0 0}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Share button:not(.ms-Button).od-ShareTargets-target{outline:.0625rem solid windowText}.od-Share button:not(.ms-Button).od-ShareTargets-target:focus{outline:.125rem solid highlight}}"}]);var w=n(2400),E=n(476),A=n(1673),L=n(129),k=n(1829),M=n(8);function P(e,t){var i=this,r=m.useState({showCoachmark:!1,teachingBubbleCampaigns:void 0}),o=r[0],s=r[1],c=m.lazy(function(){return Object(a.__awaiter)(i,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){return setTimeout(t,e.delayTimeInMilliseconds)})];case 1:return t.sent(),[2,n.e(301).then(n.bind(null,4396))]}})})});return m.useEffect(function(){var n=setTimeout(function(){return Object(a.__awaiter)(i,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return Promise.all([t.loadTeachingBubbleCampaigns(),t.shouldTeachingBubbleBeShown(t.campaignKey)]).then(function(e){var t=e[0],n=e[1];s({teachingBubbleCampaigns:t,showCoachmark:n})}),[2]})})},e.delayTimeInMilliseconds);return function(){return clearTimeout(n)}},[s]),o.showCoachmark&&o.teachingBubbleCampaigns&&m.createElement(m.Suspense,{fallback:m.createElement(m.Fragment,null)},m.createElement(c,{componentRef:e.componentRef,delayTimeInMilliseconds:e.delayTimeInMilliseconds,target:e.target,teachingBubbleCampaign:o.teachingBubbleCampaigns[t.campaignKey],dismissCallback:function(){t.markTeachingBubbleAsDismissed(t.campaignKey),s({showCoachmark:!1,teachingBubbleCampaigns:void 0})},onTeachingBubbleSeen:e.onTeachingBubbleSeen,onPrimaryButtonClicked:e.onPrimaryButtonClicked}))}P.contextTypes={shouldTeachingBubbleBeShown:_.func,markTeachingBubbleAsDismissed:_.func,loadTeachingBubbleCampaigns:_.func,campaignKey:_.number};var T,U=n(1826),F=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/outlook_48x1.svg"),H=window.require.toUrl("odsp-media/images/brand-icons/product-fluent/svg/teams_48x1.svg"),R=function(e){function t(t){var n=e.call(this,t)||this;return n._shareToTeamsExperiment=k.i(),n._shareToTeamsCoachmarkTarget=m.createRef(),n._coachmarkRef=m.createRef(),n._showTeams=!1,n.state={areTargetsReady:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this._shareToTeamsExperiment&&this.context.canUseTeams().then(function(t){e._showTeams=t,e.setState({areTargetsReady:!0})})},t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.audience!==o.e.anyone&&this.props.currentSettings.audience!==o.e.organization;return this._shareToTeamsExperiment?(this._shareTargetsData=this.state.areTargetsReady&&this._getShareTargetsData(),e?m.createElement(A.e,{content:v.s,calloutProps:{calloutWidth:300,directionalHint:L.e.topCenter}},m.createElement("ul",{className:"od-ShareTargets-items","aria-label":v.Za},this.state.areTargetsReady&&this._renderTargets())):m.createElement("ul",{className:"od-ShareTargets-items","aria-label":v.Za},this.state.areTargetsReady&&this._renderTargets())):(this._shareTargetsData=this._getShareTargetsData(),e?m.createElement(A.e,{content:v.s,calloutProps:{calloutWidth:300,directionalHint:L.e.topCenter}},m.createElement("ul",{className:"od-ShareTargets-items","aria-label":v.Za},this._renderTargets())):m.createElement("ul",{className:"od-ShareTargets-items","aria-label":v.Za},this._renderTargets()))},t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.audience!==o.e.anyone&&this.props.currentSettings.audience!==o.e.organization,n=!M.t.isActivated("2f033097-46da-4c25-9748-ce932d169987","07/01/2021","Blocking share targets (e.g. CopyLink) by blockPeoplePickerAndSharing.")&&this.props.sharingInformation.blockPeoplePickerAndSharing&&this.props.currentSettings.audience!==o.e.existing,a=0,i=this._shareTargetsData;a<i.length;a++){var r,s=i[a],d=s.icon,l=d.split(":",2)[1],u=t||n||Object(y.T)(this.props.sharingInformation),f="od-ShareTargets-icon ".concat(u?"od-ShareTargets-disabled":""," new");"od-ShareTargets-itemText ms-font-xs ".concat(u?"od-ShareTargets-disabled":""),r=d.indexOf("font:")>-1?m.createElement(E.e,{iconName:l,className:f}):m.createElement("img",{src:d,className:f}),e.push(m.createElement("li",{key:s.shareType,className:"od-ShareTargets-item new"},m.createElement(A.e,{content:s.label,styles:{root:{display:"inline-block"}}},m.createElement("button",{className:"od-ShareTargets-target new","aria-label":s.label,disabled:u,onClick:s.action,id:s.id,ref:s.shareType===c.e.webShareToTeams?this._shareToTeamsCoachmarkTarget:null},s.shareType===c.e.webShareToTeams?this._renderCoachmark():m.createElement(m.Fragment,null),m.createElement("div",{role:"presentation","aria-hidden":"true",className:"od-ShareTargets-itemImage new"},r)))))}return e},t.prototype._renderCoachmark=function(){return m.createElement(P,{componentRef:this._coachmarkRef,delayTimeInMilliseconds:200,target:this._shareToTeamsCoachmarkTarget,onTeachingBubbleSeen:this.context.onTeachingBubbleSeen(this.context.campaignKey),onPrimaryButtonClicked:this._onClick.bind(this,c.e.webShareToTeams)})},t.prototype._getShareTargetsData=function(){var e=[],t=this._determineMailShareTarget(this.props.clientId);if(t===w.e.available){var n=I.r(this.props.clientId)?"font:OutlookLogo":F,a="".concat(v.Fo," ").concat(v.$a);e.push({label:a,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:c.e.outlook,action:this._onClick.bind(this,c.e.outlook),id:"od-ShareTarget-outlookButton"})}else t===w.e.other&&(a="".concat(v.Fo," ").concat(v.ya),e.push({label:a,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:c.e.nonOutlook,action:this._onClick.bind(this,c.e.nonOutlook),id:"od-ShareTarget-nonOutlookButton"}));return Object(U.f)()?(a="".concat(v.Fo," ").concat(v.Ps),e.push({label:a,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:c.e.mobileShareToTeams,action:this._onClick.bind(this,c.e.mobileShareToTeams),id:"od-ShareTarget-mobileTeamsButton"})):this.props.fullscreenIframeMode&&this._shareToTeamsExperiment&&!this.context.platformDetection.isIE&&this._showTeams&&(n=H,a="".concat(v.Fo," ").concat(v.Ps),e.push({label:a,icon:n,bgColor:"ms-bgColor-themePrimary",shareType:c.e.webShareToTeams,action:this._onClick.bind(this,c.e.webShareToTeams),id:"od-ShareTarget-webTeamsButton"})),Object(U.d)()&&(a="".concat(v.Fo," ").concat(v.aa),e.push({label:a,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:c.e.moreApps,action:this._onClick.bind(this,c.e.moreApps),id:"od-ShareTarget-moreAppsButton"})),e},t.prototype._onClick=function(e){var t;e===c.e.webShareToTeams&&(null===(t=this._coachmarkRef.current)||void 0===t||t.dismiss()),this.props.onShareTargetClicked(e)},t.prototype._determineMailShareTarget=function(e){return I.h(this.props.clientId)&&this.props.outlookAvailability===w.e.available?w.e.available:Object(U.a)()},t.contextTypes={platformDetection:_.object.isRequired,shouldTeachingBubbleBeShown:_.func,onTeachingBubbleSeen:_.func,markTeachingBubbleAsDismissed:_.func,campaignKey:_.number,canUseTeams:_.func},t}(m.Component),N=n(1802),B=function(e){function t(t,n){var i=e.call(this,t)||this;return i._topLevelDivRef=m.createRef(),i._validateMessage=function(e){i.props.onSendLinkMessageChange(e);var t=Object(y.p)(e);return i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{messageLength:t})),""},i._validateSubject=function(e){i.props.onSendLinkSubjectChange(e);var t=Object(y.p)(e);return i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{subjectLength:t})),e.length<=i.props.maximumSubjectLength?"":e.length+"/"+i.props.maximumSubjectLength},i._onResolvedSuggestions=function(e){return i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e),e},i._platformDetection=n.platformDetection,i.state={messageLength:0,subjectLength:0},i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i),i._resizeTracker=new x.e(n.resize),i}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){p.o({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:Object(y.a)(e.sharingInformation)?e.onShareHintClick:void 0,permissionsMap:e.permissionsMap}),this.setState(Object(a.__assign)({},this.state))},t.prototype.componentDidMount=function(){this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()},t.prototype.render=function(){var e=this.props,t=e.currentSettings,n=e.linkRecipients,a=p.n(n),i=p.a(n,e.groupsMemberCount),r=this._platformDetection.isIOS||I.i(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||I.t(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left";r+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-emailButtons-roleSelector":"";var o=m.createElement(R,{fullscreenIframeMode:this.props.fullscreenIframeMode,clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this.props.onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}),s=this.props.showSendButton?m.createElement("div",{className:r},m.createElement(b.e,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this.props.onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:g.e.button,sharingInformation:this.props.sharingInformation})):"",c=e.isLoadingDefaultRecipients?m.createElement("div",null,m.createElement(S.e,{className:"od-SendLink-spinner",label:v.zn,size:D.e.small})):m.createElement(h.e,{defaultSelectedItems:n,error:e.errorMessage,onChange:e.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:a,oversharingGroupsWarning:i,pickerSettings:e.sharingInformation.peoplePickerSettings,sharingLinkKind:t.sharingLinkKind,sharingInformation:e.sharingInformation,permissionsMap:e.permissionsMap,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),clientId:e.clientId,onInputChange:e.onPeoplePickerInputChange||null,renderRoleSelector:this._shouldRenderRoleSelector(),roleSelectorProps:this._getRoleSelectorProps()});return m.createElement("div",{ref:this._topLevelDivRef,className:"od-SendLink"},m.createElement("div",{className:"od-SendLink-email"},m.createElement("div",{className:"od-SendLink-peoplePicker"},c),m.createElement("div",{className:"od-SendLink-message",id:"od-SendLink-message-id"},this._renderTextArea(),this._renderCharacterCounter(),m.createElement("div",{className:"od-SendLink-method"},o,s))))},t.prototype._shouldRenderRoleSelector=function(){return this.props.currentSettings.audience!==o.e.existing},t.prototype._getRoleSelectorProps=function(){var e=Object(y.T)(this.props.sharingInformation),t=Object(C.t)({sharingInformation:this.props.sharingInformation,audience:this.props.currentSettings.audience,mode:l.e.share}),n=!1;return N.s()&&(n=Object(C.c)(this.props.currentSettings.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)),{shimmer:e,menuPermissionOptions:t,sharingRole:this.props.currentSettings.sharingRole,mode:l.e.share,clientId:this.props.clientId,ariaLabel:v.Un,showStopSharing:!1,onRoleChange:this.props.onRoleChange,showLinkSettings:!0,onLinkSettingsClicked:this.props.onLinkSettingsClicked,currentSettings:this.props.currentSettings,roleSelectorAs:O.e,showDropdownWithOfficeReview:n}},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._onManageExistingAccessClick=function(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData),this.props.onManageExistingAccessClick()},t.prototype._renderTextArea=function(){if(this.props.showTextArea){var e=N.ne()&&!!this.props.messageText;return m.createElement("div",{className:"od-SendLink-message-TextField"},this._isSubjectExperimentOn&&m.createElement(f.e,{borderless:!0,underlined:!0,placeholder:v.As,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),m.createElement(f.e,{borderless:!0,placeholder:e?this.props.messageText:v.Jn,ariaLabel:v.Yn,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}))}},t.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t=e>this.props.maximumMessageLength,n="od-SendLink-characterCounter ".concat(t?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return t?m.createElement("div",{className:"od-SendLink-characterCounterWrapper"},m.createElement("span",{"aria-label":v.we,role:"alert",className:n},e,"/",this.props.maximumMessageLength)):m.createElement("div",{className:"od-SendLink-characterCounterWrapper"},m.createElement("span",{className:n},e,"/",this.props.maximumMessageLength))},t.contextTypes={platformDetection:_.object.isRequired,sharingStore:_.object.isRequired,resize:_.func.isRequired},t}(m.Component),j=n(2050),V=n(1992),z=n(1830),G=n(1818);(T||(T={})).getAttachAsCopyOptions=function(e,t,n,a){var i=[],r=function(e,t,n,a){var i=n.name.split("."),r="";if(i.length>1&&(r=i[1].toLowerCase()),Object(U.l)()){var o=function(){!function(e,t){e.getEngagementHelper().sendACopyOfficeClicked(t),Object(U.y)()}(e,a)};return I.p(t)||function(e){return["doc","docx","dot","docm","odt","rtf","txt"].indexOf(e)>-1}(r)?{key:"word",name:v.Xs,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:o}:I.l(t)||function(e){return["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(e)>-1}(r)?{key:"powerpoint",name:v.Sr,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:o}:I.a(t)||function(e){return["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(e)>-1}(r)?{key:"excel",name:v.At,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:o}:I.f(t)||function(e){return["vsd","vsdx"].indexOf(e)>-1}(r)?{key:"visio",name:v.Ys,iconProps:{iconName:"VisioLogo"},onClick:o}:{key:"document",name:v.Dt,iconProps:{iconName:"Document"},onClick:o}}}(n,e,t,a);r&&i.push(r);var o=function(e,t){if(Object(U.u)())return{key:"pdf",name:v.Ci,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){!function(e,t){e.getEngagementHelper().sendACopyPdfClicked(t),Object(U.D)()}(e,t)}}}(n,a);return o&&i.push(o),i};var K=T,W=n(1934),q=n(1176),Q=n(1998),Y=n(1817),J=n(1919),X=n(2051),Z=n(2136),$=n(1991),ee=(m.lazy(function(){return Promise.resolve().then(n.bind(null,2308))}),m.lazy(function(){return Promise.resolve().then(n.bind(null,2309))}),m.lazy(function(){return Promise.resolve().then(n.bind(null,2145))}),m.lazy(function(){return Promise.resolve().then(n.bind(null,2049))}),m.lazy(function(){return Promise.resolve().then(n.bind(null,2316))}),m.lazy(function(){return Promise.resolve().then(n.bind(null,1889))})),te=(m.lazy(function(){return Promise.resolve().then(n.bind(null,2314))}),m.lazy(function(){return Promise.resolve().then(n.bind(null,2344))}),m.lazy(function(){return Promise.resolve().then(n.bind(null,2307))}),m.lazy(function(){return Promise.resolve().then(n.bind(null,2315))}),m.lazy(function(){return Promise.resolve().then(n.bind(null,2305))}),500),ne=function(e){function t(t,n){var a=e.call(this,t)||this;return a._headerControl=Object(m.createRef)(),a._peoplePickerHasUnresolvedText=!1,a._onSharedWithClicked=function(){a.context.sharingStore.getEngagementHelper().manageAccessFacePileClicked(a._engagementExtraData),a.props.onShowPermissionsListClicked()},a._onConfirmationExternalSharingApply=function(){a.setState({showConfirmationDialog:!1,showShareHintAnimation:!0},function(){a.props.onAudienceChange(o.e.specificPeopleFlex,s.e.flexible)})},a._onConfirmationExternalSharingCancel=function(){a.setState({showConfirmationDialog:!1})},a._onSelectedPeopleChange=function(e){var t=a.props,n=void 0;Object(y.a)(t.sharingInformation)&&(n=t.onShareHintClick,N.I()&&(n=t.onShareHintClick.bind(a,J.t.PeoplePickerErrorLinkSettingsHint)));var i=p.o({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,onShareHintClick:n,permissionsMap:t.permissionsMap,audience:t.currentSettings.audience}),r=!1,o=!1,c=null;if(i){for(var d=t.currentSettings.sharingLinkKind,l=d===s.e.organizationEdit||d===s.e.organizationView,u=0,f=e;u<f.length;u++){var m=f[u];if(m.isExternal&&l){r=!0,k.t()&&(o=!0,c=m);break}}r&&a.context.sharingStore.getEngagementHelper().externalSharingCslError(a._engagementExtraData)}a.setState({peoplePickerErrorMessage:i,showConfirmationDialog:o,externalSharingPerson:c},function(){t.onSelectedPeopleChange(e)})},a._onPeoplePickerInputChange=function(e){a._peoplePickerHasUnresolvedText=""!==e},a._onShareTargetClicked=function(e,t){(N.u()&&a.context.sharingStore.isConsumer()&&a.props.currentSettings.audience!==o.e.specificPeople||a._isPeoplePickerValid(e)||!(a.props.currentSettings.audience===o.e.specificPeopleFlex||a.props.currentSettings.audience===o.e.specificPeople||a.props.linkRecipients.length>0))&&a.setState({showActivityIndicator:!0,shareType:e},function(){a.props.onShareTargetClicked(e,t)})},a._onCopyLinkSectionCopyButtonClicked=function(){a.context.sharingStore.getEngagementHelper().log("ShareV3.copyLinkSectionCopyButtonClicked",a.props.engagementExtraData),a._onShareTargetClicked(c.e.copy,!0)},a._onSendLinkClicked=function(e,t){a.context.sharingStore.getEngagementHelper().log("ShareV3.SendLinkSendButtonClicked",a.props.engagementExtraData),a._isPeoplePickerValid(c.e.share)&&a.setState({showActivityIndicator:!0,shareType:c.e.share},function(){a.props.onSendLinkClicked(e,t)})},a._onAttachAsCopyClicked=function(){var e=a.props.clientId;if(a.context.sharingStore.getEngagementHelper().sendACopyClicked(a._engagementExtraData),I.s(e)){var t=!a.state.isAttachAsCopyContextualMenuVisible;a.setState({isAttachAsCopyContextualMenuVisible:t},function(){})}else if(e===d.e.ngsc||I.r(e))try{window.external.SendCopy()}catch(e){}},a._shareClickTime=n.shareClickTime,a._shouldRenderSharedWith=!N.y()&&n.sharingStore&&n.sharingStore.isConsumer&&!n.sharingStore.isConsumer(),a._engagementExtraData=t.engagementExtraData,a._sharingClientMessenger=n.sharingClientMessenger,a.state={isAttachAsCopyContextualMenuVisible:!1,shareType:c.e.share,showActivityIndicator:!1,peoplePickerErrorMessage:null,showConfirmationDialog:!1,externalSharingPerson:null,showShareHintAnimation:!1},a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():U.b(this._shareClickTime,this.props.clientId,l.e.share,this.props.scenarioId,this.props.correlationId),this._updatePeoplePickerError(this.props),I.r(this.props.clientId)&&this._headerControl.current&&this._headerControl.current.focusCloseButton()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)},t.prototype.render=function(){var e=this.props,t=this.state.showActivityIndicator?this._getActivityMessage():"",n=this.props.hideShareDialogOverflowButton||this._shouldRenderSharedWith,i=this._renderFooter(),o=this.props.hasBackButton?"od-ShareMain-Header-backBtnAdjust":"";return m.createElement("div",{className:"od-ShareMain ".concat(this.state.showActivityIndicator?" blocker":"")},m.createElement("div",{className:"od-ShareMain-section new"},m.createElement("div",{className:"od-ShareMain-Header ".concat(o)},m.createElement(r.e,Object(a.__assign)({},Object(z.e)(this.props),{item:e.item,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,viewState:G.e.default,hideShareDialogOverflowButton:n,ref:this._headerControl,hasBackButton:this.props.hasBackButton,closeButtonOnBlur:this.props.closeButtonOnBlur,closeButtonOnFocus:this.props.closeButtonOnFocus,fullScreenIframeMode:this.props.fullScreenIframeMode,sensitivityLabelInformation:this.props.sharingInformation.sensitivityLabelInformation,getGraphToken:this.props.getGraphToken}))),m.createElement("div",{className:"od-ShareMain-ShareHint ".concat(this.state.showShareHintAnimation?"animation":"")},m.createElement(V.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:e.onShareHintClick.bind(this,J.t.MainLinkSettingsHint),sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig})),this._renderSendLink()),this._renderCopyLinkSection(n),this._renderSharedWith(),i,this._renderActivityIndicator(),this._renderConfirmationDialogExternalSharing(),Y.e(t,"assertive","alert",!0))},t.prototype._renderCopyLinkSection=function(e){return N.Q()?m.createElement("div",{className:"od-ShareMain-section new separator-top"},m.createElement(r.e,Object(a.__assign)({},Object(z.e)(this.props),{item:this.props.item,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,viewState:G.e.default,hideShareDialogOverflowButton:e,ref:this._headerControl,title:v.Ke,doNotrenderHeaderButtons:!0,hideItemName:!0,titleIsSubLevel:!0})),m.createElement("div",{className:"od-ShareMain-copyLink shareType-section"},m.createElement(V.e,{clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,onShareHintClick:this.props.onShareHintClick.bind(this,J.t.CopyLinkSettingsHint,!0),sharingInformation:this.props.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}),m.createElement("div",{className:"od-ShareMain-copyLink copyLink-button"},m.createElement(b.e,{ctaLabel:v.We,currentSettings:this.props.currentSettings,errorMessage:this.state.peoplePickerErrorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:te,maximumSubjectLength:te,messageText:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this._onCopyLinkSectionCopyButtonClicked,permissionsMap:this.props.permissionsMap,sendButtonType:g.e.copyLink,sharingInformation:this.props.sharingInformation})))):m.createElement(m.Fragment,null,m.createElement(X.e,null),m.createElement(Z.e,{singleComponent:!1,clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,sharingInformation:this.props.sharingInformation,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,hostOptions:this.props.hostOptions,onShareHintClick:this.props.onShareHintClick,onSendLinkClicked:this._onCopyLinkSectionCopyButtonClicked}))},t.prototype._renderFooter=function(){var e=this.props,t=e.clientId;if(I.s(t)){var n=K.getAttachAsCopyOptions(t,e.item,this.context.sharingStore,this._engagementExtraData);if(1===n.length&&"pdf"!==n[0].key)return m.createElement("div",null,m.createElement("button",{className:"od-ShareMain-footer",onClick:n[0].onClick},m.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},m.createElement(E.e,{iconName:"Copy"})),m.createElement("span",null,v.te)));if(n.length>0)return m.createElement("div",null,m.createElement(q.e,{className:"od-ShareMain-footer",text:v.te,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:n},styles:{label:{marginLeft:"0px"}}}))}else if((t===d.e.ngsc||I.r(t))&&this._isSendCopyEnabled())return m.createElement("div",null,m.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},m.createElement("div",{className:"od-ShareMain-attachIcon"},m.createElement(E.e,{iconName:"Copy"})),m.createElement("span",null,v.te)))},t.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||Object(y.T)(this.props.sharingInformation)){var e=this.props;return m.createElement(B,{fullscreenIframeMode:this.props.fullScreenIframeMode,ctaLabel:v.Io,showTextArea:!0,sharingInformation:e.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:e.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,linkRecipients:e.linkRecipients,permissionsMap:e.permissionsMap,messageText:e.messageText,subjectText:e.subjectText,onSendLinkMessageChange:e.onSendLinkMessageChange,onSendLinkSubjectChange:e.onSendLinkSubjectChange,createPeopleSharingLinks:e.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:e.clientId,showSendButton:!0,maximumMessageLength:te,maximumSubjectLength:100,isLoadingDefaultRecipients:e.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this._engagementExtraData,onShareHintClick:this.props.onShareHintClick,onRoleChange:this.props.onRoleChange,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onLinkSettingsClicked:e.onShareHintClick.bind(this,J.t.RoleSelector),onShareTargetClicked:this._onShareTargetClicked,outlookAvailability:this.props.outlookAvailability})}},t.prototype._renderSharedWith=function(){if(this._shouldRenderSharedWith){var e=Object(y.C)(this.props.sharingInformation),t=e.shared,n=e.activeLinks,a=e.sharingPrincipals;return t?m.createElement("div",{className:"od-ShareMain-section od-ShareMain-SharedWith new separator-top"},m.createElement(j.e,{ariaLabel:v.Kn,label:v.Ro,getPhotoUrl:Object(Q.t)(this.props.sharingInformation.webUrl),onClick:this._onSharedWithClicked,sharingLinks:n,sharingPrincipals:a})):null}return null},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return m.createElement(W.e,{message:this._getActivityMessage(),ariaHidden:!0})},t.prototype._renderConfirmationDialogExternalSharing=function(){if(!k.t()||!this.state.showConfirmationDialog||!this.state.externalSharingPerson)return null;var e=this.state.externalSharingPerson;return m.createElement(m.Suspense,{fallback:m.createElement(S.e,null)},m.createElement(ee,{confirmationCode:$.e.shareDialogExternalSharing,participant:e,onApply:this._onConfirmationExternalSharingApply,onCancel:this._onConfirmationExternalSharingCancel}))},t.prototype._getActivityMessage=function(){switch(this.state.shareType){case c.e.share:return v.b;case c.e.mobileShareToTeams:case c.e.webShareToTeams:return v.h;case c.e.outlook:return v._;case c.e.copy:case c.e.nonOutlook:case c.e.moreApps:default:return v.m}},t.prototype._isSendCopyEnabled=function(){return U.l()},t.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==c.e.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===o.e.specificPeople){for(var t=!1,n=!1,a=0,i=this.props.linkRecipients;a<i.length;a++){var r=i[a];t||(t=r.isExternal&&!r.providerName),n||(n=!r.isExternal||r.isExternal&&!!r.providerName)}if(t&&n)return this.setState({peoplePickerErrorMessage:m.createElement("span",{role:"alert","aria-live":"assertive"},v.Xn)}),!1}var s=this.props.currentSettings.audience===o.e.specificPeopleFlex||this.props.currentSettings.audience===o.e.specificPeople||e===c.e.share;return this._peoplePickerHasUnresolvedText?(this.setState({peoplePickerErrorMessage:m.createElement("span",{role:"alert","aria-live":"assertive"},v.Ns)}),!1):0!==this.props.linkRecipients.length||!s||(this.setState({peoplePickerErrorMessage:m.createElement("span",{role:"alert","aria-live":"assertive"},v.Zr)}),!1)}},t.prototype._updatePeoplePickerError=function(e){var t=void 0;if(Object(y.a)(e.sharingInformation)&&(t=e.onShareHintClick,N.I()&&(t=e.onShareHintClick.bind(this,J.t.PeoplePickerErrorLinkSettingsHint))),e.linkRecipients||e.sharingInformation.errorCategory==u.e.shareLink){var n=p.o({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:t,permissionsMap:e.permissionsMap,audience:e.currentSettings.audience});n||e.sharingInformation.errorCategory!=u.e.shareLink||(n=m.createElement("span",null,e.sharingInformation.errorMessage)),this.setState({peoplePickerErrorMessage:n,showActivityIndicator:!n&&this.state.showActivityIndicator})}},t.prototype.shouldShowActivityIndicator=function(e){this.setState({showActivityIndicator:e})},t.contextTypes={shareClickTime:_.number,sharingStore:_.object.isRequired,sharingClientMessenger:_.object},t}(m.Component)},function(e,t,n){"use strict";n.r(t),n.d(t,"ModifyPermissions",function(){return re});var a=n(0),i=n(17);Object(i.n)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ModifyPermissions.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-ModifyPermissions .ms-Dialog-main{width:450px;max-width:none}.od-ModifyPermissions .ms-Dialog-header{display:none}.od-ModifyPermissions .ms-Dialog-actions{margin:20px}.od-ModifyPermissions.wide{min-width:480px}@media (max-width:480px){.od-ModifyPermissions.wide{min-width:320px}}#od-ModifyPermissions-apply-id.ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}.od-ModifyPermissions-header{padding:12px 0;text-align:center;height:44px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ModifyPermissions-actions{padding:0 20px 20px 20px}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-actions div.ms-Button-label{font:-apple-system-headline}#od-ModifyPermissions-actions-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}.teams .od-ModifyPermissions-actions{padding-bottom:32px}[dir=ltr] .teams .od-ModifyPermissions-actions.old{padding-right:0}[dir=rtl] .teams .od-ModifyPermissions-actions.old{padding-left:0}.od-ModifyPermissions-section{padding:0}.od-ModifyPermissions-section.new{padding:24px!important}.od-ModifyPermissions-section.permissionsSettings{padding-top:0!important;padding-bottom:0!important}.teams .od-ModifyPermissions-section{padding-top:10px}.od-ModifyPermissions-section-noAudienceMod{padding-top:0}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-actions.new{padding:24px}.od-ModifyPermissions-margins{margin:0 14px 0 10px;padding:0 6px}[dir=rtl] .od-ModifyPermissions-margins{margin:0 10px 0 14px}.od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{width:100%;margin-top:4px;margin-bottom:4px}[dir=ltr] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-left:-4px}[dir=rtl] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-right:-4px}@media screen and (-ms-high-contrast:active){.od-ModifyPermissions-apply:focus,.od-ModifyPermissions-apply:hover{background:highlight}}.od-ModifyPermissions-Header{padding:16px}"}]);var r=n(1098),o=n(2579),s=n(2576),c=n(2578),d=n(2321),l=n(1934),u=n(1991),f=n(1889),p=n(1830),m=n(1863),_=(n(2137),n(2155)),h=n(112),b=n(2125),g=n(2343),v=n(2146),y=n(2149),S=n(1804),D=n(1990),I=n(2690),x=n(2138),C=n(1839),O=n(1),w=n(1800),E=n(1834),A=n(39),L=n(1954),k=n(1801),M=n(2156),P=n(1806),T=n(2268),U=n(476),F={"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bmp:1,cbl:1,cfg:1,cool:1,cr2:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,dwg:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},H={"3fr":1,"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,ari:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bay:1,bmp:1,cap:1,cbl:1,cfg:1,cool:1,cr2:1,cr3:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dcr:1,dcs:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,drf:1,dwg:1,eip:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,fff:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,iiq:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,k25:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mef:1,mkv:1,mos:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mpeg:1,mpg:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,ori:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,ptx:1,pxn:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srf:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,x3f:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},R=n(8),N=n(2157);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}[dir=ltr] .teams .od-LinkTemplateChoiceGroup-row{padding-left:0}[dir=rtl] .teams .od-LinkTemplateChoiceGroup-row{padding-right:0}.teams .od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{font-weight:700}.od-LinkTemplateChoiceGroup-row{background:0 0;border:none;cursor:pointer;margin-top:4px;font:-apple-system-caption1;padding:0;width:calc(100% - 24px)}.od-LinkTemplateChoiceGroup-row .od-ShareHintDetail{padding-top:2px}.od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:';font-weight:600}.od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{content:"\\e73e";font-family:FabricMDL2Icons;color:'},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin-top:10px;font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:"},{theme:"smallFontWeight",defaultValue:"400"},{rawString:"}[dir=ltr] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir=rtl] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:left}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareHintDetail-statusText{color:#a19f9d}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}@media screen and (-ms-high-contrast:active){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast:black-on-white){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset}@media screen and (-ms-high-contrast:active){.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{box-shadow:0 0 0 1px #37006e inset}}.teams .od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:0}.od-LinkTemplateChoiceGroup-description{align-items:center;display:inline-flex;overflow:hidden;width:90%}[dir=ltr] .od-LinkTemplateChoiceGroup-description{float:left}[dir=rtl] .od-LinkTemplateChoiceGroup-description{float:right}"}]);var B=n(1750),j=n(345),V=n(1807),z=n(1673),G=n(2153),K=n(814),W=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onActiveElementChanged=function(e){if(!a._platformDetection.isMobile&&!P.r(a.props.clientId)&&e&&e.hasAttribute("data-key")){var t=e.getAttribute("data-key");"true"===e.getAttribute("aria-disabled")||a._onRowClick(t,null)}},a.state={selectedKey:a._getSelectedIndex(t)},a._platformDetection=n.platformDetection,a}return Object(a.__extends)(t,e),t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var a=n[t];if(a.isChecked)return a.key}return null},t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return O.createElement("div",{"aria-label":k._r,role:"radiogroup"},O.createElement(B.e,{direction:j.e.vertical,defaultActiveElement:".od-LinkTemplateChoiceGroup-row.is-selected",onActiveElementChanged:this._onActiveElementChanged},e))},t.prototype._renderItem=function(e){var t=e.key,n=e.isDisabled&&e.disabledText?e.disabledText:"",a=this.state.selectedKey===t,i=D.e[e.permissionsType],r=e.iconUrl?O.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:e.iconUrl,alt:e.label}):O.createElement(U.e,{"aria-hidden":"true",iconName:i});return O.createElement("div",{key:t},O.createElement("button",{role:"radio","aria-checked":a,key:t,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,t),className:this._getRowClasses(e),autoFocus:a,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":"".concat(e.label," ").concat(n),"data-key":t},O.createElement("span",{tabIndex:-1,role:"status","aria-live":"polite","aria-label":a?A.format(k.ne,e.label):"",className:"od-Share-screenReaderOnly"},a?A.format(k.ne,e.label):""),O.createElement("div",{className:"od-LinkTemplateChoiceGroup-description"},O.createElement("div",{className:"od-ShareLinkDescription"},O.createElement("div",{className:"od-ShareLinkDescription-icon icon-".concat(i),"aria-hidden":"true"},r),this._renderLabel(e))),O.createElement("div",{className:"tickIcon","aria-hidden":!0})),O.createElement("div",{className:"od-LinkTemplateChoiceGroup-bottomBorder"}))},t.prototype._renderLabel=function(e){var t=e.isDisabled&&e.disabledText?e.disabledText:"";return t&&O.createElement(G.e,{message:t}),O.createElement("div",{className:"od-ShareHintDetail"},O.createElement("div",{className:"od-ShareHintDetail-description"},O.createElement("div",{className:"od-ShareHintDetail-status"},O.createElement("span",{className:"od-ShareHintDetail-statusText"},e.label),this._renderStatusIcons(e.link))))},t.prototype._renderStatusIcons=function(e){if(e){var t=e.expiration,n=e.hasPassword,a=e.blockDownload,i=[];t&&t.getTime()!==new Date(0).getTime()&&i.push({icon:"Calendar",tooltip:"".concat(A.format(k.Vt,Object(V.d)(t)))}),n&&i.push({icon:"Lock",tooltip:k.To}),a&&i.push({icon:"Blocked2",tooltip:k.Ir}),e.audience!==o.e.existing&&e.isReview&&K.t[this.props.sharingInformation.fileExtension]&&i.push({icon:"Feedback",tooltip:k.Ga});var r=i.map(function(e,t){return O.createElement("i",{className:"od-ShareHintDetail-item"},O.createElement(z.e,{content:e.tooltip,id:e.icon},O.createElement(U.e,{iconName:e.icon,"aria-describedby":e.icon})))});return O.createElement("div",{className:"od-ShareHintDetail-iconsList"},r)}},t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-LinkTemplateChoiceGroup-row";return this.state.selectedKey===e.key&&(t+=" is-selected"),e.isDisabled&&(t+=" is-disabled"),t},t.prototype._onRowClick=function(e,t){var n=this.props;this.setState({selectedKey:e}),n.onChange(e),n.onLinkTemplateChange(e)},t.contextTypes={platformDetection:w.object.isRequired},t}(O.Component),q=n(1829),Q=n(1802),Y=n(1885),J=n(2050),X=n(1998),Z=function(e){function t(t,n){var i,r,o=this;(o=e.call(this,t)||this)._allowEditCheckbox=Object(O.createRef)(),o._pickerUpsellDiv=Object(O.createRef)(),o._passwordUpsellDiv=Object(O.createRef)(),o._linkSettingsImprovement=Q.U(),o._onSharedWithClicked=function(){o.context.sharingStore.getEngagementHelper().manageAccessFacePileClicked(o.props.engagementExtraData),o.props.onShowPermissionsListClicked()},o._learnMoreClicked=function(){o.context.sharingStore.getEngagementHelper().linkSettingsLearnMoreClicked(o.props.engagementExtraData)},o._onPeoplePickerChange=function(e){o.setState(Object(a.__assign)(Object(a.__assign)({},o.state),{externalRecipientWarning:C.n(e),groupRecipientWarning:C.a(e,o.props.groupsMemberCount)}),function(){o.props.onPeoplePickerChange(e)})},o._setSpecificPeopleReadOnlyExpanded=function(){o.setState({isSpecificPeopleReadOnlyExpanded:!0})},o._onAllowRoleChange=function(e){var t=!1,n=!1;e===s.e.edit&&(t=!0),e===s.e.review&&(n=!0);var i=o.state.officeReviewModeDisabled;Q.s()&&(i=!n),o.setState(Object(a.__assign)(Object(a.__assign)({},o.state),{preventDownloadDisabled:t||n,officeReviewModeDisabled:i}),function(){o.props.onRoleChange(e)})},o._onResolvedSuggestions=function(e){return o.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(o.props.engagementExtraData,e),e},o._resize=n.resize;var c=t.selectedPermissions.specificPeople;return o.state={expirationErrorCode:S.e.none,externalRecipientWarning:C.n(c),groupRecipientWarning:C.a(c,t.groupsMemberCount),preventDownloadDisabled:o.props.selectedPermissions.isEdit||o.props.selectedPermissions.isReview,officeReviewModeDisabled:!1===o.props.selectedPermissions.isEdit&&!1===o.props.selectedPermissions.isReview,showPickerTeachingBubble:!1,showPasswordTeachingBubble:!1,isSpecificPeopleReadOnlyExpanded:!1},o._onAllowEditChange=o._onAllowEditChange.bind(o),o._onTrackableChange=o._onTrackableChange.bind(o),o._onLinkTemplateChoiceChange=o._onLinkTemplateChoiceChange.bind(o),o._onSelectDate=o._onSelectDate.bind(o),o._renderExpirationDatePicker=o._renderExpirationDatePicker.bind(o),o._renderExpirationDatePickerErrorMessage=o._renderExpirationDatePickerErrorMessage.bind(o),o._renderPeoplePicker=o._renderPeoplePicker.bind(o),o._linkTemplateOptions=o._getLinkTemplateOptions(),o._supportedAudienceOptions=n.sharingStore.getSupportedAudienceOptions(),o._hiddenAudienceOptions=(null===(i=t.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[],o._disabledAudienceOptions=(null===(r=t.hostOptions)||void 0===r?void 0:r.disabledAudienceOptions)||[],o._canReviewInRoleSelector=Q.s(),o}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.context.platformDetection.isMobile;this._isConsumer=this.context.sharingStore.isConsumer(),this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed(),this._disablePremiumFeatures&&(this._pickerUpsellDiv.current&&(this._pickerUpsellDiv.current.addEventListener("click",function(t){e._togglePickerTeachingBubble()}),this._pickerUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==h.e.enter&&t.keyCode!==h.e.space||e._togglePickerTeachingBubble()}),t&&this._pickerUpsellDiv.current.addEventListener("focus",function(t){e._togglePickerTeachingBubble()})),this._passwordUpsellDiv.current&&(this._passwordUpsellDiv.current.addEventListener("click",function(t){e._togglePasswordTeachingBubble()}),this._passwordUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==h.e.enter&&t.keyCode!==h.e.space||e._togglePasswordTeachingBubble()}),t&&this._passwordUpsellDiv.current.addEventListener("focus",function(t){e._togglePasswordTeachingBubble()})));var n,a,i=document.getElementsByClassName("od-PermissionsSettings-allowEdit")[0];i&&(n=i.getElementsByClassName("ms-Checkbox-text")[0],a=i.children[0]),n&&n.setAttribute("aria-hidden","true"),a&&(a.setAttribute("aria-label",k.L),this.context.sharingStore.isPremiumExperienceAllowed()||a.focus())},t.prototype.componentDidUpdate=function(e,t){this._resize()},t.prototype.render=function(){var e=this.props;this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed();var t="";return this._linkSettingsImprovement&&(t=" new"),this._getLinkTemplateOptions().length>0?O.createElement("div",{className:"od-PermissionsSettings"},O.createElement("div",{className:"od-PermissionsSettings-section"+t},O.createElement("h3",{className:"od-PermissionsSettings-description header od-ModifyPermissions-margins"+t},O.createElement("span",{className:"od-PermissionsSettings-linksFromTemplateHeader"},k.Nn)),O.createElement(W,{items:this._getLinkTemplateOptions(),onChange:this._onLinkTemplateChoiceChange,onLinkTemplateChange:e.onLinkTemplateChange,companyName:e.companyName,clientId:e.clientId,sharingInformation:e.sharingInformation}),this._renderPeoplePicker())):this._getAudienceOptions().length>1?O.createElement("div",{className:"od-PermissionsSettings"},O.createElement("div",{className:"od-PermissionsSettings-section"+t},O.createElement("h3",{className:"od-PermissionsSettings-description header od-ModifyPermissions-margins"+t},O.createElement("span",{className:"od-PermissionsSettings-prompt",id:"od-PermissionsSettings-prompt-id"},this._linkSettingsImprovement?k.hr:k._r),this.context.sharingStore.showAudienceLearnMore()&&!this._linkSettingsImprovement&&O.createElement("a",{id:"od-PermissionsSettings-learnMore",className:"od-PermissionsSettings-learnMore","aria-label":"".concat(k.An,": ").concat(k._r,". ").concat(k.Ja),href:"https://go.microsoft.com/fwlink/?linkid=846149",target:"_blank",onClick:this._learnMoreClicked,tabIndex:0},k.An,O.createElement(U.e,{iconName:"OpenInNewTab"}))),O.createElement(_.e,{items:this._getAudienceOptions(),onAudienceChange:e.onAudienceChange,companyName:e.companyName,clientId:e.clientId,engagementExtraData:e.engagementExtraData}),this._renderPeoplePicker()),this._renderOtherSettings()):O.createElement("div",{className:"od-PermissionsSettings"},O.createElement("div",{className:"od-PermissionsSettings-section"+t}),this._renderOtherSettings())},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this,n=e.selectedPermissions,i=n.specificPeople;0===i.length&&e.recipients.length>0&&this._onPeoplePickerChange(e.recipients),this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{expirationErrorCode:Object(S._)(n.expiration,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),externalRecipientWarning:C.n(i),groupRecipientWarning:C.a(i,e.groupsMemberCount),preventDownloadDisabled:n.isEdit||n.isReview,officeReviewModeDisabled:!n.isEdit&&!n.isReview}),function(){t.props.updateExpirationErrorCode(t.state.expirationErrorCode)})},t.prototype._togglePickerTeachingBubble=function(){this.setState({showPickerTeachingBubble:!this.state.showPickerTeachingBubble})},t.prototype._togglePasswordTeachingBubble=function(){this.setState({showPasswordTeachingBubble:!this.state.showPasswordTeachingBubble})},t.prototype._renderOtherSettings=function(){var e=!this._disablePremiumFeatures||!this.context.sharingStore.disablePremiumUpsell(),t="",n=k.Xa;if(this._linkSettingsImprovement&&(t=" new other-settings",this._linkSettingsImprovement&&(n=k.oa)),this.props.selectedPermissions.audience!==o.e.existing&&!this.props.sharingInformation.requiresAccessApproval)return O.createElement("div",{className:"od-PermissionsSettings-section od-ModifyPermissions-margins"+t},O.createElement("h3",{className:"od-PermissionsSettings-description od-PermissionsSettings-otherSettings header "+t},n),O.createElement("div",{role:"group","aria-label":n},O.createElement("div",{className:"od-PermissionsSettings-setting"},this._renderRolesDropDown()),!this._isConsumer&&!this._canReviewInRoleSelector&&this._renderOfficeReviewModeToggle(),e&&this._renderExpirationDatePicker(),this.props.sharingInformation.anyoneLinkTrackUsers&&this._renderRequireVerificationToggle(),e&&this._renderPasswordField(),this._renderPreventDownloadToggle()))},t.prototype._getSpecificPeopleOption=function(){var e=this.props.sharingInformation.requiresAccessApproval,t=e?k.mr:this._getSpecificPeopleLabel(),n=!this.props.createPeopleSharingLinks||e?[c.e.direct]:[c.e.flexible],a=this.props.createPeopleSharingLinks?o.e.specificPeopleFlex:o.e.specificPeople,i={disabledText:k.yt,icon:D.e[I.e.specificPeople],isChecked:!1,isDisabled:!1,key:a,label:t,linkKinds:n,permissionsType:I.e.specificPeople};return this._linkSettingsImprovement&&(i.label=k.ur,i.detailText=k.lr,this.props.selectedPermissions.audience!==o.e.specificPeople&&this.props.selectedPermissions.audience!==o.e.specificPeopleFlex||!this.props.copyLinkShortcut&&this.props.mode!==r.e.linkSettings||(i.subComponent=O.createElement(L.e,{defaultSelectedItems:this.props.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:this.state.externalRecipientWarning,oversharingGroupsWarning:this.state.groupRecipientWarning,pickerSettings:this.props.sharingInformation.peoplePickerSettings,error:this.props.peoplePickerError,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:this._onResolvedSuggestions,onInputChange:this.props.onPeoplePickerInputChange||null}))),i},t.prototype._renderPeoplePicker=function(){var e=this.props,t=e.selectedPermissions,n=e.copyLinkShortcut,a=e.mode,i=e.peoplePickerError,s=e.sharingInformation,c=e.onPeoplePickerInputChange,d=e.clientId,l=e.currentSettings,u=this.state;if(!(t.audience!==o.e.specificPeople&&t.audience!==o.e.specificPeopleFlex||!n&&a!==r.e.linkSettings))return P.d(this.props.clientId)?O.createElement("div",{className:"od-PermissionsSetting-specificPeople-container"},l.specificPeople.length>0?this._renderReadOnlySpecificPeople():void 0):this._linkSettingsImprovement?void 0:O.createElement("div",{className:"od-ModifyPermissions-margins od-PermissionsSettings-PeoplePicker"},O.createElement(L.e,{defaultSelectedItems:t.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:u.externalRecipientWarning,oversharingGroupsWarning:u.groupRecipientWarning,pickerSettings:s.peoplePickerSettings,error:i,sharingInformation:s,clientId:d,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:this._onResolvedSuggestions,onInputChange:c||null}))},t.prototype._renderReadOnlySpecificPeople=function(){for(var e="",t=this.props.currentSettings.specificPeople,n=this.state.isSpecificPeopleReadOnlyExpanded?t.length:5,a=t.length-n,i=0;i<Math.min(t.length,n);i++)e+=t[i].name+(t.length-1>i?", ":"");var r=a>0&&!this.state.isSpecificPeopleReadOnlyExpanded?O.createElement("a",{href:"javascript:void(0)",onClick:this._setSpecificPeopleReadOnlyExpanded}," +"+a):void 0;return O.createElement("div",{className:"od-PermissionsSetting-specificPeople-list"},e,r)},t.prototype._renderRolesDropDown=function(){var e=this.props,t=E.l(e.selectedPermissions.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension),n=!1;this._canReviewInRoleSelector&&(n=!this.context.sharingStore.isConsumer()&&E.c(e.selectedPermissions.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension));var a=e.sharingInformation.sharedObjectType===Y.e.list;return t||a||this._canReviewInRoleSelector?O.createElement("div",{className:"od-PermissionsSettings-changePermission"},O.createElement(x.e,{mode:e.mode,clientId:e.clientId,selectedPermissions:e.selectedPermissions,onRoleChange:this._onAllowRoleChange,canChangePermission:!1,sharingInformation:this.props.sharingInformation,showDropdownWithOfficeReview:n})):O.createElement(b.e,{className:"od-PermissionsSettings-allowEdit",label:k.L,onChange:this._onAllowEditChange,checked:e.selectedPermissions.isEdit,disabled:!e.selectedPermissions.allowEditing,componentRef:this._allowEditCheckbox,styles:{text:{fontSize:"0.875rem",lineHeight:"1.25rem"},checkbox:{width:"1.25rem",height:"1.25rem"},checkmark:{fontSize:"0.875rem"}}})},t.prototype._renderRequireVerificationToggle=function(){var e=this.props,t=e.selectedPermissions,n=this.props.sharingInformation.anyoneLinkTrackUsers,a=Q.se()&&P.n(e.clientId),i=!a,r=!1;return t.audience===o.e.anyone?(r=!(!n||a)||t.trackLinkUsers,O.createElement("div",{className:"od-PermissionsSettings-setting"},O.createElement("div",{className:"od-PermissionsSettings-setting--RequireVerification"},O.createElement("div",{className:"od-RequireVerificationToggle"},O.createElement("div",{className:"od-PermissionsSettings-setting--RequireVerification-Icon"},O.createElement(U.e,{iconName:"ReminderPerson"})),O.createElement(g.e,{"aria-disabled":i,role:"checkbox",checked:r,disabled:i,label:a?k.mo:k.ho,onChange:this._onTrackableChange,styles:{label:{fontSize:".875rem"},pill:{width:"2.5rem",height:"1.25rem",borderWidth:"0.0625rem",borderRadius:"0.625rem"},thumb:{width:"0.75rem",height:"0.75rem"}}}))))):void 0},t.prototype._renderExpirationDatePicker=function(){var e=this.props,t=e.selectedPermissions;return this.context.sharingStore.isExpirationDateModificationAllowed()&&(t.audience===o.e.anyone||this.context.sharingStore.isSpecificPeopleExpirationAllowed()&&t.audience===o.e.specificPeople)?this._disablePremiumFeatures?O.createElement("div",{ref:this._pickerUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0,role:"tab","aria-label":"".concat(k.Mt)},O.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},O.createElement("div",{className:"od-PermissionsSettings-setting"},O.createElement("div",{className:"od-PermissionsSettings-datePicker"},O.createElement(v.e,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures,tabIndex:-1})),this._renderExpirationTeachingBubble(),O.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())))):O.createElement("div",{className:"od-PermissionsSettings-setting"},O.createElement("div",{className:"od-PermissionsSettings-datePicker"},O.createElement(v.e,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures})),this._renderExpirationTeachingBubble(),this._renderExpirationDatePickerErrorMessage()):void 0},t.prototype._renderExpirationTeachingBubble=function(){var e=this;if(this.state.showPickerTeachingBubble){var t={targetElement:this._pickerUpsellDiv.current,onDismiss:function(t){return e.setState({showPickerTeachingBubble:!1})},headline:k.Ht,mainText:k.Rt};return this._renderUpsellTeachingBubble(t)}},t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode,t=Object(S.m)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);if(""!==t)return O.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},t)},t.prototype._renderPasswordField=function(){var e=this.props,t=this.context.sharingStore.isPasswordModificationAllowed(),n=e.selectedPermissions;return t&&n.audience===o.e.anyone?this._disablePremiumFeatures?O.createElement("div",{ref:this._passwordUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0,role:"tab","aria-label":"".concat(k.ci)},O.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},O.createElement("div",{className:"od-PermissionsSettings-setting"},O.createElement(y.e,{onPasswordChange:this.props.onPasswordChange,readOnly:!0,showGleam:!0,tabIndex:-1,engagementExtraData:this.props.engagementExtraData}),this._renderPasswordTeachingBubble()))):O.createElement("div",{className:"od-PermissionsSettings-setting"},O.createElement(y.e,{onPasswordChange:this.props.onPasswordChange,engagementExtraData:this.props.engagementExtraData})):void 0},t.prototype._renderPasswordTeachingBubble=function(){var e=this;if(this.state.showPasswordTeachingBubble){var t={targetElement:this._passwordUpsellDiv.current,onDismiss:function(t){return e.setState({showPasswordTeachingBubble:!1})},headline:k.Di,mainText:k.Ii};return this._renderUpsellTeachingBubble(t)}},t.prototype._getLinkTemplateOptions=function(){var e=[],t=this.props.sharingInformation,n=t.sharingLinkTemplates,a=t.sharingAbilities,i=E.i(a,n);if(i.length>0){for(var r=0,s=i;r<s.length;r++){var d=s[r];e.push(this._getLinkTemplateOption(d))}var l={icon:D.e[I.e.workGroup],isChecked:this.props.currentSettings.audience===o.e.existing,isDisabled:!1,key:o.e.existing.toString(),label:k.nr,linkKinds:[c.e.direct],permissionsType:I.e.existing};e.push(l);var u=this.props.sharingInformation.requiresAccessApproval?k.mr:this._getSpecificPeopleLabel(),f={icon:D.e[I.e.specificPeople],isChecked:this.props.currentSettings.audience===o.e.specificPeople,isDisabled:!1,key:o.e.specificPeople.toString(),label:u,linkKinds:[c.e.direct],permissionsType:I.e.specificPeople};e.push(f)}return e},t.prototype._getLinkTemplateOption=function(e){var t={icon:D.e[I.e.anyone],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[c.e.anonymousView,c.e.anonymousEdit],permissionsType:I.e.anyone,link:e},n={icon:D.e[I.e.workGroup],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[c.e.organizationView,c.e.organizationEdit],permissionsType:I.e.workGroup,link:e};switch(e.audience){case o.e.anyone:return t.key=e.shareId,t.label=Object(S.y)(e,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension),t;case o.e.organization:return n.key=e.shareId,n.label=Object(S.y)(e,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension),n}},t.prototype._getAudienceOptions=function(){var e=this.props.sharingInformation.sharingAbilities,t=this.props.sharingInformation,n=[],a=this.props.currentSettings,i=void 0;for(var s in e)if(e.hasOwnProperty(s)){var d=e[s];if(null!==d){var l=E.n(s),u=n.map(function(e){return e.key}).indexOf(l)>-1;if(!l||u)continue;if(l===o.e.specificPeopleFlex&&!this.props.createPeopleSharingLinks){i=this._getSpecificPeopleOption(),t.canManagePermissions&&!t.blockPeoplePickerAndSharing?i.isChecked=i.key===a.audience||o.e.specificPeopleFlex===a.audience:i.isDisabled=!0,this._supportedAudienceOptions.indexOf(o.e.specificPeople)>-1&&n.push(i);continue}(w=this._getAudienceOption(l))&&(w.isDisabled=!(d.canManageEditLink.enabled||d.canManageReadLink.enabled),w.isChecked=w.key===a.audience,n.push(w))}}var f={icon:D.e[I.e.workGroup],isChecked:a.audience===o.e.existing,isDisabled:!1,key:o.e.existing,label:k.nr,linkKinds:[c.e.direct],permissionsType:I.e.existing,detailText:k.tr};if(-1!==this._supportedAudienceOptions.indexOf(o.e.existing)&&n.splice(2,0,f),this._linkSettingsImprovement&&!this.context.sharingStore.isConsumer()){var p=Object(S.C)(t),m=p.shared,_=p.activeLinks,h=p.sharingPrincipals;m&&!P.u(this.props.clientId)&&(f.subComponent=O.createElement(J.e,{ariaLabel:k.Kn,label:null,getPhotoUrl:Object(X.t)(t.webUrl),onClick:this._onSharedWithClicked,sharingLinks:_,sharingPrincipals:h}))}var b=n.filter(function(e){return e.key===o.e.specificPeople&&!e.isDisabled||e.key===o.e.specificPeopleFlex&&!e.isDisabled?e:null}).length>0,g=!this.props.omitCustomLabeledAudience&&Object(S.M)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig);if(b&&g){var v=this._getAudienceOption(o.e.customLabeledSpecificPeople);n.splice(2,0,v),v.isDisabled=!(this.props.sharingInformation.canAddInternalPrincipal||this.props.sharingInformation.canAddExternalPrincipal),v.isChecked=a.audience===o.e.customLabeledSpecificPeople||this.props.preferCustomLabeledAudience&&a.audience===o.e.specificPeopleFlex}this.props.mode!==r.e.linkSettings||!P.d(this.props.clientId)||this.props.shareId&&a.audience===o.e.specificPeopleFlex||!b||n.splice(n.indexOf(b),1);for(var y=[],x=0,C=n;x<C.length;x++){var w=C[x];-1!==this._hiddenAudienceOptions.indexOf(w.key)&&a.audience!==w.key||(-1!==this._disabledAudienceOptions.indexOf(w.key)&&a.audience!==w.key&&(w.isDisabled=!0),y.push(w))}return y},t.prototype._renderPreventDownloadToggle=function(){var e,t=this.props.selectedPermissions,n=!!t.preventDownload,a=this.context.sharingStore.isPreventDownloadAllowed();return!this.context.sharingStore.getNavId()&&a&&E.u(t.audience,this.props.sharingInformation.sharingAbilities)&&((e=this.props.sharingInformation.fileExtension)&&(e=("."===e[0]?e.slice(1):e).toLowerCase(),R.t.isActivated("3B12E0BA-483A-4E92-B6EC-89DC316832D6","01/25/2022","Update BlockDownloadSupported")?F[e]>=1:H[e]>=1)||!Q.t()&&this.props.sharingInformation.sharedObjectType===Y.e.folder)?O.createElement("div",{className:"od-PermissionsSettings-setting"},O.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload"},O.createElement(M.e,{onToggleChange:this.props.onToggleChange,isToggled:n,clientId:this.props.clientId,mode:this.props.mode,disablePreventDownload:this.state.preventDownloadDisabled,isRolesDropDown:t.isReview}))):void 0},t.prototype._renderOfficeReviewModeToggle=function(){var e=this.props.selectedPermissions,t=!!e.isReview;return E.c(e.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)?O.createElement("div",{className:"od-PermissionsSettings-setting"},O.createElement("div",{className:"od-PermissionsSettings-setting--OfficeReviewMode"},O.createElement(N.e,{onToggleChange:this.props.onOfficeReviewModeToggleChange,isToggled:t,clientId:this.props.clientId,mode:this.props.mode,disableOfficeReviewMode:this.state.officeReviewModeDisabled}))):void 0},t.prototype._renderUpsellTeachingBubble=function(e){var t,n=function(){return window.open("https://onedrive.live.com/about/plans/")};if(this.context.goPremium)n=this.context.goPremium;else try{var a=window.external;a.IsGoPremiumAvailable()&&(n=function(){try{a.GoPremium("https://onedrive.live.com/about/plans/")}catch(e){}})}catch(e){}if(this.context.premiumLearnMore)t={children:k.ks,onClick:this.context.premiumLearnMore};else try{var i=window.external;i.IsPremiumLearnMoreAvailable()&&(t={children:k.ks,onClick:function(){try{i.PremiumLearnMore()}catch(e){}}})}catch(e){}return O.createElement(T.e,{targetElement:e.targetElement,onDismiss:e.onDismiss,hasCloseIcon:!0,closeButtonAriaLabel:k.Le,headline:e.headline,primaryButtonProps:{children:k.Ms,onClick:n},secondaryButtonProps:t,calloutProps:{className:"od-PermissionsSettings-teachingBubble"},hasSmallHeadline:!0,styles:{headline:{fontSize:"0.875rem"},bodyContent:{fontSize:"0.875rem"},subText:{fontSize:"0.875rem"},primaryButton:{fontSize:"0.875rem",height:"2rem",padding:"0 1rem",selectors:{".ms-Button-label":{fontSize:"0.875rem"},"&:hover":{backgroundColor:"#005A9E",color:"#FFFFFF"},"&:focus":{backgroundColor:"#005A9E",color:"#FFFFFF"}},backgroundColor:"#FFFFFF",color:"#005A9E"},closeButton:{fontSize:"0.75rem",width:"2rem",height:"2rem",selectors:{".ms-Button-icon":{fontSize:"0.75rem"}}}}},O.createElement(U.e,{iconName:"Diamond",className:"od-PermissionsSettings-teachingBubbleIcon"}),e.mainText)},t.prototype._getAudienceOption=function(e){if(e===o.e.anyone&&this._supportedAudienceOptions.indexOf(o.e.anyone)>-1){var t={disabledText:k.yt,icon:D.e[I.e.anyone],isChecked:!1,isDisabled:!1,key:o.e.anyone,label:k.Yi,linkKinds:[c.e.anonymousView,c.e.anonymousEdit],permissionsType:I.e.anyone,detailText:k.qi};return this._linkSettingsImprovement&&(t.detailText=k.Qi,t.label=k.Ji),t}if(e===o.e.organization&&this._supportedAudienceOptions.indexOf(o.e.organization)>-1){var n={disabledText:k.yt,icon:D.e[I.e.workGroup],isChecked:!1,isDisabled:!1,key:o.e.organization,label:A.format(k.$i,this.props.companyName),linkKinds:[c.e.organizationView,c.e.organizationEdit],permissionsType:I.e.workGroup,detailText:A.format(k.Xi,this.props.companyName)};return this._linkSettingsImprovement&&(n.detailText=A.format(k.Zi,this.props.companyName),n.label=A.format(k.er,this.props.companyName)),n}if(e===o.e.specificPeopleFlex&&this._supportedAudienceOptions.indexOf(o.e.specificPeopleFlex)>-1){var a={disabledText:k.yt,icon:D.e[I.e.specificPeople],isChecked:!1,isDisabled:!1,key:o.e.specificPeopleFlex,label:this._getSpecificPeopleLabel(),linkKinds:[c.e.flexible],permissionsType:I.e.specificPeople,detailText:A.format(k.cr,this.props.companyName)};return this._linkSettingsImprovement&&(a.detailText=A.format(k.dr,this.props.companyName),a.label=k.ur),!this._linkSettingsImprovement||this.props.selectedPermissions.audience!==o.e.specificPeople&&this.props.selectedPermissions.audience!==o.e.specificPeopleFlex||!this.props.copyLinkShortcut&&this.props.mode!==r.e.linkSettings||(a.subComponent=O.createElement(L.e,{defaultSelectedItems:this.props.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:this.state.externalRecipientWarning,oversharingGroupsWarning:this.state.groupRecipientWarning,pickerSettings:this.props.sharingInformation.peoplePickerSettings,error:this.props.peoplePickerError,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:this._onResolvedSuggestions,onInputChange:this.props.onPeoplePickerInputChange||null})),a}if(e===o.e.customLabeledSpecificPeople&&this._supportedAudienceOptions.indexOf(o.e.customLabeledSpecificPeople)>-1){var i,s=P.d(this.props.clientId),d=s?I.e.mail:I.e.chat,l=this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.audienceType;return i=s||"recipient"===l?k.pr:"channel"===l?k.or:"team"===l?k.fr:k.sr,{disabledText:k.yt,icon:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&D.e[d],iconUrl:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl,isChecked:!1,isDisabled:!1,key:o.e.customLabeledSpecificPeople,label:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?A.format(k.rr,this.props.customLabeledAudienceConfig.entityName):i,linkKinds:[c.e.flexible],permissionsType:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&d}}},t.prototype._getSpecificPeopleLabel=function(){if(Q.re()){var e=void 0;switch(q.r()){default:e=k.br;break;case 1:e=A.format(k.gr,this.props.companyName);break;case 2:e=A.format(k.vr,this.props.companyName)}return e}return k.br},t.prototype._onLinkTemplateChoiceChange=function(e){for(var t=0,n=this._linkTemplateOptions;t<n.length;t++){var a=n[t];a.isChecked=e===a.key}},t.prototype._onSelectDate=function(e){var t=this,n=Object(S._)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.context.sharingStore.getEngagementHelper().log("ShareV3.expirationChange",this.props.engagementExtraData),this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{expirationErrorCode:n}),function(){t.props.updateExpirationErrorCode(n),t.props.onExpirationChange(e)})},t.prototype._onTrackableChange=function(e,t){this.props.onTrackableChange(t),this.context.sharingStore.getEngagementHelper().linkTrackLinkClicked(this.props.engagementExtraData)},t.prototype._onAllowEditChange=function(e,t){this.props.onEditChange(t),this.context.sharingStore.getEngagementHelper().linkSettingsOnAllowEditingClicked(this.props.engagementExtraData),this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{preventDownloadDisabled:t,officeReviewModeDisabled:!!t}))},t.contextTypes={resize:w.func.isRequired,sharingStore:w.object.isRequired,goPremium:w.func,platformDetection:w.object.isRequired,premiumLearnMore:w.func},t}(O.Component),$=n(1176),ee=n(1642),te=n(1818),ne=n(1826),ae=n(1831),ie={root:{height:"2rem",borderRadius:"0.25rem",padding:"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"},label:{fontSize:"0.875rem"}},re=function(e){function t(t,n){var a=e.call(this,t)||this;return a._currentPassword="",a._matchingTemplate=null,a._peoplePickerHasUnresolvedText=!1,a._linkSettingsImprovement=Q.U(),a._topLevelDivRef=O.createRef(),a._onPeoplePickerInputChange=function(e){a._peoplePickerHasUnresolvedText=""!==e},a._currentPassword="",a.state=a._initializeState(),a._preventDownloadToggle=!!a.state.selectedPermissions.preventDownload,a._officeReviewModeToggle=!!a.state.selectedPermissions.isReview,a._onApplyClicked=a._onApplyClicked.bind(a),a._onCancel=a._onCancel.bind(a),a._onPeoplePickerChange=a._onPeoplePickerChange.bind(a),a._updateExpirationErrorCode=a._updateExpirationErrorCode.bind(a),a.onAudienceChange=a.onAudienceChange.bind(a),a.onLinkTemplateChange=a.onLinkTemplateChange.bind(a),a.onEditChange=a.onEditChange.bind(a),a.onRoleChange=a.onRoleChange.bind(a),a.onExpirationChange=a.onExpirationChange.bind(a),a.onTrackableChange=a.onTrackableChange.bind(a),a._getShareLinkTemplate=a._getShareLinkTemplate.bind(a),a._findMatchingShareLinkTemplate=a._findMatchingShareLinkTemplate.bind(a),a._calculateRole=a._calculateRole.bind(a),a._onPasswordChange=a._onPasswordChange.bind(a),a._onPreventDownloadToggleChange=a._onPreventDownloadToggleChange.bind(a),a._onOfficeReviewModeToggleChange=a._onOfficeReviewModeToggleChange.bind(a),a._onConfirmationUseExisting=a._onConfirmationUseExisting.bind(a),a._onConfirmationUseNew=a._onConfirmationUseNew.bind(a),a._shareClickTime=n.shareClickTime,a._resizeTracker=new ae.e(n.resize),a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():ne.b(this._shareClickTime,this.props.clientId,r.e.linkSettings,this.props.scenarioId,this.props.correlationId),this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()},t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=P.e(this.props.clientId),n=E.i(this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.sharingLinkTemplates),i="od-ModifyPermissions-section";this.context.sharingStore&&this.context.sharingStore.getSupportedAudienceOptions().length<=1&&(i+=" od-ModifyPermissions-section-noAudienceMod"),this._linkSettingsImprovement&&(i+=" new permissionsSettings");var r="od-ModifyPermissions-actions";return this._linkSettingsImprovement?r+=" new":r+=" old",O.createElement("div",{ref:this._topLevelDivRef,className:"od-ModifyPermissions ".concat(e)},O.createElement("div",{className:this._linkSettingsImprovement?"od-ModifyPermissions-section new":"od-ModifyPermissions-Header"},O.createElement(m.e,Object(a.__assign)({},Object(p.e)(this.props),{item:this.props.sharingInformation.item,viewState:n.length>0?te.e.linksFromTemplateList:te.e.modifyPermissions,mode:this.props.mode,engagementExtraData:this.props.engagementExtraData,fullScreenIframeMode:this.props.fullScreenIframeMode}))),O.createElement("div",{className:i},O.createElement(Z,Object(a.__assign)({},Object(p.e)(this.props),{mode:this.props.mode,shareId:this.props.shareId,companyName:S.j(this.props.companyName),currentSettings:this.props.currentSettings,onAudienceChange:this.onAudienceChange,onLinkTemplateChange:this.onLinkTemplateChange,onEditChange:this.onEditChange,onRoleChange:this.onRoleChange,onExpirationChange:this.onExpirationChange,onTrackableChange:this.onTrackableChange,onPeoplePickerChange:this._onPeoplePickerChange,peoplePickerError:this.state.peoplePickerError,selectedPermissions:this.state.selectedPermissions,sharingInformation:this.props.sharingInformation,showExistingAccessOption:this.props.showExistingAccessOption,updateExpirationErrorCode:this._updateExpirationErrorCode,groupsMemberCount:this.props.groupsMemberCount,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:this.props.copyLinkShortcut,onPasswordChange:this._onPasswordChange,onToggleChange:this._onPreventDownloadToggleChange,onOfficeReviewModeToggleChange:this._onOfficeReviewModeToggleChange,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onShowPermissionsListClicked:this.props.onShowPermissionsListClicked}))),t?O.createElement("div",{className:r,id:"od-ModifyPermissions-actions-id"},this._renderDefaultButton(),this._renderPrimaryButton()):O.createElement("div",{className:r},this._renderPrimaryButton(),this._renderDefaultButton()),this._renderActivityIndicator(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype.onLinkTemplateChange=function(e){var t=this.props.sharingInformation.sharingLinkTemplates.find(function(t){return!!t.linkDetails&&t.linkDetails.shareId===e}),n={allowEditing:!0,audience:o.e.existing,expiration:null,isEdit:!1,isReview:!1,sharingRole:s.e.view,preventDownload:!1,sharingLinkKind:c.e.direct,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:""};if(t){var i=t.linkDetails;n.shareId=i.shareId,n.fetchLinkOnly=!0,n.audience=i.audience,n.expiration=i.expiration,n.isEdit=i.isEdit,n.isReview=i.isReview,n.hasPassword=i.hasPassword,n.sharingRole=i.isEdit?Object(S.f)(this.props.clientId,this.props.sharingInformation):i.isReview?s.e.review:s.e.view,n.trackLinkUsers=i.trackLinkUsers,n.preventDownload=i.blockDownload,n.sharingLinkKind=i.sharingLinkKind}else e===o.e.existing.toString()?n.audience=o.e.existing:e===o.e.specificPeople.toString()&&(n.audience=o.e.specificPeople);this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{peoplePickerError:null,selectedPermissions:n}))},t.prototype.onAudienceChange=function(e){if(!Q.x()||e!==this.state.selectedPermissions.audience){var t=this.state.selectedPermissions,n=this._isAllowEditingEnabled(e),i=t.isEdit&&n,r=t.isReview&&(E.l(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)||E.c(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)),d=r?c.e.flexible:Object(S.v)(e,i),l=e===o.e.anyone||e===o.e.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:Object(S.u)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),u=s.e.view;r?u=s.e.review:i&&(u=Object(S.f)(this.props.clientId,this.props.sharingInformation)),Q.C()&&(u=t.sharingRole);var f={allowEditing:this._isEditingToggleEnabled(e),audience:e,expiration:l,isEdit:i,isReview:r,sharingRole:u,preventDownload:t.preventDownload&&!i&&!r,sharingLinkKind:d,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:"",trackLinkUsers:t.trackLinkUsers,requireSignIn:t.audience===o.e.specificPeople};this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{peoplePickerError:null,selectedPermissions:f}))}},t.prototype.onEditChange=function(e){var t=this.state.selectedPermissions,n=Object(S.v)(t.audience,e),i=s.e.view;e&&(i=t.isReview?s.e.review:Object(S.f)(this.props.clientId,this.props.sharingInformation)),this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},t),{isEdit:e,isReview:i===s.e.review,sharingRole:i,sharingLinkKind:n,preventDownload:!1}),preventDownloadDisabled:e,officeReviewModeDisabled:!!e})),this._preventDownloadToggle=!1,this._officeReviewModeToggle=!1},t.prototype.onRoleChange=function(e){var t=this.state.selectedPermissions,n=s.e.review==e,i=e==s.e.manageList,r=n||i?c.e.flexible:Object(S.v)(t.audience,S.P(e)),o=Object(S.u)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.state.selectedPermissions.sharingRole!==e&&this.context.sharingStore.getEngagementHelper().SharingRoleChangedFromLargeRoleSelector({isReview:n,isManageList:i}),this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},t),{sharingRole:e,isEdit:S.P(e),isReview:n,expiration:o,sharingLinkKind:r,preventDownload:!1}),preventDownloadDisabled:e!==s.e.view})),this._preventDownloadToggle=!1,this._officeReviewModeToggle=!1},t.prototype.onExpirationChange=function(e){e||(e=Object(S.u)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)),this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},this.state.selectedPermissions),{expiration:e})}))},t.prototype.onTrackableChange=function(e){this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},this.state.selectedPermissions),{trackLinkUsers:e})}))},t.prototype._renderDefaultButton=function(){return O.createElement($.e,{id:"od-ModifyPermissions-cancel-id",onClick:this._onCancel,styles:ie},k.De)},t.prototype._renderPrimaryButton=function(){return O.createElement(ee.e,{id:"od-ModifyPermissions-apply-id",className:"od-ModifyPermissions-apply",disabled:this._computeIsApplyButtonDisabled(),onClick:this._onApplyClicked,styles:ie},k.z)},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return O.createElement(l.e,{message:k.m})},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._initializeState=function(){var e=this.props,t=e.currentSettings,n=e.sharingInformation,a=t.isReview&&(E.l(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)||E.c(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)),i=C.o({selectedItems:t.specificPeople,sharingLinkKind:c.e.direct,canAddExternalPrincipal:n.canAddExternalPrincipal,sharingInformation:n,viewPolicyTipCallback:e.onViewPolicyTipClicked});return{expirationErrorCode:S.e.none,peoplePickerError:i,selectedPermissions:{allowEditing:this._isEditingToggleEnabled(t.audience),trackLinkUsers:t.trackLinkUsers,audience:t.audience,isEdit:t.isEdit,isReview:a,sharingRole:t.sharingRole,expiration:t.expiration||Object(S.u)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),sharingLinkKind:t.sharingLinkKind,specificPeople:t.specificPeople,updatePassword:t.updatePassword,password:t.password,hasPassword:t.hasPassword,preventDownload:t.preventDownload,shareId:t.shareId,fetchLinkOnly:t.fetchLinkOnly},showActivityIndicator:!1,preventDownloadDisabled:this._isAllowEditingEnabled(t.audience),officeReviewModeDisabled:!!this._isAllowEditingEnabled(t.audience),showConfirmationDialog:!1}},t.prototype._computeIsApplyButtonDisabled=function(){return this.state.expirationErrorCode!==S.e.none||!!this.state.peoplePickerError},t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{expirationErrorCode:e}))},t.prototype._onCancel=function(){this.props.onCancel()},t.prototype._onApplyClicked=function(){var e=this,t=this.state.selectedPermissions;if(this._peoplePickerHasUnresolvedText)this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{peoplePickerError:O.createElement("span",null,k.Ns)}));else if(t.audience!==o.e.specificPeopleFlex||0!==t.specificPeople.length||!this.props.copyLinkShortcut&&this.props.mode!==r.e.linkSettings){var n=this.props.doesCreate;if(t.fetchLinkOnly)this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{showActivityIndicator:n,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)});else{var i=t.audience===o.e.anyone||t.audience===o.e.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:null,s=this._determineMatchingTemplateAndSettingChange(i),c=this._officeReviewModeToggle;if(Q.s()&&(c=this.state.selectedPermissions.isReview),Q.Z()&&this.state.selectedPermissions.audience!==o.e.anyone&&(this._currentPassword=""),s){var d=!!this._matchingTemplate&&this._matchingTemplate.passwordProtected;this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},t),{expiration:i,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:c,shareId:this._existingPasswordLinkShareId,hasPassword:d}),showActivityIndicator:n,showConfirmationDialog:!0}))}else this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},t),{expiration:i,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:c,hasPassword:!!this._currentPassword,shareId:""}),showActivityIndicator:n,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})}}else this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{peoplePickerError:O.createElement("span",null,k.Zr)}))},t.prototype._determineMatchingTemplateAndSettingChange=function(e){if(this.state.selectedPermissions.audience!==o.e.anyone)return!1;if(this._matchingTemplate=this._getShareLinkTemplate(),!this._matchingTemplate||!this._matchingTemplate.linkDetails)return!1;if(this._currentPassword&&this._matchingTemplate.passwordProtected)return!0;var t=this._matchingTemplate.linkDetails.expiration;return null!==e&&null!==t&&(e.getMonth()!==t.getMonth()||e.getDate()!==t.getDate())},t.prototype._onPeoplePickerChange=function(e){var t=C.o({selectedItems:e,sharingLinkKind:c.e.direct,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this.props.onViewPolicyTipClicked});if(!this.props.createPeopleSharingLinks&&this.state.selectedPermissions.audience===o.e.specificPeople){for(var n=!1,i=!1,r=0,s=e;r<s.length;r++){var d=s[r];n||(n=d.isExternal&&!d.providerName),i||(i=!d.isExternal||d.isExternal&&!!d.providerName)}n&&i&&(t=O.createElement("span",null,k.Xn))}this.props.onSelectedPeopleChange&&this.props.onSelectedPeopleChange(e),this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{peoplePickerError:t,selectedPermissions:Object(a.__assign)(Object(a.__assign)({},this.state.selectedPermissions),{specificPeople:e})}))},t.prototype._getShareLinkTemplate=function(){var e=this._findMatchingShareLinkTemplate();return e&&(e.passwordProtected&&e.linkDetails?this._existingPasswordLinkShareId=e.linkDetails.shareId:this._existingPasswordLinkShareId=""),e},t.prototype._findMatchingShareLinkTemplate=function(){var e,t,n=!!this._currentPassword,a=this.props.sharingInformation.sharingLinkTemplates;if(!a||0===a.length)return null;for(var i=d.e.anyone,r=this._calculateRole(),o=0,s=a;o<s.length;o++){var c=s[o];if(c.role===r&&c.scope===i){if(n&&c.passwordProtected)return c;c.passwordProtected?e=c:t=c}}return e&&e.linkDetails&&!this._deletedPassword&&n?e:t},t.prototype._calculateRole=function(){return this.state.selectedPermissions.preventDownload?s.e.restrictedview:this.state.selectedPermissions.isReview?s.e.review:this.state.selectedPermissions.isEdit?Object(S.f)(this.props.clientId,this.props.sharingInformation):s.e.view},t.prototype._onPasswordChange=function(e){this._currentPassword=e,this._deletedPassword=0===e.length},t.prototype._onPreventDownloadToggleChange=function(e){this._preventDownloadToggle=e,this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},this.state.selectedPermissions),{preventDownload:e})}))},t.prototype._onOfficeReviewModeToggleChange=function(e){this._officeReviewModeToggle=e;var t=e?s.e.review:this.state.selectedPermissions.isEdit?Object(S.f)(this.props.clientId,this.props.sharingInformation):s.e.view;this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},this.state.selectedPermissions),{sharingRole:t,isReview:e,sharingLinkKind:e?c.e.flexible:Object(S.v)(this.state.selectedPermissions.audience,this.state.selectedPermissions.isEdit)})}))},t.prototype._isAllowEditingEnabled=function(e){return this._isSharingAbilityEnabled(e,"Editing")},t.prototype._isSharingAbilityEnabled=function(e,t){var n=this.props.sharingInformation.sharingAbilities;return"Editing"===t?E.r(e,n):E.d(e,n)},t.prototype._isEditingToggleEnabled=function(e){return this._isAllowEditingEnabled(e)&&(Q.k()||this._isSharingAbilityEnabled(e,"Reading"))},t.prototype._getShareDialogConfirmationCode=function(e,t){var n=this.state.selectedPermissions.expiration,a=t.linkDetails.expiration,i=e&&t.passwordProtected,r=null!==n&&null!==a&&(n.getMonth()!==a.getMonth()||n.getDate()!==a.getDate());return i&&r?u.e.shareDialogPasswordAndExpiration:i?u.e.shareDialogPasswordOnly:u.e.shareDialogExpirationOnly},t.prototype._renderConfirmationDialog=function(){var e=!!this._currentPassword,t=this._matchingTemplate,n=this._getShareDialogConfirmationCode(e,t),a=t&&t.linkDetails&&null!==t.linkDetails.passwordLastModifiedBy?t.linkDetails.passwordLastModifiedBy.primaryText:"",i=t&&t.linkDetails&&null!==t.linkDetails.expiration?Object(V.d)(t.linkDetails.expiration):"";return O.createElement(f.ConfirmationDialog,{confirmationCode:n,participant:null,onApply:this._onConfirmationUseNew,onCancel:this._onConfirmationUseExisting,linkPasswordSetBy:a,linkExpiration:i})},t.prototype._onConfirmationUseNew=function(){var e=this;this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})},t.prototype._onConfirmationUseExisting=function(){var e=this,t=this.state.selectedPermissions,n=this._matchingTemplate&&this._matchingTemplate.linkDetails?this._matchingTemplate.linkDetails.expiration:null,i=!(!this._matchingTemplate||!this._matchingTemplate.linkDetails)&&this._matchingTemplate.passwordProtected;this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{selectedPermissions:Object(a.__assign)(Object(a.__assign)({},t),{expiration:n,updatePassword:!1,password:"",hasPassword:i}),showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})},t.contextTypes={shareClickTime:w.number,sharingStore:w.object.isRequired,resize:w.func.isRequired,sharingClientMessenger:w.object.isRequired},t}(O.Component);t.default=re},function(e,t,n){"use strict";n.d(t,"e",function(){return G});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ExpirationDatePicker{margin-top:4px;display:flex;align-items:center;width:100%}.od-ExpirationDatePicker-content{border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ExpirationDatePicker-content,.od-ExpirationDatePicker-content-expired{width:100%;align-items:center;display:flex;flex-wrap:wrap}.od-ExpirationDatePicker-content-expired:hover,.od-ExpirationDatePicker-content:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";cursor:pointer}.od-ExpirationDatePicker-content-expired.od-ExpirationDatePicker-content-IE,.od-ExpirationDatePicker-content.od-ExpirationDatePicker-content-IE{flex-wrap:nowrap}.od-ExpirationDatePicker-content .ms-DatePicker,.od-ExpirationDatePicker-content-expired .ms-DatePicker{display:inline-block;margin-bottom:0;padding:0;flex-grow:1}.od-ExpirationDatePicker-content .ms-DatePicker i,.od-ExpirationDatePicker-content-expired .ms-DatePicker i{display:none}.od-ExpirationDatePicker-content .ms-DatePicker.od-DatePicker-IE,.od-ExpirationDatePicker-content-expired .ms-DatePicker.od-DatePicker-IE{flex-grow:1}.od-ExpirationDatePicker-content .ms-TextField-field,.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel,.od-ExpirationDatePicker-content-expired .ms-TextField-field,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel{height:1.75rem;padding:0;align-items:center;display:flex;font-size:.875rem}.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel{padding-right:.25rem}.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{flex-grow:0}.od-ExpirationDatePicker-content .ms-TextField-fieldGroup,.od-ExpirationDatePicker-content-expired .ms-TextField-fieldGroup{background:0 0}.od-ExpirationDatePicker-content .ms-TextField,.od-ExpirationDatePicker-content-expired .ms-TextField{margin-bottom:0;width:100%}.od-ExpirationDatePicker-content .ms-DatePicker .ms-TextField div,.od-ExpirationDatePicker-content-expired .ms-DatePicker .ms-TextField div{border-color:transparent;padding:0;align-items:center}.od-ExpirationDatePicker-content .ms-Icon,.od-ExpirationDatePicker-content-expired .ms-Icon{font-size:1.25rem;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:4px}.od-ExpirationDatePicker-label{display:inline-block;margin-top:7px;font-size:1rem}[dir=ltr] .od-ExpirationDatePicker-label{margin-right:12px}[dir=rtl] .od-ExpirationDatePicker-label{margin-left:12px}.od-ExpirationDatePicker-info{display:flex}[dir=ltr] .od-ExpirationDatePicker-info{margin-left:auto}[dir=rtl] .od-ExpirationDatePicker-info{margin-right:auto}.od-ExpirationDatePicker-info .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:.75rem}[dir=ltr] .od-ExpirationDatePicker-info .ms-Icon{margin-left:10px}[dir=rtl] .od-ExpirationDatePicker-info .ms-Icon{margin-right:10px}.od-ExpirationDatePicker-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';cursor:pointer;font-size:1rem;line-height:0;padding:0;height:1rem;outline:transparent;position:relative}[dir=ltr] .od-ExpirationDatePicker-delete{margin-left:10px}[dir=rtl] .od-ExpirationDatePicker-delete{margin-right:10px}.od-ExpirationDatePicker-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-delete:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ExpirationDatePicker-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-ExpirationDatePicker-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-content-expired{border-bottom:.0625rem solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-content-expired .ms-TextField-field{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-premiumGleam{height:.75rem;width:.75rem;margin-top:2px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:'}[dir=ltr] .od-ExpirationDatePicker-premiumGleam{padding-right:5px}[dir=rtl] .od-ExpirationDatePicker-premiumGleam{padding-left:5px}.od-ExpirationDatePicker-tooltipWrapper{outline:transparent;position:relative}.od-ExpirationDatePicker-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-tooltipWrapper:focus:after{content:"";position:absolute;top:-.125rem;right:-.125rem;bottom:-.125rem;left:-.125rem;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-ExpirationDatePicker-infoTooltipContent{font-size:.875rem}@media (inverted-colors){.ms-DatePicker-day-button[aria-selected=true]{outline:.125rem solid}}input[readonly]:focus{border:.0625rem solid #0078d4}@media (forced-colors:active) and (prefers-color-scheme:dark){.od-ExpirationDatePicker-delete:enabled{color:#fff!important;forced-color-adjust:none}}@media (forced-colors:active) and (prefers-color-scheme:light){.od-ExpirationDatePicker-delete:enabled{color:#000!important;forced-color-adjust:none}}"}]);var r=n(1529),o=n(1526),s=n(1),c=n(809),d=n(2429),l=n(1601),u=n(112),f=n(109),p=n(51),m=n(2622),_=n(2014),h=n(1891),b=n(1312),g=n(129),v=n(2112),y=n(1796),S=n(1602),D=n(2034),I=n(1754),x=n(2015),C=Object(a.__assign)(Object(a.__assign)({},x.t),{prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year",closeButtonAriaLabel:"Close date picker",isRequiredErrorMessage:"Field is required",invalidInputErrorMessage:"Invalid date format",isResetStatusMessage:'Invalid entry "{0}", date reset to "{1}"'}),O=Object(c.e)(),w={allowTextInput:!1,formatDate:function(e){return e?e.toDateString():""},parseDateFromString:function(e){var t=Date.parse(e);return t?new Date(t):null},firstDayOfWeek:_.n.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:C,highlightCurrentMonth:!1,highlightSelectedMonth:!1,borderless:!1,pickerAriaLabel:"Calendar",showWeekNumbers:!1,firstWeekOfYear:_.a.FirstDay,showGoToToday:!0,showCloseButton:!1,underlined:!1,allFocusable:!1},E=s.forwardRef(function(e,t){var n=Object(l.e)(w,e),i=n.firstDayOfWeek,r=n.strings,o=n.label,c=n.theme,_=n.className,x=n.styles,C=n.initialPickerDate,E=n.isRequired,L=n.disabled,k=n.ariaLabel,M=n.pickerAriaLabel,P=n.placeholder,T=n.allowTextInput,U=n.borderless,F=n.minDate,H=n.maxDate,R=n.showCloseButton,N=n.calendarProps,B=n.calloutProps,j=n.textField,V=n.underlined,z=n.allFocusable,G=n.calendarAs,K=void 0===G?m.e:G,W=n.tabIndex,q=n.disableAutoFocus,Q=void 0===q||q,Y=Object(I.e)("DatePicker",n.id),J=Object(I.e)("DatePicker-Callout"),X=s.useRef(null),Z=s.useRef(null),$=function(){var e=s.useRef(null),t=s.useRef(!1);return[e,function(){var t,n;null===(n=null===(t=e.current)||void 0===t?void 0:t.focus)||void 0===n||n.call(t)},t,function(){t.current=!0}]}(),ee=$[0],te=$[1],ne=$[2],ae=$[3],ie=function(e,t){var n=e.allowTextInput,a=e.onAfterMenuDismiss,i=s.useState(!1),r=i[0],o=i[1],c=s.useRef(!1),d=Object(S.e)();return s.useEffect(function(){c.current&&!r&&(n&&d.requestAnimationFrame(t),null==a||a()),c.current=!0},[r]),[r,o]}(n,te),re=ie[0],oe=ie[1],se=function(e){var t=e.formatDate,n=e.value,a=e.onSelectDate,i=Object(D.e)(n,void 0,function(e,t){return null==a?void 0:a(t)}),r=i[0],o=i[1],c=s.useState(function(){return n&&t?t(n):""}),d=c[0],l=c[1];return s.useEffect(function(){l(n&&t?t(n):"")},[t,n]),[r,d,function(e){o(e),l(e&&t?t(e):"")},l]}(n),ce=se[0],de=se[1],le=se[2],ue=se[3],fe=function(e,t,n,a,i){var r=e.isRequired,o=e.allowTextInput,c=e.strings,l=e.parseDateFromString,u=e.onSelectDate,f=e.formatDate,p=e.minDate,m=e.maxDate,_=s.useState(),b=_[0],g=_[1],v=s.useState(),y=v[0],S=v[1];return s.useEffect(function(){r&&!t?g(c.isRequiredErrorMessage||" "):t&&A(t,p,m)?g(c.isOutOfBoundsErrorMessage||" "):g(void 0)},[p&&Object(h.o)(p),m&&Object(h.o)(m),t&&Object(h.o)(t),r]),[i?void 0:b,function(e){if(void 0===e&&(e=null),o)if(a||e){if(t&&!b&&f&&f(null!=e?e:t)===a)return;if(!(e=e||l(a))||isNaN(e.getTime())){n(t);var i=f?f(t):"",s=c.isResetStatusMessage?Object(d.e)(c.isResetStatusMessage,a,i):c.invalidInputErrorMessage||"";S(s)}else A(e,p,m)?g(c.isOutOfBoundsErrorMessage||" "):(n(e),g(void 0),S(void 0))}else g(r?c.isRequiredErrorMessage||" ":void 0),null==u||u(e);else r&&!a?g(c.isRequiredErrorMessage||" "):(g(void 0),S(void 0))},g,i?void 0:y,S]}(n,ce,le,de,re),pe=fe[0],me=fe[1],_e=fe[2],he=fe[3],be=fe[4],ge=s.useCallback(function(){re||(ae(),oe(!0))},[re,ae,oe]);s.useImperativeHandle(n.componentRef,function(){return{focus:te,reset:function(){oe(!1),le(void 0),_e(void 0),be(void 0)},showDatePickerPopup:ge}},[te,_e,oe,le,be,ge]);var ve=function(e){re&&(oe(!1),me(e),!T&&e&&le(e))},ye=function(e){ae(),ve(e)},Se=O(x,{theme:c,className:_,disabled:L,underlined:V,label:!!o,isDatePickerShown:re}),De=Object(f.s)(n,f.r,["value"]),Ie=j&&j.iconProps,xe=j&&j.id&&j.id!==Y?j.id:Y+"-label",Ce=!T&&!L;return s.createElement("div",Object(a.__assign)({},De,{className:Se.root,ref:t}),s.createElement("div",{ref:Z,"aria-owns":re?J:void 0,className:Se.wrapper},s.createElement(v.e,Object(a.__assign)({role:"combobox",label:o,"aria-expanded":re,ariaLabel:k,"aria-haspopup":"dialog","aria-controls":re?J:void 0,required:E,disabled:L,errorMessage:pe,placeholder:P,borderless:U,value:de,componentRef:ee,underlined:V,tabIndex:W,readOnly:!T},j,{id:xe,className:Object(p.e)(Se.textField,j&&j.className),iconProps:Object(a.__assign)(Object(a.__assign)({iconName:"Calendar"},Ie),{className:Object(p.e)(Se.icon,Ie&&Ie.className),onClick:function(e){e.stopPropagation(),re||n.disabled?n.allowTextInput&&ve():ge()}}),onRenderDescription:function(e,t){return s.createElement(s.Fragment,null,e.description?t(e):null,s.createElement("div",{"aria-live":"assertive",className:Se.statusMessage},he))},onKeyDown:function(e){switch(e.which){case u.e.enter:e.preventDefault(),e.stopPropagation(),re?n.allowTextInput&&ve():(me(),ge());break;case u.e.escape:!function(e){re&&(e.stopPropagation(),ye())}(e);break;case u.e.down:e.altKey&&!re&&ge()}},onFocus:function(){Q||T||(ne.current||ge(),ne.current=!1)},onBlur:function(e){me()},onClick:function(e){!n.openOnClick&&n.disableAutoFocus||re||n.disabled?n.allowTextInput&&ve():ge()},onChange:function(e,t){var a,i=n.textField;T&&(re&&ve(),ue(t)),null===(a=null==i?void 0:i.onChange)||void 0===a||a.call(i,e,t)},onRenderInput:Ce?function(e){var t=Object(f.s)(e,f.r);return s.createElement("div",Object(a.__assign)({},t,{className:Object(p.e)(t.className,Se.readOnlyTextField),tabIndex:W||0}),de||s.createElement("span",{className:Se.readOnlyPlaceholder},P))}:void 0}))),re&&s.createElement(b.e,Object(a.__assign)({id:J,role:"dialog",ariaLabel:M,isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:Z.current,directionalHint:g.e.bottomLeftEdge},B,{className:Object(p.e)(Se.callout,B&&B.className),onDismiss:function(e){ye()},onPositioned:function(){var e=!0;n.calloutProps&&void 0!==n.calloutProps.setInitialFocus&&(e=n.calloutProps.setInitialFocus),X.current&&e&&X.current.focus()}}),s.createElement(y.e,{isClickableOutsideFocusTrap:!0,disableFirstFocus:Q},s.createElement(K,Object(a.__assign)({},N,{onSelectDate:function(e){n.calendarProps&&n.calendarProps.onSelectDate&&n.calendarProps.onSelectDate(e),ye(e)},onDismiss:ye,isMonthPickerVisible:n.isMonthPickerVisible,showMonthPickerAsOverlay:n.showMonthPickerAsOverlay,today:n.today,value:ce||C,firstDayOfWeek:i,strings:r,highlightCurrentMonth:n.highlightCurrentMonth,highlightSelectedMonth:n.highlightSelectedMonth,showWeekNumbers:n.showWeekNumbers,firstWeekOfYear:n.firstWeekOfYear,showGoToToday:n.showGoToToday,dateTimeFormatter:n.dateTimeFormatter,minDate:F,maxDate:H,componentRef:X,showCloseButton:R,allFocusable:z})))))});function A(e,t,n){return!!t&&Object(h.i)(t,e)>0||!!n&&Object(h.i)(n,e)<0}E.displayName="DatePickerBase";var L=n(21),k={root:"ms-DatePicker",callout:"ms-DatePicker-callout",withLabel:"ms-DatePicker-event--with-label",withoutLabel:"ms-DatePicker-event--without-label",disabled:"msDatePickerDisabled "},M=Object(o.e)(E,function(e){var t,n=e.className,a=e.theme,i=e.disabled,r=e.underlined,o=e.label,s=e.isDatePickerShown,c=a.palette,d=a.semanticColors,l=a.fonts,u=Object(L.I)(k,a),f={color:c.neutralSecondary,fontSize:L.i.icon,lineHeight:"18px",pointerEvents:"none",position:"absolute",right:"4px",padding:"5px"};return{root:[u.root,a.fonts.large,s&&"is-open",L.H,n],textField:[{position:"relative",selectors:{"& input[readonly]":{cursor:"pointer"},input:{selectors:{"::-ms-clear":{display:"none"}}}}},i&&{selectors:{"& input[readonly]":{cursor:"default"}}}],callout:[u.callout],icon:[f,o?u.withLabel:u.withoutLabel,{paddingTop:"7px"},!i&&[u.disabled,{pointerEvents:"initial",cursor:"pointer"}],i&&{color:d.disabledText,cursor:"default"}],statusMessage:[l.small,{color:d.errorText,marginTop:5}],readOnlyTextField:[{cursor:"pointer",height:32,lineHeight:30,overflow:"hidden",textOverflow:"ellipsis"},r&&{lineHeight:34}],readOnlyPlaceholder:(t={color:d.inputPlaceholderText},t[L.o]={color:"GrayText"},t)}},void 0,{scope:"DatePicker"}),P=n(476),T=n(1804),U=n(1801),F=n(1673),H=n(39),R=n(1800),N=n(1807),B=n(1806),j=M,V={day:"numeric",month:"numeric",year:"numeric"},z={weekday:"long",day:"numeric",month:"short",year:"numeric"},G=function(e){function t(t,n){var a=e.call(this,t)||this;a._dateRemovedStatus=s.createRef(),a._onSelectDateForExpirationPicker=function(e){a._expirationDateRemoved=!1;var t=e<new Date(Date.now());a._focusDatePicker(),a.setState({hasExpired:t,selectedDate:e}),a.props.onSelectDate(e)},a._onDeleteDate=function(){a._expirationDateRemoved=!0,a._datePicker.focus(),a.setState({selectedDate:null},function(){a.props.onSelectDate(null)})},a._formatDate=function(e){return e?Object(N.l)(e,z):""};var i=a.props.value<new Date(Date.now());a.state={hasExpired:i,selectedDate:null},a._platformDetection=n.platformDetection;var r=new Date(Date.now());return a._minDate=new Date(r.getFullYear(),r.getMonth(),r.getDate()+1,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),t.expiryRestriction>0?a._maxDate=new Date(r.getFullYear(),r.getMonth(),r.getDate()+t.expiryRestriction,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()):a._maxDate=new Date(r.getFullYear()+2,r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),a._isMobile=a._platformDetection.isMobile||B.r(a.props.clientId),a._datePickerStrings={months:T.U,shortMonths:T.H,days:T.c,shortDays:T.F,goToToday:U.un,setExpirationDate:U.wo,nextMonthAriaLabel:U.fa,prevMonthAriaLabel:U.Dr,ariaLabel:a._formattedExpirationDateAriaLabel(),pickerAriaLabel:U.kt,closeButtonAriaLabel:a._isMobile&&U.re||"",invalidInputErrorMessage:H.format(U.Ft,Object(N.l)(a._minDate,V))},a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props.value,t=e&&this.state.hasExpired;return this._datePickerStrings.ariaLabel=this._formattedExpirationDateAriaLabel(),s.createElement("div",{className:"od-ExpirationDatePicker"+(t?" od-ExpirationDatePicker-expired":"")},s.createElement("div",{className:"od-ExpirationDatePicker-label"+(t?" od-ExpirationDatePicker-expired":"")},s.createElement(P.e,{"aria-hidden":"true",iconName:t?"EventDateMissed12":"Calendar"})),s.createElement("div",{className:"od-ExpirationDatePicker-content"+(t?" od-ExpirationDatePicker-content-expired":""+this._platformDetection.isIE?" od-ExpirationDatePicker-content-IE":"")},this._renderExpiresLabel(),s.createElement(j,{className:this._platformDetection.isIE?"od-DatePicker-IE":"",componentRef:this._resolveRef("_datePicker"),strings:this._datePickerStrings,placeholder:Object(N.o)(),isMonthPickerVisible:!1,onSelectDate:this._onSelectDateForExpirationPicker,value:e,formatDate:this._formatDate,minDate:this._minDate,maxDate:this._maxDate,allowTextInput:this._platformDetection.isIE,ariaLabel:this._datePickerStrings.ariaLabel,pickerAriaLabel:this._datePickerStrings.pickerAriaLabel,showGoToToday:!1,showCloseButton:this._isMobile,allFocusable:!1,calloutProps:{preventDismissOnScroll:this._isMobile},disableAutoFocus:this.props.disableAutoFocus,tabIndex:this.props.tabIndex,onAfterMenuDismiss:this._focusDatePicker.bind(this),styles:{callout:{fontSize:"0.875rem",selectors:{".ms-DatePicker-header":{height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-monthAndYear":{fontSize:"0.875rem"},".ms-DatePicker-prevMonth":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-nextMonth":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-weekday":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-day":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-day-button":{width:"1.5rem",height:"1.5rem"}}},textField:{fontSize:"0.875rem",height:"1.75rem",selectors:{".ms-TextField-fieldGroup":{height:"1.75rem"},"input::placeholder":{fontSize:"0.875rem"}}},icon:{fontSize:"0.875rem"}},disabled:this.props.disabled}),this._renderExpirationDateRemovedLabel(),this._renderRemoveDateButton()),this._renderPremiumGleam())},t.prototype._renderExpirationDateRemovedLabel=function(){if(this._expirationDateRemoved)return s.createElement("div",{ref:this._dateRemovedStatus,className:"od-Share-screenReaderOnly",tabIndex:-1,role:"alert","aria-live":"assertive","aria-hidden":!0},U.Pt)},t.prototype._renderExpiresLabel=function(){if(this.props.value){var e="od-ExpirationDate-expiresLabel"+(this._platformDetection.isIE?" od-ExpirationDate-expiresLabelIE":"");return s.createElement("span",{className:e,role:"status","aria-live":"polite"},this.state.hasExpired?U.Nt:U.jt)}},t.prototype._renderRemoveDateButton=function(){var e=this.state.selectedDate;if(!this.props.hideRemoveDateButton){if(this.props.expiryRestriction>0){var t=H.format(U.Tt,this.props.expiryRestriction),n={maxWidth:"300px",onRenderContent:function(){return s.createElement("div",{className:"od-ExpirationDatePicker-infoTooltipContent"},t)}};return s.createElement("div",{className:"od-ExpirationDatePicker-info","aria-label":t},s.createElement(F.e,{id:"od-ExpirationDatePicker-tooltip-id",hostClassName:"od-ExpirationDatePicker-tooltip",directionalHint:g.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:n},s.createElement("div",{tabIndex:0,className:"od-ExpirationDatePicker-tooltipWrapper",role:"note"},s.createElement(P.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}))))}return n={onRenderContent:function(){return s.createElement("div",{className:"od-ExpirationDatePicker-infoTooltipContent"},U.to)}},s.createElement(F.e,{tooltipProps:n,id:"expirationDateRemovedButton",calloutProps:{gapSpace:0}},s.createElement("button",{className:"od-ExpirationDatePicker-delete",onClick:this._onDeleteDate,disabled:!e,"aria-label":U.to},s.createElement(P.e,{iconName:"Cancel","aria-hidden":!0})))}},t.prototype._formattedExpirationDateAriaLabel=function(){return this.state.selectedDate?H.format(U.Ut,""):U.wo},t.prototype._renderPremiumGleam=function(){if(this.props.showGleam){var e=window.require?window.require.toUrl("odsp-media/images/premium/premium-gleam-single.svg"):"https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/onedrive-assets/images/gleam.svg";return s.createElement("img",{role:"presentation",src:e,className:"od-ExpirationDatePicker-premiumGleam"})}},t.prototype._focusDatePicker=function(){this._platformDetection.isIE||this._datePicker.focus()},t.contextTypes={platformDetection:R.object.isRequired},t}(r.e)},,function(e,t,n){"use strict";n.d(t,"e",function(){return F});var a={};n.r(a),n.d(a,"root",function(){return b}),n.d(a,"suggestionsItem",function(){return g}),n.d(a,"closeButton",function(){return v}),n.d(a,"suggestionsItemIsSuggested",function(){return y}),n.d(a,"itemButton",function(){return S}),n.d(a,"actionButton",function(){return D}),n.d(a,"buttonSelected",function(){return I}),n.d(a,"suggestionsTitle",function(){return x}),n.d(a,"suggestionsContainer",function(){return C}),n.d(a,"suggestionsNone",function(){return O}),n.d(a,"suggestionsSpinner",function(){return w}),n.d(a,"suggestionsAvailable",function(){return E});var i,r=n(0),o=n(1),s=n(809),c=n(1526),d=n(112),l=n(1104),u=n(51),f=n(2170),p=n(1786),m=n(2453);!function(e){e[e.none=0]="none",e[e.forceResolve=1]="forceResolve",e[e.searchMore=2]="searchMore"}(i||(i={}));var _=n(1644),h=n(17);Object(h.n)([{rawString:".root_8c91000a{min-width:260px}.suggestionsItem_8c91000a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;position:relative;overflow:hidden}.suggestionsItem_8c91000a:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.suggestionsItem_8c91000a:hover .closeButton_8c91000a{display:block}.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a:hover{background:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a{background:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a .closeButton_8c91000a:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a .itemButton_8c91000a{color:HighlightText}}.suggestionsItem_8c91000a .closeButton_8c91000a{display:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.suggestionsItem_8c91000a .closeButton_8c91000a:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.actionButton_8c91000a{background-color:transparent;border:0;cursor:pointer;margin:0;position:relative;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:40px;width:100%;font-size:12px}[dir=ltr] .actionButton_8c91000a{padding-left:8px}[dir=rtl] .actionButton_8c91000a{padding-right:8px}html[dir=ltr] .actionButton_8c91000a{text-align:left}html[dir=rtl] .actionButton_8c91000a{text-align:right}.actionButton_8c91000a:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.actionButton_8c91000a:active,.actionButton_8c91000a:focus{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.actionButton_8c91000a .ms-Button-icon{font-size:16px;width:25px}.actionButton_8c91000a .ms-Button-label{margin:0 4px 0 9px}html[dir=rtl] .actionButton_8c91000a .ms-Button-label{margin:0 9px 0 4px}.buttonSelected_8c91000a{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.suggestionsTitle_8c91000a{padding:0 12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;line-height:40px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsContainer_8c91000a{overflow-y:auto;overflow-x:hidden;max-height:300px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsNone_8c91000a{text-align:center;color:#797775;font-size:12px;line-height:30px}.suggestionsSpinner_8c91000a{margin:5px 0;white-space:nowrap;line-height:20px;font-size:12px}html[dir=ltr] .suggestionsSpinner_8c91000a{padding-left:14px}html[dir=rtl] .suggestionsSpinner_8c91000a{padding-right:14px}html[dir=ltr] .suggestionsSpinner_8c91000a{text-align:left}html[dir=rtl] .suggestionsSpinner_8c91000a{text-align:right}.suggestionsSpinner_8c91000a .ms-Spinner-circle{display:inline-block;vertical-align:middle}.suggestionsSpinner_8c91000a .ms-Spinner-label{display:inline-block;margin:0 10px 0 16px;vertical-align:middle}html[dir=rtl] .suggestionsSpinner_8c91000a .ms-Spinner-label{margin:0 16px 0 10px}.itemButton_8c91000a.itemButton_8c91000a{width:100%;padding:0;min-width:0;height:100%}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.itemButton_8c91000a.itemButton_8c91000a{color:WindowText}}.itemButton_8c91000a.itemButton_8c91000a:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.closeButton_8c91000a.closeButton_8c91000a{padding:0 4px;height:auto;width:32px}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.closeButton_8c91000a.closeButton_8c91000a{color:WindowText}}.closeButton_8c91000a.closeButton_8c91000a:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.suggestionsAvailable_8c91000a{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var b="root_8c91000a",g="suggestionsItem_8c91000a",v="closeButton_8c91000a",y="suggestionsItemIsSuggested_8c91000a",S="itemButton_8c91000a",D="actionButton_8c91000a",I="buttonSelected_8c91000a",x="suggestionsTitle_8c91000a",C="suggestionsContainer_8c91000a",O="suggestionsNone_8c91000a",w="suggestionsSpinner_8c91000a",E="suggestionsAvailable_8c91000a",A=a,L=Object(s.e)(),k=function(e){function t(t){var n=e.call(this,t)||this;return Object(l.e)(n),n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.suggestionModel,a=t.RenderSuggestion,i=t.onClick,r=t.className,s=t.id,c=t.onRemoveItem,d=t.isSelectedOverride,l=t.removeButtonAriaLabel,p=t.styles,m=t.theme,h=t.removeButtonIconProps,b=p?L(p,{theme:m,className:r,suggested:n.selected||d}):{root:Object(u.e)("ms-Suggestions-item",A.suggestionsItem,(e={},e["is-suggested "+A.suggestionsItemIsSuggested]=n.selected||d,e),r),itemButton:Object(u.e)("ms-Suggestions-itemButton",A.itemButton),closeButton:Object(u.e)("ms-Suggestions-closeButton",A.closeButton)};return o.createElement("div",{className:b.root,role:"presentation"},o.createElement(f.e,{onClick:i,className:b.itemButton,id:s,"aria-selected":n.selected,role:"option","aria-label":n.ariaLabel},a(n.item,this.props)),this.props.showRemoveButton?o.createElement(_.e,{iconProps:null!=h?h:{iconName:"Cancel"},styles:{icon:{fontSize:"12px"}},title:l,ariaLabel:l,onClick:c,className:b.closeButton}):null)},t}(o.Component),M=n(2116),P=a,T=Object(s.e)(),U=Object(c.e)(k,M.t,void 0,{scope:"SuggestionItem"}),F=function(e){function t(t){var n=e.call(this,t)||this;return n._forceResolveButton=o.createRef(),n._searchForMoreButton=o.createRef(),n._selectedElement=o.createRef(),n._scrollContainer=o.createRef(),n.tryHandleKeyDown=function(e,t){var a=!1,r=null,o=n.state.selectedActionType,s=n.props.suggestions.length;if(e===d.e.down)switch(o){case i.forceResolve:s>0?(n._refocusOnSuggestions(e),r=i.none):r=n._searchForMoreButton.current?i.searchMore:i.forceResolve;break;case i.searchMore:n._forceResolveButton.current?r=i.forceResolve:s>0?(n._refocusOnSuggestions(e),r=i.none):r=i.searchMore;break;case i.none:-1===t&&n._forceResolveButton.current&&(r=i.forceResolve)}else if(e===d.e.up)switch(o){case i.forceResolve:n._searchForMoreButton.current?r=i.searchMore:s>0&&(n._refocusOnSuggestions(e),r=i.none);break;case i.searchMore:s>0?(n._refocusOnSuggestions(e),r=i.none):n._forceResolveButton.current&&(r=i.forceResolve);break;case i.none:-1===t&&n._searchForMoreButton.current&&(r=i.searchMore)}return null!==r&&(n.setState({selectedActionType:r}),a=!0),a},n._getAlertText=function(){var e=n.props,t=e.isLoading,a=e.isSearching,i=e.suggestions,r=e.suggestionsAvailableAlertText,o=e.noResultsFoundText,s=e.isExtendedLoading,c=e.loadingText;if(t||a){if(t&&s)return c||""}else{if(i.length>0)return r||"";if(o)return o}return""},n._getMoreResults=function(){n.props.onGetMoreResults&&(n.props.onGetMoreResults(),n.setState({selectedActionType:i.none}))},n._forceResolve=function(){n.props.createGenericItem&&n.props.createGenericItem()},n._shouldShowForceResolve=function(){return!!n.props.showForceResolve&&n.props.showForceResolve()},n._onClickTypedSuggestionsItem=function(e,t){return function(a){n.props.onSuggestionClick(a,e,t)}},n._refocusOnSuggestions=function(e){"function"==typeof n.props.refocusSuggestions&&n.props.refocusSuggestions(e)},n._onRemoveTypedSuggestionsItem=function(e,t){return function(a){(0,n.props.onSuggestionRemove)(a,e,t),a.stopPropagation()}},Object(l.e)(n),n.state={selectedActionType:i.none},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.scrollSelected(),this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null},t.prototype.componentDidUpdate=function(){this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current&&(this.scrollSelected(),this.activeSelectedElement=this._selectedElement.current)},t.prototype.render=function(){var e,t,n=this,a=this.props,s=a.forceResolveText,c=a.mostRecentlyUsedHeaderText,d=a.searchForMoreIcon,l=a.searchForMoreText,_=a.className,h=a.moreSuggestionsAvailable,b=a.noResultsFoundText,g=a.suggestions,v=a.isLoading,y=a.isSearching,S=a.loadingText,D=a.onRenderNoResultFound,I=a.searchingText,x=a.isMostRecentlyUsedVisible,C=a.resultsMaximumNumber,O=a.resultsFooterFull,w=a.resultsFooter,E=a.isResultsFooterVisible,A=void 0===E||E,L=a.suggestionsHeaderText,k=a.suggestionsClassName,M=a.theme,U=a.styles,F=a.suggestionsListId,H=a.suggestionsContainerAriaLabel;this._classNames=U?T(U,{theme:M,className:_,suggestionsClassName:k,forceResolveButtonSelected:this.state.selectedActionType===i.forceResolve,searchForMoreButtonSelected:this.state.selectedActionType===i.searchMore}):{root:Object(u.e)("ms-Suggestions",_,P.root),title:Object(u.e)("ms-Suggestions-title",P.suggestionsTitle),searchForMoreButton:Object(u.e)("ms-SearchMore-button",P.actionButton,(e={},e["is-selected "+P.buttonSelected]=this.state.selectedActionType===i.searchMore,e)),forceResolveButton:Object(u.e)("ms-forceResolve-button",P.actionButton,(t={},t["is-selected "+P.buttonSelected]=this.state.selectedActionType===i.forceResolve,t)),suggestionsAvailable:Object(u.e)("ms-Suggestions-suggestionsAvailable",P.suggestionsAvailable),suggestionsContainer:Object(u.e)("ms-Suggestions-container",P.suggestionsContainer,k),noSuggestions:Object(u.e)("ms-Suggestions-none",P.suggestionsNone)};var R=this._classNames.subComponentStyles?this._classNames.subComponentStyles.spinner:void 0,N=U?{styles:R}:{className:Object(u.e)("ms-Suggestions-spinner",P.suggestionsSpinner)},B=function(){return o.createElement("div",{id:"sug-noResultsFound",role:"option"},D?D(void 0,B):o.createElement("div",{className:n._classNames.noSuggestions},b))},j=L;x&&c&&(j=c);var V=void 0;A&&(V=g.length>=C?O:w);var z=!(g&&g.length||v),G=this.state.selectedActionType===i.forceResolve?"sug-selectedAction":void 0,K=this.state.selectedActionType===i.searchMore?"sug-selectedAction":void 0;return o.createElement("div",{className:this._classNames.root,"aria-label":H||j,id:F,role:"listbox"},o.createElement(m.e,{message:this._getAlertText(),"aria-live":"polite"}),j?o.createElement("div",{className:this._classNames.title},j):null,s&&this._shouldShowForceResolve()&&o.createElement(f.e,{componentRef:this._forceResolveButton,className:this._classNames.forceResolveButton,id:G,onClick:this._forceResolve,"data-automationid":"sug-forceResolve"},s),v&&o.createElement(p.e,Object(r.__assign)({},N,{ariaLabel:S,label:S})),z?B():this._renderSuggestions(),l&&h&&o.createElement(f.e,{componentRef:this._searchForMoreButton,className:this._classNames.searchForMoreButton,iconProps:d||{iconName:"Search"},id:K,onClick:this._getMoreResults,"data-automationid":"sug-searchForMore",role:"option"},l),y?o.createElement(p.e,Object(r.__assign)({},N,{ariaLabel:I,label:I})):null,!V||h||x||y?null:o.createElement("div",{className:this._classNames.title},V(this.props)))},t.prototype.hasSuggestedAction=function(){return!!this._searchForMoreButton.current||!!this._forceResolveButton.current},t.prototype.hasSuggestedActionSelected=function(){return this.state.selectedActionType!==i.none},t.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case i.forceResolve:this._forceResolve();break;case i.searchMore:this._getMoreResults()}},t.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:i.forceResolve}):this._searchForMoreButton.current&&this.setState({selectedActionType:i.searchMore})},t.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:i.searchMore}):this._forceResolveButton.current&&this.setState({selectedActionType:i.forceResolve})},t.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()},t.prototype.scrollSelected=function(){if(this._selectedElement.current&&this._scrollContainer.current&&void 0!==this._scrollContainer.current.scrollTo){var e=this._selectedElement.current,t=e.offsetHeight,n=e.offsetTop,a=this._scrollContainer.current,i=a.offsetHeight,r=a.scrollTop,o=n+t>r+i;n<r?this._scrollContainer.current.scrollTo(0,n):o&&this._scrollContainer.current.scrollTo(0,n-i+t)}},t.prototype._renderSuggestions=function(){var e=this,t=this.props,n=t.onRenderSuggestion,a=t.removeSuggestionAriaLabel,i=t.suggestionsItemClassName,r=t.resultsMaximumNumber,s=t.showRemoveButtons,c=t.removeButtonIconProps,d=this.props.suggestions,l=U,u=-1;return d.some(function(e,t){return!!e.selected&&(u=t,!0)}),r&&(d=u>=r?d.slice(u-r+1,u+1):d.slice(0,r)),0===d.length?null:o.createElement("div",{className:this._classNames.suggestionsContainer,ref:this._scrollContainer,role:"presentation"},d.map(function(t,r){return o.createElement("div",{ref:t.selected?e._selectedElement:void 0,key:t.item.key?t.item.key:r,role:"presentation"},o.createElement(l,{suggestionModel:t,RenderSuggestion:n,onClick:e._onClickTypedSuggestionsItem(t.item,r),className:i,showRemoveButton:s,removeButtonAriaLabel:a,onRemoveItem:e._onRemoveTypedSuggestionsItem(t.item,r),id:"sug-"+r,removeButtonIconProps:c}))}))},t}(o.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PasswordField{margin-top:4px;height:100%;width:100%;display:block}.od-PasswordField .od-PasswordField-passwordFieldLine{display:flex}.od-PasswordField .od-ShareLink-passwordFieldContent{height:2rem;width:100%;border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-PasswordField .od-ShareLink-passwordFieldContent:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-PasswordField .ms-PasswordField .ms-TextField input::placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.875rem}.od-PasswordField .ms-TextField{width:100%;display:inline-block;padding:2px;height:1.75rem;min-width:0;cursor:pointer;border-color:transparent}.od-PasswordField .ms-TextField .ms-TextField-fieldGroup{background:0 0}.od-PasswordField .ms-TextField-field{display:inline-block;padding:0;height:1.75rem;min-width:0;width:100%;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.od-PasswordField-delete{outline:transparent;position:relative;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:'}.od-PasswordField-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PasswordField-delete:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-PasswordField-label{display:flex;align-items:center;margin-top:7px;font-size:.875rem}[dir=ltr] .od-PasswordField-label{margin-right:12px}[dir=rtl] .od-PasswordField-label{margin-left:12px}.od-PasswordField-cancel{display:inline-block;vertical-align:top;margin-top:1px}.odPasswordField-lastModifiedBy{font-style:italic}.od-PasswordField-shareReminder{display:block;margin-top:3px;font-size:.75rem}[dir=ltr] .od-PasswordField-shareReminder{padding-left:22px}[dir=rtl] .od-PasswordField-shareReminder{padding-right:22px}.od-PasswordField-shareReminder-detailsPane{display:block;margin-top:8px;font-size:.75rem}[dir=ltr] .od-PasswordField-shareReminder-detailsPane{padding-left:36px}[dir=rtl] .od-PasswordField-shareReminder-detailsPane{padding-right:36px}.od-PasswordField-passwordField{display:flex}.od-PermissionsSettings-delete{outline:transparent;position:relative;background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';cursor:pointer;font-size:.875rem;line-height:0;padding:0}.od-PermissionsSettings-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-delete:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}[dir=ltr] .od-PermissionsSettings-delete{margin-left:auto}[dir=rtl] .od-PermissionsSettings-delete{margin-right:auto}.od-PasswordField-premiumGleam{height:.75rem;width:.75rem;margin-top:12px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}[dir=ltr] .od-PasswordField-premiumGleam{padding-right:5px}[dir=rtl] .od-PasswordField-premiumGleam{padding-left:5px}"}]),n(2139);var r=n(1);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}[dir=ltr] .od-PasswordStrengthMeter{padding-left:6px}[dir=rtl] .od-PasswordStrengthMeter{padding-right:6px}.od-PasswordStrengthMeter .display-linebreak{white-space:pre-line}.od-PasswordStrengthMeter-StrengthExplanation{font-weight:700}.od-PasswordStrengthMeter-StrengthNotificationText{display:inline}.od-PasswordStrengthMeter-StrengthNotificationText.Weak{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Fair{color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Good{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Strong{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-tooltip{font-size:.875rem}.od-PasswordStrengthMeter-StrengthNotificationText-StrengthText{display:inline;font-weight:700}.od-PasswordStrengthMeter-StrengthNotificationBar{width:auto}.od-PasswordStrengthMeter-StrengthNotificationBar.Weak .ms-ProgressIndicator-progressBar{background-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Fair .ms-ProgressIndicator-progressBar{background-color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Good .ms-ProgressIndicator-progressBar{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Strong .ms-ProgressIndicator-progressBar{background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var o=n(2311),s=n(1673),c=n(39),d=n(1801),l=[d.bi,d.gi,d.vi,d.yi,d.Si],u=function(e){function t(t){var n=e.call(this,t)||this;return n._calculatePasswordStrength=n._calculatePasswordStrength.bind(n),n._renderStrengthText=n._renderStrengthText.bind(n),n._renderStrengthBar=n._renderStrengthBar.bind(n),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this._calculatePasswordStrength(this.props.currentPassword),t=c.format(d.et,l[e]);return this.props.getStrengthMeterValue&&this.props.getStrengthMeterValue(l[e]),r.createElement("div",{className:"od-PasswordStrengthMeter"},r.createElement(s.e,{tooltipProps:{maxWidth:"300px",onRenderContent:function(){return r.createElement("div",{className:"od-PasswordStrengthMeter-tooltip"},r.createElement("ul",{style:{margin:0,padding:0}},r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthExplanation"},d.pi," ",r.createElement("br",null)),d.mi," ",r.createElement("br",null),d._i," ",r.createElement("br",null),d.hi))}}},r.createElement("div",{className:"od-PasswordStrengthMeter-test",tabIndex:0,"aria-label":t},this._renderStrengthText(e),this._renderStrengthBar(e))))},t.prototype._renderStrengthText=function(e){var t=l[e];return r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText",role:"status","aria-live":"assertive"},r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText-StrengthText"},d.fi),r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText "+t},t))},t.prototype._renderStrengthBar=function(e){var t=l[e];return r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationBar "+t,"aria-hidden":!0,role:"presentation"},r.createElement(o.e,{percentComplete:.25*e,barHeight:4,styles:{itemProgress:{height:"0.25rem"},progressBar:{height:"0.25rem"},progressTrack:{height:"0.25rem"}}}))},t.prototype._calculatePasswordStrength=function(e){var t=0;return e.length>8&&t++,/[A-Z]/.test(e)&&/[a-z]/.test(e)&&t++,/\d/.test(e)&&t++,/[^A-Za-z0-9]/g.test(e)&&t++,t},t}(r.Component),f=n(2112),p=n(476),m=n(1800),_=n(1831),h=n(1644),b=function(e){function t(t,n){var i=e.call(this,t)||this;return i._currentStrengthMeterValue="",i._topLevelDiv=r.createRef(),i._onUpdatePassword=function(e,t){void 0===t&&(t=""),i._passwordUpdateLogged||(i._passwordUpdateLogged=!0,i._sharingStore.getEngagementHelper().log("ShareV3.passwordUpdated",Object(a.__assign)({},i.props.engagementExtraData)));var n=t.length>0;i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{currentPassword:t,displayRemovePasswordButton:n&&i.props.detailsPane}),function(){i.props.onPasswordChange(t)})},i.props.detailsPane?i.state={currentPassword:"************",disablePasswordField:!0,displayRemovePasswordButton:!0,displayNotificationText:!0,hasExistingPassword:!0}:i.state=Object(a.__assign)(Object(a.__assign)({},i.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,displayNotificationText:!1,hasExistingPassword:!1}),i._renderShareReminder=i._renderShareReminder.bind(i),i._onFocusPasswordFieldDetails=i._onFocusPasswordFieldDetails.bind(i),i._onFocusPasswordField=i._onFocusPasswordField.bind(i),i._onBlurPasswordField=i._onBlurPasswordField.bind(i),i._onDeletePassword=i._onDeletePassword.bind(i),i._getPasswordFieldAriaLabel=i._getPasswordFieldAriaLabel.bind(i),i._getStrengthMeterValue=i._getStrengthMeterValue.bind(i),i._passwordUpdateLogged=!1,i._sharingStore=n.sharingStore,i._resizeTracker=new _.e(n.resize),i}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDiv)},t.prototype.render=function(){var e=this.props.detailsPane?this._onFocusPasswordFieldDetails:this._onFocusPasswordField,t=this._getPasswordFieldAriaLabel();return r.createElement("div",{ref:this._topLevelDiv,className:"od-PasswordField"},r.createElement("div",{className:"od-PasswordField-passwordFieldLine"},r.createElement("div",{className:"od-PasswordField-label"},r.createElement(p.e,{iconName:"Lock"})),r.createElement("div",{className:"od-ShareLink-passwordFieldContent"},r.createElement(f.e,{type:"password",name:"password",autoComplete:"off","data-automationid":"share_link_password",disabled:this.state.disablePasswordField,placeholder:d.Eo,value:this.state.currentPassword,onChange:this._onUpdatePassword,onFocus:e,onBlur:this._onBlurPasswordField,borderless:!0,ariaLabel:t,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,"aria-describedby":"shareReminderText",styles:{field:{fontSize:".875rem",lineHeight:" 1.0625rem",selectors:{"::placeholder":{fontSize:".875rem"}},borderColor:"transparent",border:"none"}}})),this.state.displayRemovePasswordButton&&r.createElement(h.e,{"data-is-focusable":!0,className:"od-PasswordField-delete",iconProps:{iconName:"Cancel"},ariaLabel:d.ao,onClick:this._onDeletePassword}),this._renderPremiumGleam()),this._renderShareReminder())},t.prototype._renderShareReminder=function(){var e,t="od-PasswordField-shareReminder";return this.props.detailsPane&&(t+="-detailsPane"),this.state.displayNotificationText?this.state.hasExistingPassword?this.props.detailsPane&&(e=r.createElement("div",{className:"odPasswordField-lastModifiedBy"},d.li+this.props.lastModifiedBy)):e=this.state.currentPassword.length>0?r.createElement(u,{currentPassword:this.state.currentPassword,getStrengthMeterValue:this._getStrengthMeterValue}):r.createElement("div",null,d.ui):e=r.createElement("div",null,""),r.createElement("div",{className:t,id:"shareReminderText"},e)},t.prototype._renderPremiumGleam=function(){if(this.props.showGleam){var e=window.require?window.require.toUrl("odsp-media/images/premium/premium-gleam-single.svg"):"https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/onedrive-assets/images/gleam.svg";return r.createElement("img",{role:"presentation",src:e,className:"od-PasswordField-premiumGleam"})}},t.prototype._onFocusPasswordFieldDetails=function(){var e=this;this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{currentPassword:"",displayNotificationText:!0,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})},t.prototype._onFocusPasswordField=function(){this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{displayNotificationText:!0}))},t.prototype._onBlurPasswordField=function(){this.state.currentPassword.length>0||this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{displayNotificationText:!1}))},t.prototype._onDeletePassword=function(){var e=this;this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})},t.prototype._getPasswordFieldAriaLabel=function(){return this.state.displayNotificationText?this.state.currentPassword.length>0?c.format(d.et,this._currentStrengthMeterValue):this.state.hasExistingPassword&&this.props.detailsPane?d.li+this.props.lastModifiedBy:d.di+d.ui:d.di},t.prototype._getStrengthMeterValue=function(e){this._currentStrengthMeterValue=e},t.contextTypes={resize:m.func.isRequired,sharingStore:m.object.isRequired},t}(r.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=(n(2210),n(1644)),r=n(1098),o=n(1818),s=n(1),c=n(1800),d=n(39),l=n(1806),u=n(1804),f=n(1801),p=n(129),m=n(1817),_=n(1802),h=n(17);Object(h.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-sensitiviity-label-left-align{border-radius:2px;padding:3px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-sensitivity-label{border-radius:4px;padding:3px 6px 3px 6px!important;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}[dir=ltr] .od-sensitivity-label{margin-left:8px}[dir=rtl] .od-sensitivity-label{margin-right:8px}.od-sensitivity-text{font-size:.75rem;font-weight:400;font:-apple-system-caption1;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.od-sensitivity-tooltip-text{font-weight:600;margin:0;margin-bottom:2px}.od-sensitivity-tooltip-information{margin:0}"}]);var b=n(1927),g=n(1673);function v(e,t){var n=s.useState(null),a=n[0],i=n[1];return e.sensitivityLabelInformation.displayName&&t.sharingStore.getEngagementHelper().showSensitivityLabel(e.engagementExtraData),s.createElement(g.e,{tooltipProps:{directionalHint:p.e.bottomAutoEdge,onRenderContent:function(){return t.sharingStore.getEngagementHelper().hoverOverSensitivityLabel(e.engagementExtraData),s.createElement("div",{className:"od-sensitivity-tooltip"},s.createElement("p",{className:"od-sensitivity-tooltip-text"},e.sensitivityLabelInformation.displayName),s.createElement("p",{className:"od-sensitivity-tooltip-information"},a))},calloutProps:{hidden:null===a||0===a.length}},onTooltipToggle:function(n){return n?void(null===a&&t.sharingStore.getSensitivityLabels(e.getGraphToken).then(function(t){if(t){var n=t.filter(function(t){return t.id===e.sensitivityLabelInformation.id});0!==n.length?i(n[0].tooltip):i("")}else i("")}).catch(function(){i("")})):null},styles:{root:{overflow:"hidden"}}},s.createElement(b.e,{className:e.filename&&0!==e.filename.length?"od-sensitivity-label":"od-sensitiviity-label-left-align"},s.createElement("p",{className:"od-sensitivity-text"},e.sensitivityLabelInformation.displayName)))}v.contextTypes={sharingStore:c.object.isRequired};var y=n(476),S=_.O(),D=_.w(),I=function(e){function t(t,n){var a=e.call(this,t)||this;return a._closeButtonRef=Object(s.createRef)(),a._onInfoButtonClicked=function(){a._store.getEngagementHelper().linkSettingsLearnMoreClicked(a.props.engagementExtraData),window.open("https://go.microsoft.com/fwlink/?linkid=846149")},a._dismissComponent=function(e){e.stopPropagation(),e.preventDefault(),a._onDismiss()},a.state={target:null,headerAria:""},a._onDismiss=n.onDismiss,a._platformDetection=n.platformDetection,a._store=n.sharingStore,a._onManageExistingAccessClick=a._onManageExistingAccessClick.bind(a),a._linkSettingsImprovement=_.U(),a._newShareNotification=_.j(),a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._newShareNotification&&this.props.viewState===o.e.linkSuccess&&this._titleAriaText&&this._updateHeaderAria(this._titleAriaText)},t.prototype.render=function(){var e,t=this.props,n=this.props.mode!==r.e.manageAccess||_.e()?"od-ShareHeader-buttons-right":"od-ShareHeader-buttons-right-wac",a=this._platformDetection.isIE?"od-ShareHeader-linkSettings IE":"od-ShareHeader-linkSettings";if(S||(n="od-ShareHeader-buttons-right-fullscreen"+(this._linkSettingsImprovement?" new":"")),!this._linkSettingsImprovement&&(t.mode===r.e.linkSettings||t.mode===r.e.manageAccess&&!_.e()))return s.createElement("div",{className:"od-ShareHeader-flexBox"},s.createElement("h2",{className:a},this._getViewName()),!this.props.doNotrenderHeaderButtons&&s.createElement("div",{className:n},this._renderCloseButton()));var i=t.viewState===o.e.notify||t.viewState===o.e.linkSuccess&&!this._newShareNotification,c=i?"":" od-ShareHeader-backgroundColor",d=this.props.hasBackButton?" od-ShareHeader-withBackButton":"",l=this.props.title||(null===(e=this.props.hostOptions)||void 0===e?void 0:e.customHeaderString)||this._getViewName();this._titleAriaText=this.props.titleAria||l;var u="";(this._linkSettingsImprovement||t.viewState==o.e.default||_.f()&&t.viewState==o.e.copyLinkShortcut||t.viewState==o.e.error||this._newShareNotification&&t.viewState==o.e.linkSuccess)&&(u=" new");var f="od-ShareHeader"+c+d+u+(D?"":" V2"),p=this.props.titleIsSubLevel||D?this.props.titleIsSubLevel?s.createElement("div",{className:"od-ShareHeader-title"},s.createElement("h2",{className:"od-ShareHeader-viewName od-ShareHeader-subheading",id:"od-shareHeader-viewTitle"},l),this._renderItemName()):s.createElement("div",{className:"od-ShareHeader-header"},s.createElement("div",{className:"od-ShareHeader-title"},s.createElement("h1",{className:"od-ShareHeader-viewName",id:"od-shareHeader-viewTitle"},l)),s.createElement("div",{className:"od-ShareHeader-filename-and-label"},this._renderItemName(),this.props.viewState===o.e.default?this._renderSensitivityLabel():null)):s.createElement("div",{className:"od-ShareHeader-header-V2"},s.createElement("div",{className:"od-ShareHeader-title-V2"},s.createElement("h1",{className:"od-ShareHeader-viewName-V2",id:"od-shareHeader-viewTitle"},l),s.createElement("div",{className:"od-ShareHeader-filename-and-label"},this._renderItemName(this.props.sensitivityLabelInformation?35:70),this.props.viewState===o.e.default?this._renderSensitivityLabel():null)));this._newShareNotification&&t.viewState===o.e.linkSuccess&&(p=s.createElement("div",{className:"od-ShareHeader-notification"},s.createElement(y.e,{iconName:"CheckMark",className:"od-ShareHeader-linkSuccessIcon"}),m.e(this.state.headerAria,"polite","alert"),s.createElement("h1",{className:"od-ShareHeader-viewName new",id:"od-shareHeader-viewTitle"},l)));var h=i?s.createElement("div",null):s.createElement("div",{className:f},p);return S?s.createElement("div",null,h,!this.props.doNotrenderHeaderButtons&&this._renderRightHeaderButtons(!1,i,t.viewState),!this.props.doNotrenderHeaderButtons&&this._renderContextualMenu()):s.createElement("div",{className:"od-ShareHeader-flexBox"+u},h,!this.props.doNotrenderHeaderButtons&&this._renderRightHeaderButtons(!1,i,t.viewState))},t.prototype._renderSensitivityLabel=function(){if(this.props.sensitivityLabelInformation&&_.h()){var e="",t=this.props.item;if(t){var n=t.childCount>1?" (".concat(d.format(f.on,t.childCount),")"):"";e=u.N("".concat(t.name," ").concat(n))}return s.createElement(v,{sensitivityLabelInformation:this.props.sensitivityLabelInformation,engagementExtraData:this.props.engagementExtraData,getGraphToken:this.props.getGraphToken,filename:e.split(" ").join("")})}},t.prototype._renderInfoButton=function(){if(this.props.viewState!=o.e.modifyPermissions)return null;var e=s.createElement(i.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":"".concat(f.An,": ").concat(f._r,". ").concat(f.Ja),iconProps:{iconName:"Info"},onClick:this._onInfoButtonClicked});return this._platformDetection.isMobile||(e=m.t(e,f.An,{position:p.e.bottomRightEdge})),e},t.prototype._renderMoreButton=function(){if(!(this.props.viewState!==o.e.default&&this.props.viewState!==o.e.addPeople||this.props.hideShareDialogOverflowButton||this._store.isBundleShare())){var e={items:[{key:"manageaccess",text:f.Kn,ariaLabel:f.Kn,onClick:this._onManageExistingAccessClick}],styles:{list:{selectors:{".ms-ContextualMenu-itemText":{fontSize:"0.875rem"},".ms-ContextualMenu-link":{height:"2.25rem",lineHeight:"2.25rem"}}}}},t=s.createElement(i.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric",ariaLabel:f.ra,menuIconProps:{iconName:"More",className:"od-ShareHeader-moreOptionsIcon"},menuProps:e});return this._platformDetection.isMobile?t:m.t(t,f.ra,{position:p.e.bottomRightEdge})}},t.prototype._renderCloseButton=function(){var e,t,n,a=null!==(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)&&void 0!==n?n:l._(this.props.clientId);if(this._onDismiss&&a){var r=s.createElement(i.e,{componentRef:this._closeButtonRef,className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":f.Le,onClick:this._dismissComponent,iconProps:{iconName:"Cancel",className:"od-ShareHeader-closeButtonIcon"}});return this._platformDetection.isMobile?r:m.t(r,f.Le,{position:p.e.bottomRightEdge})}},t.prototype._renderRightHeaderButtons=function(e,t,n){var a="od-ShareHeader-buttons-right od-ShareHeader-buttons-fabric";return S||(a="od-ShareHeader-buttons-right-fullscreen"+(D||this.props.viewState!==o.e.default||this.props.titleIsSubLevel?"":"V2")+(this._linkSettingsImprovement?" new":"")),e&&!t&&n===o.e.default?s.createElement("div",{className:a},this._renderMoreButton()):e&&(t||n!==o.e.default)?"":s.createElement("div",{className:a},this._renderInfoButton(),this._renderMoreButton(),this._renderCloseButton())},t.prototype._renderItemName=function(e){var t=this.props,n=t.item;if(n){var a=n.childCount>1?" (".concat(d.format(f.on,n.childCount),")"):"";return s.createElement("div",null,s.createElement("p",{className:"od-ShareHeader-itemName","aria-label":n.name},!t.hideItemName&&u.N("".concat(n.name," ").concat(a),e)))}},t.prototype._renderContextualMenu=function(){[].push({key:"editable",name:f.Kn,onClick:this._onManageExistingAccessClick})},t.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick&&this.props.onManageExistingAccessClick()},t.prototype._updateHeaderAria=function(e){this.setState({headerAria:e})},t.prototype._getViewName=function(){switch(this.props.viewState){case o.e.default:return f.Mo;case o.e.modifyPermissions:return this._linkSettingsImprovement?f.$n:f.Zn;case o.e.linksFromTemplateList:return f.ta;case o.e.permissionsList:return f.Kn;case o.e.policyDetails:return f.yr;case o.e.grantPermissions:return f.pn;case o.e.addPeople:return f.S;default:return f.Mo}},t.prototype.focusCloseButton=function(){this._closeButtonRef.current&&(this._closeButtonRef.current.focus(),this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus())},t.contextTypes={onDismiss:c.func,platformDetection:c.object.isRequired,sharingStore:c.object.isRequired},t}(s.Component)},,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDescription{align-items:top;display:flex;padding:4px 0;width:100%}.od-ShareLinkDescription.new{padding:0}.od-ShareLinkDescription .od-ShareLinkDescription-label-section{width:80%;text-align:left}[dir=ltr] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-left:2%}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{padding-right:2%}[dir=rtl] .od-ShareLinkDescription .od-ShareLinkDescription-label-section{text-align:right}.od-ShareLinkDescription .od-ShareLinkDescription-label-section .od-ShareLinkDescription-detailText{font-size:.75rem;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ShareLinkDescription-label{font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;font:-apple-system-subheadline;width:80%;top:2px;position:relative}[dir=ltr] .od-ShareLinkDescription-label{margin-left:8px}[dir=rtl] .od-ShareLinkDescription-label{margin-right:8px}[dir=ltr] .od-ShareLinkDescription-label{text-align:left}[dir=rtl] .od-ShareLinkDescription-label{text-align:right}.od-ShareLinkDescription-label.new{margin:0;width:100%}.od-ShareLinkDescription-image{width:1rem;height:1rem}.od-ShareLinkDescription-icon{align-items:center;border-radius:50%;border-style:solid;border-width:.0625rem;box-sizing:border-box;display:flex;height:1.5rem;justify-content:center;width:1.5rem;font-size:.875rem}.od-ShareLinkDescription-icon .ms-Icon{font-size:.875rem}.od-ShareLinkDescription-icon.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLinkDescription-icon.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{top:50%;left:50%;transform:translate(-50%,-50%);color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:1.5rem;height:1.5rem;border:.0625rem solid "},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-right:10px}[dir=rtl] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-left:10px}"}]);var r=n(1990),o=n(2153),s=n(476),c=n(1),d=n(1802),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._linkSettingsImprovement=Object(d.U)(),t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this._linkSettingsImprovement?" new":"",t=r.e[this.props.permissionsType],n=this.props.iconUrl?c.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):c.createElement(s.e,{"aria-hidden":"true",iconName:t,styles:{root:{fontSize:"0.875rem",width:"2.75",height:"2.75"}}});return c.createElement("div",{className:"od-ShareLinkDescription"+e},c.createElement("div",{className:"od-ShareLinkDescription-icon icon-".concat(t),"aria-hidden":"true"},n),this._renderLabel())},t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?c.createElement(o.e,{message:e}):"",n=this._linkSettingsImprovement?" new":"";if(this.props.showLabel){var a=!0;this._linkSettingsImprovement&&(t=this.props.isSelected?null:t,a=this.props.isSelected);var i=c.createElement("div",{className:"od-ShareLinkDescription-label"+n},this.props.label,t);return this._linkSettingsImprovement?c.createElement("div",{className:"od-ShareLinkDescription-label-section"},i,a&&c.createElement("span",{className:"od-ShareLinkDescription-detailText"},this.props.detailText)):i}},t}(c.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:5px 4px 4px 4px;font-size:.75rem}.od-InfoButton-button{background:0 0;border:none;padding:0}.od-InfoButton-content{font-size:.75rem;display:flex;flex-direction:column;padding:10px;width:250px}"}]);var r=n(1312),o=n(129),s=n(476),c=n(1),d=n(1800),l=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onShowCallout=function(){i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{isCalloutVisible:!0}))},i._onDismissCallout=function(){i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{isCalloutVisible:!1}))},i._onInfoButton=function(e){i._infoButton=e},i.state={isCalloutVisible:!1},i}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=this.state;return c.createElement("div",null,c.createElement("div",{className:"od-InfoButton-button",onClick:this._onShowCallout,ref:this._onInfoButton},c.createElement(s.e,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,styles:{root:{fontSize:"0.75rem"}}})),t.isCalloutVisible&&c.createElement(r.e,{directionalHint:o.e.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},c.createElement("div",{className:"od-InfoButton-content"},c.createElement("span",{className:"od-InfoButton-message"},e.message))))},t.contextTypes={strings:d.object.isRequired},t}(c.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return H});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharePrincipal2{padding:18px 20px;margin:0 -20px;border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-SharePrincipal2-spinner.ms-Spinner{position:relative;top:unset;left:unset}.od-SharePrincipal2-personaCard{display:inline!important}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-FocusZone{width:100%;display:flex;justify-content:space-between;align-items:center}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-FocusZone .ms-Persona.ms-Persona--size32.od-SharePrincipal-persona2{width:max-content}.od-ShareLink-personaItem.od-SharePrincipal2 .od-SharePrincipal-unknownTooltip{padding-left:6px}.od-ShareLink-personaItem.od-SharePrincipal2.narrow{padding:13px 8px;margin:0}.od-ShareLink-personaItem.od-SharePrincipal2 div.ms-Persona-primaryText{font-size:.875rem}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-Persona-secondaryText{color:"},{theme:"bodySubtext",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-SharePrincipal-roleFullText{padding-left:6px}[dir=rtl] .od-SharePrincipal-roleFullText{padding-right:6px}.od-SharePrincipal-permissions{font-size:.875rem}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissions{display:flex;align-items:center}.od-SharePrincipal-permissions .role-nowrap{white-space:nowrap}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}.ms-SharePrincipal_contextMenu .ms-ContextualMenu-icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}"}]);var r=n(1772),o=n(129),s=n(2452),c=n(1840),d=n(2105),l=n(2576),u=n(1853),f=n(1098),p=n(2579),m=n(1),_=n(1800),h=n(476),b=n(1801),g=n(1941),v=n(1804),y=n(1644),S=n(1673),D=n(39),I=n(435),x=n(1889),C=n(1991),O=n(1750),w=n(345),E=n(2496),A=n(1834),L=n(1885),k=n(2053),M=n(1802),P=n(1829),T=n(1786),U=n(434),F=n(598),H=function(e){function t(t,n){var a=e.call(this,t)||this;return a._menuElement=Object(m.createRef)(),a._showMenu=function(){var e=a.state.showMenu;a.setState({showMenu:!e})},a._hideMenu=function(){a.setState({showMenu:!1})},a._stopSharingConfirmation=function(){a.setState({showConfirmationDialog:!0})},a._onCancel=function(){a.setState({showConfirmationDialog:!1})},a._onStopSharingClick=function(){a._store.getEngagementHelper().manageAccessRemoveDirectAccess(a.props.engagementExtraData),a._store.updatePermissions(a.props.principal,l.e.none)},a.state={showMenu:!1,showConfirmationDialog:!1,selectedRole:t.principal.role},a._store=n.sharingStore,a._onChangeRoleClick=a._onChangeRoleClick.bind(a),a._enableCompactRoleSelector=!0,a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.principal,n=t.role===l.e.owner,a=t.type===u.e.sharePointGroup,i=!n,r=this.props.sharingInformation;r&&r.sharedObjectType===L.e.list&&(i=!a&&!t.isSiteAdmin||a&&!n);var o="od-ShareLink-personaItem od-SharePrincipal2 "+(this.props.useCompact?"narrow":""),s=void 0===e.allowFocus||e.allowFocus,c=t.primaryText===g.de&&""===t.secondaryText,d="";return Object(F.e)()&&(d=t.loginName),m.createElement("div",{className:o,"data-is-focusable":s,"data-principal-detail":d,"aria-label":this._computeAriaLabel(t,n),tabIndex:-1},m.createElement(O.e,{direction:w.e.horizontal},c&&this.props.showUnknownUsers?this._renderUnknownPersona(t):this._renderPersona(t),m.createElement("div",{className:"od-SharePrincipal-permissions"},i?this._renderChangePermissions(t):m.createElement("span",{className:"od-SharePrincipal-ownerLabel",style:{cursor:"default"}},b.oi))),this.state.showConfirmationDialog&&this._renderConfirmationDialog())},t.prototype._renderPersona=function(e){return this.props.isSPO?m.createElement(s.e,{className:"od-SharePrincipal-persona2",size:c.n.size32,text:e.primaryText,secondaryText:e.isExternal?b.Yt:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl,onRenderPersonaCoin:this._onRenderPersonaCoinWithPersonaCard(e)}):m.createElement(s.e,{className:"od-SharePrincipal-persona2",size:c.n.size32,text:e.primaryText,secondaryText:e.isExternal?b.Yt:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl})},t.prototype._renderUnknownPersona=function(e){var t=this,n=function(){return m.createElement("span",null,e.primaryText,m.createElement("span",{className:"od-SharePrincipal-unknownTooltip"},t._renderUnknownDisplayNameTooltip()))};return this.props.isSPO?m.createElement(s.e,{className:"od-SharePrincipal-persona2",onRenderPrimaryText:n,onRenderPersonaCoin:this._onRenderPersonaCoinWithPersonaCard(e)}):m.createElement(s.e,{className:"od-SharePrincipal-persona2",size:c.n.size32,text:e.primaryText,secondaryText:e.isExternal?b.Yt:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl,onRenderPrimaryText:n})},t.prototype._onRenderPersonaCoinWithPersonaCard=function(e){var t=this;return function(){var n=t._getPersonaType(e.type);return m.createElement(E.e,{personaType:n,identifier:e.email||e.loginName,pageContext:t.props.pageContext,ariaLabel:e.primaryText,className:"od-SharingPrincipal2-personaCard",lpcCardBehavior:{onCardClose:void 0,onCardOpen:void 0,disableClick:!0}},m.createElement(d.e,{size:c.n.size32,text:e.primaryText,secondaryText:e.isExternal?b.Yt:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl}))}},t.prototype._getPersonaType=function(e){switch(e){case u.e.securityGroup:case u.e.sharePointGroup:return"Group";default:return"NotResolved"}},t.prototype._getRoleSelectorProps=function(e){return{menuPermissionOptions:Object(A.e)({sharingInformation:this.props.sharingInformation}),sharingRole:e,mode:f.e.addPeople,clientId:this.props.clientId,ariaLabel:b.D,showStopSharing:!0,onRoleChange:this._onChangeRoleClick.bind(this),onStopSharing:this._stopSharingConfirmation.bind(this),roleSelectorAs:k.e}},t.prototype._renderRoleSelector=function(e){var t=this._getRoleSelectorProps(e);return m.createElement(k.e,Object(a.__assign)({},t))},t.prototype._renderChangePermissions=function(e){var t=this.state.selectedRole,n=this.props.userRole,a=this.props.showViewOnly,i=Object(M.R)()||Object(P.n)()?"od-SharePrincipal-permissionsRole role-nowrap":"od-SharePrincipal-permissionsRole",r=void 0===this.props.allowFocus||this.props.allowFocus;return a||n!==l.e.owner||t!==l.e.edit&&t!==l.e.view&&t!==l.e.review&&t!==l.e.owner&&t!==l.e.manageList?m.createElement("div",{className:i},this._renderRoleIcon(e,r)):this._enableCompactRoleSelector?m.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleSelector(t)):m.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleIcon(e,!1),this._renderChangePermissionDropdown())},t.prototype._renderUnknownDisplayNameTooltip=function(){var e=g.le;return m.createElement(S.e,{content:e,calloutProps:{gapSpace:0},id:"od-SharePrincipal-unknownDisplayNameTooltip"},m.createElement("span",{tabIndex:0,role:"note",className:"od-SharePrincipal-inlineTooltip"},m.createElement(h.e,{className:"od-SharePrincipal-unknownDisplayName-infoIcon","aria-describedby":"od-SharePrincipal-unknownDisplayNameTooltip","data-is-focusable":!0,iconName:"Info"})))},t.prototype._renderRoleIcon=function(e,t){var n=e.role;this.props.useAccessMap&&(n=Object(v.h)(e));var a=Object(v.x)(n),i=this._computeRoleText(n,e),r=this.props.roleVerbose;return!this.props.isSPO||this.props.accessChecked?m.createElement(S.e,{content:i,calloutProps:{gapSpace:0}},m.createElement(h.e,{className:"od-SharePrincipal-roleIcon",iconName:a.name,"data-is-focusable":t,"aria-hidden":!t,"aria-label":i}),r&&m.createElement("span",{className:"od-SharePrincipal-roleFullText"}," ",i," ")):m.createElement(T.e,{size:U.e.small,className:"od-SharePrincipal2-spinner"})},t.prototype._renderChangePermissionDropdown=function(){var e=Object(I.e)();return m.createElement("div",{ref:this._menuElement},m.createElement(y.e,{className:"od-SharePrincipal-changePermissionsChevron",onClick:this._showMenu,iconProps:{iconName:"ChevronDown"},ariaLabel:D.format(b.ar,this.props.principal.primaryText)}),this.state.showMenu&&m.createElement(r.e,{target:this._menuElement.current,items:this._getContextualMenuItems(),directionalHint:e?o.e.bottomLeftEdge:o.e.bottomRightEdge,onDismiss:this._hideMenu,className:"ms-SharePrincipal_contextMenu"}))},t.prototype._onChangeRoleClick=function(e){e!==this.props.principal.role&&(this._store.updatePermissions(this.props.principal,e),this.setState({selectedRole:e}))},t.prototype._renderConfirmationDialog=function(){var e=this.props.principal,t={id:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,loginName:e.loginName,principalType:e.type};return m.createElement(x.ConfirmationDialog,{confirmationCode:C.e.participant,participant:t,onApply:this._onStopSharingClick,onCancel:this._onCancel})},t.prototype._getContextualMenuItems=function(){var e=this,t=this.props.principal.role,n=A.l(p.e.existing,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension),a=this.props.sharingInformation.sharedObjectType===L.e.list&&this.props.principal.type!==u.e.sharePointGroup,i={key:"currentRole",name:Object(v.x)(t).title,onClick:function(){e._onChangeRoleClick(t)},checked:!0,iconProps:{iconName:"CheckMark"}},r={key:"fullControl",name:b.cn,onClick:function(){e._onChangeRoleClick(l.e.owner)}},o={key:"editRole",name:b.oe,onClick:function(){e._onChangeRoleClick(l.e.edit)}},s={key:"reviewRole",name:b._e,onClick:function(){e._onChangeRoleClick(l.e.review)}},c={key:"viewRole",name:b.ge,onClick:function(){e._onChangeRoleClick(l.e.view)}},d={key:"stopSharing",name:"".concat(b.Ds),onClick:this._stopSharingConfirmation},f=[i];return a&&t!=l.e.owner&&f.push(r),t!=l.e.edit&&f.push(o),n&&t!=l.e.review&&f.push(s),t!=l.e.view&&f.push(c),f.push(d),f},t.prototype._computeAriaLabel=function(e,t){var n=this._computeRoleText(e.role,e),a="".concat(e.primaryText,", ").concat(n,".");return t||(a+=" "+b.Uo),a},t.prototype._computeRoleText=function(e,t){if("number"!=typeof e)return t.sharingLinkKind?b.l:"";switch(e){case l.e.edit:return b.oe;case l.e.review:return b._e;case l.e.view:return b.ge;case l.e.owner:return b.oi;default:return""}},t.contextTypes={sharingStore:_.object.isRequired},t}(m.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}[dir=ltr] .teams .od-AudienceChoiceGroup-row{padding-left:0}[dir=rtl] .teams .od-AudienceChoiceGroup-row{padding-right:0}.teams .od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{font-weight:700}.od-AudienceChoiceGroup-row{background:0 0;border:none;cursor:pointer;margin-top:4px;font:-apple-system-caption1;display:flex;flex-wrap:wrap;width:calc(100% - 24px)}.od-AudienceChoiceGroup-row.new{margin:0;width:100%;padding:12px 0}.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-main{display:flex;width:100%}.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-sub{width:100%;margin-left:24px;padding-left:2%}.od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:';font-weight:600;overflow-wrap:anywhere}.od-AudienceChoiceGroup-row.is-selected .tickIcon::after{content:"\\e73e";font-family:FabricMDL2Icons;flex-basis:10%;color:'},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.75rem;margin-top:10px;padding-right:5px}[dir=ltr] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir=rtl] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:left}.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-radio{width:20px;height:20px;margin:0}.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-radio.ms-RadioButton-field::before{position:inherit}@media screen and (-ms-high-contrast:active){.od-AudienceChoiceGroup-row .od-AudienceChoiceGroup-radio.ms-RadioButton-field.is-checked::after{background-color:highlight}}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-label{color:#a19f9d;overflow-wrap:anywhere}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}@media screen and (-ms-high-contrast:active){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast:black-on-white){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset}@media screen and (-ms-high-contrast:active){.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{box-shadow:0 0 0 1px #37006e inset}}.teams .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.od-AudienceChoiceGroup-description{align-items:center;display:inline-flex;overflow:hidden;width:90%;flex-grow:1;flex-basis:90%}[dir=ltr] .od-AudienceChoiceGroup-description{float:left}[dir=rtl] .od-AudienceChoiceGroup-description{float:right}"}]);var r=n(1750),o=n(345),s=n(2152),c=n(1),d=n(1800),l=n(1806),u=n(1802),f=n(2051),p=function(e){function t(t,n){var a=e.call(this,t)||this;return a._firstInteractiveElement=c.createRef(),a._linkSettingsImprovement=Object(u.U)(),a._onActiveElementChanged=function(e){if(!a._platformDetection.isMobile&&!l.r(a.props.clientId)&&e&&e.hasAttribute("data-key")){var t=parseInt(e.getAttribute("data-key"),10);"true"===e.getAttribute("aria-disabled")||a._onRowClick(t)}},a.state={selectedKey:a._getSelectedIndex(t)},a._platformDetection=n.platformDetection,a}return Object(a.__extends)(t,e),t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var a=n[t];if(a.isChecked)return a.key}},t.prototype.componentDidMount=function(){var e=this;this._firstInteractiveElement&&this._firstInteractiveElement.current&&(this._platformDetection.isIOS?setTimeout(function(){e._firstInteractiveElement.current.focus()},100):this._firstInteractiveElement.current.focus())},t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return c.createElement(r.e,{direction:o.e.vertical,onActiveElementChanged:this._onActiveElementChanged},c.createElement("div",{"aria-labelledby":"od-shareHeader-viewTitle od-PermissionsSettings-prompt-id",role:"radiogroup"},e))},t.prototype._renderItem=function(e,t){var n=e.key,a=!this._platformDetection.isFirefox,i=e.isDisabled&&e.disabledText?e.disabledText:"",r=this.state.selectedKey===n;!e.isDisabled&&this._linkSettingsImprovement&&(i=e.detailText);var o=this._platformDetection.isAndroid||this._platformDetection.isIE||this._platformDetection.isFirefox?t+1+" of "+this.props.items.length:"",d="od-AudienceChoiceGroup-radio ms-RadioButton-field";e.isDisabled&&(d+=" is-disabled"),r&&(d+=" is-checked");var l=c.createElement(c.Fragment,null,c.createElement("div",{className:"od-AudienceChoiceGroup-description"},c.createElement(s.e,{label:e.label,permissionsType:e.permissionsType,showLabel:!0,iconUrl:e.iconUrl,infoButtonMessage:a?i:"",detailText:e.detailText,isSelected:r})),this._linkSettingsImprovement?c.createElement("label",{className:d}):c.createElement("div",{className:"tickIcon","aria-hidden":!0}));return this._linkSettingsImprovement&&(l=c.createElement("div",{className:"od-AudienceChoiceGroup-main"},l)),c.createElement(c.Fragment,null,c.createElement("button",{ref:r?this._firstInteractiveElement:void 0,role:"radio","aria-checked":r,key:n,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,n),className:this._getRowClasses(e),"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":this.props.items.length,"aria-label":"".concat(e.label," ").concat(i," ").concat(o),"data-key":n,tabIndex:r?0:-1},l,!!this._linkSettingsImprovement&&e.subComponent&&c.createElement("div",{className:"od-AudienceChoiceGroup-sub"},e.subComponent)),this._linkSettingsImprovement&&t<this.props.items.length-1?c.createElement(f.e,null):c.createElement("div",{className:"od-AudienceChoiceGroup-bottomBorder"}))},t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-AudienceChoiceGroup-row od-Share-noFocusBorder";return this.state.selectedKey===e.key&&(t+=" is-selected"),e.isDisabled&&(t+=" is-disabled"),this._linkSettingsImprovement&&(t+=" new"),t},t.prototype._onRowClick=function(e){var t=this.props;this.setState({selectedKey:e}),t.onAudienceChange(e),this.context.sharingStore.getEngagementHelper().linkSettingsLinkTypeChanged(this.props.engagementExtraData)},t.contextTypes={sharingStore:d.object.isRequired,platformDetection:d.object.isRequired},t}(c.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n(0),i=n(1),r=n(2343),o=n(476),s=n(17);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PreventDownloadToggle{vertical-align:top;height:100%;display:flex;line-height:2rem}.od-PreventDownloadToggle .ms-Toggle{width:100%}.od-PreventDownloadToggle .ms-Toggle-slider{position:absolute;top:.375rem}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-slider{right:30px}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-slider{left:30px}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-slider{float:right}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-slider{float:left}.od-PreventDownloadToggle .ms-Toggle-label{padding:0;display:inline-flex;font-size:.875rem;cursor:pointer;margin:0 4px 0 12px}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-PreventDownloadToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:400}.od-PreventDownloadToggle .ms-Toggle-innerContainer{line-height:2rem;align-items:center}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:right}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:left}.od-preventDownload-tooltip .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';cursor:pointer;font-size:.75rem}[dir=ltr] .od-preventDownload-tooltip .ms-Icon{margin-left:10px}[dir=rtl] .od-preventDownload-tooltip .ms-Icon{margin-right:10px}.od-preventDownload-tooltipContent{font-size:.875rem}.od-PreventDownloadToggle-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-PreventDownloadToggle-label.new{display:flex}.od-preventDownload-tooltipWrapper{outline:transparent;position:relative}.od-preventDownload-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-preventDownload-tooltipWrapper:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-preventDownload-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var c=n(1801),d=n(1673),l=n(129),u=n(39),f=n(1800),p=n(1802),m=function(e){function t(t,n){var a=e.call(this,t)||this;return a.state={preventDownloadToggle:!1},a._onChanged=a._onChanged.bind(a),a._linkSettingsImprovement=Object(p.U)(),a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props.disablePreventDownload,t=!e&&this.props.isToggled,n=!this.props.detailsPane&&this.props.disablePreventDownload;Object(p.E)()&&(n=!1);var s=n?this.props.isRolesDropDown?u.format(c.Cr,c.ve):u.format(c.xr,c.L):c.Or,f={maxWidth:"300px",onRenderContent:function(){return i.createElement("div",{className:"od-preventDownload-tooltipContent"},s)}};this.props.detailsPane&&(t=!0);var m=n?i.createElement(d.e,{hostClassName:"od-preventDownload-tooltip",directionalHint:l.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:f},i.createElement(o.e,{className:"ms-Icon ms-Icon--Info od-preventDownload-tooltipWrapper",iconName:"Info",tabIndex:0,role:"img","aria-label":s})):null,_=i.createElement("div",{className:"od-PreventDownloadToggle-label ".concat(this._linkSettingsImprovement?" new":"")},c.Or,!!this._linkSettingsImprovement&&m);return i.createElement("div",{className:"od-PreventDownloadToggle"},i.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload-Icon"},i.createElement(o.e,Object(a.__assign)({iconName:"Blocked2"},{alt:c.gn}))),i.createElement(r.e,{checked:t,disabled:e,"aria-disabled":e,className:t?"isToggled":"",label:_,ariaLabel:s,onChanged:this._onChanged,role:"switch",styles:{label:{fontSize:".875rem"},pill:{width:"2.5rem",height:"1.25rem",borderWidth:"0.0625rem",borderRadius:"0.625rem"},thumb:{width:"0.75rem",height:"0.75rem"}},onText:this._linkSettingsImprovement?c.Fs:"",offText:this._linkSettingsImprovement?c.Us:""}),!this._linkSettingsImprovement&&m)},t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("PreventDownload.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode}),this.setState({preventDownloadToggle:e},function(){t.props.onToggleChange(e)})},t.contextTypes={sharingStore:f.object.isRequired},t}(i.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var a=n(0),i=n(1),r=n(2343),o=n(476),s=n(17);Object(s.n)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-OfficeReviewModeToggle{vertical-align:top;height:100%;display:flex;line-height:2rem}.od-OfficeReviewModeToggle .ms-Toggle{width:100%}.od-OfficeReviewModeToggle .ms-Toggle-slider{position:absolute;top:.375rem}[dir=ltr] .od-OfficeReviewModeToggle .ms-Toggle-slider{right:30px}[dir=rtl] .od-OfficeReviewModeToggle .ms-Toggle-slider{left:30px}[dir=ltr] .od-OfficeReviewModeToggle .ms-Toggle-slider{float:right}[dir=rtl] .od-OfficeReviewModeToggle .ms-Toggle-slider{float:left}.od-OfficeReviewModeToggle .ms-Toggle-label{padding:0;display:inline-block;font-size:.875rem;cursor:pointer;width:calc(100% - 4.4rem);margin:0 4px 0 12px}[dir=rtl] .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-OfficeReviewModeToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:400}.od-OfficeReviewModeToggle .ms-Toggle-innerContainer{line-height:2rem;margin-top:.25rem}[dir=ltr] .od-OfficeReviewModeToggle .ms-Toggle-innerContainer{float:right}[dir=rtl] .od-OfficeReviewModeToggle .ms-Toggle-innerContainer{float:left}.od-OfficeReviewModeToggle-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-OfficeReviewModeToggle-learnMore{text-decoration:none;outline:transparent;position:relative;white-space:nowrap;font:-apple-system-caption2}.od-OfficeReviewModeToggle-learnMore::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-learnMore:focus:after{content:"";position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-OfficeReviewMode-tooltip .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';cursor:pointer;font-size:.75rem}[dir=ltr] .od-OfficeReviewMode-tooltip .ms-Icon{margin-left:10px}[dir=rtl] .od-OfficeReviewMode-tooltip .ms-Icon{margin-right:10px}.od-OfficeReviewMode-tooltipContent{font-size:.75rem}.od-OfficeReviewMode-tooltipContent-text{padding-bottom:10px}.od-OfficeReviewMode-tooltipWrapper{outline:transparent;position:relative;font-size:.75rem}.od-OfficeReviewMode-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-OfficeReviewMode-tooltipWrapper:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}.od-OfficeReviewModeToggle-tooltipWrapper{display:inline;outline:transparent;position:relative;font-size:.75rem}.od-OfficeReviewModeToggle-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-tooltipWrapper:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-OfficeReviewMode-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0;font-size:.75rem}"}]);var c=n(1801),d=n(1673),l=n(129),u=n(1312),f=n(1782),p=n(39),m=n(1800),_=n(1802),h=n(112),b={label:{fontSize:".875rem"},pill:{width:"2.5rem",height:"1.25rem",borderWidth:"0.0625rem",borderRadius:"0.625rem"},thumb:{width:"0.75rem",height:"0.75rem"}},g=function(e){function t(t,n){var a=e.call(this,t)||this;return a.state={OfficeReviewModeToggle:!1,isInfoCalloutVisible:!1,isInfoCalloutFocused:!1},a._onChanged=a._onChanged.bind(a),a}return Object(a.__extends)(t,e),t.prototype.render=function(){return this._renderReviewModeWithEllipsis()},t.prototype._showInfoCallout=function(){this.state.isInfoCalloutVisible||this.setState({isInfoCalloutVisible:!0})},t.prototype._hideInfoCallout=function(){this.state.isInfoCalloutVisible&&!this.state.isInfoCalloutFocused&&this.setState({isInfoCalloutVisible:!1})},t.prototype._iconInfoKeyPressed=function(e){if(e&&e.charCode===h.e.enter||e.charCode===h.e.space){e.preventDefault();var t=this.state.isInfoCalloutVisible;this.setState({isInfoCalloutVisible:!t})}},t.prototype._setCalloutFocused=function(){this.setState({isInfoCalloutFocused:!0})},t.prototype._setCalloutUnfocused=function(){this.setState({isInfoCalloutFocused:!1,isInfoCalloutVisible:!1})},t.prototype._renderReviewModeWithEllipsis=function(){var e=this.props.disableOfficeReviewMode,t=this.props.isToggled,n=!this.props.detailsPane&&this.props.disableOfficeReviewMode,s=n?p.format(c.Ka,c.L):c.Wa,m="od-OfficeReviewModeToggle-InfoIcon",h={maxWidth:"300px",onRenderContent:function(){return n?i.createElement("div",{className:"od-OfficeReviewMode-tooltipContent"},s):i.createElement("div",{className:"od-OfficeReviewMode-tooltipContent"},c.Ga," ",i.createElement("a",{className:"od-OfficeReviewModeToggle-learnMore","aria-label":"".concat(c.An,": ").concat(c.Wa),href:"https://support.office.com/article/9fcc2f7d-de0c-4cec-93b0-a82024800c07",target:"_blank"},c.An))}};return i.createElement("div",{className:"od-OfficeReviewModeToggle"},i.createElement("div",{className:"od-PermissionsSettings-setting--OfficeReviewMode-Icon"},i.createElement(o.e,Object(a.__assign)({iconName:"Feedback"},{alt:c.bn}))),i.createElement(r.e,{checked:t,disabled:e,"aria-disabled":e,className:t?"isToggled":"",label:i.createElement("div",{className:"od-OfficeReviewModeToggle-label"},c.Wa," "),ariaLabel:s,onChanged:this._onChanged,styles:b}),i.createElement("div",{className:n?"od-OfficeReviewModeToggle--info":"od-OfficeReviewMode-tooltip--info"},Object(_.te)()?i.createElement(d.e,{hostClassName:"od-OfficeReviewMode-tooltip",directionalHint:l.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:h},i.createElement("div",{tabIndex:0,className:"od-OfficeReviewModeToggle-tooltipWrapper","aria-label":c.Ga},i.createElement(o.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}))):i.createElement("span",{tabIndex:0,className:"od-OfficeReviewModeToggle-tooltipWrapper od-OfficeReviewMode-tooltip",onMouseEnter:this._showInfoCallout.bind(this),onMouseLeave:this._hideInfoCallout.bind(this),onKeyPress:this._iconInfoKeyPressed.bind(this),id:m,"aria-label":c.Ga},i.createElement(o.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}),i.createElement(u.e,{ariaLabelledBy:"od-OfficeReviewMode-tooltipContent",ariaDescribedBy:"od-OfficeReviewMode-tooltipContent",role:"dialog",gapSpace:0,target:"#".concat(m),onDismiss:this._hideInfoCallout.bind(this),onMouseOver:this._setCalloutFocused.bind(this),onMouseLeave:this._setCalloutUnfocused.bind(this),setInitialFocus:!0,hidden:!this.state.isInfoCalloutVisible,style:{maxWidth:"300px",padding:"12px 16px",fontSize:"0.75rem"},directionalHint:l.e.topCenter},n?i.createElement("div",{className:"od-OfficeReviewMode-tooltipContent"},s):i.createElement("div",{className:"od-OfficeReviewMode-tooltipContent"},i.createElement("div",{className:"od-OfficeReviewMode-tooltipContent-text"},c.Ga),i.createElement(f.e,{tabIndex:0,style:{fontSize:"0.875rem"},className:"od-OfficeReviewModeToggle-learnMore","aria-label":"".concat(c.An,": ").concat(c.Wa),href:"https://support.office.com/article/9fcc2f7d-de0c-4cec-93b0-a82024800c07",target:"_blank"},c.An))))))},t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("OfficeReviewMode.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode}),this.setState({OfficeReviewModeToggle:e},function(){t.props.onToggleChange(e)})},t.contextTypes={sharingStore:m.object.isRequired},t}(i.Component)},,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"i",function(){return u});var a=n(58),i=n(252),r=n(7),o=function(e){return{dependencies:{observablesFactoryType:a.i},create:function(t){var n=new(0,t.observablesFactoryType)({}),a=n.create();return e&&(a.equalityComparer=i.n),{instance:a,disposable:n}}}},s=new r.t({name:"".concat("ShareCommandKeys",".shareFocusItem"),factory:o(!0)}),c=new r.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),d=new r.t({name:"".concat("ShareCommandKeys",".copyFormLinkFocusItem"),factory:o()}),l=new r.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),u=new r.t({name:"".concat("ShareCommandKeys",".shareFromGrantAccess"),factory:o()})},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(1624).e},,,,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.shouldStartExpanded,i=void 0===a||a;return n._shouldStartExpanded=i,n.showArrow=!1,n.isExpanded=n._getIsExpanded(),n}return Object(a.__extends)(t,e),t.prototype._getIsExpanded=function(){var e=this,t=this.createObservable(this._shouldStartExpanded);return this.createComputed({read:function(){return!e.showArrow||t()},write:function(n){e.showArrow&&t(n)},pure:!0})},t}(n(58).n);t.e=i},,,,function(e,t,n){"use strict";n(2007);var a=n(399),i=n(0),r=n(196),o=n(1825),s=n(812),c=n(1812),d=n(811),l=n(1803),u=n(1828),f=n(1841),p=n(1822),m=n(1109),_=n(530),h=n(2172),b={},g=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.overlayTagName=o.e.tagName,n.closePanelLabel=h.e,n.addBindingHandlers({dismiss:s.e,element:m.e,host:c.e,interactionScope:d.t,focusTrap:u.e,recoverFocus:p.e,preserveFocus:f.e,scrollContainer:l.e});var a=t.size,i=void 0===a?"Small":a,r=t.title,_=void 0===r?"":r,g=t.onClose,v=t.ariaLabel,y=void 0===v?"":v,S=t.showCloseButton,D=void 0===S||S,I=t.isOpen,x=t.width,C=void 0===x?"":x,O=t.virtualParentElement,w=t.hasCommandBar,E=void 0!==w&&w,A=t.customCssStyle,L=void 0===A?n.createObservable(""):A;n._size=i,n._onClose=g,n.contentElement=n.createObservable(),n.title=n.wrapObservable(_),n._ariaLabel=n.wrapObservable(y),n.showCloseButton=n.createObservable(!!n._onClose&&D),n.isOpen=I,n.customCssStyle=L,n.widthClass=n.createPureComputed(n._computeWidthClass,{deferEvaluation:!0});var k=n.wrapObservable(C);return n.style=n.createPureComputed(function(){return k()?{width:k()+"px"}:b}),n.ariaLabel=n.createPureComputed(n._computeAriaLabel),n.virtualParentElement=O,n.hasCommandBar=E,n}return Object(i.__extends)(t,e),t.prototype.onClose=function(e,t){return this._onClose&&this._onClose(t),!1},t.prototype.onDismiss=function(e,t){return this._onClose&&this._onClose(t),!1},t.prototype.isPanelOpen=function(e){return this.isOpen?this.isOpen():e()},t.prototype._computeWidthClass=function(){return this.unwrapObservable(this.style)===b?"od-Panel--"+_.e.determineCssClass(this._size):""},t.prototype._computeAriaLabel=function(){return this.unwrapObservable(this.title)||this.unwrapObservable(this._ariaLabel)},t}(r.t),v=a.e({tagName:"od-panel-overlay",template:'\x3c!--ko component:{name:overlayTagName,params:{animation:{afterAdd:1,beforeRemove:500,isOpen:isOpen},alignToParent:false,virtualParentElement:virtualParentElement}}--\x3e<div class="od-Panel-container" data-bind="focusTrap:{},css:{\'od-Panel--hidden\':!isPanelOpen($host.isOpen)}"><div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel od-Panel--hasPadding od-Panel--autoScroll" role="dialog" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:isPanelOpen($host.isOpen)},scrollContainer,dismiss:{isOpen:isOpen||$host.isOpen,close:$component.onDismiss.bind($component),useLocalEvents:true},class:widthClass()+\' \'+customCssStyle(),css:{\'od-Panel--hasCommandBar\':hasCommandBar},attr:{\'aria-label\':ariaLabel},style:style,element:$component.contentElement">\x3c!--ko if:title--\x3e<div class="od-Panel-title" role="heading" aria-level="1" data-bind="text:title"></div>\x3c!--/ko--\x3e<div class="od-Panel-content" data-bind="host:{}"></div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Panel-button od-Panel-button--close" data-bind="click:$component.onClose.bind($component),attr:{\'aria-label\':$component.closePanelLabel}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e',viewModel:g,synchronous:!0});t.e=v},,,function(e,t,n){"use strict";n.d(t,"n",function(){return I}),n.d(t,"t",function(){return x}),n.d(t,"e",function(){return C});var a=n(0),i=n(1),r=n(1840),o=n(2452),s=n(1673),c=n(129),d=n(1923),l=n(1644),u=n(476),f=n(51),p=n(39),m=n(17);Object(m.n)([{rawString:"@media screen and (-ms-high-contrast:active){.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-secondaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-secondaryText{color:HighlightText}}.ms-PickerPersona-container{position:relative;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:';margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:flex;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077b5}.itemContent_780e3396{flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.peoplePickerPill_780e3396{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:24px;border-radius:12px;display:inline-flex;align-items:center;margin:4px}.peoplePickerClose_780e3396{border-radius:12px;height:24px;width:24px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .peoplePickerClose_780e3396{padding-left:4px}html[dir=rtl] .peoplePickerClose_780e3396{padding-right:4px}.peoplePickerClose_780e3396:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";border-radius:12px}.placeholderUser_780e3396{background-color:unset;outline:1px dashed;outline-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}]);var _=n(2129),h=n(430),b=n(1010),g=n(8),v=n(2430),y=h.e.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||g.e.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated");function S(e,t,n){var a="3rem";if(t)switch(t){case r.n.size24:a="1.5rem";break;case r.n.size32:a="2rem";break;case r.n.size40:a="2.5rem";break;case r.n.extraSmall:a="1.75rem";break;default:a="3rem"}var i={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:a,height:a,maxWidth:"75px",maxHeight:"75px",flexShrink:0},image:{width:a+"!important",height:a+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:a,height:a,maxWidth:"75px",maxHeight:"75px"},initials:{width:a,height:a,fontSize:"0.625rem",lineHeight:a}}},styles:{root:{height:"auto"},primaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.875rem"},secondaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.75rem"}}};return Object(v.n)(e)&&void 0!==n?Object(b.default)(i,Object(v.t)(n)):i}var D=function(e){return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(o.e,Object(a.__assign)({},e.personaProps,{presence:r.t.none,size:r.n.size40,className:"ms-PeoplePicker-pickerPersona"})),e.person.entityType===d.e.linkedinUser&&i.createElement(u.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},I=function(e,t){var n,a=S(e,r.n.size40,v.e.standalone);return n=a,t&&(n=t(a)),i.createElement(D,{person:e,personaProps:n})},x=function(e){var t,n=e.item,d=e.onRemoveItem,u=e.index,m=e.selected,h=e.removeButtonAriaLabel,b=S(n,r.n.extraSmall,v.e.pill);return y||(b.onRenderPrimaryText=function(){return i.createElement(s.e,{content:n.email||b.text,directionalHint:c.e.topLeftEdge},b.text)}),i.createElement("div",{className:Object(f.e)("ms-PickerPersona-container",(t={"is-selected":!!m},t.placeholderUser_780e3396=Object(v.n)(n),t)),"data-is-focusable":!0,"data-selection-index":u,key:u,role:"listitem"},i.createElement("div",{className:Object(f.e)("ms-PickerItem-content","itemContent_780e3396")},i.createElement(o.e,Object(a.__assign)({},b,{presence:r.t.none,size:r.n.extraSmall}))),i.createElement(l.e,{styles:{root:{flexShrink:0}},onClick:d,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":null!=h?h:p.format(_.n,n.name),disabled:e.disabled}))},C=function(e){var t=e.item,n=e.onRemoveItem,s=e.index,c=e.selected,d=S(t,r.n.size40),u="PickerPersonaId"+Math.floor(1e4*Math.random()),m=p.format(_.n,t.name);return i.createElement("div",{className:Object(f.e)("ms-PickerPersona-container is-listbelow",{"is-selected":!!c}),"data-is-focusable":!0,"data-selection-index":s,key:s,"aria-labelledby":u,role:"listitem"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(o.e,Object(a.__assign)({id:u},d,{presence:r.t.none,size:r.n.size40}))),i.createElement("div",{className:"ms-PickerItem-content"},i.createElement(l.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":m})))}},,,,,,,,,function(e,t,n){"use strict";var a,i=n(60),r=n(128),o=n(47);!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(a||(a={}));var s=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:o.e.Success}),e},function(e){return n.end({resultType:o.e.Failure}),i.n.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:o.e.Success}),e},function(e){return n.end({resultType:o.e.Failure}),i.n.reject(e)})},e}();t.e=s},,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(119),r=n(67),o=n(58),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._dataSource=n.policyTipDataSource,a}return Object(a.__extends)(t,e),t.prototype.getPolicyTip=function(e){return this._dataSource.getPolicyTip(e)},t.prototype.updatePolicy=function(e){return this._dataSource.updatePolicy(e)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},o.n.dependencies),{policyTipDataSource:r.W}),t}(o.n),c=Object(i.r)("PolicyTipProvider",s)},function(e,t,n){"use strict";var a=n(1920);n.d(t,"t",function(){return a.n}),n.d(t,"e",function(){return a.t})}],Array(14),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(1),r=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return Object(a.__extends)(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0}},t.prototype.render=function(){return this.state.hasError?null:i.createElement(i.Fragment,null,this.props.children)},t.prototype.componentDidCatch=function(e,t){this.props.onError&&this.props.onError(e,t)},t}(i.PureComponent)},,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(1),r=n(1104),o=n(1455),s=n(109),c=function(e){function t(t){var n=e.call(this,t)||this;return Object(r.e)(n),Object(o.e)("PivotItem",t,{linkText:"headerText"}),n}return Object(a.__extends)(t,e),t.prototype.render=function(){return i.createElement("div",Object(a.__assign)({},Object(s.s)(this.props,s.r)),this.props.children)},t}(i.Component)}],Array(13),[function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.SelectAll=3]="SelectAll"}(a||(a={}))},,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(472),i=n(119),r=n(1985),o=n(2061),s=n(2249),c=Object(i.r)("GraphPeoplePickerHelper",r.t,{oAuthTokenProvider:o.e,pageContext:a.e,sharingContextInformation:s.e.optional})},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return j});var a,i=n(1526),r=n(0),o=n(1),s=n(1644),c=n(1611),d=n(1787),l=n(1760),u=n(809),f=n(801),p=n(51),m=n(524),_=n(170),h=n(1104),b=n(1455),g=n(587),v=n(435),y=n(109),S=n(529),D=n(1796),I=n(1912),x=Object(u.e)();!function(e){e[e.closed=0]="closed",e[e.animatingOpen=1]="animatingOpen",e[e.open=2]="open",e[e.animatingClosed=3]="animatingClosed"}(a||(a={}));var C,O,w,E,A,L=function(e){function t(t){var n=e.call(this,t)||this;n._panel=o.createRef(),n._animationCallback=null,n._hasCustomNavigation=!(!n.props.onRenderNavigation&&!n.props.onRenderNavigationContent),n.dismiss=function(e){n.props.onDismiss&&n.isActive&&n.props.onDismiss(e),(!e||e&&!e.defaultPrevented)&&n.close()},n._allowScrollOnPanel=function(e){e?n._allowTouchBodyScroll?Object(f.e)(e,n._events):Object(f.t)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onRenderNavigation=function(e){if(!n.props.onRenderNavigationContent&&!n.props.onRenderNavigation&&!n.props.hasCloseButton)return null;var t=n.props.onRenderNavigationContent,a=void 0===t?n._onRenderNavigationContent:t;return o.createElement("div",{className:n._classNames.navigation},a(e,n._onRenderNavigationContent))},n._onRenderNavigationContent=function(e){var t,a=e.closeButtonAriaLabel,i=e.hasCloseButton,r=e.onRenderHeader,c=void 0===r?n._onRenderHeader:r;if(i){var d=null===(t=n._classNames.subComponentStyles)||void 0===t?void 0:t.closeButton();return o.createElement(o.Fragment,null,!n._hasCustomNavigation&&c(n.props,n._onRenderHeader,n._headerTextId),o.createElement(s.e,{styles:d,className:n._classNames.closeButton,onClick:n._onPanelClick,ariaLabel:a,title:a,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null},n._onRenderHeader=function(e,t,a){var i=e.headerText,s=e.headerTextProps,c=void 0===s?{}:s;return i?o.createElement("div",{className:n._classNames.header},o.createElement("div",Object(r.__assign)({id:a,role:"heading","aria-level":1},c,{className:Object(p.e)(n._classNames.headerText,c.className)}),i)):null},n._onRenderBody=function(e){return o.createElement("div",{className:n._classNames.content},e.children)},n._onRenderFooter=function(e){var t=n.props.onRenderFooterContent,a=void 0===t?null:t;return a?o.createElement("div",{className:n._classNames.footer},o.createElement("div",{className:n._classNames.footerInner},a())):null},n._animateTo=function(e){e===a.open&&n.props.onOpen&&n.props.onOpen(),n._animationCallback=n._async.setTimeout(function(){n.setState({visibility:e}),n._onTransitionComplete()},200)},n._clearExistingAnimationTimer=function(){null!==n._animationCallback&&n._async.clearTimeout(n._animationCallback)},n._onPanelClick=function(e){n.dismiss(e)},n._onTransitionComplete=function(){n._updateFooterPosition(),n.state.visibility===a.open&&n.props.onOpened&&n.props.onOpened(),n.state.visibility===a.closed&&n.props.onDismissed&&n.props.onDismissed()};var i=n.props.allowTouchBodyScroll,c=void 0!==i&&i;return n._allowTouchBodyScroll=c,n._async=new m.e(n),n._events=new _.e(n),Object(h.e)(n),Object(b.e)("Panel",t,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),n.state={isFooterSticky:!1,visibility:a.closed,id:Object(g.e)("Panel")},n}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return void 0===e.isOpen?null:!e.isOpen||t.visibility!==a.closed&&t.visibility!==a.animatingClosed?e.isOpen||t.visibility!==a.open&&t.visibility!==a.animatingOpen?null:{visibility:a.animatingClosed}:{visibility:a.animatingOpen}},t.prototype.componentDidMount=function(){this._events.on(window,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.setState({visibility:a.animatingOpen})},t.prototype.componentDidUpdate=function(e,t){var n=this._shouldListenForOuterClick(this.props),i=this._shouldListenForOuterClick(e);this.state.visibility!==t.visibility&&(this._clearExistingAnimationTimer(),this.state.visibility===a.animatingOpen?this._animateTo(a.open):this.state.visibility===a.animatingClosed&&this._animateTo(a.closed)),n&&!i?this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0):!n&&i&&this._events.off(document.body,"mousedown",this._dismissOnOuterClick,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,i=e.elementToFocusOnDismiss,s=e.firstFocusableSelector,u=e.focusTrapZoneProps,f=e.forceFocusInsideTrap,p=e.hasCloseButton,m=e.headerText,_=e.headerClassName,h=void 0===_?"":_,b=e.ignoreExternalFocusing,g=e.isBlocking,S=e.isFooterAtBottom,C=e.isLightDismiss,O=e.isHiddenOnDismiss,w=e.layerProps,E=e.overlayProps,A=e.popupProps,L=e.type,k=e.styles,M=e.theme,P=e.customWidth,T=e.onLightDismissClick,U=void 0===T?this._onPanelClick:T,F=e.onRenderNavigation,H=void 0===F?this._onRenderNavigation:F,R=e.onRenderHeader,N=void 0===R?this._onRenderHeader:R,B=e.onRenderBody,j=void 0===B?this._onRenderBody:B,V=e.onRenderFooter,z=void 0===V?this._onRenderFooter:V,G=this.state,K=G.isFooterSticky,W=G.visibility,q=G.id,Q=L===I.e.smallFixedNear||L===I.e.customNear,Y=Object(v.e)(M)?Q:!Q,J=L===I.e.custom||L===I.e.customNear?{width:P}:{},X=Object(y.s)(this.props,y.r),Z=this.isActive,$=W===a.animatingClosed||W===a.animatingOpen;if(this._headerTextId=m&&q+"-headerText",!Z&&!$&&!O)return null;this._classNames=x(k,{theme:M,className:n,focusTrapZoneClassName:u?u.className:void 0,hasCloseButton:p,headerClassName:h,isAnimating:$,isFooterSticky:K,isFooterAtBottom:S,isOnRightSide:Y,isOpen:Z,isHiddenOnDismiss:O,type:L,hasCustomNavigation:this._hasCustomNavigation});var ee,te=this._classNames,ne=this._allowTouchBodyScroll;return g&&Z&&(ee=o.createElement(d.e,Object(r.__assign)({className:te.overlay,isDarkThemed:!1,onClick:C?U:void 0,allowTouchBodyScroll:ne},E))),o.createElement(c.e,Object(r.__assign)({},w),o.createElement(l.e,Object(r.__assign)({role:"dialog","aria-modal":g?"true":void 0,ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:te.hiddenPanel,enableAriaHiddenSiblings:!!Z},A),o.createElement("div",Object(r.__assign)({"aria-hidden":!Z&&$},X,{ref:this._panel,className:te.root}),ee,o.createElement(D.e,Object(r.__assign)({ignoreExternalFocusing:b,forceFocusInsideTrap:!(!g||O&&!Z)&&f,firstFocusableSelector:s,isClickableOutsideFocusTrap:!0},u,{className:te.main,style:J,elementToFocusOnDismiss:i}),o.createElement("div",{className:te.contentInner},o.createElement("div",{ref:this._allowScrollOnPanel,className:te.scrollableContent,"data-is-scrollable":!0},o.createElement("div",{className:te.commands,"data-is-visible":!0},H(this.props,this._onRenderNavigation)),(this._hasCustomNavigation||!p)&&N(this.props,this._onRenderHeader,this._headerTextId),j(this.props,this._onRenderBody),z(this.props,this._onRenderFooter)))))))},t.prototype.open=function(){void 0===this.props.isOpen&&(this.isActive||this.setState({visibility:a.animatingOpen}))},t.prototype.close=function(){void 0===this.props.isOpen&&this.isActive&&this.setState({visibility:a.animatingClosed})},Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state.visibility===a.open||this.state.visibility===a.animatingOpen},enumerable:!1,configurable:!0}),t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen},t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,n=e.scrollHeight;this.setState({isFooterSticky:t<n})}},t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this.isActive&&t&&!e.defaultPrevented&&(Object(S.e)(t,e.target)||(this.props.onOuterClick?this.props.onOuterClick(e):this.dismiss(e)))},t.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:I.e.smallFixedFar},t}(o.Component),k=n(21),M={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},P="auto",T=((C={})["@media (min-width: "+k.p+"px)"]={width:340},C),U=((O={})["@media (min-width: "+k.f+"px)"]={width:592},O["@media (min-width: "+k.h+"px)"]={width:644},O),F=((w={})["@media (min-width: "+k._+"px)"]={left:48,width:"auto"},w["@media (min-width: "+k.b+"px)"]={left:428},w),H=((E={})["@media (min-width: "+k.b+"px)"]={left:P,width:940},E),R=((A={})["@media (min-width: "+k.b+"px)"]={left:176},A),N=function(e){var t;switch(e){case I.e.smallFixedFar:t=Object(r.__assign)({},T);break;case I.e.medium:t=Object(r.__assign)(Object(r.__assign)({},T),U);break;case I.e.large:t=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},T),U),F);break;case I.e.largeFixed:t=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},T),U),F),H);break;case I.e.extraLarge:t=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},T),U),F),R)}return t},B={paddingLeft:"24px",paddingRight:"24px"},j=Object(i.e)(L,function(e){var t,n,a,i,o=e.className,s=e.focusTrapZoneClassName,c=e.hasCloseButton,d=e.headerClassName,l=e.isAnimating,u=e.isFooterSticky,f=e.isFooterAtBottom,p=e.isOnRightSide,m=e.isOpen,_=e.isHiddenOnDismiss,h=e.hasCustomNavigation,b=e.theme,g=e.type,v=void 0===g?I.e.smallFixedFar:g,y=b.effects,S=b.fonts,D=b.semanticColors,x=Object(k.I)(M,b),C=v===I.e.custom||v===I.e.customNear;return{root:[x.root,b.fonts.medium,m&&x.isOpen,c&&x.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},C&&p&&x.custom,C&&!p&&x.customNear,o],overlay:[{pointerEvents:"auto",cursor:"pointer"},m&&l&&k.e.fadeIn100,!m&&l&&k.e.fadeOut100],hiddenPanel:[!m&&!l&&_&&{visibility:"hidden"}],main:[x.main,{backgroundColor:D.bodyBackground,boxShadow:y.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:P,right:0,width:"100%",selectors:Object(r.__assign)((t={},t[k.o]={borderLeft:"3px solid "+D.variantBorder,borderRight:"3px solid "+D.variantBorder},t),N(v))},v===I.e.smallFluid&&{left:0},v===I.e.smallFixedNear&&{left:0,right:P,width:272},v===I.e.customNear&&{right:"auto",left:0},C&&{maxWidth:"100vw"},m&&l&&!p&&k.e.slideRightIn40,m&&l&&p&&k.e.slideLeftIn40,!m&&l&&!p&&k.e.slideLeftOut40,!m&&l&&p&&k.e.slideRightOut40,s],commands:[x.commands,{paddingTop:18,selectors:(n={},n["@media (min-height: "+k.p+"px)"]={position:"sticky",top:0,zIndex:1},n)},h&&{paddingTop:"inherit"},u&&{backgroundColor:D.bodyBackground}],navigation:[x.navigation,{display:"flex",justifyContent:"flex-end"},h&&{height:"44px"}],contentInner:[x.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden"}],header:[x.header,B,{alignSelf:"flex-start"},c&&!h&&{flexGrow:1},h&&{flexShrink:0}],headerText:[x.headerText,S.xLarge,{color:D.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},d],scrollableContent:[x.scrollableContent,{overflowY:"auto"},f&&{flexGrow:1,display:"inherit",flexDirection:"inherit"}],content:[x.content,B,{paddingBottom:20},f&&{selectors:(a={},a["@media (min-height: "+k.p+"px)"]={flexGrow:1},a)}],footer:[x.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity "+k.n.durationValue3+" "+k.n.easeFunction2,selectors:(i={},i["@media (min-height: "+k.p+"px)"]={position:"sticky",bottom:0},i)},u&&{backgroundColor:D.bodyBackground,borderTopColor:D.variantBorder}],footerInner:[x.footerInner,B,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[x.closeButton,{marginRight:14,color:b.palette.neutralSecondary,fontSize:k.c.large},h&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:b.palette.neutralPrimary}}}}},void 0,{scope:"Panel"})}],Array(14),[function(e,t,n){"use strict";function a(e,t){var n=t?document.createElement("textarea"):document.createElement("input");t?n.innerHTML=e:(n.setAttribute("type","text"),n.setAttribute("value",e)),document.body.appendChild(n);var a=!1;try{n.focus(),n.select(),a=document.execCommand("copy")}catch(e){}if(!a&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(n.value),a=!0}catch(e){}return document.body.removeChild(n),a}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("sharingContextInformation")},function(e,t,n){"use strict";e.exports=n(2251).polyfill()},function(e,t,n){(function(t,n){var a;a=function(){"use strict";function e(e){return"function"==typeof e}var a=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,r=void 0,o=void 0,s=function(e,t){m[i]=e,m[i+1]=t,2===(i+=2)&&(o?o(_):y())},c="undefined"!=typeof window?window:void 0,d=c||{},l=d.MutationObserver||d.WebKitMutationObserver,u="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(_,1)}}var m=new Array(1e3);function _(){for(var e=0;e<i;e+=2)(0,m[e])(m[e+1]),m[e]=void 0,m[e+1]=void 0;i=0}var h,b,g,v,y=void 0;function S(e,t){var n=this,a=new this.constructor(x);void 0===a[I]&&H(a);var i=n._state;if(i){var r=arguments[i-1];s(function(){return U(i,a,r,n._result)})}else P(n,a,e,t);return a}function D(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(x);return A(t,e),t}u?y=function(){return t.nextTick(_)}:l?(b=0,g=new l(_),v=document.createTextNode(""),g.observe(v,{characterData:!0}),y=function(){v.data=b=++b%2}):f?((h=new MessageChannel).port1.onmessage=_,y=function(){return h.port2.postMessage(0)}):y=void 0===c?function(){try{var e=Function("return this")().require("vertx");return void 0!==(r=e.runOnLoop||e.runOnContext)?function(){r(_)}:p()}catch(e){return p()}}():p();var I=Math.random().toString(36).substring(2);function x(){}var C=void 0,O={error:null};function w(e){try{return e.then}catch(e){return O.error=e,O}}function E(t,n,a){n.constructor===t.constructor&&a===S&&n.constructor.resolve===D?function(e,t){1===t._state?k(e,t._result):2===t._state?M(e,t._result):P(t,void 0,function(t){return A(e,t)},function(t){return M(e,t)})}(t,n):a===O?(M(t,O.error),O.error=null):void 0===a?k(t,n):e(a)?function(e,t,n){s(function(e){var a=!1,i=function(n,i,r,o){try{n.call(i,function(n){a||(a=!0,t!==n?A(e,n):k(e,n))},function(t){a||(a=!0,M(e,t))})}catch(e){return e}}(n,t,0,0,e._label);!a&&i&&(a=!0,M(e,i))},e)}(t,n,a):k(t,n)}function A(e,t){var n,a;e===t?M(e,new TypeError("You cannot resolve a promise with itself")):(a=typeof(n=t),null===n||"object"!==a&&"function"!==a?k(e,t):E(e,t,w(t)))}function L(e){e._onerror&&e._onerror(e._result),T(e)}function k(e,t){e._state===C&&(e._result=t,e._state=1,0!==e._subscribers.length&&s(T,e))}function M(e,t){e._state===C&&(e._state=2,e._result=t,s(L,e))}function P(e,t,n,a){var i=e._subscribers,r=i.length;e._onerror=null,i[r]=t,i[r+1]=n,i[r+2]=a,0===r&&e._state&&s(T,e)}function T(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var a=void 0,i=void 0,r=e._result,o=0;o<t.length;o+=3)a=t[o],i=t[o+n],a?U(n,a,i,r):i(r);e._subscribers.length=0}}function U(t,n,a,i){var r=e(a),o=void 0,s=void 0,c=void 0,d=void 0;if(r){if(o=function(e,t){try{return e(t)}catch(e){return O.error=e,O}}(a,i),o===O?(d=!0,s=o.error,o.error=null):c=!0,n===o)return void M(n,new TypeError("A promises callback cannot return that same promise."))}else o=i,c=!0;n._state!==C||(r&&c?A(n,o):d?M(n,s):1===t?k(n,o):2===t&&M(n,o))}var F=0;function H(e){e[I]=F++,e._state=void 0,e._result=void 0,e._subscribers=[]}var R=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(x),this.promise[I]||H(this.promise),a(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&k(this.promise,this._result))):M(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===C&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,a=n.resolve;if(a===D){var i=w(e);if(i===S&&e._state!==C)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===N){var r=new n(x);E(r,e,i),this._willSettleAt(r,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(a(e),t)},e.prototype._settledAt=function(e,t,n){var a=this.promise;a._state===C&&(this._remaining--,2===e?M(a,n):this._result[t]=n),0===this._remaining&&k(a,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;P(e,void 0,function(e){return n._settledAt(1,t,e)},function(e){return n._settledAt(2,t,e)})},e}(),N=function(){function e(t){this[I]=F++,this._result=this._state=void 0,this._subscribers=[],x!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){A(e,t)},function(t){M(e,t)})}catch(t){M(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},e}();return N.prototype.then=S,N.all=function(e){return new R(this,e).promise},N.race=function(e){var t=this;return a(e)?new t(function(n,a){for(var i=e.length,r=0;r<i;r++)t.resolve(e[r]).then(n,a)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},N.resolve=D,N.reject=function(e){var t=new this(x);return M(t,e),t},N._setScheduler=function(e){o=e},N._setAsap=function(e){s=e},N._asap=s,N.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var a=null;try{a=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===a&&!t.cast)return}e.Promise=N},N.Promise=N,N},e.exports=a()}).call(this,n(2134),n(819))},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.none=0]="none",e[e.descriptive=1]="descriptive",e[e.more=2]="more",e[e.downArrow=3]="downArrow"}(a||(a={}))}],Array(26),[function(e,t,n){"use strict";n.d(t,"e",function(){return T});var a=n(1526),i=n(21),r={root:"ms-GroupedList",compact:"ms-GroupedList--Compact",group:"ms-GroupedList-group",link:"ms-Link",listCell:"ms-List-cell"},o=n(0),s=n(1),c=n(809),d=n(435),l=n(112),u=n(1104),f=n(51),p=n(587),m=n(170),_=n(108),h=n(2029),b={root:"ms-GroupShowAll",link:"ms-Link"},g=n(1782),v=n(1115),y=Object(c.e)(),S=Object(a.e)(function(e){var t=e.group,n=e.groupLevel,a=e.showAllLinkText,i=void 0===a?"Show All":a,r=e.styles,o=e.theme,c=e.onToggleSummarize,d=y(r,{theme:o}),l=Object(s.useCallback)(function(e){c(t),e.stopPropagation(),e.preventDefault()},[c,t]);return t?s.createElement("div",{className:d.root},s.createElement(v.e,{count:n}),s.createElement(g.e,{onClick:l},i)):null},function(e){var t,n=e.theme,a=n.fonts,r=Object(i.I)(b,n);return{root:[r.root,{position:"relative",padding:"10px 84px",cursor:"pointer",selectors:(t={},t["."+r.link]={fontSize:a.small.fontSize},t)}]}},void 0,{scope:"GroupShowAll"}),D={root:"ms-groupFooter"},I=Object(c.e)(),x=Object(a.e)(function(e){var t=e.group,n=e.groupLevel,a=e.footerText,i=e.indentWidth,r=e.styles,o=e.theme,c=I(r,{theme:o});return t&&a?s.createElement("div",{className:c.root},s.createElement(v.e,{indentWidth:i,count:n}),a):null},function(e){var t=e.theme,n=e.className,a=Object(i.I)(D,t);return{root:[t.fonts.medium,a.root,{position:"relative",padding:"5px 38px"},n]}},void 0,{scope:"GroupFooter"}),C=n(1794),O=function(e){function t(n){var a=e.call(this,n)||this;a._root=s.createRef(),a._list=s.createRef(),a._subGroupRefs={},a._droppingClassName="",a._onRenderGroupHeader=function(e){return s.createElement(h.e,Object(o.__assign)({},e))},a._onRenderGroupShowAll=function(e){return s.createElement(S,Object(o.__assign)({},e))},a._onRenderGroupFooter=function(e){return s.createElement(x,Object(o.__assign)({},e))},a._renderSubGroup=function(e,n){var i=a.props,r=i.dragDropEvents,o=i.dragDropHelper,c=i.eventsToRegister,d=i.getGroupItemLimit,l=i.groupNestingDepth,u=i.groupProps,f=i.items,p=i.headerProps,m=i.showAllProps,_=i.footerProps,h=i.listProps,b=i.onRenderCell,g=i.selection,v=i.selectionMode,y=i.viewport,S=i.onRenderGroupHeader,D=i.onRenderGroupShowAll,I=i.onRenderGroupFooter,x=i.onShouldVirtualize,C=i.group,O=i.compact,w=e.level?e.level+1:l;return!e||e.count>0||u&&u.showEmptyGroups?s.createElement(t,{ref:function(e){return a._subGroupRefs["subGroup_"+n]=e},key:a._getGroupKey(e,n),dragDropEvents:r,dragDropHelper:o,eventsToRegister:c,footerProps:_,getGroupItemLimit:d,group:e,groupIndex:n,groupNestingDepth:w,groupProps:u,headerProps:p,items:f,listProps:h,onRenderCell:b,selection:g,selectionMode:v,showAllProps:m,viewport:y,onRenderGroupHeader:S,onRenderGroupShowAll:D,onRenderGroupFooter:I,onShouldVirtualize:x,groups:C?C.children:[],compact:O}):null},a._getGroupDragDropOptions=function(){var e=a.props,t=e.group,n=e.groupIndex,i=e.dragDropEvents;return{eventMap:e.eventsToRegister,selectionIndex:-1,context:{data:t,index:n,isGroup:!0},updateDropState:a._updateDroppingState,canDrag:i.canDrag,canDrop:i.canDrop,onDrop:i.onDrop,onDragStart:i.onDragStart,onDragEnter:i.onDragEnter,onDragLeave:i.onDragLeave,onDragEnd:i.onDragEnd,onDragOver:i.onDragOver}},a._updateDroppingState=function(e,t){var n=a.state.isDropping,i=a.props,r=i.dragDropEvents,o=i.group;n!==e&&(n?r&&r.onDragLeave&&r.onDragLeave(o,t):r&&r.onDragEnter&&(a._droppingClassName=r.onDragEnter(o,t)),a.setState({isDropping:e}))};var i=n.selection,r=n.group;return Object(u.e)(a),a._id=Object(p.e)("GroupedListSection"),a.state={isDropping:!1,isSelected:!(!i||!r)&&i.isRangeSelected(r.startIndex,r.count)},a._events=new m.e(a),a}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.dragDropHelper,n=e.selection;t&&this._root.current&&(this._dragDropSubscription=t.subscribe(this._root.current,this._events,this._getGroupDragDropOptions())),n&&this._events.on(n,_.e,this._onSelectionChange)},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._dragDropSubscription&&this._dragDropSubscription.dispose()},t.prototype.componentDidUpdate=function(e){this.props.group===e.group&&this.props.groupIndex===e.groupIndex&&this.props.dragDropHelper===e.dragDropHelper||(this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this.props.dragDropHelper&&this._root.current&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getGroupDragDropOptions())))},t.prototype.render=function(){var e=this.props,t=e.getGroupItemLimit,n=e.group,a=e.groupIndex,i=e.headerProps,r=e.showAllProps,c=e.footerProps,d=e.viewport,l=e.selectionMode,u=e.onRenderGroupHeader,p=void 0===u?this._onRenderGroupHeader:u,m=e.onRenderGroupShowAll,_=void 0===m?this._onRenderGroupShowAll:m,h=e.onRenderGroupFooter,b=void 0===h?this._onRenderGroupFooter:h,g=e.onShouldVirtualize,v=e.groupedListClassNames,y=e.groups,S=e.compact,D=e.listProps,I=void 0===D?{}:D,x=this.state.isSelected,O=n&&t?t(n):1/0,w=n&&!n.children&&!n.isCollapsed&&!n.isShowingAll&&(n.count>O||n.hasMoreData),E=n&&n.children&&n.children.length>0,A=I.version,L={group:n,groupIndex:a,groupLevel:n?n.level:0,isSelected:x,selected:x,viewport:d,selectionMode:l,groups:y,compact:S},k={groupedListId:this._id,ariaLevel:(null==n?void 0:n.level)?n.level+1:1,ariaSetSize:y?y.length:void 0,ariaPosInSet:void 0!==a?a+1:void 0},M=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},i),L),k),P=Object(o.__assign)(Object(o.__assign)({},r),L),T=Object(o.__assign)(Object(o.__assign)({},c),L),U=!!this.props.dragDropHelper&&this._getGroupDragDropOptions().canDrag(n)&&!!this.props.dragDropEvents.canDragGroups;return s.createElement("div",Object(o.__assign)({ref:this._root},U&&{draggable:!0},{className:Object(f.e)(v&&v.group,this._getDroppingClassName()),role:"presentation"}),p(M,this._onRenderGroupHeader),n&&n.isCollapsed?null:E?s.createElement(C.e,{role:"presentation",ref:this._list,items:n?n.children:[],onRenderCell:this._renderSubGroup,getItemCountForPage:this._returnOne,onShouldVirtualize:g,version:A,id:this._id}):this._onRenderGroup(O),n&&n.isCollapsed?null:w&&_(P,this._onRenderGroupShowAll),b(T,this._onRenderGroupFooter))},t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this),this.forceListUpdate()},t.prototype.forceListUpdate=function(){var e=this.props.group;if(this._list.current){if(this._list.current.forceUpdate(),e&&e.children&&e.children.length>0)for(var t=e.children.length,n=0;n<t;n++){var a;(a=this._list.current.pageRefs["subGroup_"+String(n)])&&a.forceListUpdate()}}else(a=this._subGroupRefs["subGroup_"+String(0)])&&a.forceListUpdate()},t.prototype._onSelectionChange=function(){var e=this.props,t=e.group,n=e.selection;if(n&&t){var a=n.isRangeSelected(t.startIndex,t.count);a!==this.state.isSelected&&this.setState({isSelected:a})}},t.prototype._onRenderGroupCell=function(e,t,n){return function(a,i){return e(t,a,i,n)}},t.prototype._onRenderGroup=function(e){var t=this.props,n=t.group,a=t.items,i=t.onRenderCell,r=t.listProps,c=t.groupNestingDepth,d=t.onShouldVirtualize,l=t.groupProps,u=n&&!n.isShowingAll?n.count:a.length,f=n?n.startIndex:0;return s.createElement(C.e,Object(o.__assign)({role:l&&l.role?l.role:"rowgroup","aria-label":null==n?void 0:n.name,items:a,onRenderCell:this._onRenderGroupCell(i,c,n),ref:this._list,renderCount:Math.min(u,e),startIndex:f,onShouldVirtualize:d,id:this._id},r))},t.prototype._returnOne=function(){return 1},t.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(e.level)+String(t))},t.prototype._getDroppingClassName=function(){var e=this.state.isDropping,t=this.props,n=t.group,a=t.groupedListClassNames;return e=!(!n||!e),Object(f.e)(e&&this._droppingClassName,e&&"is-dropping",e&&a&&a.groupIsDropping)},t}(s.Component),w=n(404),E=n(1750),A=n(345),L=Object(c.e)(),k=w.t.rowHeight,M=w.t.compactRowHeight,P=function(e){function t(t){var n=e.call(this,t)||this;n._list=s.createRef(),n._renderGroup=function(e,t){var a=n.props,i=a.dragDropEvents,r=a.dragDropHelper,c=a.eventsToRegister,d=a.groupProps,l=a.items,u=a.listProps,f=a.onRenderCell,p=a.selectionMode,m=a.selection,_=a.viewport,h=a.onShouldVirtualize,b=a.groups,g=a.compact,v={onToggleSelectGroup:n._onToggleSelectGroup,onToggleCollapse:n._onToggleCollapse,onToggleSummarize:n._onToggleSummarize},y=Object(o.__assign)(Object(o.__assign)({},d.headerProps),v),S=Object(o.__assign)(Object(o.__assign)({},d.showAllProps),v),D=Object(o.__assign)(Object(o.__assign)({},d.footerProps),v),I=n._getGroupNestingDepth();if(!d.showEmptyGroups&&e&&0===e.count)return null;var x=Object(o.__assign)(Object(o.__assign)({},u||{}),{version:n.state.version});return s.createElement(O,{key:n._getGroupKey(e,t),dragDropEvents:i,dragDropHelper:r,eventsToRegister:c,footerProps:D,getGroupItemLimit:d&&d.getGroupItemLimit,group:e,groupIndex:t,groupNestingDepth:I,groupProps:d,headerProps:y,listProps:x,items:l,onRenderCell:f,onRenderGroupHeader:d.onRenderHeader,onRenderGroupShowAll:d.onRenderShowAll,onRenderGroupFooter:d.onRenderFooter,selectionMode:p,selection:m,showAllProps:S,viewport:_,onShouldVirtualize:h,groupedListClassNames:n._classNames,groups:b,compact:g})},n._getDefaultGroupItemLimit=function(e){return e.children&&e.children.length>0?e.children.length:e.count},n._getGroupItemLimit=function(e){var t=n.props.groupProps;return(t&&t.getGroupItemLimit?t.getGroupItemLimit:n._getDefaultGroupItemLimit)(e)},n._getGroupHeight=function(e){var t=n.props.compact?M:k;return t+(e.isCollapsed?0:t*n._getGroupItemLimit(e))},n._getPageHeight=function(e){var t=n.state.groups,a=n.props.getGroupHeight,i=void 0===a?n._getGroupHeight:a,r=t&&t[e];return r?i(r,e):0},n._onToggleCollapse=function(e){var t=n.props.groupProps,a=t&&t.headerProps&&t.headerProps.onToggleCollapse;e&&(a&&a(e),e.isCollapsed=!e.isCollapsed,n._updateIsSomeGroupExpanded(),n.forceUpdate())},n._onToggleSelectGroup=function(e){var t=n.props,a=t.selection,i=t.selectionMode;e&&a&&i===_.n.multiple&&a.toggleRangeSelected(e.startIndex,e.count)},n._isInnerZoneKeystroke=function(e){return e.which===Object(d.t)(l.e.right)},n._onToggleSummarize=function(e){var t=n.props.groupProps,a=t&&t.showAllProps&&t.showAllProps.onToggleSummarize;a?a(e):(e&&(e.isShowingAll=!e.isShowingAll),n.forceUpdate())},n._getPageSpecification=function(e){var t=n.state.groups,a=t&&t[e];return{key:a&&a.key}},Object(u.e)(n),n._isSomeGroupExpanded=n._computeIsSomeGroupExpanded(t.groups);var a=t.listProps,i=(void 0===a?{}:a).version,r=void 0===i?{}:i;return n.state={groups:t.groups,items:t.items,listProps:t.listProps,version:r},n}return Object(o.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.groups,a=e.selectionMode,i=e.compact,r=e.items,s=e.listProps,c=s&&s.version,d=Object(o.__assign)(Object(o.__assign)({},t),{selectionMode:a,compact:i,groups:n,listProps:s,items:r}),l=!1;return c===(t.listProps&&t.listProps.version)&&r===t.items&&n===t.groups&&a===t.selectionMode&&i===t.compact||(l=!0),l&&(d=Object(o.__assign)(Object(o.__assign)({},d),{version:{}})),d},t.prototype.scrollToIndex=function(e,t,n){this._list.current&&this._list.current.scrollToIndex(e,t,n)},t.prototype.getStartItemIndexInView=function(){return this._list.current.getStartItemIndexInView()||0},t.prototype.componentDidMount=function(){var e=this.props,t=e.groupProps,n=e.groups,a=void 0===n?[]:n;t&&t.isAllGroupsCollapsed&&this._setGroupsCollapsedState(a,t.isAllGroupsCollapsed)},t.prototype.render=function(){var e=this.props,t=e.className,n=e.usePageCache,a=e.onShouldVirtualize,i=e.theme,r=e.role,c=void 0===r?"treegrid":r,d=e.styles,l=e.compact,u=e.focusZoneProps,p=void 0===u?{}:u,m=e.rootListProps,_=void 0===m?{}:m,h=this.state,b=h.groups,g=h.version;this._classNames=L(d,{theme:i,className:t,compact:l});var v=p.shouldEnterInnerZone,y=void 0===v?this._isInnerZoneKeystroke:v;return s.createElement(E.e,Object(o.__assign)({direction:A.e.vertical,"data-automationid":"GroupedList","data-is-scrollable":"false",role:"presentation"},p,{shouldEnterInnerZone:y,className:Object(f.e)(this._classNames.root,p.className)}),b?s.createElement(C.e,Object(o.__assign)({ref:this._list,role:c,items:b,onRenderCell:this._renderGroup,getItemCountForPage:this._returnOne,getPageHeight:this._getPageHeight,getPageSpecification:this._getPageSpecification,usePageCache:n,onShouldVirtualize:a,version:g},_)):this._renderGroup(void 0,0))},t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this),this._forceListUpdates()},t.prototype.toggleCollapseAll=function(e){var t=this.state.groups,n=void 0===t?[]:t,a=this.props.groupProps,i=a&&a.onToggleCollapseAll;n.length>0&&(i&&i(e),this._setGroupsCollapsedState(n,e),this._updateIsSomeGroupExpanded(),this.forceUpdate())},t.prototype._setGroupsCollapsedState=function(e,t){for(var n=0;n<e.length;n++)e[n].isCollapsed=t},t.prototype._returnOne=function(){return 1},t.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(t))},t.prototype._getGroupNestingDepth=function(){for(var e=0,t=this.state.groups;t&&t.length>0;)e++,t=t[0].children;return e},t.prototype._forceListUpdates=function(e){this.setState({version:{}})},t.prototype._computeIsSomeGroupExpanded=function(e){var t=this;return!(!e||!e.some(function(e){return e.children?t._computeIsSomeGroupExpanded(e.children):!e.isCollapsed}))},t.prototype._updateIsSomeGroupExpanded=function(){var e=this.state.groups,t=this.props.onGroupExpandStateChanged,n=this._computeIsSomeGroupExpanded(e);this._isSomeGroupExpanded!==n&&(t&&t(n),this._isSomeGroupExpanded=n)},t.defaultProps={selectionMode:_.n.multiple,isHeaderVisible:!0,groupProps:{},compact:!1},t}(s.Component),T=Object(a.e)(P,function(e){var t,n,a=e.theme,o=e.className,s=e.compact,c=a.palette,d=Object(i.I)(r,a);return{root:[d.root,a.fonts.small,{position:"relative",selectors:(t={},t["."+d.listCell]={minHeight:38},t)},s&&[d.compact,{selectors:(n={},n["."+d.listCell]={minHeight:32},n)}],o],group:[d.group,{transition:"background-color "+i.n.durationValue2+" cubic-bezier(0.445, 0.050, 0.550, 0.950)"}],groupIsDropping:{backgroundColor:c.neutralLight}}},void 0,{scope:"GroupedList"})},,function(e,t,n){"use strict";n.d(t,"e",function(){return y});var a=n(0),i=n(1),r=n(1529),o=n(2342),s=n(8),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){t.props.inputProps&&t.props.inputProps.onClick&&t.props.inputProps.onClick(e),0!==e.button||e&&e.target&&e.target.value||t.onEmptyInputFocus()},t.onInputFocus=function(e){var n,a;d()||null===(a=null===(n=t.props.inputProps)||void 0===n?void 0:n.onFocus)||void 0===a||a.call(n,e)},t}return Object(a.__extends)(t,e),t}(o.e);function d(){return s.t.isActivated("f7dc3d8b-8019-4187-9e11-6dcb2597352b")}var l=n(2498),u=n(1853),f=n(2182),p=n(2130),m=n(17);Object(m.n)([{rawString:".ms-Suggestions{width:260px}"}]);var _=n(2129),h=n(704),b=s.t.isActivated("41868B4D-8044-4ACF-8E89-CFD71EF69C3D","10/31/2021","fix people picker suggestion dup"),g=c,v=o.t,y=function(e){function t(t){var n=e.call(this,t)||this;if(n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise&&(n._peoplePickerSearchPromise.cancel(),n._peoplePickerSearchPromise=void 0),!(e=e.trim())&&!n._canCallGraph)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._getPeoplePickerQueryParams(),a=null==t?void 0:t.conversationId;t&&t.conversationId&&delete t.conversationId;var i="peoplePickerSearch_".concat(e.trim(),"_").concat(JSON.stringify(t));t&&a&&(t.conversationId=a);var r=function(){var a=n._dataProvider.search(e.trim(),t);if(!a)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var i=a.cached?a.cached:[];return n._peoplePickerSearchPromise=a.promise,n._peoplePickerSearchPromise.then(function(e){return n._peoplePickerSearchPromise=void 0,e?i.concat(e):[]}).then(function(t){var a=b?t:n._dedupeSuggestions(t);return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(a,e):a})};if(!n.props.peoplePickerImprovementsExperiment||!n.props.persistCachePeopleSearch)return r().then(function(e){return n._callRumOneLoggerFromProps(),e});try{return n.props.persistCachePeopleSearch({getData:r,key:i}).then(function(e){var t=!isNaN(e.cacheStats.lastModified);return n._callRumOneLoggerFromProps(t),e.data})}catch(e){return r().then(function(e){return n._callRumOneLoggerFromProps(),e})}},n._callRumOneLoggerFromProps=function(e){void 0===e&&(e=!1),n.props.writeUserInputDataToRumoneLogger&&n.props.writeUserInputDataToRumoneLogger(e)},n._onGetMoreResults=function(e){var t;return n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked(),n.props.peoplePickerQueryParams&&((t=Object(a.__assign)({},n.props.peoplePickerQueryParams)).useGraph=!1,t.useSubstrate=!1),n._dataProvider&&n._dataProvider.sharePointSearch&&t?n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var a=n.props.onResolvedSuggestions(t,e);if(a instanceof Array)return a}return t}):[]},t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new l.e({pageContext:t.context,peoplePickerDataSource:t.dataSource})}return n._canCallGraph=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams)),n._handleGetMoreResultsInBaseClass=n._canCallGraph&&!n.props.onGetMoreResults,n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)},n}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.onRenderItem,o=t.onRenderSuggestionsItem,s=t.defaultSelectedItems,c=t.onSelectedPersonasChange,d=t.suggestionsHeaderText,l=t.suggestionsClassName,u=t.noResultsFoundText,m=t.loadingText,h=t.inputProps,b=t.onSuggestionSelected,y=t.suggestionsAvailableAlertText,S=t.enableSelectedSuggestionAlert,D=t.selectedItems,I=t.itemLimit,x=t.onInputChange,C=t.onGetMoreResults,O=t.searchForMoreIcon,w=t.searchForMoreText,E=t.ariaLabel,A=void 0===E?"":E,L=t.pickerCalloutProps,k=t.pickerOverrideStyles,M=t.theme,P=t.disabled,T=t.onGetMoreResultsClicked,U=t.removeButtonAriaLabel,F=t.onEmptyResolveSuggestions,H=t.showDefaultSuggestion,R=t.customizeSuggestionPersonaProps;this._onGetMoreResultsClicked=T;var N={className:n,onRenderSuggestionsItem:o||function(e){return Object(f.n)(e,R)},onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:s,selectedItems:D,onChange:c,inputProps:h,enableSelectedSuggestionAlert:S,pickerSuggestionsProps:{suggestionsHeaderText:d,loadingText:m,noResultsFoundText:u,className:l,suggestionsAvailableAlertText:y,searchForMoreIcon:O,searchForMoreText:w||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:_.t},onItemSelected:b,itemLimit:I,onInputChange:x,onGetMoreResults:C||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:L,styles:k,theme:M,"aria-label":A,disabled:P,removeButtonAriaLabel:U,onEmptyResolveSuggestions:H&&this._canCallGraph?function(){return e.props.initRumone&&e.props.initRumone("",!0),e._onResolveSuggestions("")}:F};return this.props.peoplePickerType===p.e.listBelow?(N.onRenderItem=r||f.e,i.createElement(v,Object(a.__assign)({},N,{componentRef:this._resolveRef("_peoplePicker")}))):(N.onRenderItem=r||f.t,i.createElement(g,Object(a.__assign)({},N,{componentRef:this._resolveRef("_peoplePicker")})))},t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()},t.prototype._getPeoplePickerQueryParams=function(){return this.props.peoplePickerQueryParams?(!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults),this.props.peoplePickerQueryParams):{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:u.e.user|u.e.securityGroup|u.e.sharePointGroup}},t.prototype._dedupeSuggestions=function(e){var t=this,n=[],i=this._peoplePicker&&this._peoplePicker.items||[];i=Object(a.__spreadArray)([],i,!0);for(var r=function(e){var a=o._getItemKey(e);i.some(function(e){var n=t._getItemKey(e);return a===n})||(n.push(e),i.push(e))},o=this,s=0,c=e;s<c.length;s++)r(c[s]);return n},t.prototype._getItemKey=function(e){return e.email||e.userId||Object(h.e)(JSON.stringify(e)).toString()},t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})},t.prototype._getSearchForMoreText=function(e){return e?_.a:void 0},t}(r.e)},,,,,,,,,,function(e,t,n){"use strict";function a(e,t){for(var n=[],a=0,i=t;a<i.length;a++){var r=e[i[a]];r&&n.push(r)}return n}n.d(t,"e",function(){return a})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return M});var a,i=n(0),r=n(1857),o=n(130),s=n(256),c="undefined"==typeof window?self:window,d=n(47);!function(e){e.success="success",e.error="error"}(a||(a={}));var l="app",u="app_lastRead",f="ODSP_DB",p="ODSP_DB_TABLE",m="lastModified",_="lastRead",h="ODSP_DB_METADATA_TABLE",b="database_metadata",g="parentKey",v="reads",y=(new o.e).isFirefox,S="indexedDB is not supported",D=function(){function e(t){if(!("indexedDB"in c)||!c.indexedDB)throw new Error(S);this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,r,o,s=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=i.sent(),i.label=2;case 2:return a=r._db=o,[2,new Promise(function(e,i){var r=a.transaction([p],"readwrite").objectStore(p).index(u).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return[2,this._readInternal(p,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a,r,o,s,c,d,l,u,f,m,_,h,b=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n={},r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=i.sent(),i.label=2;case 2:return a=r._db=o,s=a.transaction([p],"readonly"),c=s.objectStore(p),d=[],l=t.index,u=t.range,f=t.direction,m=t.count,_=c.index(l),(h=_.openKeyCursor(u,f)).onerror=function(e){b._errorHandling(e,n.reject)},h.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=m?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t;return Object(i.__generator)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:p,key:t,row:Object(i.__assign)(Object(i.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:p,key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(p,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=y?indexedDB.open(f,{version:4,storage:"temporary"}):indexedDB.open(f,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(p,{keyPath:"key"})).createIndex(m,m,{unique:!1}),a.createIndex(v,v,{unique:!1}),t.createObjectStore(h,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(p)).createIndex(l,l,{unique:!1}),a.createIndex(_,_,{unique:!1}),a.createIndex(u,[l,_],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(p)).createIndex("app_lastModified",[l,m],{unique:!1}),a.createIndex("app_reads",[l,v],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(p)).createIndex(g,g,{unique:!1}),a.createIndex("parentKey_app",[g,l],{unique:!1}),a.createIndex("parentKey_app_lastModified",[g,l,m],{unique:!1}),a.createIndex("parentKey_app_lastRead",[g,l,_],{unique:!1}),a.createIndex("parentKey_app_reads",[g,l,v],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(h,function(e){return e.get(b)}).then(function(t){if(t)return t.data;var n={id:s.generate(),created:Date.now(),cacheType:r.e.indexedDB};return e._writeInternal({tableName:h,key:b,row:{key:b,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,r,o,s=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=i.sent(),i.label=2;case 2:return a=r._db=o,[2,new Promise(function(e,i){var r=s._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),c=a.transaction([t],"readonly").objectStore(t),l=n(c);l.onsuccess=function(t){r({resultType:d.e.Success,extraData:{io:Math.round(Date.now()-o)}}),e(l.result)},l.onerror=function(e){r({resultType:d.e.Failure,extraData:{io:Math.round(Date.now()-o)}}),s._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,r,o,s,c=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=i.sent(),i.label=2;case 2:return a=r._db=o,s=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(s.push(n(a.value)),a.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a,r,o,s,c,d=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n=t.tableName,a=t.key,r=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=i.sent(),i.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var i=o.transaction([n],"readwrite"),s=i.objectStore(n);i.oncomplete=function(){},i.onerror=function(e){d._errorHandling(e,t)};var c=r?s.put(r):s.delete(a);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n=this;return Object(i.__generator)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:g,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:p,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===a.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),I="PersistentCache",x="PersistentCache_metadata",C=function(){function e(){try{if("localStorage"in c&&c.localStorage&&(this._localStorage=c.localStorage,!this._localStorage.getItem(x))){var e={id:s.generate(),created:Date.now(),cacheType:r.e.localStorage};this._localStorage.setItem(x,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(i.__assign)(Object(i.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(I)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(x)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(I,"_").concat(e)},e}(),O=0,w=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var r={execute:function(){return Object(i.__awaiter)(n,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),r.error=e,[3,4];case 3:return this._completeTask(r),[7];case 4:return[2]}})})},schedule:0,id:O++,key:e,signal:a};return r},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=c.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function E(){return c.performance&&performance.now?Math.round(performance.now()):Date.now()}var A="_odspcache_",L="_____",k={cacheType:r.e.indexedDB},M=function(){function e(e){var t=e.cacheType,n=void 0===t?k.cacheType:t,a=Object(i.__rest)(e,["cacheType"]);if(this._config=Object(i.__assign)(Object(i.__assign)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new w,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a,r,o,s,c,l,u,f,p,m,_,h,b,g,v,y,S,D,I;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=this._logQos({name:"PersistentCache.read"}),s=E(),c=Date.now(),i.label=1;case 1:return i.trys.push([1,12,,13]),u=this._getCacheKey(t),f=!1,p={lastModified:NaN,lastRead:c,reads:1},m=void 0,u?(_=E(),[4,this._storage.read(u)]):[3,11];case 2:return l=i.sent(),o=Math.round(E()-_),l?(h=l.data,p={lastModified:l.lastModified,lastRead:c,reads:l.reads+1},(a=e._buffer[u])&&a.cacheStats.lastModified===l.lastModified?(a.app=l.app||this._app,a.key={original:t,encoded:l.key||u},a.cacheStats.lastRead=c,a.cacheStats.reads++,a.performance={total:Math.round(E()-s)},[3,11]):[3,3]):[3,11];case 3:if(a=void 0,void 0===h)return[3,11];if(!this._dataIsEncrypted)return[3,10];b=h,g=this._cacheSecret,v=g.CurrentKey.Key,y=g.PreviousKey.Key,S=E(),i.label=4;case 4:return i.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:v})];case 5:return m=i.sent(),[3,9];case 6:return(D=i.sent())&&D.message&&D.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:y})]:[3,8];case 7:m=i.sent(),f=void 0!==m,n({resultType:d.e.ExpectedFailure,error:D.message,extraData:{cacheResult:"hit"}}),i.label=8;case 8:return[3,9];case 9:return r=Math.round(E()-S),[3,11];case 10:m=h,i.label=11;case 11:return a=a||{key:{original:t,encoded:l&&l.key||u},app:l&&l.app||this._app,data:m,cacheStats:p,cacheType:this._cacheType,performance:{crypto:r,io:o,total:Math.round(E()-s)}},e._buffer[u]=a,f&&this.update(t,m),[3,13];case 12:throw I=i.sent(),n({resultType:d.e.Failure,error:I.message?I.message:I.toString(),extraData:{cacheResult:"miss"}}),I;case 13:return n({resultType:d.e.Success,extraData:{cacheResult:"".concat(void 0!==a.data?"hit":"miss")}}),[2,Promise.resolve(a)]}})})},e.prototype.rangeQuery=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,a,o,s,c,l,u=this;return Object(i.__generator)(this,function(i){if(this._cacheType!==r.e.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=E(),o=Date.now(),c={lastModified:NaN,lastRead:o,reads:1};try{l=E(),s=this._storage.rangeQuery(e).then(function(e){return n=Math.round(E()-l),{key:void 0,app:void 0,data:e.map(function(e){return{original:u._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:c,cacheType:u._cacheType,performance:{io:n,total:Math.round(E()-a)}}})}catch(e){throw t({resultType:d.e.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:d.e.Success}),[2,s||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:c,cacheType:this._cacheType,performance:{io:n,total:Math.round(E()-a)}})]})})},e.prototype.update=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,function(){return a._doCacheUpdate(e,t)}).signal.promise];case 1:return i.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a,o,s,c,l,u=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=E(),a=Date.now(),o=this._logQos({name:"PersistentCache.readAndUpdate"}),s=t().then(function(t){var i={app:u._app,key:{original:e,encoded:u._getCacheKey(e)},data:t,cacheType:r.e.none,cacheStats:{lastModified:void 0,lastRead:a,reads:1},performance:{total:Math.round(E()-n)}};return u.update(e,t),i}),i.label=1;case 1:i.trys.push([1,8,,9]),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,Promise.race([this.read(e),s])];case 3:return c=i.sent(),[3,5];case 4:return i.sent(),[3,5];case 5:return!c||c.cacheType!==r.e.none&&void 0===c.data?[4,s]:[3,7];case 6:c=i.sent(),i.label=7;case 7:return[3,9];case 8:throw l=i.sent(),o({resultType:d.e.Failure,error:l.message?l.message:l.toString()}),l;case 9:return o({resultType:d.e.Success}),[2,c]}})})},e.prototype._initLocalStorage=function(e){switch(e){case r.e.localStorage:this._storage=new C;break;case r.e.indexedDB:default:try{this._storage=new D(this._logQos.bind(this))}catch(e){e.message===S&&(this._storage=new C,this._cacheType=r.e.localStorage)}}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?L+e.user:""));return"".concat(A).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(A,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(L)>=0){var i=a.split(L);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._doCacheUpdate=function(t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,o,s,c,l,u,f;return Object(i.__generator)(this,function(p){switch(p.label){case 0:a=this._logQos({name:"PersistentCache.update"}),p.label=1;case 1:return p.trys.push([1,9,,10]),o=this._getCacheKey(t),void 0===n?[3,6]:((s=e._buffer[o]=Object(i.__assign)(Object(i.__assign)({},e._buffer[o]),{data:n,cacheType:this._cacheType})).cacheStats||(s.cacheStats={lastModified:NaN,lastRead:E(),reads:1}),c=n,l=NaN,this._dataIsEncrypted?(u=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:u,data:n,doSerialize:this._cacheType===r.e.localStorage})]):[3,3]);case 2:return c=p.sent(),l=c.cipherText?c.cipherText.byteLength:0,[3,4];case 3:try{l="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}p.label=4;case 4:return[4,this._storage.write({app:this._app,key:o,data:c,lastRead:s.cacheStats.lastRead,parentKey:t.parentKey,reads:s.cacheStats.reads,size:l})];case 5:return p.sent(),[3,8];case 6:return delete e._buffer[o],[4,this._storage.write({key:o,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:p.sent(),p.label=8;case 8:return[3,10];case 9:throw f=p.sent(),a({resultType:d.e.Failure,error:f.message?f.message:f.toString()}),f;case 10:return a({resultType:d.e.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(i.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(i.__awaiter)(e,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return X});var a=n(1526),i=n(0),r=n(1),o=n(809),s=n(1452),c=n(1158),d=n(51),l=n(208),u=n(112),f=n(121),p=n(1104),m=n(587),_=n(109),h=n(1759),b=n(1755),g=n(1756),v=n(1312),y=n(129),S=n(2170),D=n(2225),I=function(){function e(){this._size=0}return e.prototype.updateOptions=function(e){for(var t=[],n=[],a=0,r=0;r<e.length;r++){var o=e[r],s=o.itemType,c=o.hidden;s===D.e.Divider||s===D.e.Header?(t.push(r),n.push(r)):c?n.push(r):a++}this._size=a,this._displayOnlyOptionsCache=t,this._notSelectableOptionsCache=n,this._cachedOptions=Object(i.__spreadArray)([],e)},Object.defineProperty(e.prototype,"optionSetSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedOptions",{get:function(){return this._cachedOptions},enumerable:!1,configurable:!0}),e.prototype.positionInSet=function(e){if(void 0!==e){for(var t=0;e>this._notSelectableOptionsCache[t];)t++;if(this._displayOnlyOptionsCache[t]===e)throw new Error("Unexpected: Option at index "+e+" is not a selectable element.");if(this._notSelectableOptionsCache[t]!==e)return e-t+1}},e}(),x=n(1750),C=n(345),O=n(476),w=n(1927),E=n(2233),A=n(1758),L=n(342),k=n(2291),M=n(2125),P=n(1601),T=n(1583),U=n(1600),F=Object(o.e)(),H={options:[]},R=r.forwardRef(function(e,t){var n=Object(P.e)(H,e),a=r.useRef(null),o=Object(U.e)(t,a),c=Object(A.e)(a,n.responsiveMode),d=function(e){var t,n=e.defaultSelectedKeys,a=e.selectedKeys,i=e.defaultSelectedKey,o=e.selectedKey,c=e.options,d=e.multiSelect,l=Object(T.e)(c),u=r.useState([]),f=u[0],p=u[1],m=c!==l;t=d?m&&void 0!==n?n:a:m&&void 0!==i?i:o;var _=Object(T.e)(t);return r.useEffect(function(){var e=function(e){return Object(s.a)(c,function(t){return null!=e?t.key===e:!!t.selected||!!t.isSelected})};void 0===t&&l||t===_&&!m||p(function(){if(void 0===t)return d?c.map(function(e,t){return e.selected?t:-1}).filter(function(e){return-1!==e}):-1!==(r=e(null))?[r]:[];if(!Array.isArray(t))return-1!==(r=e(t))?[r]:[];for(var n=[],a=0,i=t;a<i.length;a++){var r,o=i[a];-1!==(r=e(o))&&n.push(r)}return n}())},[m,d,l,_,c,t]),[f,p]}(n),l=d[0],u=d[1];return r.createElement(V,Object(i.__assign)({},n,{responsiveMode:c,hoisted:{rootRef:o,selectedIndices:l,setSelectedIndices:u}}))});R.displayName="DropdownBase";var N,B,j,V=function(e){function t(t){var n,a,o=e.call(this,t)||this;o._host=r.createRef(),o._focusZone=r.createRef(),o._dropDown=r.createRef(),o._scrollIdleDelay=250,o._sizePosCache=new I,o._requestAnimationFrame=(n=o,function(e){a||(a=new Set,Object(c.e)(n,{componentWillUnmount:function(){a.forEach(function(e){return cancelAnimationFrame(e)})}}));var t=requestAnimationFrame(function(){a.delete(t),e()});a.add(t)}),o.dismissMenu=function(){o.state.isOpen&&o.setState({isOpen:!1})},o._onChange=function(e,t,n,a,r){var s=o.props,c=s.onChange,d=s.onChanged;if(c||d){var l=r?Object(i.__assign)(Object(i.__assign)({},t[n]),{selected:!a}):t[n];c&&c(Object(i.__assign)(Object(i.__assign)({},e),{target:o._dropDown.current}),l,n),d&&d(l,n)}},o._getPlaceholder=function(){return o.props.placeholder||o.props.placeHolder},o._getTitle=function(e,t){var n=o.props.multiSelectDelimiter,a=void 0===n?", ":n;return e.map(function(e){return e.text}).join(a)},o._onRenderTitle=function(e){return r.createElement(r.Fragment,null,o._getTitle(e))},o._onRenderPlaceholder=function(e){return o._getPlaceholder()?r.createElement(r.Fragment,null,o._getPlaceholder()):null},o._onRenderContainer=function(e){var t=e.calloutProps,n=e.panelProps,a=o.props,s=a.responsiveMode,c=a.dropdownWidth,d=s<=L.e.medium,l={firstFocusableTarget:"#"+o._listId+"1"},u=o._classNames.subComponentStyles?o._classNames.subComponentStyles.panel:void 0,f=void 0,p=void 0;return"auto"===c?p=o._dropDown.current?o._dropDown.current.clientWidth:0:f=c||(o._dropDown.current?o._dropDown.current.clientWidth:0),d?r.createElement(E.e,Object(i.__assign)({closeButtonAriaLabel:"Close",focusTrapZoneProps:l,hasCloseButton:!0,isOpen:!0,isLightDismiss:!0,onDismiss:o._onDismiss,styles:u},n),o._renderFocusableList(e)):r.createElement(v.e,Object(i.__assign)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHintFixed:!1,directionalHint:y.e.bottomLeftEdge,calloutWidth:f,calloutMinWidth:p},t,{className:o._classNames.callout,target:o._dropDown.current,onDismiss:o._onDismiss,onScroll:o._onScroll,onPositioned:o._onPositioned}),o._renderFocusableList(e))},o._onRenderCaretDown=function(e){return r.createElement(O.e,{className:o._classNames.caretDown,iconName:"ChevronDown","aria-hidden":!0})},o._onRenderList=function(e){var t=e.onRenderItem,n=void 0===t?o._onRenderItem:t,a={items:[]},s=[],c=function(){var e=a.id?[r.createElement("div",{role:"group",key:a.id,"aria-labelledby":a.id},a.items)]:a.items;s=Object(i.__spreadArray)(Object(i.__spreadArray)([],s),e),a={items:[]}};return e.options.forEach(function(e,t){!function(e,t){switch(e.itemType){case D.e.Header:a.items.length>0&&c();var r=o._id+e.key;a.items.push(n(Object(i.__assign)(Object(i.__assign)({id:r},e),{index:t}),o._onRenderItem)),a.id=r;break;case D.e.Divider:t>0&&a.items.push(n(Object(i.__assign)(Object(i.__assign)({},e),{index:t}),o._onRenderItem)),a.items.length>0&&c();break;default:a.items.push(n(Object(i.__assign)(Object(i.__assign)({},e),{index:t}),o._onRenderItem))}}(e,t)}),a.items.length>0&&c(),r.createElement(r.Fragment,null,s)},o._onRenderItem=function(e){switch(e.itemType){case D.e.Divider:return o._renderSeparator(e);case D.e.Header:return o._renderHeader(e);default:return o._renderOption(e)}},o._renderOption=function(e){var t=o.props,n=t.onRenderOption,a=void 0===n?o._onRenderOption:n,s=t.hoisted.selectedIndices,c=void 0===s?[]:s,l=!(void 0===e.index||!c)&&c.indexOf(e.index)>-1,u=e.hidden?o._classNames.dropdownItemHidden:l&&!0===e.disabled?o._classNames.dropdownItemSelectedAndDisabled:l?o._classNames.dropdownItemSelected:!0===e.disabled?o._classNames.dropdownItemDisabled:o._classNames.dropdownItem,f=e.title,p=o._classNames.subComponentStyles?o._classNames.subComponentStyles.multiSelectItem:void 0;return o.props.multiSelect?r.createElement(M.e,{id:o._listId+e.index,key:e.key,disabled:e.disabled,onChange:o._onItemClick(e),inputProps:Object(i.__assign)({"aria-selected":l,onMouseEnter:o._onItemMouseEnter.bind(o,e),onMouseLeave:o._onMouseItemLeave.bind(o,e),onMouseMove:o._onItemMouseMove.bind(o,e),role:"option"},{"data-index":e.index,"data-is-focusable":!(e.disabled||e.hidden)}),label:e.text,title:f,onRenderLabel:o._onRenderItemLabel.bind(o,e),className:Object(d.e)(u,"is-multi-select"),checked:l,styles:p,ariaPositionInSet:e.hidden?void 0:o._sizePosCache.positionInSet(e.index),ariaSetSize:e.hidden?void 0:o._sizePosCache.optionSetSize,ariaLabel:e.ariaLabel}):r.createElement(S.e,{id:o._listId+e.index,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,className:u,onClick:o._onItemClick(e),onMouseEnter:o._onItemMouseEnter.bind(o,e),onMouseLeave:o._onMouseItemLeave.bind(o,e),onMouseMove:o._onItemMouseMove.bind(o,e),role:"option","aria-selected":l?"true":"false",ariaLabel:e.ariaLabel,title:f,"aria-posinset":o._sizePosCache.positionInSet(e.index),"aria-setsize":o._sizePosCache.optionSetSize},a(e,o._onRenderOption))},o._onRenderOption=function(e){return r.createElement("span",{className:o._classNames.dropdownOptionText},e.text)},o._onRenderItemLabel=function(e){var t=o.props.onRenderOption;return(void 0===t?o._onRenderOption:t)(e,o._onRenderOption)},o._onPositioned=function(e){o._focusZone.current&&o._requestAnimationFrame(function(){var e=o.props.hoisted.selectedIndices;if(o._focusZone.current)if(!o._hasBeenPositioned&&e&&e[0]&&!o.props.options[e[0]].disabled){var t=Object(l.e)().getElementById(o._id+"-list"+e[0]);t&&o._focusZone.current.focusElement(t),o._hasBeenPositioned=!0}else o._focusZone.current.focus()}),o.state.calloutRenderEdge&&o.state.calloutRenderEdge===e.targetEdge||o.setState({calloutRenderEdge:e.targetEdge})},o._onItemClick=function(e){return function(t){e.disabled||(o.setSelectedIndex(t,e.index),o.props.multiSelect||o.setState({isOpen:!1}))}},o._onScroll=function(){o._isScrollIdle||void 0===o._scrollIdleTimeoutId?o._isScrollIdle=!1:(clearTimeout(o._scrollIdleTimeoutId),o._scrollIdleTimeoutId=void 0),o._scrollIdleTimeoutId=window.setTimeout(function(){o._isScrollIdle=!0},o._scrollIdleDelay)},o._onMouseItemLeave=function(e,t){if(!o._shouldIgnoreMouseEvent()&&o._host.current)if(o._host.current.setActive)try{o._host.current.setActive()}catch(e){}else o._host.current.focus()},o._onDismiss=function(){o.setState({isOpen:!1})},o._onDropdownBlur=function(e){o._isDisabled()||o.state.isOpen||(o.setState({hasFocus:!1}),o.props.onBlur&&o.props.onBlur(e))},o._onDropdownKeyDown=function(e){if(!o._isDisabled()&&(o._lastKeyDownWasAltOrMeta=o._isAltOrMeta(e),!o.props.onKeyDown||(o.props.onKeyDown(e),!e.defaultPrevented))){var t,n=o.props.hoisted.selectedIndices.length?o.props.hoisted.selectedIndices[0]:-1,a=e.altKey||e.metaKey,i=o.state.isOpen;switch(e.which){case u.e.enter:o.setState({isOpen:!i});break;case u.e.escape:if(!i)return;o.setState({isOpen:!1});break;case u.e.up:if(a){if(i){o.setState({isOpen:!1});break}return}o.props.multiSelect?o.setState({isOpen:!0}):o._isDisabled()||(t=o._moveIndex(e,-1,n-1,n));break;case u.e.down:a&&(e.stopPropagation(),e.preventDefault()),a&&!i||o.props.multiSelect?o.setState({isOpen:!0}):o._isDisabled()||(t=o._moveIndex(e,1,n+1,n));break;case u.e.home:o.props.multiSelect||(t=o._moveIndex(e,1,0,n));break;case u.e.end:o.props.multiSelect||(t=o._moveIndex(e,-1,o.props.options.length-1,n));break;case u.e.space:break;default:return}t!==n&&(e.stopPropagation(),e.preventDefault())}},o._onDropdownKeyUp=function(e){if(!o._isDisabled()){var t=o._shouldHandleKeyUp(e),n=o.state.isOpen;o.props.onKeyUp&&(o.props.onKeyUp(e),e.defaultPrevented)||(e.which===u.e.space?(o.setState({isOpen:!n}),e.stopPropagation(),e.preventDefault()):t&&n&&o.setState({isOpen:!1}))}},o._onZoneKeyDown=function(e){var t,n,a;o._lastKeyDownWasAltOrMeta=o._isAltOrMeta(e);var i=e.altKey||e.metaKey;switch(e.which){case u.e.up:i?o.setState({isOpen:!1}):o._host.current&&(a=Object(f.s)(o._host.current,o._host.current.lastChild,!0));break;case u.e.home:case u.e.end:case u.e.pageUp:case u.e.pageDown:break;case u.e.down:!i&&o._host.current&&(a=Object(f.i)(o._host.current,o._host.current.firstChild,!0));break;case u.e.escape:o.setState({isOpen:!1});break;case u.e.tab:o.setState({isOpen:!1});var r=Object(l.e)();r&&(e.shiftKey?null===(t=Object(f.l)(r.body,o._dropDown.current,!1,!1,!0,!0))||void 0===t||t.focus():null===(n=Object(f.d)(r.body,o._dropDown.current,!1,!1,!0,!0))||void 0===n||n.focus());break;default:return}a&&a.focus(),e.stopPropagation(),e.preventDefault()},o._onZoneKeyUp=function(e){o._shouldHandleKeyUp(e)&&o.state.isOpen&&(o.setState({isOpen:!1}),e.preventDefault())},o._onDropdownClick=function(e){if(!o.props.onClick||(o.props.onClick(e),!e.defaultPrevented)){var t=o.state.isOpen;o._isDisabled()||o._shouldOpenOnFocus()||o.setState({isOpen:!t}),o._isFocusedByClick=!1}},o._onDropdownMouseDown=function(){o._isFocusedByClick=!0},o._onFocus=function(e){if(!o._isDisabled()){o.props.onFocus&&o.props.onFocus(e);var t={hasFocus:!0};o._shouldOpenOnFocus()&&(t.isOpen=!0),o.setState(t)}},o._isDisabled=function(){var e=o.props.disabled,t=o.props.isDisabled;return void 0===e&&(e=t),e},o._onRenderLabel=function(e){var t=e.label,n=e.required,a=e.disabled,i=o._classNames.subComponentStyles?o._classNames.subComponentStyles.label:void 0;return t?r.createElement(w.e,{className:o._classNames.label,id:o._labelId,required:n,styles:i,disabled:a},t):null},Object(p.e)(o),t.multiSelect,t.selectedKey,t.selectedKeys,t.defaultSelectedKey,t.defaultSelectedKeys;var s=t.options;return o._id=t.id||Object(m.e)("Dropdown"),o._labelId=o._id+"-label",o._listId=o._id+"-list",o._optionId=o._id+"-option",o._isScrollIdle=!0,o._hasBeenPositioned=!1,o._sizePosCache.updateOptions(s),o.state={isOpen:!1,hasFocus:!1,calloutRenderEdge:void 0},o}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.props,t=e.options,n=e.hoisted.selectedIndices;return Object(k.e)(t,n)},enumerable:!1,configurable:!0}),t.prototype.componentWillUnmount=function(){clearTimeout(this._scrollIdleTimeoutId)},t.prototype.componentDidUpdate=function(e,t){!0===t.isOpen&&!1===this.state.isOpen&&(this._gotMouseMove=!1,this._hasBeenPositioned=!1,this.props.onDismiss&&this.props.onDismiss())},t.prototype.render=function(){var e=this._id,t=this.props,n=t.className,a=t.label,o=t.options,s=t.ariaLabel,c=t.required,d=t.errorMessage,l=t.styles,u=t.theme,f=t.panelProps,p=t.calloutProps,m=t.onRenderTitle,b=void 0===m?this._getTitle:m,g=t.onRenderContainer,v=void 0===g?this._onRenderContainer:g,y=t.onRenderCaretDown,S=void 0===y?this._onRenderCaretDown:y,D=t.onRenderLabel,I=void 0===D?this._onRenderLabel:D,x=t.onRenderItem,C=void 0===x?this._onRenderItem:x,O=t.hoisted.selectedIndices,w=this.state,E=w.isOpen,A=w.calloutRenderEdge,L=w.hasFocus,M=t.onRenderPlaceholder||t.onRenderPlaceHolder||this._getPlaceholder;o!==this._sizePosCache.cachedOptions&&this._sizePosCache.updateOptions(o);var P=Object(k.e)(o,O),T=Object(_.s)(t,_.r),U=this._isDisabled(),H=e+"-errorMessage";this._classNames=F(l,{theme:u,className:n,hasError:!!(d&&d.length>0),hasLabel:!!a,isOpen:E,required:c,disabled:U,isRenderingPlaceholder:!P.length,panelClassName:f?f.className:void 0,calloutClassName:p?p.className:void 0,calloutRenderEdge:A});var R=!!d&&d.length>0;return r.createElement("div",{className:this._classNames.root,ref:this.props.hoisted.rootRef,"aria-owns":E?this._listId:void 0},I(this.props,this._onRenderLabel),r.createElement("div",Object(i.__assign)({"data-is-focusable":!U,"data-ktp-target":!0,ref:this._dropDown,id:e,tabIndex:U?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":E?"true":"false","aria-label":s,"aria-labelledby":a&&!s?Object(h.e)(this._labelId,this._optionId):void 0,"aria-describedby":R?this._id+"-errorMessage":void 0,"aria-required":c,"aria-disabled":U,"aria-controls":E?this._listId:void 0},T,{className:this._classNames.dropdown,onBlur:this._onDropdownBlur,onKeyDown:this._onDropdownKeyDown,onKeyUp:this._onDropdownKeyUp,onClick:this._onDropdownClick,onMouseDown:this._onDropdownMouseDown,onFocus:this._onFocus}),r.createElement("span",{id:this._optionId,className:this._classNames.title,"aria-live":L?"polite":void 0,"aria-atomic":!!L||void 0,"aria-invalid":R},P.length?b(P,this._onRenderTitle):M(t,this._onRenderPlaceholder)),r.createElement("span",{className:this._classNames.caretDownWrapper},S(t,this._onRenderCaretDown))),E&&v(Object(i.__assign)(Object(i.__assign)({},t),{onDismiss:this._onDismiss,onRenderItem:C}),this._onRenderContainer),R&&r.createElement("div",{role:"alert",id:H,className:this._classNames.errorMessage},d))},t.prototype.focus=function(e){this._dropDown.current&&(this._dropDown.current.focus(),e&&this.setState({isOpen:!0}))},t.prototype.setSelectedIndex=function(e,t){var n=this.props,a=n.options,i=n.selectedKey,r=n.selectedKeys,o=n.multiSelect,s=n.notifyOnReselect,c=n.hoisted.selectedIndices,d=void 0===c?[]:c,l=!!d&&d.indexOf(t)>-1,u=[];if(t=Math.max(0,Math.min(a.length-1,t)),void 0===i&&void 0===r){if(o||s||t!==d[0]){if(o)if(u=d?this._copyArray(d):[],l){var f=u.indexOf(t);f>-1&&u.splice(f,1)}else u.push(t);else u=[t];e.persist(),this.props.hoisted.setSelectedIndices(u),this._onChange(e,a,t,l,o)}}else this._onChange(e,a,t,l,o)},t.prototype._copyArray=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];t.push(i)}return t},t.prototype._moveIndex=function(e,t,n,a){var i=this.props.options;if(a===n||0===i.length)return a;n>=i.length?n=0:n<0&&(n=i.length-1);for(var r=0;i[n].itemType===D.e.Header||i[n].itemType===D.e.Divider||i[n].disabled;){if(r>=i.length)return a;n+t<0?n=i.length:n+t>=i.length&&(n=-1),n+=t,r++}return this.setSelectedIndex(e,n),n},t.prototype._renderFocusableList=function(e){var t=e.onRenderList,n=void 0===t?this._onRenderList:t,a=e.label,i=e.ariaLabel,o=e.multiSelect;return r.createElement("div",{className:this._classNames.dropdownItemsWrapper,onKeyDown:this._onZoneKeyDown,onKeyUp:this._onZoneKeyUp,ref:this._host,tabIndex:0},r.createElement(x.e,{ref:this._focusZone,direction:C.e.vertical,id:this._listId,className:this._classNames.dropdownItems,role:"listbox","aria-label":i,"aria-labelledby":a&&!i?this._labelId:void 0,"aria-multiselectable":o},n(e,this._onRenderList)))},t.prototype._renderSeparator=function(e){var t=e.index,n=e.key,a=e.hidden?this._classNames.dropdownDividerHidden:this._classNames.dropdownDivider;return t>0?r.createElement("div",{role:"separator",key:n,className:a}):null},t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,n=void 0===t?this._onRenderOption:t,a=e.key,i=e.id,o=e.hidden?this._classNames.dropdownItemHeaderHidden:this._classNames.dropdownItemHeader;return r.createElement("div",{id:i,key:a,className:o},n(e,this._onRenderOption))},t.prototype._onItemMouseEnter=function(e,t){this._shouldIgnoreMouseEvent()||t.currentTarget.focus()},t.prototype._onItemMouseMove=function(e,t){var n=t.currentTarget;this._gotMouseMove=!0,this._isScrollIdle&&document.activeElement!==n&&n.focus()},t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},t.prototype._isAltOrMeta=function(e){return e.which===u.e.alt||"Meta"===e.key},t.prototype._shouldHandleKeyUp=function(e){var t=this._lastKeyDownWasAltOrMeta&&this._isAltOrMeta(e);return this._lastKeyDownWasAltOrMeta=!1,!!t&&!(Object(b.e)()||Object(g.e)())},t.prototype._shouldOpenOnFocus=function(){var e=this.state.hasFocus,t=this.props.openOnKeyboardFocus;return!this._isFocusedByClick&&!0===t&&!e},t.defaultProps={options:[]},t}(r.Component),z=n(525),G=n(82),K=n(21),W={root:"ms-Dropdown-container",label:"ms-Dropdown-label",dropdown:"ms-Dropdown",title:"ms-Dropdown-title",caretDownWrapper:"ms-Dropdown-caretDownWrapper",caretDown:"ms-Dropdown-caretDown",callout:"ms-Dropdown-callout",panel:"ms-Dropdown-panel",dropdownItems:"ms-Dropdown-items",dropdownItem:"ms-Dropdown-item",dropdownDivider:"ms-Dropdown-divider",dropdownOptionText:"ms-Dropdown-optionText",dropdownItemHeader:"ms-Dropdown-header",titleIsPlaceHolder:"ms-Dropdown-titleIsPlaceHolder",titleHasError:"ms-Dropdown-title--hasError"},q=((N={})[K.o+", "+K.s.replace("@media ","")]=Object(i.__assign)({},Object(K.x)()),N),Q={selectors:Object(i.__assign)((B={},B[K.o]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},B),q)},Y={selectors:(j={},j[K.o]={borderColor:"Highlight"},j)},J=Object(K.A)(0,K.p),X=Object(a.e)(R,function(e){var t,n,a,r,o,s,c,d,l,u,f,p,m=e.theme,_=e.hasError,h=e.hasLabel,b=e.className,g=e.isOpen,v=e.disabled,y=e.required,S=e.isRenderingPlaceholder,D=e.panelClassName,I=e.calloutClassName,x=e.calloutRenderEdge;if(!m)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var C=Object(K.I)(W,m),O=m.palette,w=m.semanticColors,E=m.effects,A=m.fonts,L={color:w.menuItemTextHovered},k={color:w.menuItemText},M={borderColor:w.errorText},P=[C.dropdownItem,{backgroundColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:"flex",alignItems:"center",padding:"0 8px",width:"100%",minHeight:36,lineHeight:20,height:0,position:"relative",border:"1px solid transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",".ms-Button-flexContainer":{width:"100%"}}],T=[C.dropdownItemHeader,Object(i.__assign)(Object(i.__assign)({},A.medium),{fontWeight:K.r.semibold,color:w.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(t={},t[K.o]=Object(i.__assign)({color:"GrayText"},Object(K.x)()),t)})],U=w.menuItemBackgroundPressed,F=function(e){var t;return void 0===e&&(e=!1),{selectors:(t={"&:hover":[{color:w.menuItemTextHovered,backgroundColor:e?U:w.menuItemBackgroundHovered},Q],"&.is-multi-select:hover":[{backgroundColor:e?U:"transparent"}],"&:active:hover":[{color:w.menuItemTextHovered,backgroundColor:e?w.menuItemBackgroundHovered:w.menuItemBackgroundPressed},Q]},t["."+z.e+" &:focus:after"]={left:0,top:0,bottom:0,right:0},t[K.o]={border:"none"},t)}},H=Object(i.__spreadArray)(Object(i.__spreadArray)([],P),[{backgroundColor:U,color:w.menuItemTextHovered},F(!0),Q]),R=Object(i.__spreadArray)(Object(i.__spreadArray)([],P),[{color:w.disabledText,cursor:"default",selectors:(n={},n[K.o]={color:"GrayText",border:"none"},n)}]),N=x===G.t.bottom?E.roundedCorner2+" "+E.roundedCorner2+" 0 0":"0 0 "+E.roundedCorner2+" "+E.roundedCorner2,B=x===G.t.bottom?"0 0 "+E.roundedCorner2+" "+E.roundedCorner2:E.roundedCorner2+" "+E.roundedCorner2+" 0 0";return{root:[C.root,b],label:C.label,dropdown:[C.dropdown,K.H,A.medium,{color:w.menuItemText,borderColor:w.focusBorder,position:"relative",outline:0,userSelect:"none",selectors:(a={},a["&:hover ."+C.title]=[!v&&L,{borderColor:g?O.neutralSecondary:O.neutralPrimary},Y],a["&:focus ."+C.title]=[!v&&L,{selectors:(r={},r[K.o]={color:"Highlight"},r)}],a["&:focus:after"]=[{pointerEvents:"none",content:"''",position:"absolute",boxSizing:"border-box",top:"0px",left:"0px",width:"100%",height:"100%",border:v?"none":"2px solid "+O.themePrimary,borderRadius:"2px",selectors:(o={},o[K.o]={color:"Highlight"},o)}],a["&:active ."+C.title]=[!v&&L,{borderColor:O.themePrimary},Y],a["&:hover ."+C.caretDown]=!v&&k,a["&:focus ."+C.caretDown]=[!v&&k,{selectors:(s={},s[K.o]={color:"Highlight"},s)}],a["&:active ."+C.caretDown]=!v&&k,a["&:hover ."+C.titleIsPlaceHolder]=!v&&k,a["&:focus ."+C.titleIsPlaceHolder]=!v&&k,a["&:active ."+C.titleIsPlaceHolder]=!v&&k,a["&:hover ."+C.titleHasError]=M,a["&:active ."+C.titleHasError]=M,a)},g&&"is-open",v&&"is-disabled",y&&"is-required",y&&!h&&{selectors:(c={":before":{content:"'*'",color:w.errorText,position:"absolute",top:-5,right:-10}},c[K.o]={selectors:{":after":{right:-14}}},c)}],title:[C.title,K.H,{backgroundColor:w.inputBackground,borderWidth:1,borderStyle:"solid",borderColor:w.inputBorder,borderRadius:g?N:E.roundedCorner2,cursor:"pointer",display:"block",height:32,lineHeight:30,padding:"0 28px 0 8px",position:"relative",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},S&&[C.titleIsPlaceHolder,{color:w.inputPlaceholderText}],_&&[C.titleHasError,M],v&&{backgroundColor:w.disabledBackground,border:"none",color:w.disabledText,cursor:"default",selectors:(d={},d[K.o]=Object(i.__assign)({border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},Object(K.x)()),d)}],caretDownWrapper:[C.caretDownWrapper,{height:32,lineHeight:30,paddingTop:1,position:"absolute",right:8,top:0},!v&&{cursor:"pointer"}],caretDown:[C.caretDown,{color:O.neutralSecondary,fontSize:A.small.fontSize,pointerEvents:"none"},v&&{color:w.disabledText,selectors:(l={},l[K.o]=Object(i.__assign)({color:"GrayText"},Object(K.x)()),l)}],errorMessage:Object(i.__assign)(Object(i.__assign)({color:w.errorText},m.fonts.small),{paddingTop:5}),callout:[C.callout,{boxShadow:E.elevation8,borderRadius:B,selectors:(u={},u[".ms-Callout-main"]={borderRadius:B},u)},I],dropdownItemsWrapper:{selectors:{"&:focus":{outline:0}}},dropdownItems:[C.dropdownItems,{display:"block"}],dropdownItem:Object(i.__spreadArray)(Object(i.__spreadArray)([],P),[F()]),dropdownItemSelected:H,dropdownItemDisabled:R,dropdownItemSelectedAndDisabled:[H,R,{backgroundColor:"transparent"}],dropdownItemHidden:Object(i.__spreadArray)(Object(i.__spreadArray)([],P),[{display:"none"}]),dropdownDivider:[C.dropdownDivider,{height:1,backgroundColor:w.bodyDivider}],dropdownDividerHidden:[C.dropdownDivider,{display:"none"}],dropdownOptionText:[C.dropdownOptionText,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:0,maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",margin:"1px"}],dropdownItemHeader:T,dropdownItemHeaderHidden:Object(i.__spreadArray)(Object(i.__spreadArray)([],T),[{display:"none"}]),subComponentStyles:{label:{root:{display:"inline-block"}},multiSelectItem:{root:{padding:0},label:{alignSelf:"stretch",padding:"0 8px",width:"100%"},input:{selectors:(f={},f["."+z.e+" &:focus + label::before"]={outlineOffset:"0px"},f)}},panel:{root:[D],main:{selectors:(p={},p[J]={width:272},p)},contentInner:{padding:"0 0 20px"}}}}},void 0,{scope:"Dropdown"});X.displayName="Dropdown"},function(e,t,n){"use strict";n.r(t),n.d(t,"PermissionsViewState",function(){return Q}),n.d(t,"PermissionsPivot",function(){return ye});var a=n(0),i=n(1),r=n(1800),o=n(1941),s=n(17);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsPivot-contentParent{height:633px;min-height:440px}.od-PermissionsPivot-contentParent.spo{position:relative}.od-PermissionsPivot-content .principalContent{margin:0 -8px}.od-PermissionPivot-resultsCount{float:right;position:inherit;font-style:italic;font-size:.75rem}.od-PermissionsPivot-footerDiv{margin-top:4px}.od-PermissionsPivot-footerDiv .ms-Spinner{position:relative;top:unset;left:-180px}[dir=ltr] .od-PermissionsPivot-pivot .ms-Pivot .ms-Button+.ms-Button{margin-left:0}[dir=rtl] .od-PermissionsPivot-pivot .ms-Pivot .ms-Button+.ms-Button{margin-right:0}.od-PermissionsPivot-DefaultView-content,.od-PrincipalDetails-content{padding:24px}.od-PermissionsPivot-header{position:relative}.od-PermissionsPivot-headerButtons{position:absolute;top:0}[dir=ltr] .od-PermissionsPivot-headerButtons{right:0}[dir=rtl] .od-PermissionsPivot-headerButtons{left:0}.od-PermissionsPivot-title{font-weight:600;font-size:1.25rem;display:inline}.od-PermissionsPivot-title.withBackButton{font-size:1rem!important}.od-PermissionsPivot-close,.od-PrincipalDetails-close{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";float:right}[dir=rtl] .od-PermissionsPivot-close,[dir=rtl] .od-PrincipalDetails-close{float:left}.od-PermissionsPivot-fileNameAndIcon,.od-PrincipalDetails-fileNameAndIcon{padding:12px 0 8px 0;font-size:.75rem;overflow:hidden;text-overflow:ellipsis}.od-PrincipalDetails-tooltipFileIcon{padding-right:6px}.od-PrincipalDetails-tooltipChevron{padding:0 10px}.od-PermissionsPivot-fileIcon,.od-PrincipalDetails-fileIcon{padding:0;vertical-align:bottom}[dir=ltr] .od-PermissionsPivot-fileIcon,[dir=ltr] .od-PrincipalDetails-fileIcon{padding-right:8px}[dir=rtl] .od-PermissionsPivot-fileIcon,[dir=rtl] .od-PrincipalDetails-fileIcon{padding-left:8px}.od-PermissionsPivot-dropdown,.od-PermissionsPivot-pivot{padding-top:12px}.od-PermissionsPivot-dropdown div[role=tablist].ms-FocusZone,.od-PermissionsPivot-pivot div[role=tablist].ms-FocusZone{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:0 24px 16px 24px;margin:0 -24px}.od-PermissionsPivot-dropdown div.od-PermissionsPivot-dropdown-container,.od-PermissionsPivot-pivot div.od-PermissionsPivot-dropdown-container{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:0 24px 16px 24px;margin:0 -24px}.od-PermissionsPivot-sharingHeaderButtons{display:flex;justify-content:space-between}.od-PermissionsPivot-sharingHeaderButtons button{height:20px;padding:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:.875rem}.od-PermissionsPivot-sharingHeaderButtons i{font-size:.875rem;margin-right:4px;margin-left:0}.od-PermissionsPivot-resolvedLink{border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}div.od-PermissionsPivot-search{padding:12px 0;height:auto;margin:0 8px}.od-PermissionsPivot-searchResultsCount{font-style:italic;margin:0 8px}button.od-PermissionsPivot-sectionShareButton{display:block;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding:0;border:0 transparent}button.od-PermissionsPivot-sectionShareButton.hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}button.od-PermissionsPivot-sectionShareButton i.ms-Icon{margin-left:0}.od-PermissionsPivot-emptySection{padding-top:16px;font-size:.875rem}ul.od-PermissionsPivot-linksList,ul.od-PermissionsPivot-usersList{list-style-type:none;padding-left:0}ul.od-PermissionsPivot-usersList{margin:0 -8px}div.od-PermissionsPivot-user{margin:0 20px}.od-PermissionsPivot-infoMessage{font-size:.75rem;margin:12px 0}[dir=ltr] .od-PermissionsPivot-backButton{margin-left:-8px}[dir=rtl] .od-PermissionsPivot-backButton{margin-right:-8px}.od-PermissionsPivot-backButton.ie{top:8px}[dir=rtl] .od-PermissionsPivot-backButton{transform:scale(-1,1)}li.od-PermissionsPivot-resolvedLink .od-ShareLink-header{margin-left:-24px;margin-right:-24px}[dir=ltr] .od-PrincipalDetails-backButton{margin-left:-8px}[dir=rtl] .od-PrincipalDetails-backButton{margin-right:-8px}[dir=rtl] .od-PrincipalDetails-backButton{transform:scale(-1,1)}.od-PrincipalDetails-backButton.ie .ms-Button-flexContainer{display:inline}.od-PrincipalDetails-editStatus{font-weight:600}[dir=ltr] .od-PrincipalDetails-editStatus{right:0}[dir=rtl] .od-PrincipalDetails-editStatus{left:0}[dir=ltr] .od-PrincipalDetails-name{left:0}[dir=rtl] .od-PrincipalDetails-name{right:0}.od-PrincipalDetails-title{font-weight:600;font-size:.75rem;display:inline;line-height:16px;vertical-align:text-top}.od-PrincipalDetails-accessSummary{padding-top:28px}.od-PrincipalDetails-accessSummaryTitle{font-weight:600;font-size:.875rem}.od-PrincipalDetails-accessSummaryTitle.manageGroupLink{padding-bottom:24px}.od-PrincipalDetails-accessSummaryTitle.noManageGroupLink{padding-bottom:12px}.od-PrincipalDetails-unknownTooltip{padding-left:6px}.od-PrincipalDetails-accessSummaryTooltip{padding-left:4px;display:inline;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PrincipalDetails-textTooltipContent{margin:8px;font-size:.75rem;overflow-wrap:break-word}.od-PrincipalDetails-Persona{line-height:2rem}.od-PrincipalDetails-Persona div.ms-Persona-primaryText{font-size:1.125rem}.od-PrincipalDetails-Persona.ie .ms-Persona-details{flex-direction:row;justify-content:flex-end}.od-PrincipalDetails-accessSummaryPrincipalSubtext{font-size:.875rem;line-height:1.25rem;padding-top:4px;margin-left:calc(2rem + 8px)}.od-PrincipalDetails-accessSummaryPrincipalSubtext .od-PrincipalDetails-unknownUserLink{padding:0 .25rem}.od-PrincipalDetails-accessSummaryRole{display:inline;font-weight:600;line-height:2rem;vertical-align:middle;font-size:1.125rem;white-space:nowrap}.od-PrincipalDetails-content2{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:24px;font-size:1rem}.od-PrincipalDetails-content2.spo{height:280px}.od-PrincipalDetails-accessDetailsSection{font-weight:600;padding-bottom:6px;font-size:.875rem}.od-PrincipalDetails-inlineTooltip{padding:0 4px 0 2px;display:inline}.od-PrincipalDetails-inheritedTooltipContent{margin:20px;font-size:.75rem;overflow-wrap:break-word}.od-PrincipalDetails-inheritedTooltipContent-description{padding-bottom:12px}.od-PrincipalDetails-inheritedTooltipContent-secondFilename{display:inline-block}.od-PrincipalDetails-groupHeader{width:100%;cursor:pointer;display:grid;display:-ms-grid;grid-template-columns:min-content auto}i.od-PrincipalDetails-groupHeader-headerChevron{font-size:.5rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding-top:6px;padding-bottom:6px;grid-column:1}[dir=ltr] i.od-PrincipalDetails-groupHeader-headerChevron{padding-left:6px}[dir=rtl] i.od-PrincipalDetails-groupHeader-headerChevron{padding-right:6px}[dir=ltr] i.od-PrincipalDetails-groupHeader-headerChevron{padding-right:8px}[dir=rtl] i.od-PrincipalDetails-groupHeader-headerChevron{padding-left:8px}.od-PrincipalDetails-groupHeader-text{-ms-grid-column:2;grid-column:2}.od-PrincipalDetails-footer{bottom:0;width:100%;position:fixed}.od-PrincipalDetails-footer.spo{bottom:unset;width:480px}.od-PrincipalDetails-infoMessage{margin:0 16px 12px 16px}.od-PrincipalDetails-inheritanceInfoMessage{background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";border-radius:6px;margin-top:12px}.od-PrincipalDetails-actionsContainer{padding:16px 24px 24px 24px;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";height:32px}.od-PrincipalDetails-actionsContainer-spacer{padding:16px 24px 24px 24px;background-color:transparent;height:32px}.od-PrincipalDetails-actionsStack{position:relative;float:right}[dir=rtl] .od-PrincipalDetails-actionsStack{float:left}.od-PrincipalDetails-cell{padding-left:calc(.5rem + 6px + 8px);padding-top:2px;padding-bottom:6px}.od-PrincipalDetails-cellDirectAccess{font-size:.875rem;color:#605e5c}.od-PrincipalDetails-cellLinkDetails{font-size:.75rem;color:#323130}.od-PrincipalDetails-cellRoleSelector{width:200px;padding-top:12px}"}]);var c=n(2047);Object(s.n)([{rawString:"@keyframes fadeOutAnimation{0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-50%)}}.od-TransientMessageBar-infoMessage-transient{animation:fadeOutAnimation .3s cubic-bezier(.1,.25,.75,.9) 3s}.od-TransientMessageBar-infoMessage-correlation{padding-top:15px}"}]);var d,l,u=n(1981),f=n(2379),p=function(e){function t(t,n){var a=e.call(this,t)||this;return a._correlationId=a.props.correlationId,a.state={isVisible:!1},a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.setState({isVisible:!0}),this.props.infoMessage.isTransient&&setTimeout(function(){e._resetNotification()},3e3)},t.prototype.render=function(){var e,t,n=this.props.infoMessage,r=n.isTransient?" od-TransientMessageBar-infoMessage-transient":" od-TransientMessageBar-infoMessage-visible";switch(n.type){case u.e.success:e=i.createElement(i.Fragment,null,n.message),t={ariaLabel:n.message,onDismiss:void 0};break;case u.e.error:e=i.createElement(i.Fragment,null,n.message,i.createElement("div",{className:"od-TransientMessageBar-infoMessage-correlation"},i.createElement("span",null,o.x," ",this._correlationId))),t={ariaLabel:n.message,onDismiss:this._resetNotification.bind(this),truncated:!0,overflowButtonAriaLabel:o.ie};break;default:e=i.createElement(i.Fragment,null,n.message),t={ariaLabel:n.message,onDismiss:this._resetNotification.bind(this)}}return i.createElement("div",null,this.state.isVisible&&i.createElement(f.e,Object(a.__assign)({},t,{className:this.props.additionalClassName+r,messageBarType:n.type,dismissButtonAriaLabel:o.u,role:"alert"}),e))},t.prototype._resetNotification=function(){this.setState({isVisible:!1}),this.props.dismissCallback()},t}(i.Component),m=n(2052),_=n(1991),h=n(1889),b=n(2576),g=n(1098),v=n(1853),y=n(2580),S=n(2578),D=n(2255),I=n(112),x=n(476),C=n(1673),O=n(21),w=n(2029),E=n(1840),A=n(1644),L=n(129),k=n(2452),M=n(1782),P=n(2279),T=n(108),U=n(1642),F=n(1176),H=n(1403),R=n(1677),N=n(238),B=n(39),j=n(621),V=n(2119),z=n(1989),G=n(1834),K=n(1804),W=n(1806),q=n(1817);!function(e){e[e.directAccess=0]="directAccess",e[e.specificPeople=1]="specificPeople",e[e.anyone=2]="anyone",e[e.inheritedDirect=3]="inheritedDirect",e[e.inheritedLink=4]="inheritedLink",e[e.bundleDirect=5]="bundleDirect",e[e.bundleLink=6]="bundleLink",e[e.organization=7]="organization",e[e.groupMembership=8]="groupMembership"}(d||(d={})),function(e){e[e.none=0]="none",e[e.direct=1]="direct",e[e.full=2]="full"}(l||(l={})),Object(H.t)(void 0);var Q,Y={id:"",accessType:d.directAccess,role:b.e.none,permission:{id:"",isSPO:!0,rawPermission:{shareId:""},role:b.e.none},isGroupCollapsed:!0},J=function(e){function t(n,r){var s=e.call(this,n)||this;return s._onShouldVirtualize=function(){return!1},s._generateGroups=function(e,t){for(var n=[],a=0;a<e.length;a++){var i=e[a];if(i.accessType===d.directAccess&&i.role===b.e.none&&t===b.e.edit)break;if(i.accessType!==d.groupMembership){var r={count:1,startIndex:a,key:i.id,level:0,children:[],isCollapsed:i.isGroupCollapsed,name:s._computeGroupHeaderText(i.accessType,i),data:{sharingRole:i.role,accessType:i.accessType,item:i}};n.push(r)}}return n},s._onRenderHeader=function(e){if(e){var t,n,r=e.group.data.item,c=e.group.data.sharingRole,l=s._getEditText(c,r),u=s._isInheritedPermission(e.group.data.accessType),f=s._isBundlePermission(e.group.data.accessType),p=e.group.data.accessType===d.inheritedLink||e.group.data.accessType===d.bundleLink;u&&(t=s._getInheritedTooltipContent(r,p)),f&&(n={onRenderContent:function(){return i.createElement(D.e,{className:"od-PrincipalDetails-textTooltipContent"},i.createElement("span",null,B.format(p?o.d:o.s,r.permission.rawPermission.inheritedFrom.name.toLowerCase())))}});var m=function(e){var t=s.state.accessItems.map(function(t){return t.id===e.key&&(t.isGroupCollapsed=!e.isCollapsed),t});s.setState({accessItems:t})};return e.onGroupHeaderClick=function(e){m(e)},e.onGroupHeaderKeyUp=function(e,t){e.preventDefault(),e&&e.keyCode&&(e.keyCode===I.e.space||e.keyCode===I.e.enter)&&m(t)},e.expandButtonProps={style:{display:"none"}},e.onRenderName=function(){return i.createElement("div",{className:"od-PrincipalDetails-groupHeader","aria-label":e.group.isCollapsed?o.f:o.C},i.createElement(x.e,{"data-is-focusable":!1,onClick:function(){return e.onGroupHeaderClick(e.group)},className:"od-PrincipalDetails-groupHeader-headerChevron",iconName:e.group.isCollapsed?"ChevronDown":"ChevronUp"}),i.createElement("div",{className:"od-PrincipalDetails-groupHeader-text"},i.createElement("span",{className:"od-PrincipalDetails-name"},e.group.name),":"," ",i.createElement("span",{className:"od-PrincipalDetails-editStatus"},l),i.createElement("span",{className:"od-PrincipalDetails-groupTooltip"},u&&i.createElement(C.e,{tooltipProps:t,id:"od-PrincipalDetails-inheritedTooltip"},i.createElement("span",{tabIndex:0,role:"note",className:"od-PrincipalDetails-inlineTooltip"},i.createElement(x.e,{"aria-describedby":"od-PrincipalDetails-inheritedTooltip","data-is-focusable":!0,iconName:"Info"}))),f&&i.createElement(C.e,{tooltipProps:n,id:"od-PrincipalDetails-bundleTooltip"},i.createElement("span",{tabIndex:0,role:"note",className:"od-PrincipalDetails-inlineTooltip"},i.createElement(x.e,{"aria-describedby":"od-PrincipalDetails-bundleTooltip","data-is-focusable":!0,iconName:"Info"}))))))},e.styles=Object(O.T)({groupHeaderContainer:{height:"fit-content",padding:"8px 0px"}}),i.createElement(w.e,Object(a.__assign)({},e))}return null},s._onRenderCell=function(e,t,n){var a,r,l=s.props,u=l.sharingInformation.sharingLinks?l.sharingInformation.sharingLinks.filter(function(e){var n,a;return(null==e?void 0:e.shareId)===(null===(a=null===(n=null==t?void 0:t.permission)||void 0===n?void 0:n.rawPermission)||void 0===a?void 0:a.shareId)})[0]:null,f=Object(G.e)({sharingInformation:l.sharingInformation}),p=(s._store.isShared&&s._store.isShared()||l.sharingInformation.isShared)&&(s._store.isOwner&&s._store.isOwner()||l.sharingInformation.userRole===b.e.owner)&&t.role!==b.e.none,_=s.props.isSPO&&""===t.id&&t.role===b.e.none;switch(t.accessType){case d.directAccess:case d.inheritedDirect:case d.bundleDirect:r=i.createElement(D.e,{key:null===(a=t.permission.rawPermission)||void 0===a?void 0:a.shareId},i.createElement("div",{className:"od-PrincipalDetails-cellDirectAccess"},o.m),i.createElement("div",{className:"od-PrincipalDetails-cellRoleSelector"},i.createElement(m.e,{sharingRole:t.role,mode:g.e.manageAccess,clientId:l.clientId,permissionId:t.id,onRoleChange:s._itemAccessChanged,menuPermissionOptions:f,roleSelectorAs:m.e,showRemoveDirectAccess:p,showGrantAccess:_})));break;case d.organization:case d.specificPeople:case d.anyone:case d.inheritedLink:case d.bundleLink:r=u&&i.createElement(D.e,{key:u.shareId},i.createElement(c.e,{key:u.shareId,companyName:l.companyName,link:u,clientId:l.clientId,mode:g.e.manageAccess,sharingInformation:l.sharingInformation,showPermissionsList:s._showPermissionsList,onShowLinkDetailsClicked:l.openLinkDetailsCallback.bind(u),enableLinkSettings:!0,showMoreOptions:!0,isAddressBarLink:!1,engagementExtraData:l.engagementExtraData,linkRecipients:Object(K.S)(u),hideConsumerExpiredLinkIcons:!0,spacing:c.t.compact,isAccessSummaryLink:s.props.isSPO}))}return i.createElement("div",{className:"od-PrincipalDetails-cell"},r)},s._showPermissionsList=function(){},s._onStopSharingDialogDismiss=function(){s.setState({activePermissionId:void 0,showStopSharingDialogType:l.none})},s._stopSharingConfirmed=function(){s._engagementEventHelper.manageAccessV3PrincipalRemoveDirectAccess(Object(K.I)(s.state.principal.type),s.props.engagementExtraData),s._store.updatePermissionById(s.state.activePermissionId,b.e.none),s._onStopSharingDialogDismiss()},s._itemAccessChanged=function(e,t){var n;if(e!==b.e.none){if(t&&s.state.updatedPermissions.has(t)){var i=s.props.principal.accessMap.get(t);if(i){var r=Object(K.D)(i);e===r?(n=s.state.updatedPermissions).delete(t):(n=s.state.updatedPermissions.set(t,e),n=s.state.updatedPermissions)}}else n=s.state.updatedPermissions.set(t,e),n=s.state.updatedPermissions;if(n){var o=s.state.accessItems.map(function(n){return n.id===t?Object(a.__assign)(Object(a.__assign)({},n),{role:e}):n});s.setState({accessItems:o,updatedPermissions:n})}}else s.setState({activePermissionId:t,showStopSharingDialogType:l.direct})},s._undoClicked=function(){s._engagementEventHelper.manageAccessV3CancelPermissionUpdate(s.props.engagementExtraData);var e=s.state.sharingInformation.sharingPrincipals.filter(function(e){return e.id===s.props.principal.id})[0],n=t._parsePermissions(s.state.sharingInformation,e,s.props.backButtonCallback,s.props.isSPO).map(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{isGroupCollapsed:!0})});s.setState({updatedPermissions:new Map,accessItems:n,showMessageBar:!1})},s._applyClicked=function(){var e=new j.e({scenario:Object(V.e)("ShareManageAccessV3.updatePermissions"),perfGoalInMs:3e4}),t=[];s.state.updatedPermissions.forEach(function(e,n){if(n&&""!==n){var a=s._store.updatePermissionById(n,e);t.push(a)}else s._store.grantDirectAccess(s.props.principal.id.toString(),e)}),Promise.all(t).then(function(){Object(z.a)({customerPromise:e,engagementExtraData:s.props.engagementExtraData,sharingStore:s._store}),s.setState({updatedPermissions:new Map,showMessageBar:!0,messageBarContent:{type:u.e.success,message:o.fe,isTransient:!0}}),s._store.fetchSharingInformation(!0)},function(t){Object(z.n)({customerPromise:e,rawErrorMessage:t||"generic share manage access failure",engagementExtraData:s.props.engagementExtraData,errorType:z.e.api,sharingStore:s._store}),s.setState({updatedPermissions:new Map,showMessageBar:!0,messageBarContent:{type:u.e.error,message:o.ue,isTransient:!1}}),s._store.fetchSharingInformation(!0)})},s._store=n.store,s._permissionsViewSettings=s._store.getPermissionsViewSettings(),s._engagementEventHelper=n.store.getEngagementHelper(),s._isConsumer=s.props.store.isConsumer(),s.state={sharingInformation:n.sharingInformation,accessItems:t._parsePermissions(n.sharingInformation,n.principal,n.backButtonCallback,s.props.isSPO),principal:n.principal,updatedPermissions:new Map,activePermissionId:void 0,showStopSharingDialogType:l.none,showMessageBar:!1},s}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e,n,a){var i=this;if(this.props.sharingInformation!==e.sharingInformation){var r=this.props.sharingInformation.sharingPrincipals.filter(function(e){return e.id===i.props.principal.id})[0];this.props.sharingInformation.sharingPrincipals&&this.props.sharingInformation.sharingPrincipals.length<1||!r?this.props.backButtonCallback():this.setState({sharingInformation:this.props.sharingInformation,accessItems:t._parsePermissions(this.props.sharingInformation,r,this.props.backButtonCallback,this.props.isSPO),principal:r,updatedPermissions:new Map,activePermissionId:void 0,showStopSharingDialogType:l.none})}},t.prototype.render=function(){var e=this,t={onRenderContent:function(){return i.createElement("div",null,o.t)}},n=this.state.principal,r={imageUrl:n.imageUrl,text:n.primaryText,showSecondaryText:!1,size:E.n.size32,presence:E.t.none,showInitialsUntilImageLoads:!0,coinProps:{styles:{coin:{width:"2rem",height:"2rem"},image:{width:"2rem !important",height:"2rem !important"},imageArea:{width:"2rem",height:"2rem"},initials:{width:"2rem",height:"2rem",fontSize:"1.125rem",lineHeight:"2rem"}}},styles:{root:{height:"2rem"},primaryText:{fontSize:"1.125rem"}}};Object(G.e)({sharingInformation:this.props.sharingInformation}),this._safeFileName=Object(K.N)(this.props.fileName);var s=this._safeFileName!==this.props.fileName,c=this._permissionsViewSettings.supportedGroupTypes.indexOf(n.type)>=0,d=this._isConsumer?"":"spo",u=n.primaryText===o.de&&""===n.secondaryText;u&&(r.text="",r.onRenderPrimaryText=function(){return i.createElement("span",null,n.primaryText,i.createElement("span",{className:"od-PrincipalDetails-unknownTooltip"},e._renderUnknownDisplayNameTooltip()))});var m=c&&!this.props.isSPO;return i.createElement("div",null,i.createElement("div",{className:"od-PrincipalDetails-content",tabIndex:-1},this.state.showStopSharingDialogType!==l.none&&this._renderStopSharing(),i.createElement("div",{className:"od-PrincipalDetails-header"},q.t(i.createElement(A.e,{className:"od-PrincipalDetails-backButton ".concat(W.m(this.props.clientId)?"ie":""),onClick:this.props.backButtonCallback,id:"od-PrincipalDetails-backButton",iconProps:{iconName:"Back"},ariaLabel:o.r}),o.r,{tooltipId:"od-PrincipalDetails-backButton-tooltip",position:L.e.bottomCenter,targetElementId:"od-PrincipalDetails-backButton"}),i.createElement("span",{className:"od-PrincipalDetails-title"},o.B),this.props.showCloseButton&&q.t(i.createElement(A.e,{className:"od-PrincipalDetails-close",id:"od-PrincipalDetails-close",iconProps:{iconName:"Cancel"},ariaLabel:o.u,onClick:this.props.onDismiss}),o.u,{tooltipId:"od-PrincipalDetails-closeButton-tooltip",position:L.e.bottomCenter,targetElementId:"od-PrincipalDetails-close"}),s?Object(q.t)(i.createElement("div",{className:"od-PrincipalDetails-fileNameAndIcon",tabIndex:0},i.createElement(x.e,Object(a.__assign)({className:"od-PrincipalDetails-fileIcon","aria-hidden":"true"},Object(R.n)(this.props.fileIconProps))),i.createElement("span",{"aria-label":this.props.fileName},this._safeFileName)),this.props.fileName,{position:L.e.topLeftEdge}):i.createElement("div",{className:"od-PrincipalDetails-fileNameAndIcon"},i.createElement(x.e,Object(a.__assign)({className:"od-PrincipalDetails-fileIcon","aria-hidden":"true"},Object(R.n)(this.props.fileIconProps))),this.props.fileName)),i.createElement("div",{className:"od-PrincipalDetails-accessSummary"},i.createElement("h2",{className:"od-PrincipalDetails-accessSummaryTitle ".concat(m?"manageGroupLink":"noManageGroupLink")},i.createElement("span",null,o.e),i.createElement(C.e,{tooltipProps:t,id:"od-PrincipalDetails-accessSummaryTooltip"},i.createElement("div",{tabIndex:0,role:"note",className:"od-PrincipalDetails-accessSummaryTooltip"},i.createElement(x.e,{"aria-describedby":"od-PrincipalDetails-accessSummaryTooltip",iconName:"Info"})))),i.createElement(D.e,{horizontal:!0},i.createElement(k.e,Object(a.__assign)({},r,{className:"od-PrincipalDetails-Persona\n                ".concat(W.m(this.props.clientId)?"ie":"")})),i.createElement("span",{className:"od-PrincipalDetails-accessSummaryRole"},Object(K.x)(Object(K.h)(n),!0).title)),m&&i.createElement(M.e,{className:"od-PrincipalDetails-accessSummaryPrincipalSubtext",href:this._permissionsViewSettings.manageGroupLink,target:"_blank",underline:!0},o.j),u&&i.createElement("span",{className:"od-PrincipalDetails-accessSummaryPrincipalSubtext"},o.ce,i.createElement(M.e,{className:"od-PrincipalDetails-unknownUserLink",href:this._permissionsViewSettings.manageUnknownUserLink,target:"_blank",underline:!0},o.oe),o.se))),i.createElement("div",{className:"od-PrincipalDetails-content2 ".concat(this.props.isSPO?"spo":"")},i.createElement("h2",{className:"od-PrincipalDetails-accessDetailsSection"},c?o.Z:o.X),i.createElement(P.e,{items:this.state.accessItems,onRenderCell:this._onRenderCell,selectionMode:T.n.none,groups:this._generateGroups(this.state.accessItems,Object(K.h)(n)),groupProps:{onRenderHeader:this._onRenderHeader},compact:!0,onShouldVirtualize:this._onShouldVirtualize,focusZoneProps:{defaultTabbableElement:this._getDefaultTabbableElement}}),n.hasGSIAndCheckAccessPerms&&n.type===v.e.user&&this.props.isSPO&&i.createElement(f.e,{className:"od-PrincipalDetails-inheritanceInfoMessage"},o.A),i.createElement("div",{className:"od-PrincipalDetails-actionsContainer-spacer",tabIndex:-1,"aria-hidden":!0})),i.createElement("div",{className:"od-PrincipalDetails-footer "+d},this.state.showMessageBar&&i.createElement("div",{className:"od-PrincipalDetails-infoMessage"},i.createElement(p,Object(a.__assign)({},this.props,{infoMessage:this.state.messageBarContent,dismissCallback:this._messageBarDismissed.bind(this),additionalClassName:"od-PrincipalDetails-infoMessage-footerMessageBar"}))),i.createElement("div",{className:"od-PrincipalDetails-actionsContainer"},i.createElement(D.e,{horizontal:!0,tokens:{childrenGap:12},className:"od-PrincipalDetails-actionsStack"},i.createElement(U.e,{text:o.i,onClick:this._applyClicked,allowDisabledFocus:!0,disabled:this.state.updatedPermissions.size<1,className:"od-PrincipalDetails-applyChangesBtn"}),i.createElement(F.e,{text:o.re,onClick:this._undoClicked,allowDisabledFocus:!0,disabled:this.state.updatedPermissions.size<1,className:"od-PrincipalDetails-cancelChangesBtn"})))))},t.prototype._getDefaultTabbableElement=function(e){return e.setAttribute("tabIndex","0")},t.prototype._renderUnknownDisplayNameTooltip=function(){var e=o.le;return i.createElement(C.e,{content:e,calloutProps:{gapSpace:0},id:"od-PrincipalDetails-unknownDisplayNameTooltip"},i.createElement("span",{tabIndex:0,role:"note",className:"od-PrincipalDetails-inlineTooltip"},i.createElement(x.e,{className:"od-PrincipalDetails-unknownDisplayName-infoIcon","aria-describedby":"od-PrincipalDetails-unknownDisplayNameTooltip","data-is-focusable":!0,iconName:"Info"})))},t.prototype._messageBarDismissed=function(){this.setState({showMessageBar:!1})},t.prototype._computeGroupHeaderText=function(e,t){var n;switch(e){case d.directAccess:n=o.p;break;case d.specificPeople:n=o.ne;break;case d.anyone:n=o.a;break;case d.inheritedDirect:n=o.M+" "+t.permission.rawPermission.inheritedFrom.name;break;case d.inheritedLink:n=o.T+" "+t.permission.rawPermission.inheritedFrom.name;break;case d.bundleDirect:n=o.o+" "+t.permission.rawPermission.inheritedFrom.name.toLowerCase();break;case d.bundleLink:n=o.c+" "+t.permission.rawPermission.inheritedFrom.name.toLowerCase();break;case d.organization:n=B.format(o.G,this.props.companyName)}return n},t.prototype._getInheritedTooltipContent=function(e,t){var n=this,r=this.props.sharingInformation.item,s=e.permission.rawPermission.inheritedFrom.path,c={size:16,type:N.e.folder},d=e.permission.rawPermission.inheritedFrom.name||s.substring(s.lastIndexOf("/")+1),l=r.parentName?d!==r.parentName:s.replace(r.parentPath,"").split("/").length>1;return{onRenderContent:function(){return i.createElement(D.e,{className:"od-PrincipalDetails-inheritedTooltipContent"},i.createElement("div",{className:"od-PrincipalDetails-inheritedTooltipContent-description"},t?o.U:o.P),i.createElement("span",null,i.createElement("span",null,i.createElement(x.e,Object(a.__assign)({className:"od-PrincipalDetails-tooltipFileIcon","aria-hidden":"true","data-is-focusable":!1},Object(R.n)(c))),d),i.createElement(x.e,{className:"od-PrincipalDetails-tooltipChevron","aria-hidden":"true","data-is-focusable":!1,iconName:"ChevronRight"}),l&&i.createElement("span",null,i.createElement("span",null,"..."),i.createElement(x.e,{className:"od-PrincipalDetails-tooltipChevron","aria-hidden":"true","data-is-focusable":!1,iconName:"ChevronRight"})),i.createElement("span",{className:"od-PrincipalDetails-inheritedTooltipContent-secondFilename"},i.createElement(x.e,Object(a.__assign)({className:"od-PrincipalDetails-tooltipFileIcon","aria-hidden":"true","data-is-focusable":!1},Object(R.n)(n.props.fileIconProps))),n.props.fileName)))}}},t.prototype._isInheritedPermission=function(e){return e===d.inheritedDirect||e===d.inheritedLink},t.prototype._isBundlePermission=function(e){return e===d.bundleDirect||e===d.bundleLink},t.prototype._getEditText=function(e,t){if(t.accessType===d.directAccess&&t.role===b.e.none)return o.z;var n="";switch(e){case b.e.edit:n=o._;break;case b.e.review:n=o.ee;break;case b.e.view:n=o.pe}return n},t._parsePermissions=function(e,t,n,i){var r=e.sharingPrincipals.filter(function(e){return e.id===t.id})[0];if(!(e.sharingPrincipals&&e.sharingPrincipals.length<1)&&r){var o=[],s=!1;return t.accessMap.forEach(function(e){var n;if(e.isSPO)n=Object(a.__assign)(Object(a.__assign)({},e),{accessType:d.anyone,role:Object(K.D)(e),permission:e,isGroupCollapsed:!0}),e.rawPermission.scope===y.e.specificPeople?n.accessType=d.specificPeople:e.rawPermission.scope===y.e.organization?n.accessType=d.organization:-1!==e.id.indexOf("membership")?n.accessType=d.groupMembership:(n.accessType=d.directAccess,s=!0),t.sharingLinkKind&&(t.sharingLinkKind===S.e.anonymousView||t.sharingLinkKind===S.e.anonymousEdit?n.accessType=d.anyone:t.sharingLinkKind===S.e.direct?(n.accessType=d.directAccess,s=!0):t.sharingLinkKind!==S.e.organizationView&&t.sharingLinkKind!==S.e.organizationEdit||(n.accessType=d.organization));else if(e){var i=e.rawPermission;n={id:i.id,accessType:d.anyone,role:Object(K.D)(e),permission:e,isGroupCollapsed:!0},i.grantedTo&&i.grantedTo.user&&i.grantedTo.user.id===t.id||i.grantedTo&&i.grantedTo.group&&i.grantedTo.group.id===t.id?(i.inheritedFrom?void 0!==i.inheritedFrom.path?n.accessType=d.inheritedDirect:n.accessType=d.bundleDirect:n.accessType=d.directAccess,s=!0):i.link&&(i.inheritedFrom?void 0!==i.inheritedFrom.path?n.accessType=d.inheritedLink:n.accessType=d.bundleLink:"requestAccess"===i.link.type||i.invitation&&i.invitation.signInRequired?n.accessType=d.specificPeople:n.accessType=d.anyone)}o.push(n)}),!s&&i&&o.push(Y),o}n()},t.prototype._renderStopSharing=function(){var e,t=this.props.principal,n={id:t.id,name:t.primaryText,image:t.imageUrl,isResolved:!0,principalName:t.loginName,userId:t.loginName,email:t.email,job:t.secondaryText,isExternal:t.isExternal,loginName:t.loginName,principalType:t.type};switch(this.state.showStopSharingDialogType){case l.direct:e=_.e.direct;break;case l.full:default:e=_.e.participant}return i.createElement("div",{className:"od-PermissionsPivot-stopSharing"},this.state.showStopSharingDialogType!==l.none&&i.createElement(h.ConfirmationDialog,{confirmationCode:e,participant:n,onApply:this._stopSharingConfirmed.bind(this),onCancel:this._onStopSharingDialogDismiss}))},t}(i.Component),X=n(2154),Z=n(2636),$=n(1794),ee=n(1624),te=n(2555),ne=n(2211),ae=n(2304),ie=n(1750),re=n(345),oe=n(435),se=n(173),ce=n(2109),de=n(101),le=n(47),ue=n(1826),fe=n(1919),pe=n(1802),me=n(1829),_e=n(1885),he=n(2140),be=n(1831),ge={iconName:"CirclePlus"},ve=15;Object(H.t)(void 0),function(e){e[e.mainPeople=0]="mainPeople",e[e.mainGroups=1]="mainGroups",e[e.mainLinks=2]="mainLinks",e[e.principalDetails=3]="principalDetails",e[e.linkDetails=4]="linkDetails"}(Q||(Q={}));var ye=function(e){function t(t,n){var a,r,s,d,l,u=this;(u=e.call(this,t)||this)._viewStates=[],u._navHeaderItems=new Map,u._topLevelDivRef=i.createRef(),u._isSPO=1===me.n()&&pe.H()&&!u.props.store.isConsumer(),u._hasBackButton=u.props.mode!==g.e.manageAccess&&u._isSPO,u._onAdvancedSettingsClick=function(){window.open(u.props.advancedUrl,"_blank"),u._sendAdvancedClickEngagementEvent()},u._setShowInheritedMessageDismissed=function(){u.setState({showInheritedMessage:!1})},u._setShowBundleMessageDismissed=function(){u.setState({showBundleMessage:!1})},u._renderSelectedDropdownContent=function(){switch(u.state.dropdownSelectedKey){default:return i.createElement("div",{className:"od-PermissionsPivot-scroll"}," ",u._renderPeopleContent()," ");case 1:return i.createElement("div",{className:"od-PermissionsPivot-scroll"}," ",u._renderGroupsContent()," ");case 2:return i.createElement("div",{className:"od-PermissionsPivot-scroll"}," ",u._renderLinksContent()," ")}},u._onRenderPrincipalContentCell=function(e,t){var n=u._getItemFocusStyle(e.role);return i.createElement("div",{key:e.id,onClick:u._openPersonDetailsPage.bind(u,e),className:n.itemCell,"data-is-focusable":!0},u._renderInnerCellContent(e))},u._renderPeopleContent=function(){var e,t=!1;t&&u._engagementEventHelper.manageAccessV3UserDidSearch();var n=!(u.state.peopleCount<=1),a=u._isConsumer?u.state.filteredUserPrincipals.length:u.state.usersToShow.length,r=a+" "+(1===a?o.Y:o.Q);return i.createElement("div",{id:"od-PermissionsPivot-content principalContent"},u.state.sharingInformation.hasInheritedLinks&&u.state.showInheritedMessage&&i.createElement(f.e,{className:"od-PermissionsPivot-infoMessage",onDismiss:u._setShowInheritedMessageDismissed,ariaLabel:o.u},u._isConsumer?o.k:o.L),u.state.sharingInformation.hasBundleLinks&&u.state.showBundleMessage&&i.createElement(f.e,{className:"od-PermissionsPivot-infoMessage",onDismiss:u._setShowBundleMessageDismissed,ariaLabel:o.u},o.l),i.createElement("ul",{role:"list",className:"od-PermissionsPivot-usersList"},i.createElement(ie.e,{direction:re.e.vertical,isInnerZoneKeystroke:function(e){return e.which===Object(oe.t)(I.e.right)}},n&&i.createElement(Z.e,{className:"od-PermissionsPivot-search",placeholder:u.state.showLoadMore?o.q:o.W,underlined:!0,onChange:function(e,n){if(""!==n){t=!0;var a=u.state.userPrincipals.filter(function(e){return e.primaryText.toLowerCase().indexOf(n.toLowerCase())>=0||e.email&&e.email.toLowerCase().indexOf(n.toLowerCase())>=0});u.setState({filteredUserPrincipals:a,usersToShow:a,showSearchResultCount:!0,accessChecked:!1,showLoadMore:!1,isFiltering:!u._isConsumer})}else u._resetPrincipalSearch()}}),u.state.showSearchResultCount&&i.createElement("div",{className:"od-PermissionsPivot-searchResultsCount"},r),i.createElement($.e,{className:"od-PermissionsPivot-peopleList",items:u._isConsumer?u.state.filteredUserPrincipals:u.state.usersToShow,onRenderCell:u._onRenderPrincipalContentCell}),!u._isConsumer&&i.createElement("div",{className:"od-PermissionsPivot-footerDiv"},u.state.showLoadMore&&i.createElement(M.e,{onClick:u._onLoadMoreClick},o.N),u._renderResultsCount()))),u.state.peopleCount<=1&&(!u._isSPO||0===u.state.userPrincipals.length||(null===(e=u.state.userPrincipals[0])||void 0===e?void 0:e.role)===b.e.owner)&&i.createElement("div",{className:"od-PermissionsPivot-emptySection"},u._isFolder?o.I:o.D,i.createElement(ee.e,{className:"od-PermissionsPivot-sectionShareButton",iconProps:ge,onClick:u._showDefaultShare.bind(u,"people")},o.J)))},u._onLoadMoreClick=function(){u.setState(function(e){return{usersToShow:u.state.userPrincipals.slice(0,(e.page+1)*ve),page:e.page+1,showLoadMore:(e.page+1)*ve<u.state.userPrincipals.length,accessChecked:!1}})},u._openPersonDetailsPage=function(e){e.role!==b.e.owner&&(u._viewStates.push(u.state.viewState),u._engagementEventHelper.manageAccessV3PrincipalDetailsClicked(Object(K.I)(e.type),u._engagementExtraData),u.setState({viewState:Q.principalDetails,selectedPrincipal:e}))},u._renderGroupsContent=function(){var e=u._isConsumer?o.h:o.b,t=u._isFolder?o.v:o.g;return i.createElement("div",{id:"od-PermissionsPivot-content principalContent"},u.state.sharingInformation.hasInheritedLinks&&u.state.showInheritedMessage&&i.createElement(f.e,{className:"od-PermissionsPivot-infoMessage",onDismiss:u._setShowInheritedMessageDismissed,ariaLabel:o.u},u._isConsumer?o.k:o.L),u.state.sharingInformation.hasBundleLinks&&u.state.showBundleMessage&&i.createElement(f.e,{className:"od-PermissionsPivot-infoMessage",onDismiss:u._setShowBundleMessageDismissed,ariaLabel:o.u},o.l),u.state.groupsCount<1&&i.createElement("div",{className:"od-PermissionsPivot-emptySection"},B.format(t,e),i.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=2149956",target:"_blank"}," ",o.F),i.createElement(ee.e,{className:"od-PermissionsPivot-sectionShareButton",iconProps:ge,onClick:u._showDefaultShare.bind(u,"groups")},B.format(o.O,e))),i.createElement("ul",{role:"list",className:"od-PermissionsPivot-usersList"},i.createElement($.e,{className:"od-PermissionsPivot-groupsList",items:u.state.groupPrincipals,onRenderCell:u._onRenderPrincipalContentCell})))},u._renderLinksContent=function(){return i.createElement("div",{id:"od-PermissionsPivot-content"},u.state.linksCount<1&&i.createElement("div",{className:"od-PermissionsPivot-emptySection"},i.createElement("div",null,u._isFolder?o.S:o.y),i.createElement(ee.e,{className:"od-PermissionsPivot-sectionShareButton",iconProps:ge,onClick:u._showDefaultShare.bind(u,"links")},o.R)),i.createElement("ul",{role:"list",className:"od-PermissionsPivot-linksList"},(u.props.store.isConsumer()?u.state.sharingInformation.sharingLinks:u.props.store.getActiveLinks()).map(function(e,t){return e.expiration=u.props.store.isConsumer()?new Date(e.expiration):null,i.createElement("li",{key:e.shareId,className:"od-PermissionsPivot-resolvedLink"},i.createElement(c.e,{key:e.shareId,companyName:u.props.companyName,link:e,clientId:u.props.clientId,mode:g.e.manageAccess,sharingInformation:u.state.sharingInformation,enableLinkSettings:!0,showMoreOptions:!0,showMainDeleteOption:!0,showPermissionsList:u._returnToPreviousView,onShowLinkDetailsClicked:u._openLinkDetailsPage.bind(u,e),engagementExtraData:u._engagementExtraData,linkDetailsView:!1,onRemoveLink:u._removeLink,linkRecipients:Object(K.S)(e),hideConsumerExpiredLinkIcons:!0,spacing:c.t.standard,showLinkHeader:!0,fileName:u._fileName,fileIcon:u._fileIconProps.type}))})))},u._returnToPreviousView=function(){u._viewStates&&u._viewStates.length>0?u.setState({viewState:u._viewStates.pop(),filteredUserPrincipals:u.state.userPrincipals,showSearchResultCount:!1,usersToShow:u.state.userPrincipals.slice(0,u.state.page*ve),showLoadMore:!u._isConsumer&&u.state.userPrincipals.slice(0,u.state.page*ve).length<u.state.userPrincipals.length}):u.setState({viewState:Q.mainPeople,filteredUserPrincipals:u.state.userPrincipals,showSearchResultCount:!1,usersToShow:u.state.userPrincipals.slice(0,u.state.page*ve),showLoadMore:!u._isConsumer&&u.state.userPrincipals.slice(0,u.state.page*ve).length<u.state.userPrincipals.length})},u._resetPrincipalSearch=function(){u.setState({filteredUserPrincipals:u.state.userPrincipals,usersToShow:u.state.userPrincipals.slice(0,u.state.page*ve),showSearchResultCount:!1,showLoadMore:!u._isConsumer&&u.state.userPrincipals.slice(0,u.state.page*ve).length<u.state.userPrincipals.length,isFiltering:!1})},u._removeLink=function(){},u._openLinkDetailsPage=function(e){u._viewStates.push(u.state.viewState),u.setState({selectedLink:e,viewState:Q.linkDetails})},u._stopSharing=function(){var e;u.props.onStopSharingClicked(),null===(e=u.props.store)||void 0===e||e.stopSharing(),u.setState({showStopSharingText:!1,showStopSharingDialog:!1}),u._engagementEventHelper.manageAccessV3StopSharingClicked(u._engagementExtraData)},u._showDefaultShare=function(e){u._engagementEventHelper.manageAccessV3ShareClicked(e,u._engagementExtraData);var t=u._sanitizeOverrideViewState(u.state.viewState);u.props.onDefaultShare(t)},u._shareClickTime=n.shareClickTime,u._sharingClientMessenger=n.sharingClientMessenger,u._engagementExtraData=t.engagementExtraData,u._engagementEventHelper=t.store.getEngagementHelper(),u._resize=n.resize,u._resizeTracker=new be.e(n.resize),u._fileName=t.sharingInformation.item.name,u._isFolder=(null===(r=null===(a=u.props.sharingInformation)||void 0===a?void 0:a.item)||void 0===r?void 0:r.itemType)===se.t.Folder;var p=(null===(s=t.sharingInformation.item)||void 0===s?void 0:s.extension)||t.sharingInformation.fileExtension;p&&" "!==p?u._fileIconProps={extension:u.props.sharingInformation.item.extension||p,size:16}:(null===(l=null===(d=u.props.sharingInformation)||void 0===d?void 0:d.item)||void 0===l?void 0:l.itemType)===se.t.Folder?u._fileIconProps={size:16,type:N.e.folder}:u._fileIconProps={size:16,type:N.e.genericFile};var m=u.props.store;u._isConsumer=m.isConsumer(),u._permissionsViewSettings=m.getPermissionsViewSettings(),u._navHeaderItems.set(fe.n.People,o.K),u._navHeaderItems.set(fe.n.Groups,u._permissionsViewSettings.groupPivotHeader),u._navHeaderItems.set(fe.n.Links,o.H);var _=!1;m&&u._permissionsViewSettings.itemStopSharingSupported&&m.isShared&&m.isOwner&&m.getSharedObjectType&&(_=m.isShared()&&m.isOwner()&&m.getSharedObjectType()===_e.e.file);var h,v=m.parsePrincipals(),y=v.users,S=v.groups;return u._engagementEventHelper.manageAccessV3Opened(u._engagementExtraData),u.props.viewOverride&&(h=u._sanitizeOverrideViewState(u.props.viewOverride),u._viewStates.push(h)),u.state={sharingInformation:u.props.sharingInformation,selectedNavKey:h||0,showInheritedMessage:u.props.sharingInformation.hasInheritedLinks,showBundleMessage:u.props.sharingInformation.hasBundleLinks,showSearchResultCount:!1,dropdownSelectedKey:0,useDropdown:window.outerWidth<=ce.e.DEFAULT_BREAKPOINTS.Small,peopleCount:y.length,groupsCount:S.length,linksCount:m.getLinksCount(),viewState:h||Q.mainPeople,selectedPrincipal:void 0,userPrincipals:y,groupPrincipals:S,filteredUserPrincipals:y,selectedLink:void 0,showStopSharingText:_,showStopSharingDialog:!1,accessChecked:!1,usersToShow:y.slice(0,ve),showLoadMore:!u._isConsumer&&y.length>=ve,page:1,isFiltering:!1},u}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t,n){var a=this;if(!this._isConsumer){if(this.state.page!==t.page){var i=this.state.usersToShow.slice(t.page*ve,this.state.page*ve).map(function(e){return{email:e.loginName}});this.props.store.checkUserAccess&&i.length>0&&!this.state.accessChecked?this.props.store.checkUserAccess(i).then(function(){a.setState({accessChecked:!0})}):this.setState({accessChecked:!0})}this.state.usersToShow.length>0&&t.usersToShow!==this.state.usersToShow&&(i=this.state.usersToShow.map(function(e){return{email:e.loginName}}),this.props.store.checkUserAccess&&this.props.store.checkUserAccess(i).then(function(){a.setState({accessChecked:!0})}))}if(this.props.sharingInformation!==e.sharingInformation||t.accessChecked!==this.state.accessChecked){var r=this.props.store,o=r.parsePrincipals(),s=o.users,c=o.groups,d=void 0;this.state.selectedPrincipal&&(d=this.props.sharingInformation.sharingPrincipals.filter(function(e){return e.id===a.state.selectedPrincipal.id})[0]);var l=void 0;this.state.selectedLink&&(l=this.props.sharingInformation.sharingLinks.filter(function(e){return e.shareId===a.state.selectedLink.shareId})[0]),this.setState({sharingInformation:this.props.sharingInformation,filteredUserPrincipals:s,userPrincipals:s,peopleCount:s.length,groupPrincipals:c,groupsCount:c.length,linksCount:r.getLinksCount(),selectedPrincipal:d,selectedLink:l,usersToShow:this.state.isFiltering?this.state.usersToShow:s.slice(0,this.state.page*ve)})}this._resize(),this._resizeIfNeeded()},t.prototype.componentDidMount=function(){var e,t=this;if(!this._isConsumer){var n=this.state.usersToShow.map(function(e){return{email:e.loginName}});this.props.store.checkUserAccess&&n.length>0&&!this.state.accessChecked?this.props.store.checkUserAccess(n).then(function(){t.setState({accessChecked:!0})}):this.setState({accessChecked:!0})}null===(e=this.props.shareLoadingCustomerPromise)||void 0===e||e.forEach(function(e){return e.end({resultType:le.e.Success})}),this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():ue.b(this._shareClickTime,this.props.clientId,g.e.manageAccess,this.props.scenarioId,this.props.correlationId);var a=new de.t(this);a.on(window,"keydown",function(e){e&&e.keyCode===I.e.escape&&t._handleEscKeyPress(e)}),a.on(window,"resize",function(){t.setState({useDropdown:window.outerWidth<=ce.e.DEFAULT_BREAKPOINTS.Small})}),this._resize(),this._resizeIfNeeded()},t.prototype.render=function(){var e;switch(this.state.viewState){case Q.mainPeople:case Q.mainGroups:case Q.mainLinks:e=this._renderDefaultPermissionsView();break;case Q.principalDetails:e=this._renderPrincipalDetailsView();break;case Q.linkDetails:e=this._renderLinkDetailsView();break;default:e=this._renderDefaultPermissionsView()}return i.createElement("div",{className:"od-PermissionsPivot-contentParent ".concat(this._isSPO?"spo":"")},e)},t.prototype._customPivotHeaderString=function(e,t){var n=e;return t>0&&t<100?n+=" • "+t.toString():t>=100&&(n+=" • 99+"),n},t.prototype._renderMoreButton=function(){var e={items:[{key:"advancedSettings",text:o.n,ariaLabel:o.n,onClick:this._onAdvancedSettingsClick}],styles:{list:{selectors:{".ms-ContextualMenu-itemText":{fontSize:"0.875rem"},".ms-ContextualMenu-link":{height:"2.25rem",lineHeight:"2.25rem"}}}},directionalHint:L.e.bottomRightEdge},t=i.createElement(A.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric",ariaLabel:o.V,menuIconProps:{iconName:"More",className:"od-ShareHeader-moreOptionsIcon"},menuProps:e});return q.t(t,o.V,{position:L.e.bottomRightEdge})},t.prototype._sendAdvancedClickEngagementEvent=function(){this._engagementEventHelper.manageAccessV3AdvancedSettingsClicked(this.props.engagementExtraData)},t.prototype._renderDefaultPermissionsView=function(){var e=this,t=Object(K.N)(this._fileName),n=t!==this._fileName;return i.createElement("div",{className:"od-PermissionsPivot-DefaultView-content",tabIndex:-1,ref:this._topLevelDivRef},i.createElement("div",{className:"od-PermissionsPivot-header"},this._hasBackButton&&q.t(i.createElement(A.e,{className:"od-PermissionsPivot-backButton ".concat(W.m(this.props.clientId)?"ie":""),id:"od-PermissionsPivot-backButton",onClick:this.props.backButtonClicked,iconProps:{iconName:"Back"},ariaLabel:o.r}),o.r,{position:L.e.bottomLeftEdge,targetElementId:"od-PermissionsPivot-backButton"}),i.createElement("h1",{className:"od-PermissionsPivot-title ".concat(this._hasBackButton?"withBackButton":"")},o.B),i.createElement("div",{className:"od-PermissionsPivot-headerButtons"},this._isSPO&&!W.m(this.props.clientId)&&this._renderMoreButton(),this.props.showCloseButton&&q.t(i.createElement(A.e,{className:"od-PermissionsPivot-close",id:"od-PermissionsPivot-close",iconProps:{iconName:"Cancel"},ariaLabel:o.u,onClick:this.props.onDismiss}),o.u,{tooltipId:"od-PermissionsPivot-closeButton-tooltip",position:L.e.bottomCenter,targetElementId:"od-PermissionsPivot-close"})),i.createElement("div",{className:"od-PermissionsPivot-stopSharing"},this.state.showStopSharingDialog&&i.createElement(he.e,{onDismiss:function(){e.setState({showStopSharingDialog:!1})},showStopSharingDialog:this.state.showStopSharingDialog,stopSharing:this._stopSharing})),n?Object(q.t)(i.createElement("div",{className:"od-PermissionsPivot-fileNameAndIcon",tabIndex:0},i.createElement(x.e,Object(a.__assign)({className:"od-PermissionsPivot-fileIcon","aria-hidden":"true"},Object(R.n)(this._fileIconProps))),i.createElement("span",{"aria-label":this._fileName},t)),this._fileName,{position:L.e.topLeftEdge}):i.createElement("div",{className:"od-PermissionsPivot-fileNameAndIcon"},i.createElement(x.e,Object(a.__assign)({className:"od-PermissionsPivot-fileIcon","aria-hidden":"true"},Object(R.n)(this._fileIconProps))),this._fileName),i.createElement("div",{className:"od-PermissionsPivot-sharingHeaderButtons"},this._permissionsViewSettings.itemStopSharingSupported&&this.state.showStopSharingText&&i.createElement(ee.e,{iconProps:{iconName:"Blocked2"},"aria-label":o.ae,onClick:function(){e.setState({showStopSharingDialog:!0})}},o.ae),!this._hasBackButton&&i.createElement(ee.e,{iconProps:{iconName:"Share"},className:"od-PermissionsPivot-share","aria-label":o.te,onClick:this._showDefaultShare.bind(this,"header")},o.te))),!this.state.useDropdown&&i.createElement("div",{className:"od-PermissionsPivot-pivot"},i.createElement(te.e,{selectedKey:String(this.state.selectedNavKey),onLinkClick:function(t){var n=Number(t.props.itemKey);e._viewStates.push(n),e.setState({selectedNavKey:n,viewState:n});var a=e._parseNavigationHeadersForTelem(t.props.headerText),i=[fe.n.People,fe.n.Groups,fe.n.Links],r=i&&i.length-1>=n&&i[n]||fe.n.Other;e._engagementEventHelper.manageAccessV3NavClicked(r,parseInt(a[1]),e._engagementExtraData),e._resetPrincipalSearch()}},i.createElement(ne.e,{itemKey:"0",headerText:this._customPivotHeaderString(this._navHeaderItems.get(fe.n.People),this.state.peopleCount)},this._renderPeopleContent()),i.createElement(ne.e,{itemKey:"1",headerText:this._customPivotHeaderString(this._navHeaderItems.get(fe.n.Groups),this.state.groupsCount)},this._renderGroupsContent()),i.createElement(ne.e,{itemKey:"2",headerText:this._customPivotHeaderString(this._navHeaderItems.get(fe.n.Links),this.state.linksCount)},this._renderLinksContent()))),this.state.useDropdown&&i.createElement("div",{className:"od-PermissionsPivot-dropdown"},i.createElement(ae.e,{className:"od-PermissionsPivot-dropdown-container",options:this._populateDropdownOptions(),onChange:function(t,n){var a=e._parseNavigationHeadersForTelem(n.text),i=Number(n.key),r=[fe.n.People,fe.n.Groups,fe.n.Links],o=r&&r.length-1>=i&&r[i]||fe.n.Other;e._engagementEventHelper.manageAccessV3NavClicked(o,parseInt(a[1]),e._engagementExtraData),e._viewStates.push(i),e.setState({selectedNavKey:i,viewState:i,dropdownSelectedKey:i})},defaultSelectedKey:this.state.selectedNavKey}),i.createElement("div",{className:"od-PermissionsPivot-dropdownContent"},this._renderSelectedDropdownContent())))},t.prototype._renderPrincipalDetailsView=function(){return i.createElement(J,Object(a.__assign)({},this.props,{backButtonCallback:this._returnToPreviousView,showCloseButton:this.props.showCloseButton,fileName:this._fileName,fileIconProps:this._fileIconProps,onDismiss:this.props.onDismiss,principal:this.state.selectedPrincipal,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,openLinkDetailsCallback:this._openLinkDetailsPage,store:this.props.store,companyName:this.props.companyName,engagementExtraData:this._engagementExtraData,isSPO:this._isSPO}))},t.prototype._renderLinkDetailsView=function(){return i.createElement("div",null,i.createElement(c.e,{companyName:this.props.companyName,link:this.state.selectedLink,clientId:this.props.clientId,mode:g.e.manageAccess,sharingInformation:this.state.sharingInformation,enableLinkSettings:!0,showMoreOptions:!0,showPermissionsList:this._returnToPreviousView,engagementExtraData:this._engagementExtraData,linkDetailsView:!0,onRemoveLink:this._removeLink,linkRecipients:Object(K.S)(this.state.selectedLink),inlineInDialog:!this.props.store.isConsumer(),hideConsumerExpiredLinkIcons:!0,spacing:c.t.standard}))},t.prototype._populateDropdownOptions=function(){return[{key:0,text:this._customPivotHeaderString(this._navHeaderItems.get(fe.n.People),this.state.peopleCount)},{key:1,text:this._customPivotHeaderString(this._navHeaderItems.get(fe.n.Groups),this.state.groupsCount)},{key:2,text:this._customPivotHeaderString(this._navHeaderItems.get(fe.n.Links),this.state.linksCount)}]},t.prototype._renderInnerCellContent=function(e){return i.createElement(X.e,{key:e.id,principal:e,userRole:this.state.sharingInformation.userRole,clientId:this.props.clientId,mode:g.e.manageAccess,sharingInformation:this.state.sharingInformation,showViewOnly:!0,roleVerbose:!0,engagementExtraData:this._engagementExtraData,useCompact:!0,allowFocus:!1,useAccessMap:!0,showUnknownUsers:!0,pageContext:this.props.pageContext,isSPO:this._isSPO,accessChecked:this.state.accessChecked})},t.prototype._getItemFocusStyle=function(e){var t=Object(O.L)(),n=t.palette;return Object(O.T)({itemCell:[Object(O.D)(t,{inset:-1}),e!==b.e.owner?{selectors:{"&:hover":{background:n.neutralLighter,cursor:"pointer"},"&:active":{background:n.neutralLight}}}:void 0,{selectors:{"&:focus":{border:"1px solid ".concat(n.neutralLight)}}}]})},t.prototype._renderResultsCount=function(){return i.createElement("div",{className:"od-PermissionPivot-resultsCount"},B.format(o.$,this.state.usersToShow.length,this.state.userPrincipals.length))},t.prototype._handleEscKeyPress=function(e){this._viewStates.length>0?this._returnToPreviousView():this.props.onDismiss(),e.stopPropagation()},t.prototype._sanitizeOverrideViewState=function(e){return e>=0&&e<=Q.mainLinks?e:Q.mainPeople},t.prototype._parseNavigationHeadersForTelem=function(e){var t=e.split(" • ");return t[1]||(t[1]="0"),t},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.contextTypes={shareClickTime:r.number,sharingStore:r.object.isRequired,sharingClientMessenger:r.object.isRequired,resize:r.func.isRequired},t}(i.Component);t.default=ye},,function(e,t,n){"use strict";n.r(t),n.d(t,"Notify",function(){return B});var a=n(0),i=n(17);Object(i.n)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Notify{padding:0 4px}.od-Notify.blocker{position:relative}.od-Notify.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-Notify .ms-Checkbox-label{align-items:center}.od-Notify-message{display:inline-flex;font-size:15px;padding:6px 0 4px 0;margin:0 3px 0 0}[dir=rtl] .od-Notify-message{margin:0 0 0 3px}.od-Notify-horizontalLine{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";padding-top:10px}.od-Notify-show-link{display:block;font-size:14px;margin:8px 0 0 auto}[dir=rtl] .od-Notify-show-link{margin:8px auto 0 0}.od-Notify-sendNotification-button{margin:24px auto 6px 0}[dir=ltr] .od-Notify-sendNotification-button{text-align:right}[dir=rtl] .od-Notify-sendNotification-button{text-align:left}[dir=rtl] .od-Notify-sendNotification-button{margin:24px 0 6px auto}.od-Notify-group-recipient{display:flex}.od-Notify-group-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox{margin:0 0 0 auto}[dir=rtl] .od-Notify-PickerPersona-checkbox{margin:0 auto 0 0}.od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{height:14px;width:14px;margin:0 10px 0 0;font-size:13px}[dir=rtl] .od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{margin:0 0 0 10px}.od-Notify-recipientWarning-container{height:38px}.od-Notify-recipientWarning{position:absolute;background-color:rgba(255,185,0,.3)}[dir=ltr] .od-Notify-recipientWarning{left:0}[dir=rtl] .od-Notify-recipientWarning{right:0}.od-Notify-recipientWarning .ms-MessageBar-content{height:43px;align-items:center}.ms-PickerItem-content{max-width:250px}.od-Notify-PickerPersona-container{display:flex;align-items:center}.od-Notify-PickerPersona{border-radius:16px;position:relative;display:inline-flex;vertical-align:top;white-space:nowrap;cursor:default}.od-Notify-PickerPersona .ms-Persona-secondaryText{font-size:11px}.od-Notify-PickerPersona.is-listbelow{width:100%}.od-Notify-groupLabel{font-weight:600;font-size:13px}.od-Notify-totalGroupsMembersCount{font-size:11px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:0 0 12px}.od-Notify-totalMembersCount{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:6px 0;margin:0 0 0 auto}[dir=ltr] .od-Notify-totalMembersCount{text-align:right}[dir=rtl] .od-Notify-totalMembersCount{text-align:left}[dir=rtl] .od-Notify-totalMembersCount{margin:0 auto 0 0}.od-Notify-groups-expand{height:26px;display:flex;align-items:flex-start;margin:14px 0 0}.od-Notify-group-expand-icon .ms-Button-icon{font-size:12px}.od-Notify-groups-listItem{margin:5px 1px}.od-Notify-groups-recipient-container{max-height:145px;overflow-x:hidden}.od-Notify-groups-recipient-container.expanded{margin-bottom:15px}.od-Notify-groups-recipient-container.expanded.scroll{overflow-y:scroll}.od-Notify-group-checkbox .ms-Checkbox-text{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-Notify-peopleLabel{padding:5px 0 14px;font-weight:600;font-size:13px}.od-Notify-people-recipient-container{max-height:190px;overflow-x:hidden;padding:8px 0 10px;margin-top:6px}.od-Notify-people-recipient-container.scroll{overflow-y:scroll}.od-Notify-PeoplePicker .ms-Persona-primaryText{max-width:150px;overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-Notify-PickerPersona-container{margin:8px 0}.od-Notify-groupMembersCount{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:11px}[dir=ltr] .od-Notify-groupMembersCount{margin-left:28px}[dir=rtl] .od-Notify-groupMembersCount{margin-right:28px}.od-Notify-groupMembersCount .ms-Spinner-circle{margin:0}"}]);var r=n(1),o=n(1800),s=n(2876),c=n(1098),d=n(2049),l=n(1863),u=n(1934),f=n(1644),p=n(1801),m=n(1954),_=n(1839),h=n(1853),b=n(39),g=n(51),v=n(1927),y=n(1782),S=n(2125),D=n(1673),I=n(129),x=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onCheckboxChange=function(e,t){var n=a.props.group;n.checked=t,a.setState({group:n},function(){a._sharingStore.getEngagementHelper().log("Notify.GroupCheckboxClicked",a.props.engagementExtraData),a.props.updateCountCallback(),a.props.updateCheckboxForGroup(n)})},a._sharingStore=n.sharingStore,a.state={group:t.group},a}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this._sharingStore.fetchMemberCount(this.props.group)},t.prototype.componentDidMount=function(){this._sharingStore.addListener(this.props.updateCountCallback)},t.prototype._renderGroup=function(){var e=this.state.group,t=e.disabled;return r.createElement(S.e,{id:e.email,boxSide:"start",label:t?e.name+" ("+p.La+")":e.name,checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:Object(g.e)("od-Notify-group-checkbox"),disabled:e.disabled})},t.prototype.render=function(){var e=this.state.group,t=e.disabled;return r.createElement(D.e,{className:Object(g.e)("od-Notify-group-recipient"),id:e.email,content:t?e.name+" ("+p.La+")":e.name,directionalHint:I.e.bottomCenter},this._renderGroup())},t.contextTypes={sharingStore:o.object.isRequired,strings:o.object.isRequired},t}(r.Component),C=n(2452),O=n(1840),w=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onCheckboxChange=function(e,t){var n=a.props.person;n.checked=t,a.setState({person:n}),a.context.sharingStore.getEngagementHelper().log("Notify.PersonCheckboxClicked",a.props.engagementExtraData),a.props.updateCheckboxForPerson(n)},a.state={person:t.person},a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.state.person;return r.createElement("div",{className:Object(g.e)("od-Notify-PickerPersona-container")},r.createElement(C.e,{imageUrl:e.image,text:e.name,secondaryText:e.job,showSecondaryText:!!e.job,size:O.n.extraSmall,className:Object(g.e)("od-Notify-PickerPersona")}),r.createElement(S.e,{id:e.email,boxSide:"end",checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:Object(g.e)("od-Notify-PickerPersona-checkbox")}))},t.contextTypes={sharingStore:o.object.isRequired,strings:o.object.isRequired},t}(r.Component),E=n(1993),A=n(1804),L=n(1952),k=n(2578),M=n(2878),P=n(1818),T=n(1826),U=n(2379),F=n(1981),H=n(1831),R=n(1830),N=100,B=function(e){function t(t,n){var i=e.call(this,t)||this;return i._topLevelDivRef=r.createRef(),i._onExpandClick=function(){i.setState(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{isExpanded:!e.isExpanded})},function(){i._sharingStore.getEngagementHelper().log("Notify.ExpandLinkClicked",i.props.engagementExtraData)})},i._onStoreUpdate=function(){var e=i._sharingStore.getPermissionsMap(),t=_.o({selectedItems:i.state.peoplePickerRecipients,sharingLinkKind:k.e.direct,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._sharingStore.getPolicyTipInformation,permissionsMap:e});t&&i._sharingStore.getEngagementHelper().log("Notify.AddedUserWhoDoesNotHaveAccess",i.props.engagementExtraData),e=Object(a.__assign)(Object(a.__assign)({},i.state.permissionsMap),e),i.setState(function(n){return Object(a.__assign)(Object(a.__assign)({},n),{peoplePickerError:t,permissionsMap:e})})},i._onPeoplePickerSelected=function(e){i._sharingStore.checkPermissions(e),e.filter(function(e){return e.principalType!==h.e.user}).forEach(function(e){i._sharingStore.fetchMemberCount(e)}),i._sharingStore.getEngagementHelper().log("Notify.AddedUserFromPeoplePicker",i.props.engagementExtraData);var t=i._sharingStore.getPermissionsMap(),n=_.o({selectedItems:i.state.peoplePickerRecipients,sharingLinkKind:k.e.direct,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._sharingStore.getPolicyTipInformation,permissionsMap:t});t=Object(a.__assign)(Object(a.__assign)({},i.state.permissionsMap),t),i.setState(function(i){return Object(a.__assign)(Object(a.__assign)({},i),{peoplePickerRecipients:e,peoplePickerError:n,permissionsMap:t})})},i._onResolvedSuggestions=function(e){return i._sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e),e},i._updateGroupCount=function(){for(var e=i._sharingStore.getMembersCounts(),t=i.state.groups.slice(0),n=0;n<t.length;n++){var r=i.state.groups[n];e[r.email]!==r.memberCount&&(r.memberCount=e[r.email],r.checked=!1,r.disabled=r.memberCount>=N,t[n]=r)}i.setState(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{groups:t})})},i._updateCheckboxForGroup=function(e){var t=i.state.groups;t.map(function(t){return t.email===e.email?e:t}),i.setState({groups:t})},i._updateCheckboxForPerson=function(e){var t=i.state.people;t.map(function(t){return t.email===e.email?e:t}),i.setState({people:t})},i._sendNotification=function(){var e=i._allRecipients();i.setState({showActivityIndicator:!0},function(){i._sharingClientMessenger?i._sharingClientMessenger.sendShareSendClicked():T.S(),i._sharingStore.shareLink({settings:i.props.currentSettings,recipients:e,allRecipientsHaveAccess:!0}),i._sharingStore.getEngagementHelper().shareCompleted(Object(a.__assign)(Object(a.__assign)({},i.props.engagementExtraData),{recipientsCount:e.length})),i._sharingClientMessenger?i._sharingClientMessenger.sendShareCompleted():T.x(s.e.share),i._showSuccessMessage()})},i._onGroupsExpandClick=function(){var e=i.state.groupsIsExpanded;i.setState(function(t){return Object(a.__assign)(Object(a.__assign)({},t),{groupsIsExpanded:!e})},function(){i._sharingStore.getEngagementHelper().log("Notify.GroupsExpandClicked",i.props.engagementExtraData)})},i._selectAllPeopleCheckbox=function(e,t){var n=i.state.people;n.map(function(e){return e.checked=t,e}),i.setState({people:n})},i._sharingStore=n.sharingStore,i._shareClickTime=n.shareClickTime,i._resize=n.resize,i._sharingClientMessenger=n.sharingClientMessenger,i.state={isExpanded:!1,groupsIsExpanded:!1,count:0,peoplePickerRecipients:[],groups:[],people:[],peoplePickerError:null,showActivityIndicator:!1,permissionsMap:{},viewState:P.e.notify},i._resizeTracker=new H.e(n.resize),i}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){var e=this,t=this.props;this._sharingStore.addListener(this._onStoreUpdate);var n=t.sharingInformation.sharingPrincipals,i=t.sharingInformation.sharingLinks.reduce(function(e,t){return e.concat(t.principals)},[]).concat(n).map(function(e){return{userId:e.loginName,name:e.primaryText,job:e.secondaryText,email:""!==e.email?e.email:e.loginName,principalType:e.type,image:e.imageUrl,rawPersonData:{Key:e.loginName,EntityData:{SPGroupID:e.id}}}}),r=i.filter(function(e){return e.principalType!==h.e.user}).map(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{checked:!1,expanded:!1,disabled:!0,groupId:e.rawPersonData.groupId,memberCount:null})});r.forEach(function(t){e._sharingStore.fetchMemberCount(t)});var o=i.filter(function(e){return e.principalType===h.e.user}),s={};o.concat(r).forEach(function(e){s[e.email]=M.e.hasAccess}),this.state.peoplePickerRecipients.filter(function(e){return e.principalType!==h.e.user}).forEach(function(t){e._sharingStore.fetchMemberCount(t)}),this.setState({isExpanded:!0,groupsIsExpanded:!0,count:0,peoplePickerRecipients:[],groups:r,people:o,peoplePickerError:null,permissionsMap:s,viewState:P.e.notify})},t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():T.b(this._shareClickTime,this.props.clientId,c.e.notify,this.props.scenarioId,this.props.correlationId),this.setState({groupsIsExpanded:!1,isExpanded:!1}),this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._renderPeoplePicker=function(){var e=this.state,t=this.props;return r.createElement("div",{className:Object(g.e)("od-Notify-PeoplePicker")},r.createElement(m.e,{defaultSelectedItems:e.peoplePickerRecipients,onChange:this._onPeoplePickerSelected,onResolvedSuggestions:this._onResolvedSuggestions,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:t.currentSettings.sharingLinkKind,error:e.peoplePickerError,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),sharingInformation:t.sharingInformation,permissionsMap:e.permissionsMap,clientId:t.clientId}))},t.prototype._computeTotalGroupsMembersCount=function(){var e=this.state,t=this._sharingStore.getMembersCounts();return e.groups.filter(function(e){return e.checked&&t[e.email]}).map(function(e){return t[e.email]}).reduce(function(e,t){return e+t},0)},t.prototype._computeTotalMemberCount=function(){var e=this._sharingStore.getMembersCounts(),t={};return this._allRecipients().forEach(function(e){t[e.email]||(t[e.email]=e)}),Object.keys(t).map(function(n){return t[n].principalType===h.e.user?1:e[n]||0}).reduce(function(e,t){return e+t},0)},t.prototype._allRecipients=function(){var e=this.state;return e.peoplePickerRecipients.concat(e.people.filter(function(e){return e.checked})).concat(e.groups.filter(function(e){return e.checked}))},t.prototype._showSuccessMessage=function(){this.setState(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{viewState:P.e.linkSuccess,showActivityIndicator:!1})})},t.prototype._renderGroup=function(e){return r.createElement(x,{clientId:this.props.clientId,group:e,updateCountCallback:this._updateGroupCount,updateCheckboxForGroup:this._updateCheckboxForGroup,engagementExtraData:this.props.engagementExtraData})},t.prototype._renderGroups=function(e){var t=this,n=this.state,a=n.groupsIsExpanded?" expanded ":"",i=n.groups.length>5?" scroll ":"";if(0!==e.length)return r.createElement("div",{className:Object(g.e)("od-Notify-groups-container")},r.createElement("div",{className:Object(g.e)("od-Notify-groups-expand")},r.createElement(v.e,{className:Object(g.e)("od-Notify-groupLabel")},p.ka),r.createElement(f.e,{className:"od-Notify-group-expand-icon",iconProps:{iconName:a?"ChevronUp":"ChevronDown"},onClick:this._onGroupsExpandClick})),this._displayTotalGroupsMembersCount(),r.createElement("div",{className:Object(g.e)("od-Notify-groups-recipient-container"+a+i)},a&&e.map(function(e){return r.createElement("div",{key:e.email,className:Object(g.e)("od-Notify-groups-listItem")},t._renderGroup(e))})))},t.prototype._renderPerson=function(e){return r.createElement(w,{clientId:this.props.clientId,person:e,updateCheckboxForPerson:this._updateCheckboxForPerson,engagementExtraData:this.props.engagementExtraData})},t.prototype._renderPeople=function(e){var t=this,n=this.state,a=n.people.length>5?" scroll ":"";return r.createElement("div",{className:Object(g.e)("od-Notify-people-container")},r.createElement(v.e,{className:Object(g.e)("od-Notify-peopleLabel")},p.Na),n.people.length>0&&r.createElement(S.e,{label:p.Ba,onChange:this._selectAllPeopleCheckbox,defaultChecked:!1,className:Object(g.e)("od-Notify-people-selectAll-checkbox")}),r.createElement("div",{className:Object(g.e)("od-Notify-people-recipient-container"+a)},e.map(function(e){return t._renderPerson(e)})))},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return r.createElement(u.e,{message:p.b})},t.prototype._renderNotification=function(){var e=this.props,t=e.sharingInformation,n=e.currentSettings,i={companyName:this._sharingStore.getCompanyName(),currentSettings:n,sharingInformation:t,clientId:e.clientId,onShareHintClick:null,linkRecipients:this._allRecipients(),customLabeledAudienceConfig:e.customLabeledAudienceConfig};return r.createElement(d.ShareNotification,Object(a.__assign)({},Object(R.e)(this.props),{shareType:s.e.share,itemName:t.item.name,linkUrl:null,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}))},t.prototype._displayTotalMemberCountString=function(){var e=this._computeTotalMemberCount();return this.state.groups.filter(function(e){return e.checked}).length>0?b.format(p.Fa,e):1===e?b.format(p.Ta):0===e?"":b.format(p.Ua,e)},t.prototype._tooManyRecipientsErrorString=function(){return p.ji},t.prototype._displayTotalMembersCountOrError=function(){return r.createElement(v.e,{className:Object(g.e)("od-Notify-totalMembersCount")},this._computeTotalMemberCount()>=N?this._tooManyRecipientsErrorString():this._displayTotalMemberCountString())},t.prototype._displayTotalGroupMemberCountString=function(){var e=this._computeTotalGroupsMembersCount();return 0===e?"":b.format(p.Ma,e)},t.prototype._displayTotalGroupsMembersCount=function(){return r.createElement(v.e,{className:Object(g.e)("od-Notify-totalGroupsMembersCount")},this._displayTotalGroupMemberCountString())},t.prototype._renderWarning=function(){var e=this._computeTotalMemberCount(),t=b.format(p.Pa,e);return e>20&&e<N&&r.createElement("div",{className:"od-Notify-recipientWarning-container"},r.createElement(U.e,{className:Object(g.e)("od-Notify-recipientWarning"),messageBarType:F.e.severeWarning,isMultiline:!0},t))},t.prototype._sendButtonError=function(){return r.createElement(v.e,null,p.ja)},t.prototype._renderNotifyMain=function(){var e=this.state,t=this.props,n=e.showActivityIndicator?" blocker":"",i=A.B(this.props.sharingInformation.item.name,10);return r.createElement("div",{className:"od-Notify"+n},r.createElement("div",{className:"od-Notify-headerAndMessage"},r.createElement(l.e,Object(a.__assign)({},Object(R.e)(this.props),{viewState:P.e.notify})),r.createElement(v.e,{className:Object(g.e)("od-Notify-message"),"aria-label":this.props.sharingInformation.item.name},b.format(p.Ha,i))),this._renderWarning(),!e.isExpanded&&r.createElement("div",null,r.createElement("div",{className:Object(g.e)("od-Notify-horizontalLine")}),r.createElement(y.e,{onClick:this._onExpandClick,className:Object(g.e)("od-Notify-show-link")},p.Co)),e.isExpanded&&r.createElement("div",null,this._renderGroups(e.groups),this._renderPeople(e.people),this._renderPeoplePicker(),r.createElement("div",{className:Object(g.e)("od-Notify-sendNotification-button")},r.createElement(E.e,{ctaLabel:p.xo,currentSettings:t.currentSettings,errorMessage:this._allRecipients().length<1||this._computeTotalMemberCount()>=N?this._sendButtonError():e.peoplePickerError,linkRecipients:this._allRecipients(),maximumMessageLength:1,maximumSubjectLength:1,messageText:"",subjectText:"",onSendLinkClicked:this._sendNotification,permissionsMap:e.permissionsMap,sendButtonType:L.e.button,sharingInformation:t.sharingInformation})),this._displayTotalMembersCountOrError()))},t.prototype._renderViews=function(){return this.state.viewState===P.e.linkSuccess?this._renderNotification():this._renderNotifyMain()},t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"";return r.createElement("div",{className:"od-Notify"+e},this._renderViews(),this._renderActivityIndicator())},t.contextTypes={resize:o.func.isRequired,strings:o.object.isRequired,sharingStore:o.object.isRequired,shareClickTime:o.number,sharingClientMessenger:o.object.isRequired},t}(r.Component);t.default=B},function(e,t,n){"use strict";n.r(t),n.d(t,"PermissionsList",function(){return X});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsList{max-height:inherit;overflow-y:auto}.od-PermissionsList-content{padding:0 20px;margin-top:5px}.od-PermissionsList-content.new{padding:24px;margin:0;padding-top:0}.od-PermissionsList-content-wac{padding:0 20px;margin-top:25px}.od-PermissionsList-content-wac.new{margin:0}.od-PermissionsList-emptyLinks{padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem;min-height:2.25rem}.od-PermissionsList-inheritance{margin:16px}[dir=ltr] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-left:8px}[dir=rtl] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-right:8px}[dir=ltr] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-right:8px}[dir=rtl] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-left:8px}.od-PermissionsList-linksListHolder .od-ShareLinkDetails--sectionHeader{margin-top:0}.od-PermissionsList-header{font-weight:400;font-size:.875rem;display:inline;position:relative}.od-PermissionsList-header.new{display:flex;padding:24px;align-items:center}.od-PermissionsList-header.mainHeader{display:flex;padding:14px}.od-PermissionsList-header-no-position{font-weight:400;font-size:14px;display:flex;position:relative;padding:20px}.od-PermissionsList-header-no-position.new{padding:24px}.od-ShareLinkDetails--sectionHeader{display:flex;flex-wrap:wrap;justify-content:space-between}.od-ShareLinkDetails--sectionHeader .ms-Icon{padding:0 5px;font-size:.875rem}.od-ShareLinkDetails--sectionHeader .ms-Icon--NoPadding{padding:0}.od-ShareLinkDetails--sectionHeader .ms-Icon--Add,.od-ShareLinkDetails--sectionHeader .ms-Icon--Info,.od-ShareLinkDetails--sectionHeader .ms-Icon--Share{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:.75rem}.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{margin:-5px 0;font-size:.875rem}[dir=ltr] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir=ltr] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:right}[dir=rtl] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir=rtl] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:left}.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess .od-ShareLinkDetails-Share-buttonText,.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share .od-ShareLinkDetails-Share-buttonText{font-size:.875rem;margin-right:9px}.od-ShareLinkDetails--sectionHeader .ms-Button{height:2rem}[dir=ltr] .od-PermissionsList-stopSharingText{margin-left:20px}[dir=rtl] .od-PermissionsList-stopSharingText{margin-right:20px}.ms-Button.od-PermissionsList-stopSharingButton{border:none;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding:0}.ms-Button.od-PermissionsList-stopSharingButton span.ms-Button-label{font-weight:400}.ms-Button.od-PermissionsList-stopSharingButton:active,.ms-Button.od-PermissionsList-stopSharingButton:focus,.ms-Button.od-PermissionsList-stopSharingButton:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:';background-color:none}.ms-Button.od-PermissionsList-stopSharingButton:active .ms-Button-textContainer,.ms-Button.od-PermissionsList-stopSharingButton:focus .ms-Button-textContainer,.ms-Button.od-PermissionsList-stopSharingButton:hover .ms-Button-textContainer{text-decoration:underline}@media screen and (-ms-high-contrast:active){.ms-Button.od-PermissionsList-stopSharingButton:active,.ms-Button.od-PermissionsList-stopSharingButton:focus,.ms-Button.od-PermissionsList-stopSharingButton:hover{border-color:highlight;color:highlight}}.od-PermissionsList-entities{padding-bottom:5px}.od-PermissionsList-advancedUrl{margin-bottom:16px}[dir=ltr] .od-PermissionsList-advancedUrl{text-align:right}[dir=rtl] .od-PermissionsList-advancedUrl{text-align:left}.od-PermissionsList-entities div:last-of-type{border:none}.od-PermissionsList-links>div:last-of-type ul.od-ShareLink-participants:last-of-type::after{height:0}.od-PermissionsList-principalGroup{outline:transparent;position:relative}.od-PermissionsList-principalGroup::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsList-principalGroup:focus:after{content:"";position:absolute;top:-.125rem;right:-.125rem;bottom:-.125rem;left:-.125rem;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-PermissionsList-addressBarDescription{display:inline-block;padding-top:20px;font-size:.75rem}.od-AddressBarLinkHint{padding-top:20px;padding-bottom:24px}.od-AddressBarLinkHint .od-ShareHint{margin:0}.od-AddressBarLinkHint .od-ShareLinkDescription .od-ShareLinkDescription-icon{font-size:.875rem;height:1.5rem;width:1.5rem;max-width:100px;max-height:100px}.od-AddressBarLinkHint .od-ShareLinkDescription .od-ShareLinkDescription-icon i{font-size:.875rem}.od-AddressBarLinkHint .od-ShareHintDetail .od-ShareHintDetail-status .od-ShareHintDetail-statusText{font-size:.75rem;line-height:1rem;overflow-wrap:anywhere}.od-AddressBarLinkHint .od-ShareHintDetail .od-ShareHintDetail-status .od-ShareHintDetail-chevron{font-size:.5rem}.ms-ContextualMenu-container .ms-ContextualMenu.ms-FocusZone.is-open{max-width:unset}"}]);var r=n(1863),o=n(1098),s=n(2579),c=n(2047);Object(i.n)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharePrincipal{padding:8px 0;display:flex;outline:0}.od-SharePrincipal-persona{display:inline-block;width:52px;height:52px}[dir=ltr] .od-SharePrincipal-persona{margin-right:8px}[dir=rtl] .od-SharePrincipal-persona{margin-left:8px}.od-SharePrincipal-persona .ms-Persona{height:50px}.od-SharePrincipal-persona .ms-Persona-imageArea{width:50px;height:50px;max-width:50px}.od-SharePrincipal-persona .ms-Persona-initials{line-height:50px;height:50px}.od-SharePrincipal-details{display:inline-block;vertical-align:top;width:200px}.od-SharePrincipal-details-primaryText{font-size:17px;font-weight:300;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-SharePrincipal-permissions{outline:transparent;position:relative;cursor:pointer;background:0 0;border:none;padding:0}.od-SharePrincipal-permissions::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-SharePrincipal-permissions:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-SharePrincipal-details-secondaryText,.od-SharePrincipal-permissions-role{font-size:12px;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharePrincipal-permissions-role{display:inline-block}.od-SharePrincipal-permissions-icon{display:inline-block;font-size:12px;margin-top:2px;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir=ltr] .od-SharePrincipal-permissions-icon{margin-left:4px}[dir=rtl] .od-SharePrincipal-permissions-icon{margin-right:4px}.od-SharePrincipal-deleteIcon{position:absolute;top:12px;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-SharePrincipal-deleteIcon{right:8px}[dir=rtl] .od-SharePrincipal-deleteIcon{left:8px}"}]);var d=n(1772),l=n(129),u=n(2452),f=n(1840),p=n(2576),m=n(1),_=n(1800),h=n(476),b=n(1801),g=function(e){function t(t,n){var a=e.call(this,t)||this;return a._onStopSharingClick=function(){a.setState({isUpdatingRole:!0}),a._store.updatePermissions(a.props.principal,p.e.none)},a.state={showContextualMenu:!1,isUpdatingRole:!1,roleText:a._computeInitialRoleText(t.principal)},a._store=n.sharingStore,a._onChangeRoleClick=a._onChangeRoleClick.bind(a),a._onPermissionsClick=a._onPermissionsClick.bind(a),a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._focusElement&&this.props.takeFocus&&this._focusElement.focus()},t.prototype.componentDidUpdate=function(){var e=this._computeInitialRoleText(this.props.principal);e!==this.state.previousRoleText&&this.setState({isUpdatingRole:!1,roleText:e,previousRoleText:this.state.roleText})},t.prototype.render=function(){var e=this,t=this.props.principal;return m.createElement("div",{className:"od-SharePrincipal",role:"presentation",ref:function(t){e._focusElement=t}},m.createElement(u.e,{className:"od-SharePrincipal-persona",hidePersonaDetails:!0,initialsColor:f.e.blue,primaryText:t.primaryText,size:f.n.regular,imageUrl:t.imageUrl}),m.createElement("div",{className:"od-SharePrincipal-details",role:"presentation"},m.createElement("div",{className:"od-SharePrincipal-details-primaryText"},t.primaryText),this._renderChangePermissionsButton(t)))},t.prototype._computeInitialRoleText=function(e){var t=this.props.principal.role;if("number"!=typeof t)return e.sharingLinkKind?b.l:"";switch(t){case p.e.edit:return b.oe;case p.e.review:return b._e;case p.e.view:return b.ge;case p.e.owner:return b.oi;default:return""}},t.prototype._computeRoleText=function(){return this.state.isUpdatingRole?b.js:this.state.roleText},t.prototype._renderChangePermissionsButton=function(e){var t=e.role;return this.state.isUpdatingRole||this.props.userRole!==p.e.owner||t!==p.e.edit&&t!==p.e.view&&t!==p.e.review?m.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()):m.createElement("button",{className:"od-SharePrincipal-permissions",onClick:this._onPermissionsClick,"data-is-focusable":!0,"aria-describedby":"changePermissionsDescription".concat(e.id)},m.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()),this._renderChevron(e.role),this._renderContextualMenu(e.role),m.createElement("div",{role:"tooltip","aria-hidden":"true",className:"od-Share-screenReaderOnly",id:"changePermissionsDescription".concat(e.id)},"Set permissions for "+e.primaryText))},t.prototype._renderChevron=function(e){if(e===p.e.edit||e===p.e.view||e===p.e.review)return m.createElement("div",{className:"od-SharePrincipal-permissions-icon"},m.createElement(h.e,{iconName:"ChevronDown"}))},t.prototype._renderContextualMenu=function(e){var t,n,a=this;switch(e){case p.e.view:t=p.e.edit,n=b.A,p.e.review,b.i;break;case p.e.review:t=p.e.edit,n=b.A,p.e.view,b.Oe;break;case p.e.edit:t=p.e.view,n=b.Oe,p.e.review,b.i}if(this.state.showContextualMenu)return m.createElement(d.e,{items:[{key:"editable1",name:n,onClick:this._onChangeRoleClick.bind(this,t)},{key:"stopSharing",name:"".concat(b.Ds),onClick:this._onStopSharingClick}],onDismiss:function(){a.setState({showContextualMenu:!1})},directionalHint:l.e.bottomLeftEdge,isBeakVisible:!0,target:this.state.target})},t.prototype._onChangeRoleClick=function(e){this.setState({isUpdatingRole:!0,previousRoleText:this.state.roleText}),this._store.updatePermissions(this.props.principal,e)},t.prototype._onPermissionsClick=function(e){var t=this.props.principal.role;(t===p.e.edit||t===p.e.view||t===p.e.review)&&this.setState({showContextualMenu:!0,target:e.nativeEvent.target})},t.contextTypes={sharingStore:_.object.isRequired},t}(m.Component),v=n(2154),y=n(1992),S=n(1830),D=n(2313),I=n(1818),x=n(1853),C=n(1806),O=n(1786),w=n(434),E=n(1750),A=n(345),L=n(1826),k=n(435),M=n(112),P=n(1624),T=n(1644),U=n(1613),F=n(2379),H=n(173),R=n(39),N=n(1312),B=n(1796),j=n(8),V=n(430),z=n(1804),G=n(1817),K=n(1885),W=n(2059),q=n(1802),Q=n(1831),Y=n(2140),J={ODB:1466},X=function(e){function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=m.createRef(),i._onStopSharingLinkClick=function(){i.setState({showStopSharingDialog:!0})},i._stopSharing=function(){i.props.onStopSharingClicked(),i._sharingStore.stopSharing(),i._addressBarLink=void 0,i.setState({showStopSharingText:!1}),i._onStopSharingDialogDismiss()},i._onStopSharingDialogDismiss=function(){i.setState({showStopSharingDialog:!1})},i._showPermissionsList=function(){i.setState({showLinkDetails:!1,showAddressBarLinkDetails:!1})},i._onRemoveLink=function(){i.setState({linkRemovedText:b.Fn}),setTimeout(function(){i.setState({linkRemovedText:""})},3e3)},i._onLinkSelected=function(e){i.setState({currentSharingLink:e,showLinkDetails:!0})},i._onShareClick=function(e){i._engagementHelper.manageAccessLinkSectionShareClicked(i.props.engagementExtraData),i._targetElement=e.target,i._mode=o.e.share,i.setState({showShare:!0})},i._onGrantAccessClick=function(e){i._engagementHelper.manageAccessGrantAccessClicked(i.props.engagementExtraData),i._targetElement=e.target,i._mode=o.e.addPeople,i.setState({showGrantAccess:!0})},i._onDismiss=function(){i._mode===o.e.share?i.setState({showShare:!1}):i.setState({showGrantAccess:!1}),i._onDismissFromContext()},i._onAddressBarLinkClicked=function(){i.setState(function(){return Object(a.__assign)(Object(a.__assign)({},i.state),{showAddressBarLinkDetails:!0})})},i._shareClickTime=n.shareClickTime,i._sharingStore=n.sharingStore,i._resize=n.resize,i._onDismissFromContext=n.onDismiss,i._mode=i.props.mode,i._addressBarLink=null,i._engagementHelper=i._sharingStore.getEngagementHelper();var r=!1;if(i._sharingStore&&i._sharingStore.isShared&&i._sharingStore.isOwner&&i._sharingStore.getSharedObjectType&&(r=i._sharingStore.isShared()&&i._sharingStore.isOwner()&&i._sharingStore.getSharedObjectType()===K.e.file),i.state={showStopSharingText:r,showLinkDetails:!1,showAddressBarLinkDetails:!1,showStopSharingDialog:!1,currentSharingLink:void 0,linkRemovedText:"",showShare:!1,showGrantAccess:!1,selectedKey:s.e.existing},i._isShareCommandsExperimentOn=C.o(i.props.clientId)||C.s(i.props.clientId),i._isLinkSettingsEditPanelEnabled=i._sharingStore.showManageAccess()&&(i.props.mode===o.e.manageAccess||i.props.mode===o.e.share||i.props.mode===o.e.addPeople),V.e.isFeatureEnabled(J)){var c=i.props.sharingInformation.sharingLinks?i.props.sharingInformation.sharingLinks.filter(function(e){return e.isAddressBarLink}):[];c.length>0&&(i._addressBarLink=c[0])}return i._hasBackButton=i.props.mode!==o.e.manageAccess,i._resizeTracker=new Q.e(n.resize),i}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._resizeIfNeeded(),this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():L.b(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId,this.props.correlationId)},t.prototype.componentDidUpdate=function(){this.props.hideElementsInManageAccess(this.state.showLinkDetails),this._resize(),this._resizeIfNeeded()},t.prototype.getChildContext=function(){return{onDismiss:this._onDismiss}},t.prototype.render=function(){var e,t=this.props.sharingInformation,n=this.props.sharingInformation.sharingLinks.reduce(function(e,t){return e+(t.isActive?1:0)},-1)>0;if(t.hasPermissionsInformation)if(t.isShared){var a=t.sharedObjectType===K.e.list,i=this.props.mode!==o.e.manageAccess||q.e()?"od-PermissionsList-content":"od-PermissionsList-content-wac";i+=q.U()?" new":"";var r=!this._sharingStore.isConsumerLists()||j.t.isActivated("b24742af-4a9c-481e-b41f-342b539fd775","09/29/2021","turn off Manage Access for consumer lists");e=m.createElement("div",{className:i,"aria-label":b.Kn},m.createElement("div",{className:"od-PermissionsList-links"},this._renderLinks()),!a&&m.createElement("div",{className:"od-PermissionsList-addressbar"},this._renderAddressBarAccess()," "),r&&m.createElement("div",{className:"od-PermissionsList-entities"},this._renderPrincipals(n)),this.props.advancedUrl&&this._renderAdvancedUrl())}else e=m.createElement("div",null,b.Da);else e=m.createElement("div",{className:"od-Share-spinnerHolder"},m.createElement(O.e,{className:"od-Share-spinner",label:b.Me,type:w.t.large}));var s=t.hasInheritedLinks,c=(this.props.showHeader||!C.o(this.props.clientId))&&!this.state.showLinkDetails&&!this.state.showAddressBarLinkDetails;return m.createElement("div",{tabIndex:-1,ref:this._topLevelDivRef,className:"od-PermissionsList od-Share-noFocusBorder"},G.e(b.Kn+", "+this.props.sharingInformation.item.name,"assertive","alert",!0),c&&this._renderHeader(),this.state.showStopSharingText&&!this.state.showLinkDetails&&!this.state.showAddressBarLinkDetails&&this._renderStopSharing(),s&&this._renderInheritance(n),this.state.showLinkDetails||this.state.showAddressBarLinkDetails?this._renderLinkDetails():e)},t.prototype._renderStopSharing=function(){return m.createElement("div",{className:"od-PermissionsList-stopSharing"},this.state.showStopSharingDialog&&m.createElement(Y.e,{onDismiss:this._onStopSharingDialogDismiss,showStopSharingDialog:this.state.showStopSharingDialog,stopSharing:this._stopSharing.bind(this)}),m.createElement("div",{className:"od-PermissionsList-stopSharingText"},this.state.showStopSharingText&&!this.state.showLinkDetails&&m.createElement(P.e,{iconProps:{iconName:"Blocked2"},className:"od-PermissionsList-stopSharingButton",onClick:this._onStopSharingLinkClick},b.Ds)))},t.prototype._renderAdvancedUrl=function(){return this.props.advancedUrl&&m.createElement("div",{className:"od-PermissionsList-advancedUrl"},m.createElement("a",{target:"_blank",href:this.props.advancedUrl,onClick:this._sendAdvancedClickEngagementEvent.bind(this)},b.E))},t.prototype._sendAdvancedClickEngagementEvent=function(){this._engagementHelper.manageAccessAdvancedLinkClicked(this.props.engagementExtraData)},t.prototype._renderHeader=function(){var e=this.props.mode!==o.e.manageAccess||q.e()?"od-PermissionsList-header mainHeader":"od-PermissionsList-header-no-position",t=q.U()?" new":"";return m.createElement("div",{className:e+t},this._hasBackButton&&G.t(m.createElement(T.e,{className:"od-Share-backButton"+t,id:"od-PermissionsList-backButton",onClick:this.props.backButtonClicked,iconProps:{iconName:"Back"},ariaLabel:b.ie}),b.ie,{position:l.e.bottomLeftEdge,targetElementId:"od-PermissionsList-backButton"}),m.createElement(r.e,Object(a.__assign)({},Object(S.e)(this.props),{item:this.props.sharingInformation.item,viewState:I.e.permissionsList,"data-is-focusable":!0,mode:this.props.mode,hasBackButton:this._hasBackButton})))},t.prototype._renderInheritance=function(e){var t,n;return this.props.sharingInformation.item.itemType===H.t.Folder?n=b.yn:this.props.sharingInformation.item&&(n=b.vn),t=e?R.format(b.u,n):R.format(b.Ya,n),m.createElement("div",{className:"od-PermissionsList-inheritance"},m.createElement(F.e,null,t))},t.prototype._renderLinkDetails=function(){if(this.state.showAddressBarLinkDetails){var e=this.props.sharingInformation.addressBarLinkSettings;return m.createElement(c.e,{companyName:this.props.companyName,link:this._addressBarLink,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,showPermissionsList:this._showPermissionsList,enableLinkSettings:!0,isAddressBarLink:!0,addressBarLinkSettings:e,engagementExtraData:this.props.engagementExtraData,inlineInDialog:this.props.showHeader})}return m.createElement(c.e,{key:this.state.currentSharingLink.shareId,mode:this.props.mode,companyName:this.props.companyName,link:this.state.currentSharingLink,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this._isLinkSettingsEditPanelEnabled,showMoreOptions:!1,onShowLinkDetailsClicked:this._onLinkSelected,linkDetailsView:!0,showPermissionsList:this._showPermissionsList,onRemoveLink:this._onRemoveLink,engagementExtraData:this.props.engagementExtraData,inlineInDialog:this.props.showHeader})},t.prototype._renderLinks=function(){var e=this,t=this.props.sharingInformation.sharingLinks,n=!1;return m.createElement("div",{className:"od-PermissionsList-linksListHolder"},this._isLinkSettingsEditPanelEnabled&&m.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},m.createElement("span",null,m.createElement(h.e,{iconName:"Link","aria-label":b.kn,className:"ms-Icon ms-Icon--Link",role:"img","aria-hidden":"true"}),m.createElement("h2",{className:"od-PermissionsList-header"},b.Bn),G.t(m.createElement("span",null,m.createElement(h.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-label":b.Bn+" "+b.jn,role:"img",tabIndex:0})),b.jn,{tooltipId:"od-ShareLinkDetails-tooltip-links",position:l.e.topCenter})),!this.props.isInfectedFile&&this._isShareCommandsExperimentOn&&this.props.mode===o.e.manageAccess&&m.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-share"},m.createElement(U.e,{iconProps:{iconName:"Share"},"aria-label":b.Ao,onClick:!q.c()&&this.props.centeredManageAccessEnabled?this.props.shareButtonClicked:this._onShareClick.bind(this),"aria-haspopup":!0},m.createElement("span",{className:"od-ShareLinkDetails-Share-buttonText"},b.Ao)),this.state.showShare&&this._renderShare())),m.createElement("ul",{className:"od-PermissionsList-links"},t.map(function(t,a){if(t.audience!==s.e.specificPeople&&t.isActive&&!t.isAddressBarLink)return n=!0,m.createElement("li",{key:t.shareId},m.createElement(c.e,{index:a,key:t.shareId,mode:e.props.mode,companyName:e.props.companyName,link:t,clientId:e.props.clientId,sharingInformation:e.props.sharingInformation,groupsMemberCount:e.props.groupsMemberCount,linkRecipients:e.props.linkRecipients,enableLinkSettings:e._isLinkSettingsEditPanelEnabled,showMoreOptions:e._isLinkSettingsEditPanelEnabled,onShowLinkDetailsClicked:e._onLinkSelected,linkDetailsView:!1,showPermissionsList:e._showPermissionsList,engagementExtraData:e.props.engagementExtraData,inlineInDialog:e.props.showHeader}))}),!n&&this._renderNoSharingLinks()),this._isLinkSettingsEditPanelEnabled&&m.createElement("div",null,G.e(n?"":b.ha,"polite","alert",!0),G.e(this.state.linkRemovedText,"assertive","alert",!0)))},t.prototype._renderNoSharingLinks=function(){if(this._isLinkSettingsEditPanelEnabled)return m.createElement("div",{className:"od-PermissionsList-emptyLinks"},b.ha)},t.prototype._renderPrincipals=function(e){var t=this,n=this.props.sharingInformation,a=n.sharingPrincipals.slice(),i=a.filter(function(e){return e.type===x.e.user}),r=a.filter(function(e){return e.type===x.e.securityGroup||e.type===x.e.sharePointGroup});return this._engagementHelper.manageAccessNumberOfSharingPrincipals({numberOfUsers:i.length,numberOfGroups:r.length}),this._isLinkSettingsEditPanelEnabled?m.createElement("div",{className:"od-PermissionsList-entitiesListHolder"},this._isLinkSettingsEditPanelEnabled&&m.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},m.createElement("span",null,m.createElement(h.e,{iconName:"PlayerSettings","aria-label":b.wr,className:"ms-Icon ms-Icon--PlayerSettings",role:"img","aria-hidden":"true"}),m.createElement("h2",{className:"od-PermissionsList-header"},b.wr),G.t(m.createElement("span",null,m.createElement(h.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-label":b.wr+" "+b.Er,role:"img",tabIndex:0})),b.Er,{tooltipId:"od-ShareLinkDetails-tooltip-principals"})),!this.props.isInfectedFile&&this._isShareCommandsExperimentOn&&this.props.mode===o.e.manageAccess&&m.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-grantAccess"},G.t(m.createElement(T.e,{className:"ms-Icon--NoPadding",iconProps:{iconName:"Add"},"aria-label":b.S,onClick:!q.c()&&this.props.centeredManageAccessEnabled?this.props.grantAccessClicked:this._onGrantAccessClick.bind(this),"aria-haspopup":!0}),b.S),this.state.showGrantAccess&&this._renderShare())),m.createElement("ul",{className:"od-PermissionsList-entities","aria-label":b.ir},m.createElement(E.e,{direction:A.e.vertical,isInnerZoneKeystroke:function(e){return e.which===Object(k.t)(M.e.right)}},a.map(function(e,a){return m.createElement("li",{key:e.id},m.createElement(v.e,{key:e.id,principal:e,userRole:n.userRole,clientId:t.props.clientId,mode:o.e.manageAccess,sharingInformation:n,engagementExtraData:t.props.engagementExtraData}))})))):m.createElement("ul",{className:"od-PermissionsList-entities",role:"list","aria-label":b.ir},a.map(function(a,i){return m.createElement("li",{key:a.id,tabIndex:0,"aria-atomic":!0,"aria-live":"assertive",className:"od-PermissionsList-principalGroup"},m.createElement(g,{principal:a,takeFocus:!e&&0===i,userRole:n.userRole,clientId:t.props.clientId,sharingInformation:n}))}))},t.prototype._renderShare=function(){var e;return m.createElement(N.e,{target:this._targetElement,preventDismissOnScroll:!0,role:"alert","aria-live":"assertive",directionalHint:l.e.bottomCenter,onDismiss:this._onDismiss},m.createElement(B.e,{isClickableOutsideFocusTrap:!0},m.createElement(D.e,{mode:this._mode,hideShareDialogOverflowButton:!0,clientId:this.props.clientId,maxWidth:!q.oe()||!1===(null===(e=this.props.hostOptions)||void 0===e?void 0:e.enableWiderDialog)||C.u(this.props.clientId)?z.t:z.n})))},t.prototype._renderAddressBarAccess=function(){if(V.e.isFeatureEnabled(J)){var e=this.props.sharingInformation.addressBarLinkSettings;if(Object(W.e)(this.props.sharingInformation.fileExtension),e&&this._addressBarLink)return m.createElement("div",{className:"od-PermissionsList-addressBarAccess","aria-label":b.O},m.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader"},b.C),m.createElement("div",{className:"od-PermissionsList-addressBarDescription"},b.O),m.createElement("div",{className:"od-AddressBarLinkHint"},m.createElement(y.e,{clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:null,onShareHintClick:this._onAddressBarLinkClicked,sharingInformation:this.props.sharingInformation,linkRecipients:this.state.currentSharingLink?Object(z.S)(this.state.currentSharingLink):[],customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:this._addressBarLink})))}},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.contextTypes={shareClickTime:_.number,sharingStore:_.object.isRequired,resize:_.func.isRequired,sharingClientMessenger:_.object.isRequired,onDismiss:_.func},t.childContextTypes={onDismiss:_.func},t}(m.Component);t.default=X},function(e,t,n){"use strict";n.r(t),n.d(t,"AddPeopleView",function(){return s}),n.d(t,"AddPeople",function(){return N});var a=n(0),i=n(17);Object(i.n)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}@keyframes bounce{0%{transform:translateX(-50%) scaleX(.8) scaleY(.8);opacity:0}60%{transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;animation-timing-function:ease-out}100%{transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;animation-timing-function:ease-in}}.od-AddPeople{padding-bottom:24px}.od-AddPeople.blocker{position:relative}.od-AddPeople.blocker:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-AddPeople.wide{min-width:480px}@media (max-width:480px){.od-AddPeople.wide{min-width:320px}}.od-AddPeople .od-Share-PeoplePicker .ms-BasePicker-input{font-size:.875rem;height:2.5rem;width:100%}.od-AddPeople-Success{display:flex;flex-flow:column nowrap;align-items:center;justify-content:center}.od-AddPeople-Success .od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;transform:translateX(-50%) scale(.5,.5);transform-origin:50% 50%;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.3125rem;border-radius:50%;width:2.75rem;height:2.75rem;animation:bounce .45s;animation-fill-mode:both;display:flex;align-items:center;justify-content:center;margin-left:2.75rem;background-color:"},{theme:"shareSuccessIcon",defaultValue:"#498205"},{rawString:"}.od-AddPeople-Success .od-AddPeople-SuccessMessage{font-weight:500;font-size:1.25rem}.od-AddPeople-Failure{padding:24px 16px 0 16px;font-size:.875rem}.od-AddPeople-NotAllowed{padding:0 16px;font-size:.875rem}.od-AddPeople-NotAllowed button{font-size:.875rem;height:2rem}"}]);var r=n(1098),o=n(1);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AddPeople-Edit-Header{width:100%;margin-bottom:.75rem}.od-AddPeople-Edit-Header.new{padding:24px;display:flex;width:inherit;align-items:center;margin:0}.od-AddPeople-Edit-Header-relative{margin-bottom:.75rem;position:relative;display:flex;padding:14px}.od-AddPeople-Edit-Header-relative.new{padding:24px;display:flex;width:inherit;align-items:center;margin:0}.od-AddPeople-Edit-Section{margin:0 16px 0 16px;display:flex;flex-flow:column nowrap}.od-AddPeople-Edit-Section .od-AddPeople-Edit-Section-PermissionAlert{margin-bottom:8px}.od-AddPeople-Edit-Section .ms-TextField-wrapper{margin:6px 0}.od-AddPeople-Edit-Section.new{margin:0;padding:0 24px}.od-AddPeople-Message{margin-top:12px}.od-AddPeople-Message div{border-color:transparent}.od-AddPeople-Message textarea{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";padding:0}.od-PeoplePicker-RoleSelector-wrapper{display:flex;align-items:flex-start}.od-AddPeople-NotificationSelector{align-self:flex-start;margin-top:12px;margin-bottom:12px}[dir=ltr] .od-AddPeople-NotificationSelector .ms-Checkbox-text{margin-left:4px}[dir=rtl] .od-AddPeople-NotificationSelector .ms-Checkbox-text{margin-right:4px}[dir=ltr] .od-AddPeople-NotificationSelector .ms-Checkbox-checkbox{margin-right:4px}[dir=rtl] .od-AddPeople-NotificationSelector .ms-Checkbox-checkbox{margin-left:4px}.od-AddPeople-AddButton{align-self:flex-start;font-size:.875rem;height:2rem;padding:0 1rem}"}]);var s,c=n(1863),d=n(1644),l=n(1642),u=n(2578),f=n(1818),p=n(1801),m=n(1954),_=n(2052),h=n(2053),b=n(1839),g=n(2379),v=n(2112),y=n(2576),S=n(2125),D=n(1800),I=n(1817),x=n(2058),C=n(1831),O=n(1830),w=n(1804),E=n(2144),A=n(1834),L=n(1802),k=n(129),M=n(21),P=Object(L.c)(),T=function(e){function t(t,n){var i,r=e.call(this,t)||this;r._peoplePickerHasUnresolvedText=!1,r._topLevelDivRef=o.createRef(),r._onPeoplePickerChange=function(e){r.setState(function(t,n){var i=b.o({selectedItems:e,sharingLinkKind:u.e.direct,canAddExternalPrincipal:n.sharingInformation.canAddExternalPrincipal,sharingInformation:n.sharingInformation,viewPolicyTipCallback:function(){return null}}),o=r.state.notifyRecipients||e.filter(function(e){return e.isExternal}).length>0;return Object(a.__assign)(Object(a.__assign)({},t),{people:e,notifyRecipients:o,peoplePickerError:i})})},r._onPeoplePickerInputChange=function(e){r._peoplePickerHasUnresolvedText=""!==e},r._onMessageChange=function(e,t){r.setState({messageText:t})},r._validateMessage=function(e){var t,n=Object(w.p)(e);return r.setState({messageText:e}),n<=E.e?(t="",r.setState({shareMessageError:!1})):(t=n+"/"+E.e,r.setState({shareMessageError:!0})),t},r._onRoleSelectorChange=function(e){r.setState({roleSelection:e})},r._onAllowEditChange=function(e,t){r.setState({notifyRecipients:t})},r._onAddButtonClick=function(){if(r._peoplePickerHasUnresolvedText)r.setState(Object(a.__assign)(Object(a.__assign)({},r.state),{peoplePickerError:o.createElement("span",null,p.Ns)}));else{var e=r.state.messageText||null;r._store.addPeople(r.state.people,r.state.roleSelection,r.state.notifyRecipients,e),r.props.onLoading&&r.props.onLoading({notifiedRecipients:r.state.notifyRecipients,requestedAccess:r.userRequiresAccessApproval()})}},r._store=n.sharingStore,r._resize=n.resize,r._store.addListener(function(){var e=r._store.getAddPeopleResult();if(null!==e){var t=e===x.e.AccessRequestsQueued||e===x.e.CompletedSuccessfully,n=r.userRequiresAccessApproval();t&&r.props.onSuccess?r.props.onSuccess({notifiedRecipients:r.state.notifyRecipients,requestedAccess:n}):r.props.onFailure&&r.props.onFailure({notifiedRecipients:r.state.notifyRecipients,requestedAccess:n})}}),i=r.props.sharingInformation.userRole===y.e.owner?y.e.edit:r.props.sharingInformation.userRole;var s=b.o({selectedItems:r.props.currentSettings.specificPeople,sharingLinkKind:u.e.direct,canAddExternalPrincipal:r.props.sharingInformation.canAddExternalPrincipal,sharingInformation:r.props.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked});return r.state={people:[],messageText:"",roleSelection:i,notifyRecipients:!0,peoplePickerError:s,shareMessageError:!1},r._resizeTracker=new C.e(n.resize),r}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()},t.prototype.render=function(){var e=Object(L.U)()?" new":"";return o.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople-Edit"},this._renderHeader(),o.createElement("div",{className:"od-AddPeople-Edit-Section"+e},this.userRequiresAccessApproval()&&this._renderRequestAccessAlert(),this._renderPeoplePicker(),!1,this._renderMessageArea(),this._renderNotificationSelector(),this._renderAddButton()))},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype.isAddButtonEnabled=function(){return this.state.people.length>0&&null===this.state.peoplePickerError&&!1===this.state.shareMessageError},t.prototype.userRequiresAccessApproval=function(){return this.props.sharingInformation.requiresAccessApproval},t.prototype.numberSelectedUnverifiedExternals=function(){return this.state.people.filter(function(e){return Object(b.r)(e)}).length},t.prototype._getRoleSelectorProps=function(e){return{menuPermissionOptions:Object(A.e)({sharingInformation:this.props.sharingInformation,scenarioId:this._store.getScenarioId()}),sharingRole:this.state.roleSelection,mode:r.e.addPeople,clientId:this.props.clientId,ariaLabel:p.D,showStopSharing:!1,onRoleChange:this._onRoleSelectorChange,roleSelectorAs:e?h.e:_.e}},t.prototype._renderPeoplePicker=function(){var e=this.state.people,t=b.n(e),n=b.a(e,0);return o.createElement("div",{className:"od-Share-PeoplePicker"},o.createElement(m.e,{defaultSelectedItems:this.state.people,error:this.state.peoplePickerError,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t,oversharingGroupsWarning:n,pickerSettings:this.props.sharingInformation.peoplePickerSettings,sharingLinkKind:u.e.direct,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,allowSPGroups:!0,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:null,onInputChange:this._onPeoplePickerInputChange,roleSelectorProps:this._getRoleSelectorProps(!0),renderRoleSelector:!0}))},t.prototype._renderHeader=function(){var e=P?"od-AddPeople-Edit-Header":"od-AddPeople-Edit-Header-relative",t=Object(L.U)()?" new":"";return o.createElement("div",{className:e+t},!P&&this.props.centeredManageAccessEnabled&&I.t(o.createElement(d.e,{className:"od-Share-backButton"+t,id:"od-EditView-backButton",onClick:this.props.backButtonClicked,iconProps:{iconName:"Back"},ariaLabel:p.ie}),p.ie,{position:k.e.bottomLeftEdge,targetElementId:"od-PermissionsList-backButton"}),o.createElement(c.e,Object(a.__assign)({},Object(O.e)(this.props),{item:this.props.sharingInformation.item,hasBackButton:!P&&this.props.centeredManageAccessEnabled,hideShareDialogOverflowButton:!0,viewState:f.e.addPeople})))},t.prototype._renderMessageArea=function(){if(this.state.notifyRecipients)return o.createElement(v.e,{borderless:!0,className:"od-AddPeople-Message",disabled:!this.state.notifyRecipients,placeholder:p.Jn,ariaLabel:p.Yn,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,styles:{field:{fontSize:".875rem",lineHeight:" 1.0625rem",selectors:{"::placeholder":{fontSize:".875rem"}},borderColor:"transparent",border:"none"}}})},t.prototype._renderNotificationSelector=function(){var e=this.numberSelectedUnverifiedExternals()>0;return o.createElement(S.e,{className:"od-AddPeople-NotificationSelector",disabled:e,label:p.Ra,onChange:this._onAllowEditChange,checked:this.state.notifyRecipients,styles:{text:{fontSize:"0.875rem",lineHeight:"1.25rem"},checkbox:{width:"1.25rem",height:"1.25rem"},checkmark:{fontSize:"0.875rem"}}})},t.prototype._renderAddButton=function(){var e=p.v,t=Object(M.L)();return o.createElement(l.e,{disabled:!this.isAddButtonEnabled(),onClick:this._onAddButtonClick,className:"od-AddPeople-AddButton",styles:{labelDisabled:t.semanticColors.primaryButtonTextDisabled}},e)},t.prototype._renderRequestAccessAlert=function(){return o.createElement(g.e,{className:"od-AddPeople-Edit-Section-PermissionAlert"},p.so)},t.contextTypes={sharingStore:D.object.isRequired,resize:D.func.isRequired},t}(o.Component),U=n(1934),F=n(476),H=n(1826),R=n(1919);!function(e){e[e.edit=0]="edit",e[e.successGrantingPermissions=1]="successGrantingPermissions",e[e.successRequestingPermissions=2]="successRequestingPermissions",e[e.failure=3]="failure",e[e.notAllowed=4]="notAllowed"}(s||(s={}));var N=function(e){function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=o.createRef(),i._onLoading=function(e){i.setState(function(t,n){var i;return t.view===s.edit?(i=e.requestedAccess?p.g:e.notifiedRecipients?p.p:p.f,Object(a.__assign)(Object(a.__assign)({},t),{loading:!0,message:i})):t})},i._onSuccess=function(e){var t,n;e.requestedAccess?(t=p.c,n=s.successRequestingPermissions):(t=e.notifiedRecipients?p.x:p.I,n=s.successGrantingPermissions),i.setState({view:n,message:t,loading:!1}),i._store.getEngagementHelper().log(R.a.Completed,{accessRequested:e.requestedAccess}),i._sharingClientMessenger?i._sharingClientMessenger.sendShareAddPeopleCompleted(!0,t):H.e(!0,t)},i._onFailure=function(e){var t=p.y;i.setState({view:s.failure,message:t,loading:!1}),i._sharingClientMessenger?i._sharingClientMessenger.sendShareAddPeopleCompleted(!1,t):H.e(!1,t)},i._store=n.sharingStore,i._shareClickTime=n.shareClickTime,i._resize=n.resize,i._dismiss=n.onDismiss,i._sharingClientMessenger=n.sharingClientMessenger;var r=!1===t.sharingInformation.canAddExternalPrincipal&&!1===t.sharingInformation.canAddInternalPrincipal&&!1===t.sharingInformation.canRequestAccessForGrantAccess;return i.state={message:"",view:r?s.notAllowed:s.edit,loading:!1},i._resizeTracker=new C.e(n.resize),i}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._sharingClientMessenger?this._sharingClientMessenger.sendShareReady():H.b(this._shareClickTime,this.props.clientId,r.e.addPeople,this.props.scenarioId,this.props.correlationId),this._resizeIfNeeded()},t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()},t.prototype.render=function(){return o.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople ".concat(this.state.loading?" blocker":"")},this.renderView(),this.state.loading?o.createElement(U.e,{message:this.state.message}):null)},t.prototype.renderView=function(){switch(this.state.view){case s.edit:return o.createElement(T,Object(a.__assign)({},Object(O.e)(this.props),{centeredManageAccessEnabled:this.props.centeredManageAccessEnabled,backButtonClicked:this.props.backButtonClicked,sharingInformation:this.props.sharingInformation,onLoading:this._onLoading,onSuccess:this._onSuccess,onFailure:this._onFailure,currentSettings:this.props.currentSettings,onViewPolicyTipClicked:this.props.onViewPolicyTipClicked,onManageExistingAccessClick:this.props.onManageExistingAccessClick}));case s.successGrantingPermissions:return this._renderSuccessGranting();case s.successRequestingPermissions:return this._renderSuccessRequesting();case s.failure:return this._renderFailure();case s.notAllowed:return this._renderNotAllowed()}},t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._renderSuccessGranting=function(){return o.createElement("div",{className:"od-AddPeople-Success"},o.createElement(c.e,Object(a.__assign)({},Object(O.e)(this.props),{viewState:f.e.notify,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),o.createElement("div",{className:"od-ShareNotification-icon"},o.createElement(F.e,{iconName:"CheckMark",styles:{root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}}})),o.createElement("h1",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),o.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))},t.prototype._renderSuccessRequesting=function(){return o.createElement("div",{className:"od-AddPeople-Success"},o.createElement(c.e,Object(a.__assign)({},Object(O.e)(this.props),{viewState:f.e.notify,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),o.createElement(F.e,{className:"od-ShareNotification-icon",iconName:"PeopleAlert"}),o.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),o.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))},t.prototype._renderFailure=function(){return o.createElement("div",{className:"od-AddPeople-Failure"},o.createElement(c.e,Object(a.__assign)({},Object(O.e)(this.props),{viewState:f.e.notify,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),o.createElement("p",null,this.state.message))},t.prototype._renderNotAllowed=function(){var e=this;return o.createElement(o.Fragment,null,o.createElement(c.e,Object(a.__assign)({},Object(O.e)(this.props),{hideShareDialogOverflowButton:!0,title:p.da,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),o.createElement("div",{className:"od-AddPeople-NotAllowed"},o.createElement("p",null,p.la),o.createElement("p",null,p.ua),o.createElement(l.e,{autoFocus:!0,onClick:function(){e._dismiss()}},p.qa)))},t.contextTypes={sharingStore:D.object.isRequired,shareClickTime:D.number,resize:D.func.isRequired,onDismiss:D.func.isRequired,sharingClientMessenger:D.object.isRequired},t}(o.Component);t.default=N},,function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(1526),i=n(0),r=n(1),o=n(809),s=n(587),c=Object(o.e)(),d=function(e){function t(t){var n=e.call(this,t)||this;n._onRenderProgress=function(e){var t=n.props,a=t.ariaLabel,i=t.ariaValueText,o=t.barHeight,s=t.className,d=t.description,l=t.label,u=void 0===l?n.props.title:l,f=t.styles,p=t.theme,m="number"==typeof n.props.percentComplete?Math.min(100,Math.max(0,100*n.props.percentComplete)):void 0,_=c(f,{theme:p,className:s,barHeight:o,indeterminate:void 0===m}),h={width:void 0!==m?m+"%":void 0,transition:void 0!==m&&m<.01?"none":void 0},b=void 0!==m?0:void 0,g=void 0!==m?100:void 0,v=void 0!==m?Math.floor(m):void 0;return r.createElement("div",{className:_.itemProgress},r.createElement("div",{className:_.progressTrack}),r.createElement("div",{className:_.progressBar,style:h,role:"progressbar","aria-describedby":d?n._descriptionId:void 0,"aria-label":a,"aria-labelledby":u?n._labelId:void 0,"aria-valuemin":b,"aria-valuemax":g,"aria-valuenow":v,"aria-valuetext":i}))};var a=Object(s.e)("progress-indicator");return n._labelId=a+"-label",n._descriptionId=a+"-description",n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.barHeight,n=e.className,a=e.label,o=void 0===a?this.props.title:a,s=e.description,d=e.styles,l=e.theme,u=e.progressHidden,f=e.onRenderProgress,p=void 0===f?this._onRenderProgress:f,m="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,_=c(d,{theme:l,className:n,barHeight:t,indeterminate:void 0===m});return r.createElement("div",{className:_.root},o?r.createElement("div",{id:this._labelId,className:_.itemName},o):null,u?null:p(Object(i.__assign)(Object(i.__assign)({},this.props),{percentComplete:m}),this._onRenderProgress),s?r.createElement("div",{id:this._descriptionId,className:_.itemDescription},s):null)},t.defaultProps={label:"",description:"",width:180},t}(r.Component),l=n(21),u=n(102),f=n(435),p={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},m=Object(u.t)(function(){return Object(l.M)({"0%":{left:"-30%"},"100%":{left:"100%"}})}),_=Object(u.t)(function(){return Object(l.M)({"100%":{right:"-30%"},"0%":{right:"100%"}})}),h=Object(a.e)(d,function(e){var t,n,a,r=Object(f.e)(e.theme),o=e.className,s=e.indeterminate,c=e.theme,d=e.barHeight,u=void 0===d?2:d,h=c.palette,b=c.semanticColors,g=c.fonts,v=Object(l.I)(p,c),y=h.neutralLight;return{root:[v.root,g.medium,o],itemName:[v.itemName,l.F,{color:b.bodyText,paddingTop:4,lineHeight:20}],itemDescription:[v.itemDescription,{color:b.bodySubtext,fontSize:g.small.fontSize,lineHeight:18}],itemProgress:[v.itemProgress,{position:"relative",overflow:"hidden",height:u,padding:"8px 0"}],progressTrack:[v.progressTrack,{position:"absolute",width:"100%",height:u,backgroundColor:y,selectors:(t={},t[l.o]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:h.themePrimary,height:u,position:"absolute",transition:"width .3s ease",width:0,selectors:(n={},n[l.o]=Object(i.__assign)({backgroundColor:"highlight"},Object(l.x)()),n)},s?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, "+y+" 0%, "+h.themePrimary+" 50%, "+y+" 100%)",animation:(r?_():m())+" 3s infinite",selectors:(a={},a[l.o]={background:"highlight"},a)}:{transition:"width .15s linear"},v.progressBar]}},void 0,{scope:"ProgressIndicator"})},function(e,t,n){"use strict";var a=n(0),i=(n(2250),n(1800)),r=n(2313),o=n(8),s=n(430),c=n(1098),d=n(1),l=n(173),u=n(130),f=n(2109),p=n(1796),m=n(2066),_=n(1806),h=n(39),b=n(1802),g=n(1801),v=n(291),y=n(300),S=function(){function e(e){this._pageContext=e.pageContext,this._listId=e.listId,this._listItemId=e.listItemId,this._webAbsoluteUrl=e.webAbsoluteUrl}return e.prototype.getAdvancedUrl=function(){var e=[this._webAbsoluteUrl];if(e.push("/_layouts/15/user.aspx"),e.push("?List="+v.e.encodeURIComponent(this._listId)),this._listId&&this._listItemId)return e.push("&obj=",v.e.encodeURIComponent(this._listId),",",v.e.encodeURIComponent(this._listItemId),",LISTITEM"),Number(this._pageContext.webTemplate)===y.t.group&&e.push("&noredirect=true"),e.join("")},e}(),D=n(1989),I=n(1786),x=d.lazy(function(){return Promise.resolve().then(n.bind(null,2314))}),C=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1,errorMessage:null},n}return Object(a.__extends)(t,e),t.prototype.componentDidCatch=function(e,t){var n,a=e||new Error(g.Rs);null===(n=this.props.shareLoadingCustomerPromise)||void 0===n||n.forEach(function(e){return Object(D.n)({customerPromise:e,rawErrorMessage:a,errorType:D.e.render})}),this.setState({hasError:!0,errorMessage:a.message})},t.prototype.render=function(){return this.state.hasError?d.createElement(d.Suspense,{fallback:d.createElement(I.e,null)},d.createElement(x,{clientId:this.props.clientId,genericErrorMessage:this.state.errorMessage,mode:this.props.mode})):d.createElement(d.Fragment,null,this.props.children)},t}(d.Component),O=function(e){function t(t){var i,r,p,g=this;if((g=e.call(this,t)||this)._loadTeachingBubbleCampaigns=function(){return Promise.resolve().then(n.bind(null,608)).then(function(e){var t;return g._sharingTeachingBubbleCampaigns=((t={})[0]=e.SHARE_TO_TEAMS,t),g._sharingTeachingBubbleCampaigns})},g._shouldTeachingBubbleBeShown=function(e){return Object(a.__awaiter)(g,void 0,void 0,function(){var t=this;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return this._teachingBubbleProviderPromise=this.props.loadTeachingBubbleRelatedResources(),[4,this._loadTeachingBubbleCampaigns()];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this._teachingBubbleProviderPromise.then(function(n){return n.shouldBubbleBeAdded(t._sharingTeachingBubbleCampaigns[e],!0,{bypass:!0})})];case 3:return[2,n.sent()];case 4:return n.sent(),[3,5];case 5:return[2]}})})},g._onTeachingBubbleSeen=function(e){g._teachingBubbleProviderPromise&&g._teachingBubbleProviderPromise.then(function(t){g._sharingStore.getEngagementHelper().shareToTeamsTeachingBubbleShown(),t.markBubbleAsSeen(g._sharingTeachingBubbleCampaigns[e])})},g._markTeachingBubbleAsDismissed=function(e){g._teachingBubbleProviderPromise&&g._teachingBubbleProviderPromise.then(function(t){return t.markBubbleAsDismissed(g._sharingTeachingBubbleCampaigns[e])})},g._resize=function(){var e,t,n=g._share.current;if(n){g._onResize&&g._onResize();var a=g._maxHeight,i=!b.oe()||!1===(null===(t=null===(e=g.props.sharingContextInfo)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.enableWiderDialog)||_.u(g._clientId)?320:480,r=n.clientHeight>a?a:n.clientHeight,c=n.clientWidth<i?i:n.clientWidth;if(r>0&&c>0)try{o.t.isActivated("b954de8d-255b-436b-8319-ebea85353bfa","07/22/2021","make share dialog body overflow auto")||s.e.isFeatureEnabled({ECS:90418})||(r+=10),(!g._initialHeight||r>g._initialHeight)&&(g._initialHeight=r),window.external.Resize(c,r)}catch(e){var d={name:"share_resize",command:"shareCommand",width:c,height:r};g._sharingClientMessenger?g._sharingClientMessenger.sendResize(d):window.parent.postMessage(JSON.stringify(d),"*")}}},g._dismiss=function(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}},g._getCalculatedIframeHeight=function(){return g._initialHeight},g._onStopSharingClicked=function(){var e,t;g.props.sharingProvider.stopSharing(null===(e=g.props.sharingContextInfo)||void 0===e?void 0:e.listId,null===(t=g.props.sharingContextInfo)||void 0===t?void 0:t.listItemId)},g._copyLinkShortcut=t.copyLinkShortcut,g._onDismiss=t.onDismiss,g._dismissed=!1,g._onResize=t.onResize,g._peoplePickerProvider=t.peoplePickerProvider,g._mode=t.mode||(g._copyLinkShortcut?c.e.copy:c.e.share),g._messageText=t.messageText,g._sharingStore=t.sharingStore,g._premiumLearnMore=t.premiumLearnMore,g._goPremium=t.goPremium,g._clientId=t.clientId||t.sharingProvider.getClientId(),g._sharingClientMessenger=t.sharingClientMessenger,g._platformDetection=new u.e,g._breakpoint=f.e.DEFAULT_BREAKPOINTS[f.e.determineWindowSize(window.innerWidth)],g._share=d.createRef(),!t.noMaxHeightRestriction)if(b.B()){var v=g.props.maxHeight;g._maxHeight=v<650?v:650}else{var y=g.props.maxHeight;try{y||window.name===window.parent.name||(y=window.parent.innerHeight)}catch(e){}g._maxHeight=Math.min(y,650)}g.props.sharingContextInfo&&(g._hostSessionId=g.props.sharingContextInfo.hostSessionId);var D=0,I=" ",x=" ",C=" ",O=0;if(t.item&&t.item.properties){var w=t.item.properties,E=w.ItemChildCount?parseInt(w.ItemChildCount,10):0,A=w.FolderChildCount?parseInt(w.FolderChildCount,10):0;D=t.item.type===l.t.OneNote?0:E+A,I=t.item.name,x=t.item.extension,C=t.item.appMap,O=t.item.type}else g.props.sharingContextInfo&&(I=g.props.sharingContextInfo.itemName||" ",D=g.props.sharingContextInfo.itemCount||0,x=g.props.sharingContextInfo.itemExtension,C=g.props.sharingContextInfo.itemAppmap,O=g.props.sharingContextInfo.itemType);if(t.items&&t.items.length>1&&(I=h.format(m.C,t.items.length)),g._sharingItemInformation={name:I,childCount:D,hasDlpPolicy:void 0,extension:x,appmap:C,itemType:O},t.pageContext&&t.sharingContextInfo){var L={pageContext:t.pageContext,listId:null===(i=t.sharingContextInfo)||void 0===i?void 0:i.listId,listItemId:null===(r=t.sharingContextInfo)||void 0===r?void 0:r.listItemId,webAbsoluteUrl:null===(p=t.sharingContextInfo)||void 0===p?void 0:p.webAbsoluteUrl};g._shareDialogAdvancedUrlDataSource=new S(L)}return g}return Object(a.__extends)(t,e),t.prototype.getChildContext=function(){return{peoplePickerProvider:this._peoplePickerProvider,resize:this._resize,onDismiss:this._onDismiss||this._dismiss,sharingStore:this._sharingStore,platformDetection:this._platformDetection,breakpoint:this._breakpoint,premiumLearnMore:this._premiumLearnMore,goPremium:this._goPremium,shareClickTime:this.props.clickTime||window._sharingStartTime||Date.now(),clientId:this._clientId,shouldTeachingBubbleBeShown:this._shouldTeachingBubbleBeShown,onTeachingBubbleSeen:this._onTeachingBubbleSeen,markTeachingBubbleAsDismissed:this._markTeachingBubbleAsDismissed,loadTeachingBubbleCampaigns:this._loadTeachingBubbleCampaigns,campaignKey:0,canUseTeams:this.props.canUseTeams,sharingClientMessenger:this.props.sharingClientMessenger}},t.prototype.render=function(){var e=this._getAriaLabel();return this._sharingStore?d.createElement("div",Object(a.__assign)({className:"od-share-v3",ref:this._share},this.props.renderInline&&this._mode===c.e.manageAccess?{}:{role:"dialog"},{"aria-label":e}),this._renderShareComponent()):null},t.prototype.componentWillUnmount=function(){this._shareDismiss()},t.prototype._getAriaLabel=function(){switch(this._mode){case c.e.copy:return g.Ke;case c.e.atMention:return g.pn;case c.e.addPeople:return g.S;case c.e.linkSettings:return g.Zn;default:return m._}},t.prototype._shareDismiss=function(){!this._dismissed&&this._onDismiss&&(this._dismissed=!0,this._onDismiss())},t.prototype._renderShareComponent=function(){var e,t=this.props,n=d.createElement(C,Object(a.__assign)({},t),d.createElement(r.e,{calculatedIframeHeight:this._getCalculatedIframeHeight,advancedUrl:(null===(e=this._shareDialogAdvancedUrlDataSource)||void 0===e?void 0:e.getAdvancedUrl())||void 0,onStopSharingClicked:this._onStopSharingClicked,copyLinkShortcut:this._copyLinkShortcut,shareId:t.shareId,theme:t.theme,clientId:this._clientId,scenarioId:t.scenarioId||"",omitCustomLabeledAudience:t.omitCustomLabeledAudience,customLabeledAudienceConfig:t.customLabeledAudienceConfig,showExistingAccessOption:!!t.sharingProvider&&t.sharingProvider.supportsExistingAccessOption(t.item),onManageAccessClicked:t.onManageAccessClicked,hideShareDialogOverflowButton:t.hideShareDialogOverflowButton,maxHeight:this._maxHeight,maxWidth:this.props.maxWidth,mode:this._mode,messageText:this._messageText,useVroomCreateDefaultLink:this._mode===c.e.copy&&_.u(t.clientId),sharingItemInformation:this._sharingItemInformation,hideElementsInManageAccess:t.hideElementsInManageAccess,preferCustomLabeledAudience:t.preferCustomLabeledAudience,invokeManageAccess:t.invokeManageAccess,hostSessionId:this._hostSessionId,hostOptions:t.hostOptions,clickTime:t.clickTime,fullScreenIframeMode:t.fullScreenIframeMode,showHeaderInManageAccess:t.showHeaderInManageAccess,isInstantSecondLoad:t.isInstantSecondLoad,shareLoadingCustomerPromise:t.shareLoadingCustomerPromise,pageContext:t.pageContext,getGraphToken:t.getGraphToken,flushTelemetry:t.flushTelemetry})),i=this._mode===c.e.share||this._mode===c.e.addPeople;return t.useFocusTrap?d.createElement(p.e,{isClickableOutsideFocusTrap:!0,disableFirstFocus:i,forceFocusInsideTrap:!i},n):n},t.childContextTypes={peoplePickerProvider:i.object.isRequired,resize:i.func.isRequired,onDismiss:i.func,sharingStore:i.object.isRequired,platformDetection:i.object.isRequired,breakpoint:i.number.isRequired,premiumLearnMore:i.func,goPremium:i.func,shareClickTime:i.number,clientId:i.number,shouldTeachingBubbleBeShown:i.func,onTeachingBubbleSeen:i.func,markTeachingBubbleAsDismissed:i.func,loadTeachingBubbleCampaigns:i.func,campaignKey:i.number,canUseTeams:i.func,sharingClientMessenger:i.object},t}(d.Component);t.e=O},function(e,t,n){"use strict";n.d(t,"e",function(){return _e});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:active){.od-Share{border:3px solid}}.od-Share{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';border-radius:2px;min-height:130px}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:'},{theme:"white",defaultValue:"#fff"},{rawString:";opacity:.8}.od-Share.od-Share--permissionsPivot{overflow:unset!important}[dir=ltr] .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir=rtl] .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{theme:"link",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-Share a:focus,.od-Share a:hover{color:"},{theme:"linkHovered",defaultValue:"#004578"},{rawString:";text-decoration:underline}.od-Share a:focus{outline:1px solid transparent}.od-Share button:not(.ms-Button):not(.od-Share-noFocusBorder):focus{outline:1px solid;outline-color:"},{theme:"black",defaultValue:"#000"},{rawString:'}.od-Share .od-Share-noFocusBorder:focus{outline:0;border:none}.od-Share .ms-Button--default{outline:transparent;position:relative}.od-Share .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button--default:focus:after{content:"";position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:'}@media screen and (-ms-high-contrast:active){.od-Share .ms-Button{outline:transparent;position:relative}.od-Share .ms-Button::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after{content:"";position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-Share.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-Share .icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b;color:#0b6a0b;border-color:#0b6a0b;background-color:#f1f6f1}.od-Share .icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c;color:#004e8c;border-color:#004e8c;background-color:#f0f5f8}.od-Share .icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939;color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e,.06)}.od-Share .icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e;color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c,.06)}.od-Share .ms-Tooltip{pointer-events:none}.od-Share .ms-Spinner{position:absolute;top:50%;left:50%}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-Share .ms-Button{overflow:visible}}#od-Share-backButton-tooltip{position:relative}button.od-Share-backButton{z-index:1;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;padding:0}button.od-Share-backButton#od-ShareToTeams-backButton{top:-40px}[dir=rtl] button.od-Share-backButton{transform:scale(-1,1)}button.od-Share-backButton:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}button.od-Share-backButton.new{position:inherit;left:inherit}button.od-Share-backButton.absolute{position:absolute;top:8px}[dir=ltr] button.od-Share-backButton.absolute{left:8px}[dir=rtl] button.od-Share-backButton.absolute{right:8px}button.od-Share-backButton.priorView{top:14px}[dir=ltr] button.od-Share-backButton.priorView{left:16px}[dir=rtl] button.od-Share-backButton.priorView{right:16px}.od-Share-shareMainDiv{position:relative}.od-Share-spinnerHolder{align-items:center;display:flex;height:130px;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--default,.teams .ms-Button.ms-Button--primary{border-radius:3px;min-width:96px}.teams .ms-Button--default{box-shadow:0 2px 2px 0 rgba(37,36,36,.15);border:1px solid rgba(37,36,36,.15)}.teams .ms-Button--primary{box-shadow:0 2px 2px 0 rgba(98,100,167,.4)}.teams .ms-Button--primary.is-disabled{box-shadow:none;border:none}"}]);var r=n(1098),o=n(2876),s=n(2145),c=n(2049),d=n(1818),l=n(1830),u=n(1801),f=n(1786),p=n(434),m=n(1),_=n(1826),h=n(1800),b=n(2136),g=function(e){function t(t,n){var a=e.call(this,t)||this;return a._initialLinkShown=!1,a._onLinkSettingsCancelClick=function(){a.setState({shouldCopyLinkToClipboard:!1},function(){a.props.onLinkPermissionsCancelClicked()})},a._onLinkSettingsApplyClicked=function(e){a.setState({shouldCopyLinkToClipboard:!0},function(){a.props.onLinkPermissionsApplyClicked(e)})},a._onCopyButtonClicked=function(e){a.setState({shouldCopyLinkToClipboard:!0},function(){a.props.onLinkPermissionsApplyClicked(e,!0)})},a._shareClickTime=n.shareClickTime,a.state={shouldCopyLinkToClipboard:!0},a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.sharingInformation,n={clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:e.onShareHintClick,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig};switch(this.props.viewState){case d.e.linkSuccess:case d.e.copyLinkShortcut:return this._initialLinkShown||(_.b(this._shareClickTime,this.props.clientId,r.e.copy,this.props.scenarioId,this.props.correlationId),this._initialLinkShown=!0),this.props.viewState==d.e.linkSuccess?m.createElement(c.ShareNotification,Object(a.__assign)({},Object(l.e)(this.props),{shareType:o.e.copy,itemName:t.item.name,linkUrl:e.displayUrl,sharingHintProps:n,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})):m.createElement(b.e,{singleComponent:!0,clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:this.props.currentSettings,sharingInformation:this.props.sharingInformation,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,hostOptions:this.props.hostOptions,onShareHintClick:this.props.onShareHintClick,onSendLinkClicked:this._onCopyButtonClicked.bind(this,this.props.currentSettings)});case d.e.modifyPermissions:return m.createElement(s.ModifyPermissions,Object(a.__assign)({},Object(l.e)(this.props),{shareId:e.shareId,mode:e.mode,companyName:e.companyName,currentSettings:e.currentSettings,doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,sharingInformation:e.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,createPeopleSharingLinks:e.createPeopleSharingLinks,copyLinkShortcut:!0,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onSelectedPeopleChange:function(){}}));default:return m.createElement("div",{className:"od-Share-spinnerHolder"},m.createElement(f.e,{className:"od-Share-spinner",label:u.Me,type:p.t.large}))}},t.contextTypes={shareClickTime:h.number},t}(m.Component),v=n(2576),y=n(2578),S=n(2579),D=n(1646),I=n(2577),x=n(2879),C=n(2580),O=n(2308),w=n(2305),E=n(2144),A=n(2316),L=n(1839),k=n(1923),M=n(1806),P=n(1785),T=n(1934),U=n(1644),F=n(2344),H=n(2307),R=n(1804),N=n(68),B=n(1834),j=n(101),V=n(2309),z=n(2314),G=n(21),K=n(129),W=n(1889),q=n(1991),Q=n(1817),Y=n(2296),J=n(112),X=n(1919),Z=n(1802),$=n(2119),ee=n(1829),te=n(1831),ne=n(321),ae=n(2056),ie=n(2058),re=n(1885),oe=n(621),se=n(47),ce=n(2135),de=n(229),le=n(2315),ue=n(598),fe=n(1989),pe=n(113),me=n(2059),_e=function(e){function t(t,n){var i=e.call(this,t)||this;i._viewStates=[],i._shareMainControl=Object(m.createRef)(),i._onPermissionsDefaultShare=function(e){i._lastPermissionsSubView=e,i._showShare()},i._topLevelDivRef=m.createRef(),i._copyLinkOnCancelClicked=function(){i._returnToPreviousView()},i._copyLinkOnApplyClicked=function(e,t){var n={currentSettings:e,linkRecipients:e.specificPeople,viewState:i.state.viewState};Z.f()&&t&&(n.viewState=d.e.spinner),i.setState(n,function(){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData),i._onCopyLinkClicked(!0)})},i._closeButtonOnBlur=function(){i.setState({isCloseButtonOnFocus:!1})},i._closeButtonOnFocus=function(){i.setState({isCloseButtonOnFocus:!0})},i._onRoleChange=function(e){var t=Object(R.P)(e),n=e===v.e.view,r=e===v.e.review,o=e==v.e.manageList;if(!(t||n||r||o))throw new Error("Role not implemented: "+v.e[e]);var s=i.state.currentSettings,c=r||o?y.e.flexible:Object(R.v)(s.audience,t);s.sharingRole!==e&&i._store.getEngagementHelper().log("SharingRoleChanged",{isEdit:t,isReview:r}),i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{currentSettings:Object(a.__assign)(Object(a.__assign)({},s),{sharingRole:e,isEdit:t,isReview:r,sharingLinkKind:c})}))},i._onShareTargetClicked=function(e,t){var n;switch(e){case o.e.outlook:n="outlookClicked";break;case o.e.webShareToTeams:n="webShareToTeamsClicked";break;case o.e.mobileShareToTeams:n="mobileShareToTeamsClicked";break;case o.e.nonOutlook:n="nonOutlookClicked";break;case o.e.copy:n="copyButtonClicked";break;case o.e.moreApps:n="moreAppsClicked"}if(i._shareLinkCustomerPromise=new oe.e({scenario:Object($.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:n}}),i._store.getEngagementHelper().log("ShareV3.shareTargetClicked",Object(a.__assign)(Object(a.__assign)({},i._engagementExtraData),{shareType:e})),e!==o.e.share)return e===o.e.copy?(_.t(),void i._onCopyLinkClicked(t)):void(e!==o.e.webShareToTeams?i.setState({shareType:e,shareTargetClicked:!0},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1,shareType:e})}):i._onRedirectTeamsClicked())},i._onLinkPermissionsApplyClicked=function(e){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData),i._onSelectedPermissionsChange(e),i.props.mode===r.e.linkSettings&&(i._shareLinkCustomerPromise=new oe.e({scenario:Object($.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"linkSettingChangesApply"}}),i.setState({shareType:o.e.share,applyLinkSettingsClicked:!0},function(){var e=i.state.linkRecipients;if(M.u(i.props.clientId)){var t=i.state.currentSettings.sharingLinkKind;t!==y.e.organizationEdit&&t!==y.e.organizationView||(e=e.filter(function(e){return!e.isExternal}))}i._store.shareLink({settings:i.state.currentSettings,recipients:e,copyLinkCommand:!1})}))},i._onLinkPermissionsCancelClicked=function(){i.props.mode===r.e.linkSettings&&_.i(),i._returnToPreviousView()},i._returnToPreviousView=function(){i._viewStates&&i._viewStates.length&&(i.setState({viewState:i._viewStates.pop(),showTeamsDialog:!1},function(){var e,t;null===(t=null===(e=i._shareMainControl)||void 0===e?void 0:e.current)||void 0===t||t.shouldShowActivityIndicator(!1)}),i.state.viewState===d.e.modifyPermissions&&i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData))},i._hideElementsInManageAccess=function(e){i.props.hideElementsInManageAccess&&i.props.hideElementsInManageAccess(e)},i._onSelectedPeopleChange=function(e){var t=i.state.permissionsMap;i.state.currentSettings.audience===S.e.existing&&i._store.checkPermissions(e),i._store.resetPeoplePickerError(),i.setState({linkRecipients:e,permissionsMap:t},function(){i._store.fetchGroupsMemberCount(e)})},i._onSendLinkClicked=function(e,t){var n=i.state.linkRecipients;i._shareLinkCustomerPromise=new oe.e({scenario:Object($.e)("ShareDialog.shareLink"),perfGoalInMs:3e4,extraData:{sharingScenario:"sendLink"}}),i.setState({shareType:o.e.share,recipientsCount:n.length,externalRecipientsCount:L.e(n),linkedinRecipientsCount:L.t(n),hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0},function(){_.S(),i._store.shareLink({settings:i.state.currentSettings,recipients:n,emailMessage:e,emailSubject:t})})},i._onViewPolicyTipClicked=function(){i._viewStates.push(i.state.viewState),i.setState({viewState:d.e.policyDetails})},i._onSendLinkMessageChange=function(e){i.setState({messageText:e})},i._onSendLinkSubjectChange=function(e){i.setState({subjectText:e})},i._onInterruptUseNew=function(){i._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(i._engagementExtraData),i.setState({shareType:o.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:Object(a.__assign)(Object(a.__assign)({},i.state.currentSettings),{updatePassword:!0})},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1})})},i._onInterruptUseExisting=function(){i._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(i._engagementExtraData),i.setState({shareType:o.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1,currentSettings:Object(a.__assign)(Object(a.__assign)({},i.state.currentSettings),{updatePassword:!1,password:null})},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!0})})},i._onInterruptCancel=function(){i._store.getEngagementHelper().copyLinkInterruptCancelled(i._engagementExtraData),i.setState({showCopyLinkInterrupt:!1}),i._shareMainControl.current.shouldShowActivityIndicator(!1)},i._enterShareView=function(){i._store.getEngagementHelper().manageAccessLinkSectionShareClicked(i._engagementExtraData),Z.F()||i._viewStates.push(i.state.viewState),i.setState({viewState:d.e.default})},i._enterGrantAccessView=function(){i._store.getEngagementHelper().manageAccessGrantAccessClicked(i._engagementExtraData),i.setState({viewState:d.e.addPeople})},i._enterManageAccessView=function(){i._usePermissionsPivot?i.setState({viewState:d.e.permissionsPivot}):i.setState({viewState:d.e.permissionsList})},i._showShare=function(){i._viewStates.push(i.state.viewState),i.setState({viewState:d.e.default})},i._showModifyPermissions=function(e,t){i._viewStates.push(i.state.viewState),i.setState({viewState:d.e.modifyPermissions,copyLinkShortcut:t},function(){i._store.getEngagementHelper().linkSettingsOpened(i._engagementExtraData,e)})},i._showPermissionsList=function(){i._viewStates.push(i.state.viewState),i._store.getEngagementHelper().manageAccessOpened(i._engagementExtraData);var e=i.props,t=e.invokeManageAccess,n=e.onManageAccessClicked,a=n&&!t;t?_.s():a?n():i.setState({viewState:i._usePermissionsPivot?d.e.permissionsPivot:d.e.permissionsList,showHeaderInManagedAccess:!0})},i._dismiss=n.onDismiss,i._resize=n.resize,i._store=n.sharingStore,i._shareClickTime=n.shareClickTime,i._isPeopleSharingLinksEnabled=!1,i._rumoneLogger=new ce.e,i._lastPermissionsSubView,i._usePermissionsPivot=Z.R()||ee.n()&&Z.H()&&!i._store.isConsumer();var s=_.c(),c=t.theme;c||(c=_.r()),(c&&i.props.clientId!==D.e.wac||s)&&i._loadTheme(s?Object(R.l)():c),i._sizeConstraints={maxHeight:M.r(i.props.clientId)?"none":i.props.maxHeight||"none",maxWidth:i.props.maxWidth||"none",overflowY:"auto",overflowX:"hidden"};var u={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:d.e.default,readyToCopy:!1,shareType:o.e.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:t.messageText||"",subjectText:t.subjectText||"",isLoadingDefaultRecipients:i._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1,showTeamsDialog:!1};u.viewState=t.mode===r.e.share?d.e.shareShimmer:d.e.spinner,i.state=u,i._baseProps=Object(l.e)(t),i._correlationId=i.props.correlationId||ne.e.generate(),i._baseProps.correlationId=i._correlationId;var f=Object(pe.e)(location.search.substring(1)),p=f.migratedhosting&&"true"===f.migratedhosting.toLowerCase();return i._engagementExtraData={clientId:t.clientId,scenarioId:t.scenarioId,correlationId:i._correlationId,hostSessionId:t.hostSessionId||"",mode:t.mode||(t.copyLinkShortcut?r.e.copy:r.e.share),isMigratedhosting:p},i._resizeTracker=new te.e(n.resize),i}return Object(a.__extends)(t,e),t.prototype.componentWillUnmount=function(){this._store.removeListeners&&this._store.removeListeners()},t.prototype.componentDidMount=function(){var e=this;try{var t=this._store,n=void 0;try{n=Object(ae.e)(Object(ae.a)(t.getAuthToken())),this._engagementExtraData.appId=n}catch(e){}t.getEngagementHelper().log(X.a.Opening,this._engagementExtraData),new j.t(this).on(window,"keydown",function(t){t&&t.keyCode===J.e.escape&&e._handleEscKeyPress(t)}),t.addListener(this._sharingStoreListener.bind(this));var a=!Z.y()||this.props.copyLinkShortcut||this.props.mode===r.e.linkSettings||this.props.mode===r.e.manageAccess||this.props.mode===r.e.notify,i=this.props.mode===r.e.manageAccess;if(t.fetchSuiteNavInformation(),t.fetchSharingInformation(a,i),t.fetchPolicyTipInformation(),this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===r.e.copy&&!this.props.shareId&&M.u(this.props.clientId)&&(this._copyLinkShortcutInvoked=!0,this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0}),this.setState({shareType:o.e.copy,shareTargetClicked:!0})),this._resizeIfNeeded(),this.state.sharingInformation&&(this.state.viewState===d.e.default||this.state.viewState===d.e.linkSuccess||this.state.viewState===d.e.linkSettings&&this.props.mode===r.e.linkSettings)){var s=this.props.mode,c=this.state.viewState;setTimeout(function(){e._writeShareDataToRumoneLogger({mode:s,viewState:c})},0)}this._logSuccessfulShareDialogLoadingCustomerPromise()}catch(e){this._setGenericErrorState(e)}},t.prototype.componentDidUpdate=function(){var e=this;this._resizeIfNeeded();var t=function(){var t=e.props.mode,n=e.state.viewState;setTimeout(function(){e._writeShareDataToRumoneLogger({mode:t,viewState:n})},0)};if(this.state.sharingInformation){if(this.props.mode===r.e.share)if(this.state.viewState!==d.e.default||this.state.shareTargetClicked){if(this.state.viewState===d.e.linkSuccess){var n=this.props.mode,a=this.state.viewState;setTimeout(function(){e._writeCopyLinkTargetDataToRumoneLogger({mode:n,viewState:a,clickTime:e._copyTargetClickTime})})}}else t();else if(this.state.viewState===d.e.shareToTeams){var i="https://teams.microsoft.com/share?href="+this.state.sharingLinkCreated.url+"&referrer=SharePoint.com";this._teamsUrl=i,this.setState({showTeamsDialog:!0})}else(this.props.mode===r.e.copy&&this.state.viewState===d.e.linkSuccess||this.props.mode===r.e.linkSettings&&this.state.viewState===d.e.linkSettings)&&t();this._logSuccessfulShareDialogLoadingCustomerPromise()}},t.prototype.componentDidCatch=function(e,t){this._setGenericErrorState(e)},t.prototype.render=function(){var e,t,n=this.props,i=(n.clientId,n.copyLinkShortcut),r=this.state,s=r.sharingInformation,c=r.currentSettings,l=r.showActivityIndicator,_=r.sharingLinkCreated,h="od-Share",b=!1;if(s&&c&&i&&(Z.f()||_)&&this.state.viewState!==d.e.error)b=!0,e=this._renderPostCopyShortcutView();else switch(this.state.viewState){case d.e.error:e=this._renderError(s),Object(fe.n)({customerPromise:this._shareLinkCustomerPromise,rawErrorMessage:s.rawError||"generic share link failure",engagementExtraData:this._engagementExtraData,errorType:s.rawError?fe.e.api:fe.e.generic,sharingStore:this._store});break;case d.e.default:case d.e.shareToTeams:h+=l?" od-Share--hasActivity":"",b=!0,e=this._renderShareMain(this.state.sharingInformation,this.state.currentSettings);break;case d.e.modifyPermissions:b=!0,e=m.createElement(m.Fragment,null,this._renderModifyPermissions(d.e.modifyPermissions),this._renderActivityIndicator());break;case d.e.linkSuccess:Object(fe.a)({customerPromise:this._shareLinkCustomerPromise,engagementExtraData:this._engagementExtraData,sharingStore:this._store}),e=this._renderNotification(),this.state.shareType,o.e.copy;break;case d.e.permissionsList:b=!0,e=this._renderPermissionsList();break;case d.e.permissionsPivot:h+=" od-Share--permissionsPivot",b=!0,e=this._renderPermissionsPivot();break;case d.e.policyDetails:e=m.createElement(m.Fragment,null,this._renderBackButtonForPolicyDetails(),this._renderPolicyDetails());break;case d.e.atMention:h="",e=this._renderAtMention();break;case d.e.linkSettings:h+=l?" od-Share--hasActivity":"",b=!0,e=m.createElement(m.Fragment,null,this._renderModifyPermissions(d.e.linkSettings));break;case d.e.shareShimmer:h+=" od-Share--hasShimmer",b=!0,e=this._renderShareMainShimmer();break;case d.e.notify:c.sharingLinkKind=y.e.direct,c.audience=S.e.existing,this._engagementExtraData=Object(a.__assign)(Object(a.__assign)({},this._engagementExtraData),{appMap:s.item.appmap}),h="",e=m.createElement(H.Notify,Object(a.__assign)({},this._baseProps,{currentSettings:c,sharingInformation:s,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}));break;case d.e.addPeople:b=!0,e=this._renderAddPeople();break;case d.e.spinner:e=m.createElement("div",{className:"od-Share-spinnerHolder"},m.createElement(f.e,{className:"od-Share-spinner",label:u.Me,size:p.e.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))}t=b||h?m.createElement("div",{className:h,style:b?this._sizeConstraints:void 0},e):e;var g=M.u(this.props.clientId)?" teams":"";return m.createElement(P.e,null,m.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:g+" isFluent"},t))},t.prototype._logSuccessfulShareDialogLoadingCustomerPromise=function(){var e;!this.state.sharingInformation||this.props.mode===r.e.manageAccess&&this.props.shareLoadingCustomerPromise&&this._usePermissionsPivot||null===(e=this.props.shareLoadingCustomerPromise)||void 0===e||e.forEach(function(e){e&&e.context&&e.context.SharingMode!==r.e.manageAccess&&e.end({resultType:se.e.Success})})},t.prototype._sharingStoreListener=function(e){var t,n=this,i=this._store;try{if(this.state.viewState===d.e.error)return;if(this.props.mode===r.e.copy&&e&&e.type===ie.t.UnshareLink)return;var s=i.getSharingInformation(),c=i.getSharingLinkCreated(),l=i.getCompanyName(),u=i.getGroupsMemberCount(),f=i.getPolicyTipInformation(),p=i.getPermissionsMap(),m=i.getDefaultRecipients();if(this._outlookAvailability=i.getOutlookAvailability(),this._isPeopleSharingLinksEnabled=i.isPeopleSharingLinksEnabled(),!s)return;s.webTemplateId&&(this._engagementExtraData.webTemplateId=s.webTemplateId),s.itemUniqueId&&(this._engagementExtraData.itemUniqueId=s.itemUniqueId),s.isStubFile&&(this._store.getEngagementHelper().shareErrorFileIsUploading(this._engagementExtraData),i.fetchSharingInformation(!0,!0));var h=this._store.getItemInformationForLogging(),b=h.itemType,g=h.extension;this._engagementExtraData.itemType=b,this._engagementExtraData.extension=g,this._sanitizeSharingContextInfo(s);var v=this._getSettings(s),y=Object(a.__assign)({},this.state);if(this.state.viewState!==d.e.shareShimmer&&this.state.viewState!==d.e.spinner||(y.viewState=this._getInitialViewState(s,v,c),y.viewState!==d.e.shareShimmer&&y.viewState!==d.e.spinner&&_.O()),s.error||s.isStubFile)s&&s.error&&(s.errorCategory===I.e.shareLink||s.errorCategory===I.e.shareObject||s.errorCategory===I.e.createLink||s.errorCategory===I.e.invite)?Object(fe.n)({customerPromise:this._shareLinkCustomerPromise,rawErrorMessage:s.rawError||s.error,engagementExtraData:this._engagementExtraData,errorType:s.error?fe.e.api:fe.e.generic,sharingStore:this._store}):null===(t=this.props.shareLoadingCustomerPromise)||void 0===t||t.forEach(function(e){return Object(fe.n)({customerPromise:e,rawErrorMessage:(null==s?void 0:s.isStubFile)?new Error("Is stub file"):s.rawError||s.error,engagementExtraData:n._engagementExtraData,errorType:fe.e.api,sharingStore:n._store})}),_.h(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId,s,this._correlationId),s.errorCategory===I.e.shareLink?y.viewState=d.e.default:y.viewState=d.e.error,y.sharingInformation=s;else if((Z.W()||e&&e.type===ie.t.ShareLink||this.props.shareId)&&c&&(this.state.shareTargetClicked||this.props.copyLinkShortcut||this.state.applyLinkSettingsClicked)){this._modifiedSharingLinkUrl=this._getModifiedSharingLinkUrl(c,v,s);var S=this.state.shareType,D=this.state.currentSettings,x=D?D.isEdit:v.isEdit,C=D?D.isReview:v.isReview,O=D?D.preventDownload:v.preventDownload,w=D?D.audience:v.audience,E=B.c(w,s.sharingAbilities,s.fileExtension),A=B.l(w,s.sharingAbilities,s.fileExtension),L=Object(a.__assign)(Object(a.__assign)({},this._engagementExtraData),{shareType:S,audience:c.audience,isEdit:x,isReview:A&&C,recipientsCount:this.state.recipientsCount,externalRecipientsCount:this.state.externalRecipientsCount,linkedinRecipientsCount:this.state.linkedinRecipientsCount,sharingLinkKind:c.sharingLinkKind,hasMessage:this.state.hasMessage,hasSubject:this.state.hasSubject,messageLength:this.state.messageLength,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(c),isDefaultLink:s.defaultSharingLink.sharingLinkKind===c.sharingLinkKind,linkBlocksDownload:!!O,linkWithOfficeReviewMode:E&&C,groupRecipientCount:this.state.linkRecipients.filter(function(e){return e.entityType===k.e.group&&null==e.familySharingTargetType}).length});Z.S()&&M.b(this.props.clientId)&&(L.sharedToFamilyGroup=this.state.linkRecipients.some(function(e){return e.familySharingTargetType===Y.e.Family}),L.sharedToFamilyMember=this.state.linkRecipients.some(function(e){return e.familySharingTargetType===Y.e.FamilyMember}));var P=this._store.getEngagementHelper();P.shareCompleted(L),P.logShareLinkGeneration(c,L),Object(fe.a)({customerPromise:this._shareLinkCustomerPromise,engagementExtraData:this._engagementExtraData,sharingStore:this._store});var T=Object(R.L)(c.sharingLinkKind);if(_.x(this.state.shareType,T),S===o.e.outlook||S===o.e.nonOutlook)M.h(this.props.clientId)?(this._store.navigateToOwa(this._getRecipientEmails(this.state.linkRecipients),this._modifiedSharingLinkUrl),_._(),this._dismiss()):_.I(this._getRecipientEmails(this.state.linkRecipients),this.state.linkRecipients.length,this.state.messageText,this._modifiedSharingLinkUrl);else if(S===o.e.mobileShareToTeams)this._dismiss(),_.C(c,this._getRecipientEmails(this.state.linkRecipients),this.state.messageText);else if(S===o.e.moreApps)try{y=Object(a.__assign)(Object(a.__assign)({},y),{viewState:d.e.linkSuccess,companyName:l,sharingLinkCreated:c,showActivityIndicator:!1}),_.m(c.url)}catch(e){}else if(S===o.e.webShareToTeams){if(this._modifiedSharingLinkUrl){var U="https://teams.microsoft.com/share?href="+this._modifiedSharingLinkUrl+"&referrer=SharePoint.com";return this._teamsUrl=U,void this.setState({showTeamsDialog:!0})}}else this.props.mode===r.e.linkSettings?_.p(c,l,this.props.customLabeledAudienceConfig,this.props.clientId):y=Object(a.__assign)(Object(a.__assign)({},y),{viewState:d.e.linkSuccess,sharingLinkCreated:c,companyName:l,showActivityIndicator:!1,sharingInformation:s,currentSettings:this._getSettings(s)})}else!this.props.copyLinkShortcut||!s||this.props.shareId||s.error||this._copyLinkShortcutInvoked||(this._copyLinkShortcutInvoked=!0,Z.f()||this._onCopyLinkClicked(!0,v)),y=Object(a.__assign)(Object(a.__assign)({},y),{sharingInformation:s,companyName:l,groupsMemberCount:u,currentSettings:v,policyTipInformation:f,isLoadingDefaultRecipients:i.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:p}),m&&!m.isConsumed&&(y.linkRecipients=m.recipients,this._store.consumeDefaultRecipients());this._isOpenEventLogged||(this._store.getEngagementHelper().log(X.a.Opened,this._engagementExtraData),this._isOpenEventLogged=!0),this.setState(y)}catch(e){this._setGenericErrorState(e)}},t.prototype._getInitialViewState=function(e,t,n){switch(this.props.mode){case r.e.share:if(e&&t)return d.e.default;break;case r.e.atMention:if(e&&t)return d.e.atMention;break;case r.e.linkSettings:if(t)return d.e.linkSettings;break;case r.e.manageAccess:if(t)return this._usePermissionsPivot?d.e.permissionsPivot:d.e.permissionsList;break;case r.e.copy:if(e&&t&&n)return d.e.linkSuccess;if(Z.f())return d.e.copyLinkShortcut;break;case r.e.notify:if(e)return d.e.notify;break;case r.e.addPeople:if(e)return d.e.addPeople;break;default:throw new Error("Mode not implemented: "+this.props.mode)}return this.props.mode===r.e.share?d.e.shareShimmer:d.e.spinner},t.prototype._renderAtMention=function(){var e,t=this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;return m.createElement(F.AtMention,Object(a.__assign)({},this._baseProps,{currentSettings:this.state.currentSettings,sharingInformation:this.state.sharingInformation,recipients:this.state.linkRecipients,canGrantEditPermissions:null===(e=this.props.hostOptions)||void 0===e?void 0:e.canGrantEditPermissions,onComplete:t}))},t.prototype._renderPostCopyShortcutView=function(){var e=this.state,t=e.sharingInformation,n=e.currentSettings,i=e.companyName,r=e.sharingLinkCreated,o=e.viewState,s=e.groupsMemberCount,c=r&&r.createdViaCopyLinkCommand||this._copyLinkShortcutInvoked;return Z.f()&&(c=!0),m.createElement(g,Object(a.__assign)({},this._baseProps,{mode:this.props.mode,shareId:this.props.shareId,companyName:i,currentSettings:n,item:t.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClick:this._getNotificationHintClickHandler(c),sharingInformation:t,showExistingAccessOption:this.props.showExistingAccessOption,viewState:o,groupsMemberCount:s,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,hostOptions:this.props.hostOptions}))},t.prototype._renderError=function(e){return m.createElement(z.Error,Object(a.__assign)({},this._baseProps,{viewState:d.e.error,sharingInformation:e,showReportProblem:this._store.isReportProblemSupported()}))},t.prototype._getSettings=function(e){var t=this,n=this.state.currentSettings,a=e&&e.error,i=e.sharingLinks&&e.sharingLinks.length&&this.props.shareId,r=B.i(e.sharingAbilities,e.sharingLinkTemplates),o=!1;if(!n&&!a){var s,c=e.defaultSharingLink;i&&(s=e.sharingLinks.filter(function(e){return e.shareId===t.props.shareId&&e.isActive})[0])&&(c=s,o=!0),void 0!==r&&r.length>0&&((s=r.filter(function(t){return t.sharingLinkKind===e.defaultSharingLink.sharingLinkKind})[0])||(s=r.filter(function(t){return t.audience===e.defaultSharingLink.audience})[0])?(c=s,o=!0):(c=r[0],o=!0)),n=this._initializeCurrentSettings(c,e,this.props.copyLinkShortcut,o),r.length>0&&(n.shareId=c.shareId,n.fetchLinkOnly=!0,n.audience=c.audience,n.expiration=c.expiration,n.isEdit=c.isEdit,n.isReview=c.isReview,n.sharingRole=c.isEdit?Object(R.f)(this.props.clientId,e):c.isReview?v.e.review:v.e.view,n.trackLinkUsers=c.trackLinkUsers,n.preventDownload=c.blockDownload,n.sharingLinkKind=c.sharingLinkKind,this._engagementExtraData.isRedeemedUserResharing=!0,this._engagementExtraData.redeemedLinksCount=r.length)}return n},t.prototype._getRecipientEmails=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n].email;i&&t.push(i)}return t},t.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),n=new Date;if(t){var a=(t.getTime()-n.getTime())/864e5;return Math.floor(a)}},t.prototype._handleEscKeyPress=function(e){this._viewStates.length>0?this._returnToPreviousView():this._dismiss(),e.stopPropagation()},t.prototype._initializeCurrentSettings=function(e,t,n,a){if(this._store.isConsumer())return this._store.getInitialLinkSettings(e);if(t.requiresAccessApproval&&n)return{allowEditing:!0,audience:S.e.existing,expiration:null,isEdit:!0,sharingRole:Object(R.f)(this.props.clientId,t),sharingLinkKind:y.e.direct,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1};if(t.defaultSharingLink===e&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,n);if(e.audience===S.e.specificPeople)if(!t.canManagePermissions||t.blockPeoplePickerAndSharing)e.audience=S.e.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:S.e.specificPeopleFlex,expiration:null,isEdit:!0,sharingRole:Object(R.f)(this.props.clientId,t),sharingLinkKind:y.e.flexible,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1};e.audience===S.e.specificPeopleFlex&&n&&!a&&(e.audience=S.e.existing,e.sharingLinkKind=y.e.direct);var i=e.sharingLinkKind,r=i===y.e.anonymousEdit||i===y.e.organizationEdit||i===y.e.direct||i===y.e.flexible,o=e.isEdit&&t.defaultShareLinkPermission===x.e.edit,s=[];return this.props.shareId&&e.principals&&(s=Object(R.S)(e)),{allowEditing:r,audience:this.props.preferCustomLabeledAudience&&e.audience===S.e.specificPeopleFlex?S.e.customLabeledSpecificPeople:e.audience,expiration:e.expiration||null,isEdit:o,sharingRole:o?Object(R.f)(this.props.clientId,t):v.e.view,sharingLinkKind:e.sharingLinkKind,specificPeople:s,updatePassword:!1,password:"",preventDownload:e.blockDownload,shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers}},t.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,n){var a,i,r,o,s=t.sharingAbilities,c="00000000-0000-0000-0000-000000000000"===this.props.shareId,d=c?y.e.direct:t.defaultSharingLink.sharingLinkKind,l=t.defaultShareLinkScope,u=Object(R.M)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig)?S.e.customLabeledSpecificPeople:S.e.specificPeople;if(t.defaultShareLinkToExistingAccess)u=S.e.existing,d=y.e.direct;else if(Z.i())switch(d){case y.e.anonymousEdit:case y.e.anonymousView:u=S.e.anyone;break;case y.e.organizationEdit:case y.e.organizationView:u=S.e.organization;break;case y.e.direct:default:c||!t.canManagePermissions||t.blockPeoplePickerAndSharing?u=S.e.existing:this._isPeopleSharingLinksEnabled?(u!==S.e.customLabeledSpecificPeople&&(u=S.e.specificPeopleFlex),d=y.e.flexible):u=S.e.existing}else switch(l){case C.e.anyone:u=S.e.anyone;break;case C.e.organization:u=S.e.organization;break;case C.e.specificPeople:u=S.e.specificPeopleFlex;break;default:c||!t.canManagePermissions||t.blockPeoplePickerAndSharing?u=S.e.existing:this._isPeopleSharingLinksEnabled?(u!==S.e.customLabeledSpecificPeople&&(u=S.e.specificPeopleFlex),d=y.e.flexible):u=S.e.existing}u===S.e.specificPeopleFlex&&n&&(u=S.e.existing,d=y.e.direct);var f=null,p=B.a(u,s).linkExpiration;(p?p.defaultExpirationInDays:null)>0&&(f=new Date((new Date).toDateString())).setDate(f.getDate()+p.defaultExpirationInDays);var m,_=B.r(u,s),h=_&&t.defaultShareLinkPermission===x.e.edit,b=h?Object(R.f)(this.props.clientId,t):v.e.view;(m=t.defaultShareLinkPermission===x.e.restrictedView)&&(b=v.e.restrictedview);var g=(null===(i=null===(a=this.props)||void 0===a?void 0:a.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[],D=(null===(o=null===(r=this.props)||void 0===r?void 0:r.hostOptions)||void 0===o?void 0:o.disabledAudienceOptions)||[];return u=-1===g.indexOf(u)&&-1===D.indexOf(u)?u:S.e.existing,B.o(u,s)&&(u=S.e.existing),{allowEditing:_,audience:u,expiration:f,isEdit:h,sharingRole:b,isReview:!1,preventDownload:m,sharingLinkKind:u===S.e.existing?y.e.direct:d,specificPeople:[],updatePassword:!1,password:"",shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers}},t.prototype._loadTheme=function(e){try{var t=e;Object(G.P)(t)}catch(e){}},t.prototype._onRedirectTeamsClicked=function(){var e=this;this._store.getEngagementHelper().webShareToTeamsTargetClicked(this._engagementExtraData),this._store.getEngagementHelper().shareCompleted(this._engagementExtraData),this.setState({shareType:o.e.webShareToTeams,shareTargetClicked:!0,viewState:d.e.shareToTeams},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:o.e.webShareToTeams}),e._viewStates.push(e.state.viewState)})},t.prototype._onCopyLinkClicked=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i=this;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return n=Object(a.__assign)(Object(a.__assign)({sendInvitation:!1},t),this.state.currentSettings),this._copyTargetClickTime=Date.now(),[4,this._store.shouldInterruptCopyLink(n.isEdit)];case 1:return r.sent()?(this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData),this.setState({showCopyLinkInterrupt:!0})):this.setState({shareType:o.e.copy,shareTargetClicked:!0},function(){var t=i.state.linkRecipients;Z.u()&&i._store.isConsumer()&&i.state.currentSettings.audience!==S.e.specificPeople&&(t=[]),i._store.shareLink({settings:n,recipients:t,copyLinkCommand:e,shareType:o.e.copy})}),[2]}})})},t.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:o.e.outlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:o.e.outlook})})},t.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:o.e.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:o.e.nonOutlook})})},t.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:o.e.mobileShareToTeams,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:o.e.mobileShareToTeams})})},t.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:o.e.moreApps,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:o.e.moreApps})})},t.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===S.e.existing?this._store.checkPermissions(this.state.linkRecipients):t={};var n=d.e.default;this.props.mode===r.e.linkSettings?n=this.state.viewState:this._viewStates&&this._viewStates.length>0&&(n=this._viewStates.pop()),this.setState({viewState:n,currentSettings:{allowEditing:e.allowEditing,trackLinkUsers:e.trackLinkUsers,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,hasPassword:e.hasPassword,preventDownload:e.preventDownload,shareId:e.shareId,fetchLinkOnly:e.fetchLinkOnly,requireSignIn:e.audience===S.e.specificPeople},permissionsMap:t})},t.prototype._renderBackButtonForPolicyDetails=function(){if(this.state.viewState===d.e.policyDetails)return Q.t(m.createElement(U.e,{className:"od-Share-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:u.ie}),u.ie)},t.prototype._renderBackButtonForPriorView=function(){if(this._usePermissionsPivot&&this._viewStates.length>0)return Q.t(m.createElement(U.e,{className:"od-Share-backButton absolute",id:"od-Share-prevView-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:u.ie}),u.ie,{tooltipId:"od-Share-backButton-tooltip",position:K.e.bottomCenter,targetElementId:"od-Share-prevView-backButton"})},t.prototype._renderShareMain=function(e,t){var n=this._usePermissionsPivot&&this._viewStates.length>0;return Z.K()&&(this.props.clientId===D.e.odcWac||this.props.clientId===D.e.word)&&Object(me.n)(e.fileExtension)&&(e.peoplePickerSettings.useNew3Ssearch=!0),m.createElement("div",{className:this.props.fullScreenIframeMode&&"od-Share-shareMainDiv"},this._renderBackButtonForPriorView(),m.createElement(E.t,Object(a.__assign)({},this._baseProps,{key:"share",ref:this._shareMainControl,companyName:this.state.companyName,currentSettings:t,item:e.item,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClick:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onRoleChange:this._onRoleChange,hasBackButton:n,fullScreenIframeMode:this.props.fullScreenIframeMode,getGraphToken:this.props.getGraphToken})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!t.password}),this.state.showTeamsDialog&&this._renderTeamsDialog())},t.prototype._renderTeamsDialog=function(){return m.createElement(le.default,{url:this._teamsUrl,onDismiss:this._dismiss,height:this.props.calculatedIframeHeight,onBackButtonClicked:this._returnToPreviousView.bind(this)})},t.prototype._renderPolicyDetails=function(){return m.createElement(A.SharePolicyDetails,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation})},t.prototype._renderCopyLinkInterrupt=function(e){var t=e.updatePassword;return m.createElement(W.ConfirmationDialog,{confirmationCode:t?q.e.copyInterruptUpdate:q.e.copyInterruptRemove,participant:null,onApply:t?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:t?this._onInterruptUseExisting:this._onInterruptUseNew})},t.prototype._renderModifyPermissions=function(e){return m.createElement(m.Fragment,null,m.createElement(s.ModifyPermissions,Object(a.__assign)({},this._baseProps,{shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onSelectedPermissionsChange:this.state.copyLinkShortcut?this._copyLinkOnApplyClicked:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:Z.W()&&this.state.copyLinkShortcut?function(){}:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:this.state.copyLinkShortcut,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,fullScreenIframeMode:this.props.fullScreenIframeMode})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!this.state.currentSettings.password}))},t.prototype._renderNotification=function(){var e=this.state,t=e.sharingInformation,n=e.sharingLinkCreated,i={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(n.createdViaCopyLinkCommand),linkRecipients:e.shareType===o.e.share?this.state.linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig};return m.createElement(c.ShareNotification,Object(a.__assign)({},Object(l.e)(this.props),{shareType:e.shareType,itemName:t.item.name,linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,generatedFromTargetClick:this.state.shareTargetClicked}))},t.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,X.t.CopyLinkSettingsHint,e):null},t.prototype._renderShareMainShimmer=function(){var e={allowEditing:!1,audience:S.e.existing,expiration:void 0,isEdit:!1,sharingLinkKind:y.e.uninitialized,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",sharingRole:v.e.none},t={anonymousLinkExpirationRestrictionDays:0,blockPeoplePickerAndSharing:!0,canAddExternalPrincipal:!1,canAddInternalPrincipal:!1,canManagePermissions:!1,canRequestAccessForGrantAccess:!1,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:!1,hasInheritedLinks:!1,isShared:!1,item:this.props.sharingItemInformation?this.props.sharingItemInformation:{name:"",childCount:0,hasDlpPolicy:!1},fileExtension:"",sharingLinks:[],sharingPrincipals:[],peoplePickerSettings:{},userDisplayName:"",defaultShareLinkPermission:x.e.view,defaultLinkKind:y.e.uninitialized,userRole:v.e.none,hasPermissionsInformation:!1,sharingAbilities:null,directLink:null,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:void 0,permissionsInformation:void 0};return this._renderShareMain(t,e)},t.prototype._renderPermissionsList=function(){this._store.isConsumer()?this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!1):this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&this.state.sharingInformation.addressBarLinkSettings||this._store.fetchSharingInformation(!0,!0);var e=!1;return B.s(this.state.currentSettings.audience,this.state.sharingInformation.sharingAbilities)&&(e=!0),this.state.sharingInformation&&this.state.sharingInformation.sharedObjectType===re.e.list&&Z.v(),Z.F()&&this._viewStates.push(this.state.viewState),m.createElement(O.PermissionsList,Object(a.__assign)({},this._baseProps,{onStopSharingClicked:this.props.onStopSharingClicked,advancedUrl:this.props.advancedUrl,showHeader:this.state.showHeaderInManagedAccess||this.props.showHeaderInManageAccess,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,backButtonClicked:this._returnToPreviousView,shareButtonClicked:this._enterShareView,grantAccessClicked:this._enterGrantAccessView,centeredManageAccessEnabled:this.props.showHeaderInManageAccess,hideElementsInManageAccess:this._hideElementsInManageAccess,engagementExtraData:this._engagementExtraData,isInfectedFile:e}))},t.prototype._renderPermissionsPivot=function(){return this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!0),m.createElement(w.PermissionsPivot,Object(a.__assign)({},this._baseProps,{sharingInformation:this.state.sharingInformation,clientId:this.props.clientId,onDefaultShare:this._onPermissionsDefaultShare,showCloseButton:!M.m(this.props.clientId),onDismiss:this._dismiss,store:this._store,engagementExtraData:this._engagementExtraData,viewOverride:this._lastPermissionsSubView||void 0,companyName:this.state.companyName,onStopSharingClicked:this.props.onStopSharingClicked,shareLoadingCustomerPromise:this.props.shareLoadingCustomerPromise,pageContext:this.props.pageContext}))},t.prototype._renderAddPeople=function(){var e=this,t=!this.props.hideShareDialogOverflowButton;return m.createElement(m.Fragment,null,m.createElement(V.AddPeople,Object(a.__assign)({},this._baseProps,{backButtonClicked:this._enterManageAccessView,centeredManageAccessEnabled:this.props.showHeaderInManageAccess,onManageExistingAccessClick:t?function(){return e._showPermissionsList()}:void 0,sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,onViewPolicyTipClicked:this._onViewPolicyTipClicked})))},t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return m.createElement(T.e,{message:u.K})},t.prototype._resizeIfNeeded=function(){ee.i()&&this.state.viewState===d.e.shareToTeams||this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)},t.prototype._getModifiedSharingLinkUrl=function(e,t,n){var a=this.state.shareType,i=e.url;if(a!==o.e.copy&&a!==o.e.outlook)return i;var r=this._getBase62Id(),s=new N.t(i);Object(ue.e)()||s.setQueryParameter("e",r);var c=this._store.getNavId();if(c&&s.setQueryParameter("nav",c),Z.L()){var d=this._store.getInvitationId();d&&s.setQueryParameter("inviteid",d)}return s.toString()},t.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")},t.prototype._setGenericErrorState=function(e){var t,n=this,i=e.stack?e.stack:e.toString();i.length>1024&&(i=i.substr(0,1024));var r=Object(a.__assign)(Object(a.__assign)({},this.state.sharingInformation),{error:i,errorCategory:I.e.generic,errorMessage:u.Rs,debugErrorMessage:"CorrelationId: "+this._correlationId});null===(t=this.props.shareLoadingCustomerPromise)||void 0===t||t.forEach(function(e){return e.end({resultType:se.e.Failure,scenario:"ShareLoading",errorCode:i,extraData:{clientId:n.props.clientId}})}),this.setState({sharingInformation:r,viewState:d.e.error})},t.prototype._sanitizeSharingContextInfo=function(e){if(e&&(this._isSanitizedUrl(e.customizedExternalSharingServiceUrl)||(e.customizedExternalSharingServiceUrl=""),this._isSanitizedUrl(e.fixItUrl)||(e.fixItUrl=""),e.defaultSharingLink&&!this._isSanitizedUrl(e.defaultSharingLink.url)&&(e.defaultSharingLink.url=""),e.directLink&&!this._isSanitizedUrl(e.directLink.url)&&(e.directLink.url=""),e.sharingLinks))for(var t=0;t<e.sharingLinks.length;t++)e.sharingLinks[t]&&!this._isSanitizedUrl(e.sharingLinks[t].url)&&(e.sharingLinks[t].url="")},t.prototype._isSanitizedUrl=function(e){return!e||0===e.length||0===e.toLowerCase().indexOf("http://")||0===e.toLowerCase().indexOf("https://")},t.prototype._writeShareDataToRumoneLogger=function(e){var t=e.mode,n=e.viewState,a=this.props.clickTime||this._store.getSharingClickTime()||performance.timing.navigationStart;this._writePerfData({pageTransitionType:de.e.fullPageLoad,startTime:a,mode:this.props.mode,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})},t.prototype._writeCopyLinkTargetDataToRumoneLogger=function(e){if(this._rumoneLogger.resetRumOne()){var t=e.mode,n=e.viewState,a=e.clickTime;this._writePerfData({pageTransitionType:de.e.onePageAppNavigation,startTime:a,mode:r.e.copy,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})}},t.prototype._writePerfData=function(e){var t,n=this,a=e.pageTransitionType,i=e.startTime,o=e.mode,s=e.originalMode,c=e.viewState,d=e.originalViewState,l=e.audience;if(this.props&&i&&this.props.clientId){var u=Object.keys(r.e).filter(function(e){return r.e[e]===o})[0],f=Object.keys(r.e).filter(function(e){return r.e[e]===s})[0],p=Object.keys(D.e).filter(function(e){return D.e[e]===n.props.clientId})[0],m=this._store.getSharingInformationAPIStats?this._store.getSharingInformationAPIStats():null,_=(null===(t=this._store)||void 0===t?void 0:t.getShareLinkAPIStats)?this._store.getShareLinkAPIStats():null,h=this._rumoneLogger.breakdownData,b={modeName:u,startTime:i,endTime:Date.now(),breakDownData:{sharingClientId:h(p),mode:h(u),audience:h(l),originalMode:h(f),viewState:h(c),originalViewState:h(d),getSharingInformationAPIStats:m?h(m):null,shareLinkAPIStats:_?h(_):null,realUserClickTime:h(i!==performance.timing.navigationStart),beforeNavigation:h(i<performance.timing.navigationStart?performance.timing.navigationStart-i:0),isInstantSecondLoad:!1,isLightSpeed:!1}};this._rumoneLogger.logSharingPerformance(b,a)}},t.contextTypes={resize:h.func.isRequired,onDismiss:h.func.isRequired,sharingStore:h.object.isRequired,shareClickTime:h.number},t}(m.Component)},function(e,t,n){"use strict";n.r(t),n.d(t,"Error",function(){return b});var a=n(0),i=n(476),r=n(1),o=n(1801),s=n(2635),c=n(1176),d=n(1642),l=n(2248),u=n(17);Object(u.n)([{rawString:'.Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-error{padding:16px;font-size:.875rem;font-weight:400;word-break:break-word;outline:transparent;position:relative;margin-bottom:30px}.od-Share-error::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share-error:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-Share-error-copy{margin-top:10px}[dir=ltr] .od-Share-error-copy{float:right}[dir=rtl] .od-Share-error-copy{float:left}.od-Share-error-clear{clear:both;display:block}.od-Share-error-message{min-height:3.125rem}[dir=ltr] .od-Share-error-report{float:right}[dir=rtl] .od-Share-error-report{float:left}[dir=ltr] .od-Share-error-report{margin-right:5px}[dir=rtl] .od-Share-error-report{margin-left:5px}.od-Share-error-chevron{font-size:.625rem}[dir=ltr] .od-Share-error-chevron{margin-left:5px}[dir=rtl] .od-Share-error-chevron{margin-right:5px}.od-Share-error-technical{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding:0 10px 10px 10px;margin-bottom:10px;word-wrap:break-word}[dir=rtl] .od-Share-error-technical{padding:0 10px 10px 10px}.od-Share-error-technical button.od-Share-error-copy{font-size:.875rem;padding:0 1rem;border-radius:.125rem;min-width:5rem;height:2rem}.od-Share-error-button{display:flex;justify-content:flex-end}"}]);var f=n(1800),p=n(1818),m=n(1863),_=n(1826),h=n(1806),b=function(e){function t(t,n){var a=e.call(this,t)||this;return a._errorMessage=Object(r.createRef)(),a._dismissComponent=function(e){e.stopPropagation(),e.preventDefault(),a._onDismiss()},a._onToggleDetailsClicked=function(){a.setState({areDetailsVisible:!a.state.areDetailsVisible})},a._onCopyToClipboardClicked=function(){var e;Object(l.e)((null===(e=a.props.sharingInformation)||void 0===e?void 0:e.debugErrorMessage)||"")},a.getErrorHeaderTitle=function(){var e,t;return"geoLocInvalidRequest"===(null===(e=a.props.sharingInformation)||void 0===e?void 0:e.error)?o.Wo:(null===(t=a.props.sharingInformation)||void 0===t?void 0:t.isStubFile)?o.Qo:o.Et},a._resize=n.resize,a.state={areDetailsVisible:!1,isErrorPageGotError:!1},a._onDismiss=n.onDismiss,a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._resize(),this.context.sharingClientMessenger?this.context.sharingClientMessenger.sendShareReady():_.b(this.context.clickTime,this.props.clientId,this.props.mode)},t.prototype.componentDidCatch=function(e,t){this.setState({isErrorPageGotError:!0})},t.prototype.componentDidUpdate=function(e,t){this._errorMessage.current&&this._errorMessage.current.focus(),this._resize()},t.prototype.render=function(){var e,t,n,a,l,u,f,_,b,g=(null===(e=this.props.sharingInformation)||void 0===e?void 0:e.errorMessage)||this.props.genericErrorMessage||"unknown Error";if(this.state.isErrorPageGotError)return r.createElement("div",null,g);var v=this.state.areDetailsVisible&&(null===(t=this.props.sharingInformation)||void 0===t?void 0:t.debugErrorMessage)?r.createElement("div",{className:"od-Share-error-technical"},r.createElement("h4",null," ",o.wt," "),r.createElement("div",null,null===(n=this.props.sharingInformation)||void 0===n?void 0:n.debugErrorMessage),r.createElement(s.e,{className:"od-Share-error-copy",onClick:this._onCopyToClipboardClicked},o.It),r.createElement("span",{className:"od-Share-error-clear"})):null,y=this.props.showReportProblem?r.createElement("div",{className:"od-Share-error-report"},o.Ct):null,S=this.state.areDetailsVisible?o.xt:o.Ot,D=(null===(a=this.props.sharingInformation)||void 0===a?void 0:a.debugErrorMessage)?r.createElement(c.e,{onClick:this._onToggleDetailsClicked,tabIndex:0,"aria-label":S,styles:{root:{border:"none"}}},S,r.createElement(i.e,{iconName:this.state.areDetailsVisible?"ChevronUp":"ChevronDown",className:"od-Share-error-chevron"})):null;return(null===(l=this.props.sharingInformation)||void 0===l?void 0:l.isStubFile)&&(g=o.Es),r.createElement("div",{className:"od-ShareMain-section new",role:"alert",tabIndex:0,ref:this._errorMessage},r.createElement(m.e,{clientId:this.props.clientId,title:this.getErrorHeaderTitle(),item:null===(u=this.props.sharingInformation)||void 0===u?void 0:u.item,viewState:p.e.error}),r.createElement("div",{className:"od-Share-error-message"},r.createElement("p",null," ",g," "),(null===(f=this.props.sharingInformation)||void 0===f?void 0:f.fixItUrl)&&r.createElement("a",{href:null===(_=this.props.sharingInformation)||void 0===_?void 0:_.fixItUrl,target:"_blank"},o.an),v),r.createElement("div",null,D,y),this._onDismiss&&!(null===(b=this.props.sharingInformation)||void 0===b?void 0:b.isStubFile)&&Object(h._)(this.props.clientId)&&r.createElement("div",{className:"od-Share-error-button"},r.createElement(d.e,{onClick:this._dismissComponent,styles:{label:{fontSize:"0.875rem"},root:{height:"2rem",padding:"0 1rem",borderRadius:"0.25rem"}}},o.Le)))},t.contextTypes={resize:f.func.isRequired,onDismiss:f.func,shareClickTime:f.number,sharingClientMessenger:f.object},t}(r.Component);t.default=b},function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(1),r=n(1774),o=n(1644),s=n(129),c=n(1817),d=n(1801),l=n(17);Object(l.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareToTeams{width:100%}.od-ShareToTeams.wide{min-width:480px}@media (max-width:480px){.od-ShareToTeams.wide{min-width:320px}}.od-ShareToTeams .ms-Dialog-inner{padding:0}.od-ShareToTeams iframe{border:none;height:500px;width:100%}"}]);var u=function(e){function t(t){var n=e.call(this,t)||this;return n._closeModal=function(){n.setState({showModal:!1}),n.props.onDismiss()},n._onBackButtonClicked=function(){n.setState({showModal:!1}),n.props.onBackButtonClicked()},n.state={showModal:!0},n}return Object(a.__extends)(t,e),t.prototype.render=function(){return i.createElement(r.e,{isOpen:this.state.showModal,onDismiss:this._closeModal,isBlocking:!1,dialogContentProps:{showCloseButton:!0,className:"od-ShareToTeams"},minWidth:480},c.t(i.createElement(o.e,{className:"od-Share-backButton",id:"od-ShareToTeams-backButton",onClick:this._onBackButtonClicked,iconProps:{iconName:"Back"},ariaLabel:d.ie}),d.ie,{position:s.e.bottomLeftEdge,targetElementId:"od-ShareToTeams-backButton"}),i.createElement("iframe",{src:this.props.url,style:{height:"".concat(this.props.height(),"px")}}))},t}(i.Component);t.default=u},function(e,t,n){"use strict";n.r(t),n.d(t,"SharePolicyDetails",function(){return m});var a=n(0),i=n(17);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PolicyTip{padding:0 16px 10px 16px}.od-Share-PolicyTip .od-PolicyTip-title{display:none}"}]);var r=n(1807),o=n(1863),s=n(2571),c=n(1818),d=n(1),l=n(1800),u=n(1801),f=n(2528),p=n(1830),m=function(e){function t(t,n){var i=e.call(this,t)||this;return i._onOverrideClicked=function(){var e=i.props.policyTipInformation.info.overrideOption;e===f.n.allow?i._store.updatePolicy(f.e.override):e===f.n.allowWithJustification&&i.setState(Object(a.__assign)(Object(a.__assign)({},i.state),{showJustificationInput:!0}))},i._onOverrideSubmitClicked=function(e){i._store.updatePolicy(f.e.override,e)},i._onReportClicked=function(){i._store.updatePolicy(f.e.reportFalsePositive)},i._store=n.sharingStore,i._resize=n.resize,i.state={showJustificationInput:!1},i}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(){this._resize()},t.prototype.render=function(){var e=this.props,t=this.state,n=e.policyTipInformation.info;return d.createElement("div",{className:"od-SharePolicyDetails"},d.createElement(o.e,Object(a.__assign)({},Object(p.e)(this.props),{item:e.sharingInformation.item,viewState:c.e.policyDetails,hasBackButton:!0})),d.createElement("div",{className:"od-Share-PolicyTip"},d.createElement(s.e,{confirmationText:this._getConfirmationText(),onDismissed:function(){},onOverrideClicked:this._onOverrideClicked,onOverrideSubmitClicked:this._onOverrideSubmitClicked,overrideRequiresJustification:n?n.overrideOption===f.n.allowWithJustification:void 0,showJustificationInput:t.showJustificationInput,onReportClicked:this._onReportClicked,strings:this._getStrings()})))},t.prototype._getStrings=function(){var e=this.props.policyTipInformation.info,t=e&&(e.overrideOption===f.n.allow||e.overrideOption===f.n.allowWithJustification);return{headerText:u.Tr,issues:e?e.issueDescriptions:void 0,lastScannedText:e&&e.lastScanned?"".concat(u.Ur,": ").concat(Object(r.s)(e.lastScanned)):void 0,learnMoreActionLabel:e?u.Fr:void 0,learnMoreLabel:e?u.Hr:void 0,learnMoreUrl:e?e.policyInfoUrl:void 0,noPolicyTipInfoError:e?void 0:u.Rr,overrideActionLabel:t?u.Nr:void 0,overrideLabel:u.jr,policyTipDescription:e?e.explanationText:void 0,reportActionLabel:u.Vr,reportLabel:u.Kr,reportInProgressLabel:u.Gr,submitButtonLabel:u.Wr,titleText:void 0}},t.prototype._getConfirmationText=function(){var e=this.props.policyTipInformation.actionResult;return null===e?"":e===f.t.falsePositiveReported?u.zr:e===f.t.overridden||e===f.t.falsePositiveReportedAndOverridden?u.Br:""},t.contextTypes={sharingStore:l.object.isRequired,resize:l.func.isRequired},t}(d.Component);t.default=m},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={anyone:0,organization:1,specificPeople:2}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(39),i=n(604),r=n(822);function o(e,t){void 0===t&&(t=!1);var n=e.split("|");if("0"===n[0])return e.substring(2);var o="1"===n[1],s=n[2],c=n[3]||"",d=n[4]||"";switch(s){case"1":return Object(i.t)("AFewSeconds",t,o);case"2":return Object(i.t)("AboutAMinute",t,o);case"3":return Object(i.e)(Number(c),"XMinutes",t,o);case"4":return Object(i.t)("AboutAnHour",t,o);case"5":return c?Object(a.format)(Object(i.t)(o?"TomorrowAndTime":"YesterdayAndTime",t),c):Object(i.t)(o?"Tomorrow":"Yesterday",t);case"6":return Object(i.e)(Number(c),"XHours",t,o);case"7":return d?Object(a.format)(r.RelativeDateTime_DayAndTime,c,d):c;case"8":return Object(i.e)(Number(c),"XDays",t,o);case"9":return Object(i.t)("Today",t)}return null}},,,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.succeed=0]="succeed",e[e.unsupport=1]="unsupport",e[e.failed=2]="failed"}(a||(a={}))},,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:'@charset "UTF-8";.od-ItemActivity-item{max-width:100%}.od-ItemActivity-item-nameText{font-weight:600;color:'},{theme:"bodyText",defaultValue:"#323130"},{rawString:"}@media (forced-colors:active){.od-ItemActivity-item-nameText.lpc-hoverTarget{color:ButtonText}}.od-ItemActivity-item-linkText{font-weight:600;text-decoration:none}.od-ItemActivity-item-clickableLinkText{max-width:100%;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:';cursor:pointer;font-family:inherit;font-size:12px}.od-ItemActivity-otherActors{list-style-type:none;margin:0;padding:0}.od-ItemActivity-n-Others{font-weight:600}.od-ItemActivity-item-textContent{overflow:hidden;text-overflow:ellipsis;display:inline-block;max-width:100%;vertical-align:middle}.od-ItemActivity-item .ms-ActivityItem-activityContent{width:calc(100% - 70px)}.od-ItemActivity-timeStamp{display:inline-block;vertical-align:middle}html[dir=ltr] .od-ItemActivity-timeStamp{padding-left:0}html[dir=rtl] .od-ItemActivity-timeStamp{padding-right:0}.od-ItemActivity-timeStamp:before{content:" ∙ "}.od-ItemActivity-persona{position:relative;width:100%;height:100%;font-weight:400;margin-top:-5px}@media screen and (-ms-high-contrast:active){.od-ItemActivity-persona{margin-top:0}}.od-ItemActivity-personaIcon{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:50%}.activitycard-deeplink-animate{animation:deeplinkHighlight 5s 1 cubic-bezier(.8,0,.5,1);-webkit-animation:deeplinkHighlight 5s 1 cubic-bezier(.8,0,.5,1)}.activitycard-deeplink-animate .od-ItemActivityList-activity{animation:deeplinkInnerHighlight 5s 1 cubic-bezier(.8,0,.5,1);-webkit-animation:deeplinkInnerHighlight 5s 1 cubic-bezier(.8,0,.5,1)}@keyframes deeplinkHighlight{0%{background-color:'},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";box-shadow:0 0 0 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}50%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";box-shadow:0 0 0 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}}@keyframes deeplinkInnerHighlight{0%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}50%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}}"}])},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return F}),n.d(t,"t",function(){return H});var a={};n.r(a),n.d(a,"pickerText",function(){return E}),n.d(a,"inputFocused",function(){return A}),n.d(a,"inputDisabled",function(){return L}),n.d(a,"pickerInput",function(){return k}),n.d(a,"pickerItems",function(){return M}),n.d(a,"screenReaderOnly",function(){return P});var i=n(0),r=n(1),o=n(809),s=n(1526),c=n(112),d=n(529),l=n(1104),u=n(524),f=n(587),p=n(51),m=n(2429),_=n(1312),h=n(1598),b=n(1763),g=n(108),v=n(129),y=n(2148),S=n(21),D={root:"ms-Suggestions",suggestionsContainer:"ms-Suggestions-container",title:"ms-Suggestions-title",forceResolveButton:"ms-forceResolve-button",searchForMoreButton:"ms-SearchMore-button",spinner:"ms-Suggestions-spinner",noSuggestions:"ms-Suggestions-none",suggestionsAvailable:"ms-Suggestions-suggestionsAvailable",isSelected:"is-selected"};function I(e){var t,n=e.className,a=e.suggestionsClassName,r=e.theme,o=e.forceResolveButtonSelected,s=e.searchForMoreButtonSelected,c=r.palette,d=r.semanticColors,l=r.fonts,u=Object(S.I)(D,r),f={backgroundColor:"transparent",border:0,cursor:"pointer",margin:0,paddingLeft:8,position:"relative",borderTop:"1px solid "+c.neutralLight,height:40,textAlign:"left",width:"100%",fontSize:l.small.fontSize,selectors:{":hover":{backgroundColor:d.menuItemBackgroundPressed,cursor:"pointer"},":focus, :active":{backgroundColor:c.themeLight},".ms-Button-icon":{fontSize:l.mediumPlus.fontSize,width:25},".ms-Button-label":{margin:"0 4px 0 9px"}}},p={backgroundColor:c.themeLight,selectors:(t={},t[S.o]=Object(i.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},Object(S.x)()),t)};return{root:[u.root,{minWidth:260},n],suggestionsContainer:[u.suggestionsContainer,{overflowY:"auto",overflowX:"hidden",maxHeight:300,transform:"translate3d(0,0,0)"},a],title:[u.title,{padding:"0 12px",fontSize:l.small.fontSize,color:c.themePrimary,lineHeight:40,borderBottom:"1px solid "+d.menuItemBackgroundPressed}],forceResolveButton:[u.forceResolveButton,f,o&&[u.isSelected,p]],searchForMoreButton:[u.searchForMoreButton,f,s&&[u.isSelected,p]],noSuggestions:[u.noSuggestions,{textAlign:"center",color:c.neutralSecondary,fontSize:l.small.fontSize,lineHeight:30}],suggestionsAvailable:[u.suggestionsAvailable,S.k],subComponentStyles:{spinner:{root:[u.spinner,{margin:"5px 0",paddingLeft:14,textAlign:"left",whiteSpace:"nowrap",lineHeight:20,fontSize:l.small.fontSize}],circle:{display:"inline-block",verticalAlign:"middle"},label:{display:"inline-block",verticalAlign:"middle",margin:"0 10px 0 16px"}}}}}var x=function(){function e(){var e=this;this._isSuggestionModel=function(e){return void 0!==e.item},this._ensureSuggestionModel=function(t){return e._isSuggestionModel(t)?t:{item:t,selected:!1,ariaLabel:t.name||t.primaryText}},this.suggestions=[],this.currentIndex=-1}return e.prototype.updateSuggestions=function(e,t){e&&e.length>0?(this.suggestions=this.convertSuggestionsToSuggestionItems(e),this.currentIndex=t||0,-1===t?this.currentSuggestion=void 0:void 0!==t&&(this.suggestions[t].selected=!0,this.currentSuggestion=this.suggestions[t])):(this.suggestions=[],this.currentIndex=-1,this.currentSuggestion=void 0)},e.prototype.nextSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex<this.suggestions.length-1)return this.setSelectedSuggestion(this.currentIndex+1),!0;if(this.currentIndex===this.suggestions.length-1)return this.setSelectedSuggestion(0),!0}return!1},e.prototype.previousSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex>0)return this.setSelectedSuggestion(this.currentIndex-1),!0;if(0===this.currentIndex)return this.setSelectedSuggestion(this.suggestions.length-1),!0}return!1},e.prototype.getSuggestions=function(){return this.suggestions},e.prototype.getCurrentItem=function(){return this.currentSuggestion},e.prototype.getSuggestionAtIndex=function(e){return this.suggestions[e]},e.prototype.hasSelectedSuggestion=function(){return!!this.currentSuggestion},e.prototype.removeSuggestion=function(e){this.suggestions.splice(e,1)},e.prototype.createGenericSuggestion=function(e){var t=this.convertSuggestionsToSuggestionItems([e])[0];this.currentSuggestion=t},e.prototype.convertSuggestionsToSuggestionItems=function(e){return Array.isArray(e)?e.map(this._ensureSuggestionModel):[]},e.prototype.deselectAllSuggestions=function(){this.currentIndex>-1&&(this.suggestions[this.currentIndex].selected=!1,this.currentIndex=-1)},e.prototype.setSelectedSuggestion=function(e){e>this.suggestions.length-1||e<0?(this.currentIndex=0,this.currentSuggestion.selected=!1,this.currentSuggestion=this.suggestions[0],this.currentSuggestion.selected=!0):(this.currentIndex>-1&&(this.suggestions[this.currentIndex].selected=!1),this.suggestions[e].selected=!0,this.currentIndex=e,this.currentSuggestion=this.suggestions[e])},e}(),C=n(2100),O=n(2396),w=n(17);Object(w.n)([{rawString:".pickerText_a8f91b74{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";min-width:180px;min-height:30px}.pickerText_a8f91b74:hover{border-color:"},{theme:"inputBorderHovered",defaultValue:"#323130"},{rawString:"}.pickerText_a8f91b74.inputFocused_a8f91b74{position:relative;border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:'}.pickerText_a8f91b74.inputFocused_a8f91b74:after{pointer-events:none;content:"";position:absolute;left:-1px;top:-1px;bottom:-1px;right:-1px;border:2px solid '},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:'}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.pickerText_a8f91b74.inputDisabled_a8f91b74{position:relative;border-color:GrayText}.pickerText_a8f91b74.inputDisabled_a8f91b74:after{pointer-events:none;content:"";position:absolute;left:0;top:0;bottom:0;right:0;background-color:Window}}.pickerInput_a8f91b74{height:34px;border:none;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;outline:0;padding:0 6px 0;-ms-flex-item-align:end;align-self:flex-end}.pickerItems_a8f91b74{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;max-width:100%}.screenReaderOnly_a8f91b74{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}'}]);var E="pickerText_a8f91b74",A="inputFocused_a8f91b74",L="inputDisabled_a8f91b74",k="pickerInput_a8f91b74",M="pickerItems_a8f91b74",P="screenReaderOnly_a8f91b74",T=a,U=Object(o.e)(),F=function(e){function t(t){var n,a=e.call(this,t)||this;a.root=r.createRef(),a.input=r.createRef(),a.suggestionElement=r.createRef(),a.SuggestionOfProperType=y.e,a._styledSuggestions=(n=a.SuggestionOfProperType,Object(s.e)(n,I,void 0,{scope:"Suggestions"})),a.dismissSuggestions=function(e){var t=function(){var t=!0;a.props.onDismiss&&(t=a.props.onDismiss(e,a.suggestionStore.currentSuggestion?a.suggestionStore.currentSuggestion.item:void 0)),(!e||e&&!e.defaultPrevented)&&!1!==t&&a.canAddItems()&&a.suggestionStore.hasSelectedSuggestion()&&a.state.suggestedDisplayValue&&a.addItemByIndex(0)};a.currentPromise?a.currentPromise.then(function(){return t()}):t(),a.setState({suggestionsVisible:!1})},a.refocusSuggestions=function(e){a.resetFocus(),a.suggestionStore.suggestions&&a.suggestionStore.suggestions.length>0&&(e===c.e.up?a.suggestionStore.setSelectedSuggestion(a.suggestionStore.suggestions.length-1):e===c.e.down&&a.suggestionStore.setSelectedSuggestion(0))},a.onInputChange=function(e){a.updateValue(e),a.setState({moreSuggestionsAvailable:!0,isMostRecentlyUsedVisible:!1})},a.onSuggestionClick=function(e,t,n){a.addItemByIndex(n)},a.onSuggestionRemove=function(e,t,n){a.props.onRemoveSuggestion&&a.props.onRemoveSuggestion(t),a.suggestionStore.removeSuggestion(n)},a.onInputFocus=function(e){a.selection.setAllSelected(!1),a.state.isFocused||(a._userTriggeredSuggestions(),a.props.inputProps&&a.props.inputProps.onFocus&&a.props.inputProps.onFocus(e))},a.onInputBlur=function(e){a.props.inputProps&&a.props.inputProps.onBlur&&a.props.inputProps.onBlur(e)},a.onBlur=function(e){if(a.state.isFocused){var t=e.relatedTarget;null===e.relatedTarget&&(t=document.activeElement),t&&!Object(d.e)(a.root.current,t)&&(a.setState({isFocused:!1}),a.props.onBlur&&a.props.onBlur(e))}},a.onWrapperClick=function(e){a.canAddItems()||a.resetFocus(a.state.items.length-1)},a.onClick=function(e){void 0!==a.props.inputProps&&void 0!==a.props.inputProps.onClick&&a.props.inputProps.onClick(e),0===e.button&&a._userTriggeredSuggestions()},a.onFocus=function(){a.state.isFocused||a.setState({isFocused:!0})},a.onKeyDown=function(e){var t=e.which;switch(t){case c.e.escape:a.state.suggestionsVisible&&(a.setState({suggestionsVisible:!1}),e.preventDefault(),e.stopPropagation());break;case c.e.tab:case c.e.enter:a.suggestionElement.current&&a.suggestionElement.current.hasSuggestedActionSelected()?a.suggestionElement.current.executeSelectedAction():!e.shiftKey&&a.suggestionStore.hasSelectedSuggestion()&&a.state.suggestionsVisible?(a.completeSuggestion(),e.preventDefault(),e.stopPropagation()):a._completeGenericSuggestion();break;case c.e.backspace:a.props.disabled||a.onBackspace(e),e.stopPropagation();break;case c.e.del:a.props.disabled||(a.input.current&&e.target===a.input.current.inputElement&&a.state.suggestionsVisible&&-1!==a.suggestionStore.currentIndex?(a.props.onRemoveSuggestion&&a.props.onRemoveSuggestion(a.suggestionStore.currentSuggestion.item),a.suggestionStore.removeSuggestion(a.suggestionStore.currentIndex),a.forceUpdate()):a.onBackspace(e)),e.stopPropagation();break;case c.e.up:a.input.current&&e.target===a.input.current.inputElement&&a.state.suggestionsVisible&&(a.suggestionElement.current&&a.suggestionElement.current.tryHandleKeyDown(t,a.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation(),a.forceUpdate()):a.suggestionElement.current&&a.suggestionElement.current.hasSuggestedAction()&&0===a.suggestionStore.currentIndex?(e.preventDefault(),e.stopPropagation(),a.suggestionElement.current.focusAboveSuggestions(),a.suggestionStore.deselectAllSuggestions(),a.forceUpdate()):a.suggestionStore.previousSuggestion()&&(e.preventDefault(),e.stopPropagation(),a.onSuggestionSelect()));break;case c.e.down:a.input.current&&e.target===a.input.current.inputElement&&a.state.suggestionsVisible&&(a.suggestionElement.current&&a.suggestionElement.current.tryHandleKeyDown(t,a.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation(),a.forceUpdate()):a.suggestionElement.current&&a.suggestionElement.current.hasSuggestedAction()&&a.suggestionStore.currentIndex+1===a.suggestionStore.suggestions.length?(e.preventDefault(),e.stopPropagation(),a.suggestionElement.current.focusBelowSuggestions(),a.suggestionStore.deselectAllSuggestions(),a.forceUpdate()):a.suggestionStore.nextSuggestion()&&(e.preventDefault(),e.stopPropagation(),a.onSuggestionSelect()))}},a.onItemChange=function(e,t){var n=a.state.items;if(t>=0){var i=n;i[t]=e,a._updateSelectedItems(i)}},a.onGetMoreResults=function(){a.setState({isSearching:!0},function(){if(a.props.onGetMoreResults&&a.input.current){var e=a.props.onGetMoreResults(a.input.current.value,a.state.items),t=e,n=e;Array.isArray(t)?(a.updateSuggestions(t),a.setState({isSearching:!1})):n.then&&n.then(function(e){a.updateSuggestions(e),a.setState({isSearching:!1})})}else a.setState({isSearching:!1});a.input.current&&a.input.current.focus(),a.setState({moreSuggestionsAvailable:!1,isResultsFooterVisible:!0})})},a.completeSelection=function(e){a.addItem(e),a.updateValue(""),a.input.current&&a.input.current.clear(),a.setState({suggestionsVisible:!1})},a.addItemByIndex=function(e){a.completeSelection(a.suggestionStore.getSuggestionAtIndex(e).item)},a.addItem=function(e){var t=a.props.onItemSelected?a.props.onItemSelected(e):e;if(null!==t){var n=t,i=t;if(i&&i.then)i.then(function(e){var t=a.state.items.concat([e]);a._updateSelectedItems(t)});else{var r=a.state.items.concat([n]);a._updateSelectedItems(r)}a.setState({suggestedDisplayValue:"",selectionRemoved:void 0})}},a.removeItem=function(e){var t=a.state.items,n=t.indexOf(e);if(n>=0){var i=t.slice(0,n).concat(t.slice(n+1));a.setState({selectionRemoved:e}),a._updateSelectedItems(i)}},a.removeItems=function(e){var t=a.state.items.filter(function(t){return-1===e.indexOf(t)});a._updateSelectedItems(t)},a._shouldFocusZoneEnterInnerZone=function(e){if(a.state.suggestionsVisible)switch(e.which){case c.e.up:case c.e.down:return!0}return e.which===c.e.enter},a._onResolveSuggestions=function(e){var t=a.props.onResolveSuggestions(e,a.state.items);null!==t&&a.updateSuggestionsList(t,e)},a._completeGenericSuggestion=function(){if(a.props.onValidateInput&&a.input.current&&a.props.onValidateInput(a.input.current.value)!==C.e.invalid&&a.props.createGenericItem){var e=a.props.createGenericItem(a.input.current.value,a.props.onValidateInput(a.input.current.value));a.suggestionStore.createGenericSuggestion(e),a.completeSuggestion()}},a._userTriggeredSuggestions=function(){if(!a.state.suggestionsVisible){var e=a.input.current?a.input.current.value:"";e?0===a.suggestionStore.suggestions.length?a._onResolveSuggestions(e):a.setState({isMostRecentlyUsedVisible:!1,suggestionsVisible:!0}):a.onEmptyInputFocus()}},Object(l.e)(a),a._async=new u.e(a);var i=t.selectedItems||t.defaultSelectedItems||[];return a._id=Object(f.e)(),a._ariaMap={selectedItems:"selected-items-"+a._id,selectedSuggestionAlert:"selected-suggestion-alert-"+a._id,suggestionList:"suggestion-list-"+a._id,combobox:"combobox-"+a._id},a.suggestionStore=new x,a.selection=new h.e({onSelectionChanged:function(){return a.onSelectionChange()}}),a.selection.setItems(i),a.state={items:i,suggestedDisplayValue:"",isMostRecentlyUsedVisible:!1,moreSuggestionsAvailable:!1,isFocused:!1,isSearching:!1,selectedIndices:[],selectionRemoved:void 0},a}return Object(i.__extends)(t,e),t.getDerivedStateFromProps=function(e){return e.selectedItems?{items:e.selectedItems}:null},Object.defineProperty(t.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.selection.setItems(this.state.items),this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,this.props.resolveDelay)},t.prototype.componentDidUpdate=function(e,t){if(this.state.items&&this.state.items!==t.items){var n=this.selection.getSelectedIndices()[0];this.selection.setItems(this.state.items),this.state.isFocused&&(this.state.items.length<t.items.length?(this.selection.setIndexSelected(n,!1,!0),this.resetFocus(n)):this.state.items.length>t.items.length&&!this.canAddItems()&&this.resetFocus(this.state.items.length-1))}},t.prototype.componentWillUnmount=function(){this.currentPromise&&(this.currentPromise=void 0),this._async.dispose()},t.prototype.focus=function(){this.input.current&&this.input.current.focus()},t.prototype.focusInput=function(){this.input.current&&this.input.current.focus()},t.prototype.completeSuggestion=function(e){this.suggestionStore.hasSelectedSuggestion()&&this.input.current?this.completeSelection(this.suggestionStore.currentSuggestion.item):e&&this._completeGenericSuggestion()},t.prototype.render=function(){var e=this.state,t=e.suggestedDisplayValue,n=e.isFocused,a=e.items,o=this.props,s=o.className,c=o.inputProps,d=o.disabled,l=o.selectionAriaLabel,u=o.selectionRole,f=void 0===u?"list":u,m=o.theme,_=o.styles,h=!!this.state.suggestionsVisible,v=h?this._ariaMap.suggestionList:void 0,y=_?U(_,{theme:m,className:s,isFocused:n,disabled:d,inputClassName:c&&c.className}):{root:Object(p.e)("ms-BasePicker",s||""),text:Object(p.e)("ms-BasePicker-text",T.pickerText,this.state.isFocused&&T.inputFocused),itemsWrapper:T.pickerItems,input:Object(p.e)("ms-BasePicker-input",T.pickerInput,c&&c.className),screenReaderText:T.screenReaderOnly},S=this.props["aria-label"]||(null==c?void 0:c["aria-label"]);return r.createElement("div",{ref:this.root,className:y.root,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,onClick:this.onWrapperClick},this.renderCustomAlert(y.screenReaderText),r.createElement("span",{id:this._ariaMap.selectedItems+"-label",hidden:!0},l||S),r.createElement(b.e,{selection:this.selection,selectionMode:g.n.multiple},r.createElement("div",{className:y.text,"aria-owns":v},a.length>0&&r.createElement("span",{id:this._ariaMap.selectedItems,className:y.itemsWrapper,role:f,"aria-labelledby":this._ariaMap.selectedItems+"-label"},this.renderItems()),this.canAddItems()&&r.createElement(O.e,Object(i.__assign)({spellCheck:!1},c,{className:y.input,componentRef:this.input,id:(null==c?void 0:c.id)?c.id:this._ariaMap.combobox,onClick:this.onClick,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:t,"aria-activedescendant":h?this.getActiveDescendant():void 0,"aria-controls":v,"aria-describedby":a.length>0?this._ariaMap.selectedItems:void 0,"aria-expanded":h,"aria-haspopup":"listbox","aria-label":S,role:"combobox",disabled:d,onInputChange:this.props.onInputChange})))),this.renderSuggestions())},t.prototype.canAddItems=function(){var e=this.state.items,t=this.props.itemLimit;return void 0===t||e.length<t},t.prototype.renderSuggestions=function(){var e=this._styledSuggestions;return this.state.suggestionsVisible&&this.input?r.createElement(_.e,Object(i.__assign)({isBeakVisible:!1,gapSpace:5,target:this.input.current?this.input.current.inputElement:void 0,onDismiss:this.dismissSuggestions,directionalHint:v.e.bottomLeftEdge,directionalHintForRTL:v.e.bottomRightEdge},this.props.pickerCalloutProps),r.createElement(e,Object(i.__assign)({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isExtendedLoading:this.state.suggestionsExtendedLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel,suggestionsListId:this._ariaMap.suggestionList,createGenericItem:this._completeGenericSuggestion},this.props.pickerSuggestionsProps))):null},t.prototype.renderItems=function(){var e=this,t=this.props,n=t.disabled,a=t.removeButtonAriaLabel,i=t.removeButtonIconProps,r=this.props.onRenderItem,o=this.state,s=o.items,c=o.selectedIndices;return s.map(function(t,o){return r({item:t,index:o,key:t.key?t.key:o,selected:-1!==c.indexOf(o),onRemoveItem:function(){return e.removeItem(t)},disabled:n,onItemChange:e.onItemChange,removeButtonAriaLabel:a,removeButtonIconProps:i})})},t.prototype.resetFocus=function(e){var t=this.state.items;if(t.length&&e>=0){var n=this.root.current&&this.root.current.querySelectorAll("[data-selection-index]")[Math.min(e,t.length-1)];n&&n.focus()}else this.canAddItems()?this.input.current&&this.input.current.focus():this.resetFocus(t.length-1)},t.prototype.onSuggestionSelect=function(){if(this.suggestionStore.currentSuggestion){var e=this.input.current?this.input.current.value:"",t=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e);this.setState({suggestedDisplayValue:t})}},t.prototype.onSelectionChange=function(){this.setState({selectedIndices:this.selection.getSelectedIndices()})},t.prototype.updateSuggestions=function(e){this.suggestionStore.updateSuggestions(e,0),this.forceUpdate()},t.prototype.onEmptyInputFocus=function(){var e=this.props.onEmptyResolveSuggestions?this.props.onEmptyResolveSuggestions:this.props.onEmptyInputFocus;if(e){var t=e(this.state.items);this.updateSuggestionsList(t),this.setState({isMostRecentlyUsedVisible:!0,suggestionsVisible:!0,moreSuggestionsAvailable:!1})}},t.prototype.updateValue=function(e){this._onResolveSuggestions(e)},t.prototype.updateSuggestionsList=function(e,t){var n=this;Array.isArray(e)?this._updateAndResolveValue(t,e):e&&e.then&&(this.setState({suggestionsLoading:!0}),this._startLoadTimer(),this.suggestionStore.updateSuggestions([]),void 0!==t?this.setState({suggestionsVisible:this._getShowSuggestions()}):this.setState({suggestionsVisible:this.input.current&&this.input.current.inputElement===document.activeElement}),this.currentPromise=e,e.then(function(a){e===n.currentPromise&&n._updateAndResolveValue(t,a)}))},t.prototype.resolveNewValue=function(e,t){var n=this;this.updateSuggestions(t);var a=void 0;this.suggestionStore.currentSuggestion&&(a=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e)),this.setState({suggestedDisplayValue:a,suggestionsVisible:this._getShowSuggestions()},function(){return n.setState({suggestionsLoading:!1,suggestionsExtendedLoading:!1})})},t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(e)},t.prototype.onBackspace=function(e){(this.state.items.length&&!this.input.current||this.input.current&&!this.input.current.isValueSelected&&0===this.input.current.cursorLocation)&&(this.selection.getSelectedCount()>0?this.removeItems(this.selection.getSelection()):this.removeItem(this.state.items[this.state.items.length-1]))},t.prototype.getActiveDescendant=function(){var e;if(!this.state.suggestionsLoading){var t=this.suggestionStore.currentIndex;return t<0?(null===(e=this.suggestionElement.current)||void 0===e?void 0:e.hasSuggestedAction())?"sug-selectedAction":0===this.suggestionStore.suggestions.length?"sug-noResultsFound":void 0:"sug-"+t}},t.prototype.getSuggestionsAlert=function(e){void 0===e&&(e=T.screenReaderOnly);var t=this.suggestionStore.currentIndex;if(this.props.enableSelectedSuggestionAlert){var n=t>-1?this.suggestionStore.getSuggestionAtIndex(this.suggestionStore.currentIndex):void 0,a=n?n.ariaLabel:void 0;return r.createElement("div",{id:this._ariaMap.selectedSuggestionAlert,className:e},a+" ")}},t.prototype.renderCustomAlert=function(e){void 0===e&&(e=T.screenReaderOnly);var t=this.props.suggestionRemovedText,n=void 0===t?"removed {0}":t,a="";if(this.state.selectionRemoved){var i=this._getTextFromItem(this.state.selectionRemoved,"");a=Object(m.e)(n,i)}return r.createElement("div",{className:e,id:this._ariaMap.selectedSuggestionAlert,"aria-live":"assertive"},this.getSuggestionsAlert(e),a)},t.prototype._startLoadTimer=function(){var e=this;this._async.setTimeout(function(){e.state.suggestionsLoading&&e.setState({suggestionsExtendedLoading:!0})},3e3)},t.prototype._updateAndResolveValue=function(e,t){void 0!==e?this.resolveNewValue(e,t):(this.suggestionStore.updateSuggestions(t,-1),this.state.suggestionsLoading&&this.setState({suggestionsLoading:!1,suggestionsExtendedLoading:!1}))},t.prototype._updateSelectedItems=function(e){var t=this;this.props.selectedItems?this.onChange(e):this.setState({items:e},function(){t._onSelectedItemsUpdated(e)})},t.prototype._onSelectedItemsUpdated=function(e){this.onChange(e)},t.prototype._getShowSuggestions=function(){return void 0!==this.input.current&&null!==this.input.current&&this.input.current.inputElement===document.activeElement&&""!==this.input.current.value},t.prototype._getTextFromItem=function(e,t){return this.props.getTextFromItem?this.props.getTextFromItem(e,t):""},t}(r.Component),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.state,t=e.suggestedDisplayValue,n=e.isFocused,a=this.props,o=a.className,s=a.inputProps,c=a.disabled,d=a.selectionAriaLabel,l=a.selectionRole,u=void 0===l?"list":l,f=a.theme,m=a.styles,_=!!this.state.suggestionsVisible,h=_?this._ariaMap.suggestionList:void 0,v=m?U(m,{theme:f,className:o,isFocused:n,inputClassName:s&&s.className}):{root:Object(p.e)("ms-BasePicker",o||""),text:Object(p.e)("ms-BasePicker-text",T.pickerText,this.state.isFocused&&T.inputFocused,c&&T.inputDisabled),itemsWrapper:T.pickerItems,input:Object(p.e)("ms-BasePicker-input",T.pickerInput,s&&s.className),screenReaderText:T.screenReaderOnly},y=this.props["aria-label"]||(null==s?void 0:s["aria-label"]);return r.createElement("div",{ref:this.root,onBlur:this.onBlur,onFocus:this.onFocus},r.createElement("div",{className:v.root,onKeyDown:this.onKeyDown},this.renderCustomAlert(v.screenReaderText),r.createElement("div",{className:v.text,"aria-owns":h},r.createElement(O.e,Object(i.__assign)({},s,{className:v.input,componentRef:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onClick:this.onClick,onInputValueChange:this.onInputChange,suggestedDisplayValue:t,"aria-activedescendant":_?this.getActiveDescendant():void 0,"aria-controls":h,"aria-expanded":_,"aria-haspopup":"listbox","aria-label":y,role:"combobox",id:(null==s?void 0:s.id)?s.id:this._ariaMap.combobox,disabled:c,onInputChange:this.props.onInputChange})))),this.renderSuggestions(),r.createElement(b.e,{selection:this.selection,selectionMode:g.n.single},r.createElement("div",{id:this._ariaMap.selectedItems,className:"ms-BasePicker-selectedItems",role:u,"aria-label":d||y},this.renderItems())))},t.prototype.onBackspace=function(e){},t}(F)},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(1526),i=n(0),r=n(1),o=n(2034),s=n(1754),c=n(809),d=n(109),l=n(1002),u=n(1927),f=Object(c.e)(),p=r.forwardRef(function(e,t){var n=e.as,a=void 0===n?"div":n,c=e.ariaLabel,p=e.checked,_=e.className,h=e.defaultChecked,b=void 0!==h&&h,g=e.disabled,v=e.inlineLabel,y=e.label,S=e.offAriaLabel,D=e.offText,I=e.onAriaLabel,x=e.onChange,C=e.onChanged,O=e.onClick,w=e.onText,E=e.role,A=e.styles,L=e.theme,k=Object(o.e)(p,b,r.useCallback(function(e,t){null==x||x(e,t),null==C||C(t)},[x,C])),M=k[0],P=k[1],T=f(A,{theme:L,className:_,disabled:g,checked:M,inlineLabel:v,onOffMissing:!w&&!D}),U=M?I:S,F=Object(s.e)("Toggle",e.id),H=F+"-label",R=F+"-stateText",N=M?w:D,B=Object(d.s)(e,d.f,["defaultChecked"]),j=void 0;c||U||(y&&(j=H),N&&!j&&(j=R));var V=r.useRef(null);Object(l.n)(V),m(e,M,V);var z={root:{className:T.root,hidden:B.hidden},label:{children:y,className:T.label,htmlFor:F,id:H},container:{className:T.container},pill:Object(i.__assign)(Object(i.__assign)({},B),{"aria-disabled":g,"aria-checked":M,"aria-label":c||U,"aria-labelledby":j,className:T.pill,"data-is-focusable":!0,"data-ktp-target":!0,disabled:g,id:F,onClick:function(e){g||(P(!M,e),O&&O(e))},ref:V,role:E||"switch",type:"button"}),thumb:{className:T.thumb},stateText:{children:N,className:T.text,htmlFor:F,id:R}};return r.createElement(a,Object(i.__assign)({ref:t},z.root),y&&r.createElement(u.e,Object(i.__assign)({},z.label)),r.createElement("div",Object(i.__assign)({},z.container),r.createElement("button",Object(i.__assign)({},z.pill),r.createElement("span",Object(i.__assign)({},z.thumb))),(M&&w||D)&&r.createElement(u.e,Object(i.__assign)({},z.stateText))))});p.displayName="ToggleBase";var m=function(e,t,n){r.useImperativeHandle(e.componentRef,function(){return{get checked(){return!!t},focus:function(){n.current&&n.current.focus()}}},[t,n])},_=n(21),h=Object(a.e)(p,function(e){var t,n,a,r,o,s,c,d=e.theme,l=e.className,u=e.disabled,f=e.checked,p=e.inlineLabel,m=e.onOffMissing,h=d.semanticColors,b=d.palette,g=h.bodyBackground,v=h.inputBackgroundChecked,y=h.inputBackgroundCheckedHovered,S=b.neutralDark,D=h.disabledBodySubtext,I=h.smallInputBorder,x=h.inputForegroundChecked,C=h.disabledBodySubtext,O=h.disabledBackground,w=h.smallInputBorder,E=h.inputBorderHovered,A=h.disabledBodySubtext,L=h.disabledText;return{root:["ms-Toggle",f&&"is-checked",!u&&"is-enabled",u&&"is-disabled",d.fonts.medium,{marginBottom:"8px"},p&&{display:"flex",alignItems:"center"},l],label:["ms-Toggle-label",{display:"inline-block"},u&&{color:L,selectors:(t={},t[_.o]={color:"GrayText"},t)},p&&!m&&{marginRight:16},m&&p&&{order:1,marginLeft:16},p&&{wordBreak:"break-word"}],container:["ms-Toggle-innerContainer",{display:"flex",position:"relative"}],pill:["ms-Toggle-background",Object(_.D)(d,{inset:-3}),{fontSize:"20px",boxSizing:"border-box",width:40,height:20,borderRadius:10,transition:"all 0.1s ease",border:"1px solid "+w,background:g,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 3px",overflow:"visible"},!u&&[!f&&{selectors:{":hover":[{borderColor:E}],":hover .ms-Toggle-thumb":[{backgroundColor:S,selectors:(n={},n[_.o]={borderColor:"Highlight"},n)}]}},f&&[{background:v,borderColor:"transparent",justifyContent:"flex-end"},{selectors:(a={":hover":[{backgroundColor:y,borderColor:"transparent",selectors:(r={},r[_.o]={backgroundColor:"Highlight"},r)}]},a[_.o]=Object(i.__assign)({backgroundColor:"Highlight"},Object(_.x)()),a)}]],u&&[{cursor:"default"},!f&&[{borderColor:A}],f&&[{backgroundColor:D,borderColor:"transparent",justifyContent:"flex-end"}]],!u&&{selectors:{"&:hover":{selectors:(o={},o[_.o]={borderColor:"Highlight"},o)}}}],thumb:["ms-Toggle-thumb",{display:"block",width:12,height:12,borderRadius:"50%",transition:"all 0.1s ease",backgroundColor:I,borderColor:"transparent",borderWidth:6,borderStyle:"solid",boxSizing:"border-box"},!u&&f&&[{backgroundColor:x,selectors:(s={},s[_.o]={backgroundColor:"Window",borderColor:"Window"},s)}],u&&[!f&&[{backgroundColor:C}],f&&[{backgroundColor:O}]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 8px",userSelect:"none",fontWeight:_.r.regular}}},u&&{selectors:{"&&":{color:L,selectors:(c={},c[_.o]={color:"GrayText"},c)}}}]}},void 0,{scope:"Toggle"})}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(21),i=n(102),r=Object(i.t)(function(e,t,n,i){return{root:Object(a.U)("ms-ActivityItem",t,e.root,i&&e.isCompactRoot),pulsingBeacon:Object(a.U)("ms-ActivityItem-pulsingBeacon",e.pulsingBeacon),personaContainer:Object(a.U)("ms-ActivityItem-personaContainer",e.personaContainer,i&&e.isCompactPersonaContainer),activityPersona:Object(a.U)("ms-ActivityItem-activityPersona",e.activityPersona,i&&e.isCompactPersona,!i&&n&&2===n.length&&e.doublePersona),activityTypeIcon:Object(a.U)("ms-ActivityItem-activityTypeIcon",e.activityTypeIcon,i&&e.isCompactIcon),activityContent:Object(a.U)("ms-ActivityItem-activityContent",e.activityContent,i&&e.isCompactContent),activityText:Object(a.U)("ms-ActivityItem-activityText",e.activityText),commentText:Object(a.U)("ms-ActivityItem-commentText",e.commentText),timeStamp:Object(a.U)("ms-ActivityItem-timeStamp",e.timeStamp,i&&e.isCompactTimeStamp)}})},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(21),i=n(102),r="32px",o="16px",s="16px",c="13px",d=Object(i.t)(function(){return Object(a.M)({from:{opacity:0},to:{opacity:1}})}),l=Object(i.t)(function(){return Object(a.M)({from:{transform:"translateX(-10px)"},to:{transform:"translateX(0)"}})}),u=Object(i.t)(function(e,t,n,i,u,f){var p;void 0===e&&(e=Object(a.L)());var m={animationName:a.d.continuousPulseAnimationSingle(i||e.palette.themePrimary,u||e.palette.themeTertiary,"4px","28px","4px"),animationIterationCount:"1",animationDuration:".8s",zIndex:1},_={animationName:l(),animationIterationCount:"1",animationDuration:".5s"},h={animationName:d(),animationIterationCount:"1",animationDuration:".5s"},b={root:[e.fonts.small,{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",boxSizing:"border-box",color:e.palette.neutralSecondary},f&&n&&h],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:0},f&&n&&m],isCompactRoot:{alignItems:"center"},personaContainer:{display:"flex",flexWrap:"wrap",minWidth:r,width:r,height:r},isCompactPersonaContainer:{display:"inline-flex",flexWrap:"nowrap",flexBasis:"auto",height:o,width:"auto",minWidth:"0",paddingRight:"6px"},activityTypeIcon:{height:r,fontSize:s,lineHeight:s,marginTop:"3px"},isCompactIcon:{height:o,minWidth:o,fontSize:c,lineHeight:c,color:e.palette.themePrimary,marginTop:"1px",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",selectors:{".ms-Persona-imageArea":{margin:"-2px 0 0 -2px",border:"2px solid"+e.palette.white,borderRadius:"50%",selectors:(p={},p[a.o]={border:"none",margin:"0"},p)}}},activityPersona:{display:"block"},doublePersona:{selectors:{":first-child":{alignSelf:"flex-end"}}},isCompactPersona:{display:"inline-block",width:"8px",minWidth:"8px",overflow:"visible"},activityContent:[{padding:"0 8px"},f&&n&&_],activityText:{display:"inline"},isCompactContent:{flex:"1",padding:"0 4px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden"},commentText:{color:e.palette.neutralPrimary},timeStamp:[e.fonts.tiny,{fontWeight:400,color:e.palette.neutralSecondary}],isCompactTimeStamp:{display:"inline-block",paddingLeft:"0.3em",fontSize:"1em"}};return Object(a.v)(b,t)})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return z});var a,i=n(1526),r=n(21),o=n(102),s=n(435),c=n(525),d=Object(o.t)(function(){return Object(r.M)({"0%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"78.57%":{transform:"translate(0, 0)",animationTimingFunction:"cubic-bezier(0.62, 0, 0.56, 1)"},"82.14%":{transform:"translate(0, -5px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0, 1)"},"84.88%":{transform:"translate(0, 9px)",animationTimingFunction:"cubic-bezier(1, 0, 0.56, 1)"},"88.1%":{transform:"translate(0, -2px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0.67, 1)"},"90.12%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"100%":{transform:"translate(0, 0)"}})}),l=Object(o.t)(function(){return Object(r.M)({"0%":{transform:" scale(0)",animationTimingFunction:"linear"},"14.29%":{transform:"scale(0)",animationTimingFunction:"cubic-bezier(0.84, 0, 0.52, 0.99)"},"16.67%":{transform:"scale(1.15)",animationTimingFunction:"cubic-bezier(0.48, -0.01, 0.52, 1.01)"},"19.05%":{transform:"scale(0.95)",animationTimingFunction:"cubic-bezier(0.48, 0.02, 0.52, 0.98)"},"21.43%":{transform:"scale(1)",animationTimingFunction:"linear"},"42.86%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"45.71%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"50%":{transform:"scale(1)",animationTimingFunction:"linear"},"90.12%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"92.98%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"97.26%":{transform:"scale(1)",animationTimingFunction:"linear"},"100%":{transform:"scale(1)"}})}),u=Object(o.t)(function(){return Object(r.M)({"0%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"83.33%":{transform:" rotate(0deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"83.93%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"84.52%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.12%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.71%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"86.31%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"100%":{transform:"rotate(0deg)"}})}),f=n(0),p=n(1),m=n(809),_=n(121),h=n(208),b=n(112),g=n(529),v=n(170),y=n(1601),S=n(82),D=n(1795),I=Object(o.t)(function(){var e;return Object(r.T)({root:[{position:"absolute",boxSizing:"border-box",border:"1px solid ${}",selectors:(e={},e[r.o]={border:"1px solid WindowText"},e)},Object(r.S)()],container:{position:"relative"},main:{backgroundColor:"#ffffff",overflowX:"hidden",overflowY:"hidden",position:"relative"},overFlowYHidden:{overflowY:"hidden"}})}),x=n(1611),C=n(129),O=n(51),w=n(1602),E=n(1600),A=n(1757),L={opacity:0},k=((a={})[S.t.top]="slideUpIn20",a[S.t.bottom]="slideDownIn20",a[S.t.left]="slideLeftIn20",a[S.t.right]="slideRightIn20",a),M={preventDismissOnScroll:!1,offsetFromTarget:0,minPagePadding:8,directionalHint:C.e.bottomAutoEdge},P=p.forwardRef(function(e,t){var n=Object(y.e)(M,e),a=p.useRef(null),i=p.useRef(null),o=Object(E.e)(t,i),s=Object(A.e)(n.target,i),c=s[0],d=s[1],l=function(e,t){var n=p.useRef();return function(){if(!n.current){var a=e.bounds;a||(a={top:0+e.minPagePadding,left:0+e.minPagePadding,right:t.innerWidth-e.minPagePadding,bottom:t.innerHeight-e.minPagePadding,width:t.innerWidth-2*e.minPagePadding,height:t.innerHeight-2*e.minPagePadding}),n.current=a}return n.current}}(n,d),u=function(e,t,n,a,i){var r=Object(w.e)(),o=p.useState(),s=o[0],c=o[1],d=p.useRef(0),l=function(){r.requestAnimationFrame(function(){return u()})},u=function(){var r=e.offsetFromTarget,o=e.onPositioned,l=t.current,u=n.current;if(l&&u){var p=Object(f.__assign)({},e);p.bounds=i(),p.target=a.current;var m=p.target;if(m)if(!m.getBoundingClientRect&&!m.preventDefault||document.body.contains(m)){p.gapSpace=r;var _=Object(D.r)(p,l,u);!s&&_||s&&_&&!function(e,t){return function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var a=e[n],i=t[n];if(a&&i&&a.toFixed(2)!==i.toFixed(2))return!1}return!0}(e.elementPosition,t.elementPosition)}(s,_)&&d.current<5?(d.current++,c(_),null==o||o(_)):(d.current=0,null==o||o(_))}else void 0!==s&&c(void 0);else void 0!==s&&c(void 0)}};return p.useEffect(l),[s,l]}(n,i,a,c,l),m=u[0],h=u[1],b=function(e,t,n){var a=e.directionalHintFixed,i=e.offsetFromTarget,r=e.directionalHint,o=e.target,s=p.useRef();return"string"==typeof o&&(s.current=void 0),p.useEffect(function(){s.current=void 0},[o,i]),function(){if(!s.current)if(a&&t.current){var e=i||0;s.current=Object(D.t)(t.current,r,e,n())}else s.current=n().height-2;return s.current}}(n,c,l),S=function(e,t){var n=e.finalHeight,a=p.useState({value:0}),i=a[0],r=a[1],o=Object(w.e)(),s=p.useRef(0),c=function(){t&&n&&(s.current=o.requestAnimationFrame(function(){if(t.current){var e=t.current.lastChild,a=e.scrollHeight-e.offsetHeight;r({value:i.value+a}),e.offsetHeight<n?c():o.cancelAnimationFrame(s.current)}}))};return p.useEffect(c,[n]),i.value}(n,a);if(function(e,t,n){var a=e.setInitialFocus,i=p.useRef(!1);p.useEffect(function(){!i.current&&t.current&&a&&n&&(i.current=!0,Object(_.n)(t.current))})}(n,a,m),function(e,t,n,a,i,r){var o=e.onDismiss,s=e.preventDismissOnScroll,c=Object(w.e)(),d=p.useCallback(function(e){o?o(e):r()},[o,r]),l=p.useCallback(function(e){var i=e.target,r=t.current&&!Object(g.e)(t.current,i);(!a.current&&r||e.target!==n&&r&&(a.current.stopPropagation||!a.current||i!==a.current&&!Object(g.e)(a.current,i)))&&d(e)},[d,t,a,n]),u=p.useCallback(function(e){i&&!s&&l(e)},[l,i,s]);p.useEffect(function(){var e=new v.e({});return c.setTimeout(function(){var t,a;e.on(n,"scroll",c.throttle(u,10),!0),e.on(n,"resize",c.throttle(d,10),!0),e.on(null===(t=null==n?void 0:n.document)||void 0===t?void 0:t.body,"focus",l,!0),e.on(null===(a=null==n?void 0:n.document)||void 0===a?void 0:a.body,"click",l,!0)},0),function(){return e.dispose()}},[u])}(n,i,d,c,m,h),p.useEffect(function(){var e;return null===(e=n.onLayerMounted)||void 0===e?void 0:e.call(n)},[]),!d)return null;var C=n.className,P=n.doNotLayer,T=n.positioningContainerWidth,U=n.positioningContainerMaxHeight,F=n.children,H=I(),R=m&&m.targetEdge?r.e[k[m.targetEdge]]:"",N=b()+S,B=U&&U>N?N:U,j=p.createElement("div",{ref:o,className:Object(O.e)("ms-PositioningContainer",H.container)},p.createElement("div",{className:Object(r.U)("ms-PositioningContainer-layerHost",H.root,C,R,!!T&&{width:T},P&&{zIndex:r.g.Layer}),style:m?m.elementPosition:L,tabIndex:-1,ref:a},F,B));return P?j:p.createElement(x.e,Object(f.__assign)({},n.layerProps),j)});function T(e){var t;return{root:[{position:"absolute",boxShadow:"inherit",border:"none",boxSizing:"border-box",transform:e.transform,width:e.width,height:e.height,left:e.left,top:e.top,right:e.right,bottom:e.bottom}],beak:{fill:e.color,display:"block",selectors:(t={},t[r.o]={fill:"windowtext"},t)}}}P.displayName="PositioningContainer";var U=p.forwardRef(function(e,t){var n,a,i,r,o,s,c=e.left,d=e.top,l=e.bottom,u=e.right,f=e.color,_=e.direction,h=void 0===_?S.t.top:_;switch(h===S.t.top||h===S.t.bottom?(n=10,a=18):(n=18,a=10),h){case S.t.top:default:i="9, 0",r="18, 10",o="0, 10",s="translateY(-100%)";break;case S.t.right:i="0, 0",r="10, 10",o="0, 18",s="translateX(100%)";break;case S.t.bottom:i="0, 0",r="18, 0",o="9, 10",s="translateY(100%)";break;case S.t.left:i="10, 0",r="0, 10",o="10, 18",s="translateX(-100%)"}var b=Object(m.e)()(T,{left:c,top:d,bottom:l,right:u,height:n+"px",width:a+"px",transform:s,color:f});return p.createElement("div",{className:b.root,role:"presentation",ref:t},p.createElement("svg",{height:n,width:a,className:b.beak},p.createElement("polygon",{points:i+" "+r+" "+o})))});U.displayName="Beak";var F=n(1796),H=n(1748),R=n(1006),N=Object(m.e)(),B={isCollapsed:!0,mouseProximityOffset:10,delayBeforeMouseOpen:3600,delayBeforeCoachmarkAnimation:0,isPositionForced:!0,positioningContainerProps:{directionalHint:C.e.bottomAutoEdge}},j=p.forwardRef(function(e,t){var n=Object(y.e)(B,e),a=p.useRef(null),i=p.useRef(null),r=function(){var e=Object(w.e)(),t=p.useState(),n=t[0],a=t[1],i=p.useState(),r=i[0],o=i[1];return[n,r,function(t){var n=t.alignmentEdge,i=t.targetEdge;return e.requestAnimationFrame(function(){a(n),o(i)})}]}(),o=r[0],c=r[1],d=r[2],l=function(e,t){var n=e.isCollapsed,a=e.onAnimationOpenStart,i=e.onAnimationOpenEnd,r=p.useState(!!n),o=r[0],s=r[1],c=Object(H.e)().setTimeout,d=p.useRef(!o),l=p.useCallback(function(){var e,n;d.current||(s(!1),null==a||a(),null===(n=null===(e=t.current)||void 0===e?void 0:e.addEventListener)||void 0===n||n.call(e,"transitionend",function(){c(function(){t.current&&Object(_.n)(t.current)},1e3),null==i||i()}),d.current=!0)},[t,i,a,c]);return p.useEffect(function(){n||l()},[n]),[o,l]}(n,a),u=l[0],m=l[1],I=function(e,t,n){var a=Object(s.e)(e.theme);return p.useMemo(function(){var e,i,r=void 0===n?S.t.bottom:Object(D.n)(n),o={direction:r},s="3px";switch(r){case S.t.top:case S.t.bottom:t?t===S.t.left?(o.left="7px",e="left"):(o.right="7px",e="right"):(o.left="calc(50% - 9px)",e="center"),r===S.t.top?(o.top=s,i="top"):(o.bottom=s,i="bottom");break;case S.t.left:case S.t.right:t?t===S.t.top?(o.top="7px",i="top"):(o.bottom="7px",i="bottom"):(o.top="calc(50% - 9px)",i="center"),r===S.t.left?(a?o.right=s:o.left=s,e="left"):(a?o.left=s:o.right=s,e="right")}return[o,e+" "+i]},[t,n,a])}(n,o,c),x=I[0],C=I[1],O=function(e,t){var n=p.useState(!!e.isCollapsed),a=n[0],i=n[1],r=p.useState(e.isCollapsed?{width:0,height:0}:{}),o=r[0],s=r[1],c=Object(w.e)();return p.useEffect(function(){c.requestAnimationFrame(function(){t.current&&(s({width:t.current.offsetWidth,height:t.current.offsetHeight}),i(!1))})},[]),[a,o]}(n,a),E=O[0],A=O[1],L=function(e){var t=e.ariaAlertText,n=Object(w.e)(),a=p.useState(),i=a[0],r=a[1];return p.useEffect(function(){n.requestAnimationFrame(function(){r(t)})},[]),i}(n),k=function(e){var t=e.preventFocusOnMount,n=Object(H.e)().setTimeout,a=p.useRef(null);return p.useEffect(function(){t||n(function(){var e;return null===(e=a.current)||void 0===e?void 0:e.focus()},1e3)},[]),a}(n);!function(e,t,n){var a,i=null===(a=Object(h.e)())||void 0===a?void 0:a.documentElement;Object(R.e)(i,"keydown",function(e){var a,i;(e.altKey&&e.which===b.e.c||e.which===b.e.enter&&(null===(i=null===(a=t.current)||void 0===a?void 0:a.contains)||void 0===i?void 0:i.call(a,e.target)))&&n()},!0);var r=function(n){var a;if(e.preventDismissOnLostFocus){var i=n.target,r=t.current&&!Object(g.e)(t.current,i),o=e.target;r&&i!==o&&!Object(g.e)(o,i)&&(null===(a=e.onDismiss)||void 0===a||a.call(e,n))}};Object(R.e)(i,"click",r,!0),Object(R.e)(i,"focus",r,!0)}(n,i,m),function(e){var t=e.onDismiss;p.useImperativeHandle(e.componentRef,function(e){return{dismiss:function(){null==t||t(e)}}},[t])}(n),function(e,t,n){var a=Object(H.e)(),i=a.setTimeout,r=a.clearTimeout,o=p.useRef();p.useEffect(function(){var a=function(){t.current&&(o.current=t.current.getBoundingClientRect())},s=new v.e({});return i(function(){var t=e.mouseProximityOffset,c=void 0===t?0:t,d=[];i(function(){a(),s.on(window,"resize",function(){d.forEach(function(e){r(e)}),d.splice(0,d.length),d.push(i(function(){a()},100))})},10),s.on(document,"mousemove",function(t){var i,r=t.clientY,s=t.clientX;a(),function(e,t,n,a){return void 0===a&&(a=0),t>e.left-a&&t<e.left+e.width+a&&n>e.top-a&&n<e.top+e.height+a}(o.current,s,r,c)&&n(),null===(i=e.onMouseMove)||void 0===i||i.call(e,t)})},e.delayBeforeMouseOpen),function(){return s.dispose()}},[])}(n,i,m);var M=n.beaconColorOne,T=n.beaconColorTwo,j=n.children,z=n.target,G=n.color,K=n.positioningContainerProps,W=n.ariaDescribedBy,q=n.ariaDescribedByText,Q=n.ariaLabelledBy,Y=n.ariaLabelledByText,J=n.ariaAlertText,X=n.delayBeforeCoachmarkAnimation,Z=n.styles,$=n.theme,ee=n.className,te=n.persistentBeak,ne=G;!ne&&$&&(ne=$.semanticColors.primaryButtonBackground);var ae=N(Z,{theme:$,beaconColorOne:M,beaconColorTwo:T,className:ee,isCollapsed:u,isMeasuring:E,color:ne,transformOrigin:C,entityHostHeight:void 0===A.height?void 0:A.height+"px",entityHostWidth:void 0===A.width?void 0:A.width+"px",width:"32px",height:"32px",delayBeforeCoachmarkAnimation:X+"ms"}),ie=u?32:A.height;return p.createElement(P,Object(f.__assign)({target:z,offsetFromTarget:10,finalHeight:ie,ref:t,onPositioned:d,bounds:V(n)},K),p.createElement("div",{className:ae.root},J&&p.createElement("div",{className:ae.ariaContainer,role:"alert","aria-hidden":!u},L),p.createElement("div",{className:ae.pulsingBeacon}),p.createElement("div",{className:ae.translateAnimationContainer,ref:i},p.createElement("div",{className:ae.scaleAnimationLayer},p.createElement("div",{className:ae.rotateAnimationLayer},(u||te)&&p.createElement(U,Object(f.__assign)({},x,{color:ne})),p.createElement("div",{className:ae.entityHost,ref:k,tabIndex:-1,"data-is-focusable":!0,role:"dialog","aria-labelledby":Q,"aria-describedby":W},u&&[Q&&p.createElement("p",{id:Q,key:0,className:ae.ariaContainer},Y),W&&p.createElement("p",{id:W,key:1,className:ae.ariaContainer},q)],p.createElement(F.e,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},p.createElement("div",{className:ae.entityInnerHost,ref:a},p.createElement("div",{className:ae.childrenContainer,"aria-hidden":u},j)))))))))});function V(e){var t=e.isPositionForced,n=e.positioningContainerProps;return t?!n||n.directionalHint!==C.e.topAutoEdge&&n.directionalHint!==C.e.bottomAutoEdge?{left:-1/0,top:-1/0,bottom:1/0,right:1/0,width:1/0,height:1/0}:{left:0,top:-1/0,bottom:1/0,right:window.innerWidth,width:window.innerWidth,height:1/0}:void 0}j.displayName="CoachmarkBase";var z=Object(i.e)(j,function(e){var t,n=e.theme,a=e.className,i=e.color,o=e.beaconColorOne,f=e.beaconColorTwo,p=e.delayBeforeCoachmarkAnimation,m=e.isCollapsed,_=e.isMeasuring,h=e.entityHostHeight,b=e.entityHostWidth,g=e.transformOrigin;if(!n)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var v=r.d.continuousPulseAnimationDouble(o||n.palette.themePrimary,f||n.palette.themeTertiary,"35px","150px","10px"),y=r.d.createDefaultAnimation(v,p);return{root:[n.fonts.medium,{position:"relative"},a],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:Object(s.e)(n)?"translate(50%, -50%)":"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:"0"},m&&y],translateAnimationContainer:[{width:"100%",height:"100%"},m&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:d(),transition:"opacity 0.5s ease-in-out"},!m&&{opacity:"1"}],scaleAnimationLayer:[{width:"100%",height:"100%"},m&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:l()}],rotateAnimationLayer:[{width:"100%",height:"100%"},m&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:u()},!m&&{opacity:"1"}],entityHost:[{position:"relative",outline:"none",overflow:"hidden",backgroundColor:i,borderRadius:32,transition:"border-radius 250ms, width 500ms, height 500ms cubic-bezier(0.5, 0, 0, 1)",visibility:"hidden",selectors:(t={},t[r.o]={backgroundColor:"Window",border:"2px solid WindowText"},t["."+c.e+" &:focus"]={outline:"1px solid "+n.palette.themeTertiary},t)},!_&&m&&{width:32,height:32},!_&&{visibility:"visible"},!m&&{borderRadius:"1px",opacity:"1",width:b,height:h}],entityInnerHost:[{transition:"transform 500ms cubic-bezier(0.5, 0, 0, 1)",transformOrigin:g,transform:"scale(0)"},!m&&{width:b,height:h,transform:"scale(1)"},!_&&{visibility:"visible"}],childrenContainer:[{display:!_&&m?"none":"block"}],ariaContainer:{position:"fixed",opacity:0,height:0,width:0,pointerEvents:"none"}}},void 0,{scope:"Coachmark"})},,,,function(e,t,n){"use strict";var a,i=n(0),r=n(1951),o=n(1964),s=n(1143),c=n(2193),d=n(1098),l=n(2579),u=n(2578),f=n(2876),p=n(2577),m=n(2576);!function(e){e[e.NONE=0]="NONE",e[e.VIEW=1]="VIEW",e[e.EDIT=2]="EDIT",e[e.OWNER=3]="OWNER",e[e.REVIEW=6]="REVIEW"}(a||(a={}));var _=n(2877),h=n(1646),b=n(2580),g=n(2058),v=n(2878),y=n(2400),S=n(2063),D=n(1923),I=n(1853),x=n(1815),C=n(321),O=n(60),w=n(39),E=n(101),A=n(1801),L=n(1941),k=n(8),M=n(47),P=n(128),T=n(1804),U=n(1998),F=n(88),H=n(1806),R=n(1919),N=n(1885),B=n(173),j=n(2059),V=n(1802),z=n(1829),G=n(216),K=n(1989),W=n(598),q=n(189),Q=n(1184),Y=n(68),J=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(i.__extends)(t,e),t.dependencies={sharingProvider:o.resourceKey,suiteNavProvider:s.resourceKey,peoplePickerProvider:r.t,policyTipProvider:c.e},t}(function(){function e(e,t){var n=this;this._listeners=null,this.stopSharing=function(){for(var e=n._storeContents.sharingInformation.sharingLinks,t=n._storeContents.sharingInformation.sharingPrincipals,a=0,i=e;a<i.length;a++){var r=i[a];n.unshareLink(r.sharingLinkKind,r.shareId)}n._removePrincipals(t)};var a=e.item,i=e.sharingInformation,r=e.policyTipInfo,o=e.outlookAvailability,s=e.companyName,c=e.defaultRecipients,d=e.accessChecked,l=void 0===d||d,u=e.mode,f=e.isListItem,p=e.prefetchGSI,m=e.waitSharingAPIsDuration;this._item=a,this._mode=u,this._sharingContextInformation=e.sharingContextInformation,this._clientId=this._sharingContextInformation&&Object(h.t)(this._sharingContextInformation.clientId),this._sharingProvider=t.sharingProvider,this._suiteNavProvider=t.suiteNavProvider||void 0,this._graphPeoplePickerHelper=t.graphPeoplePickerHelper,this._substratePeoplePickerHelper=t.substratePeoplePickerHelper,this._peoplePickerProvider=t.peoplePickerProvider,this._policyTipProvider=t.policyTipProvider||void 0,this._permissions=this._sharingContextInformation&&this._sharingContextInformation.rawInvite&&this._sharingContextInformation.rawInvite.value,this._sharingService=e.sharingService,this._firstShareLinkRequest=!0,this._listeners=[],this._groupsMemberCountCache=[],this._sharingInformationInvalidated=!1,this._groupMembersCountHash={},this._isListItem=f,this._prefetchGSI=p,this._waitSharingAPIsDuration=m,this._sharingContextInformation&&this._sharingContextInformation.experimentContext&&Object(z.e)(this._sharingContextInformation.experimentContext);var _=this._sharingContextInformation?this._sharingContextInformation.scenarioId:"";this._telemetryExtraData={mode:this._mode,clientId:this._clientId,scenarioId:_},this._engagementHelper=new R.e(e.telemetryManager,this._telemetryExtraData),this._storeContents={sharingInformation:i,sharingLinkCreated:null,companyName:s||this._sharingContextInformation&&this._sharingContextInformation.organizationName||A.ke,groupsMemberCount:0,policyTipInfo:r||{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:o||y.e.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1,filteredPrincipals:{},documentInformation:null},i&&i.userPhotoCdnBaseUrl&&Object(U.e)(i.userPhotoCdnBaseUrl),c&&0!==c.length?this._resolveDefaultRecipients(c,l,u):(this._eventGroup=new E.t(this),this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var a=t.recipientIds;n._resolveDefaultRecipients(a,l,u)}}catch(e){}})),V.T()||this._configureLinkIfShareId()}return e.prototype.getWaitSharingAPIsDuration=function(){return this._waitSharingAPIsDuration},e.prototype.getAuthToken=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.authToken},e.prototype.getScenarioId=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.scenarioId},e.prototype.isConsumer=function(){return!1},e.prototype.isConsumerLists=function(){return!!(window&&window._spPageContextInfo&&window._spPageContextInfo.isSiteListsHost)},e.prototype.isListItem=function(){return this._isListItem},e.prototype.getEngagementHelper=function(){return this._engagementHelper},e.prototype.addListener=function(e){this._listeners.push(e)},e.prototype.removeListeners=function(){this._listeners=[]},e.prototype.getInitialLinkSettings=function(e){return null},e.prototype.getSharingInformation=function(){return this._storeContents.sharingInformation},e.prototype.shouldDisableGraphForPeopleSearch=function(){return this._storeContents&&this._storeContents.sharingInformation&&(this._storeContents.sharingInformation.enforceIBSegmentFiltering||this._storeContents.sharingInformation.enforceSPOSearch)},e.prototype.isPeopleSharingLinksEnabled=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&!!e&&(e.peopleSharingLinkAbilities.canManageEditLink.enabled||e.peopleSharingLinkAbilities.canManageReadLink.enabled)}return!1},e.prototype.showManageAccess=function(){return!0},e.prototype.fetchSharingInformation=function(e,t){var n=this;if(this._storeContents.sharingInformation&&!this._sharingInformationInvalidated&&(!e||this._storeContents.sharingInformation.hasPermissionsInformation)&&!t)return this._getSharingInformationStats={name:"GetSharingInformationProvided",resultType:M.e.Success,duration:0},this._configureLinkIfShareId(),void this._emitChange({type:g.t.FetchSharingInformation});var a=(new Date).getTime(),i=!!this._sharingContextInformation||e;!V.d()&&this._prefetchGSI&&this._checkPrefetchSupportExpansion(i,t)?this._raceGSI(i,t,a):this._sharingProvider.getSharingInformation(this._item,i,!0,null,t).then(function(e){n._setGSIResponse(e,a)},function(e){n._setGSIError(e,a)})},e.prototype.fetchMemberCount=function(e){var t=this;this._groupMembersCountHash[e.email]||this._peoplePickerProvider.getPickerEntityInformation(e).then(function(n){var a=n.totalMemberCount;t._groupMembersCountHash[e.email]=a,t._emitChange()}).catch(function(n){t._groupMembersCountHash[e.email]=null,t._emitChange()})},e.prototype.getMembersCounts=function(){return this._groupMembersCountHash},e.prototype.shareLink=function(e){var t=this,n=new P.e({name:"shareLinkInvestigation"}),a=this._firstShareLinkRequest;this._firstShareLinkRequest=!1,Object(G.r)("sharelink.start");var r=e.settings,o=e.recipients,s=e.emailMessage,c=e.emailSubject,m=e.copyLinkCommand,_=e.allRecipientsHaveAccess,h=e.shareId,b=e.inviteesToRemove,y=e.shareType;if(e.copyLinkCommand&&H.u(this._clientId)&&this._mode===d.e.copy&&!this._sharingContextInformation.shareId&&this._sharingService&&(this._sharingContextInformation.itemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.serverRelativeItemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.uniqueId)&&a)return this._getDefaultLink(),void n.end({resultType:M.e.Success,extraData:Object(i.__assign)({sharingLinkPath:0},this._telemetryExtraData)});var S=0,I=0,x=!1,C=(o=o||[]).map(function(e){return e.entityType===D.e.externalUser?I++:S++,e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType&&(x=!0),{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});if(C=this._dedupeRecipients(C),h&&h.length>0||r.shareId&&r.shareId.length>0)n.end({resultType:M.e.Success,extraData:Object(i.__assign)({sharingLinkPath:1},this._telemetryExtraData)}),this._shareLink(r,C,s,c,m,a,h,b);else{if(!this.isPeopleSharingLinksEnabled()||!this._doesPSLSupportNewExternalUsers()&&x||r.audience===l.e.existing||this._storeContents.sharingInformation.requiresAccessApproval)if(r.sharingLinkKind!==u.e.direct&&r.sharingLinkKind!==u.e.flexible)n.end({resultType:M.e.Success,extraData:Object(i.__assign)({sharingLinkPath:3,settings:r},this._telemetryExtraData)}),this._shareLink(r,C,s,c,m,a,h,b);else{var O;O=r.sharingRole?this._getRoleString(r.sharingRole):this._getRoleValue(r.isEdit);var E={items:[this._item],roleValue:O,sendEmail:void 0!==s,message:s,subject:c,requireSignIn:!0,propagateSharing:!0},L=this._storeContents.sharingInformation.directLink,k=(null==r?void 0:r.audience)==l.e.existing&&(y===f.e.copy||y===f.e.outlook||y===f.e.mobileShareToTeams||y===f.e.nonOutlook||y===f.e.moreApps||y===f.e.webShareToTeams);if(0===o.length||r.audience==l.e.existing&&(this._mode===d.e.copy||this._mode==d.e.linkSettings)||k)n.end({resultType:M.e.Success,extraData:Object(i.__assign)({sharingLinkPath:4,useDirectLinkForShareTarget:k,recipientsLength:o.length},this._telemetryExtraData)}),this._invokeShareStatsEvent({name:"NoExtraCallReturnCanonical",duration:0,resultType:M.e.Success}),Object(G.r)("sharelink.existing"),this._handleSharedLink(L,m);else{for(var T=!0,U=0,F=o;U<F.length;U++){var R=F[U];this._storeContents.permissionsMap[R.email]!==v.e.hasAccess&&this._storeContents.permissionsMap[R.userId]!==v.e.hasAccess&&(T=!1)}if(T||_){n.end({resultType:M.e.Success,extraData:Object(i.__assign)({sharingLinkPath:5,useDirectLinkForShareTarget:k,recipientsLength:o.length,allUsersArePermissioned:T,allRecipientsHaveAccess:_},this._telemetryExtraData)});var N=(new Date).getTime();Object(G.r)("sharelink.emailWithoutPermissioning.start"),this._sharingProvider.emailWithoutPermissioning(C,this._item,s,c).done(function(e){Object(G.r)("sharelink.emailWithoutPermissioning.end");var n=e.statusCode;if(0===n)t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-N,resultType:M.e.Success}),t._handleSharedLink(L,m);else{var a=p.t.generic,r=A.ln;-8===n?(a=p.t.objectNotSupported,r=A.qo):-13===n?(a=p.t.invalidEmail,r=w.format(A.In,e.invalidEmails.join(", "))):-7===n&&(a=p.t.generic,r=e.errorMessage),t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-N,resultType:M.e.Failure,error:a}),t._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},t._storeContents.sharingInformation),{error:a,errorCategory:p.e.shareLink,errorMessage:r}),t._emitChange({type:g.t.ShareLink})}})}else{var B=(new Date).getTime();Object(G.r)("sharelink.share.start"),n.end({resultType:M.e.Success,extraData:Object(i.__assign)({sharingLinkPath:6,useDirectLinkForShareTarget:k,recipientsLength:o.length,allUsersArePermissioned:T,allRecipientsHaveAccess:_},this._telemetryExtraData)}),this._sharingProvider.share(C,E,!0).done(function(e){Object(G.r)("sharelink.share.end");var n=e.statusCode;if(0===n){var a=L;0===S&&1===I&&e.invitationLink?a=Object(i.__assign)(Object(i.__assign)({},L),{url:e.invitationLink}):0===S&&I>1&&e.invitationLink&&(a=Object(i.__assign)(Object(i.__assign)({},L),{url:t._removeEmailQueryParamFromInvitationLink(e.invitationLink)})),r.audience===l.e.customLabeledSpecificPeople&&(a=Object(i.__assign)(Object(i.__assign)({},a),{audience:l.e.customLabeledSpecificPeople})),t._invokeShareStatsEvent({name:"ShareObject",resultType:M.e.Success,duration:(new Date).getTime()-B}),t._handleSharedLink(a,m)}else if(1===n)t._storeContents.accessRequestCreated=!0,t._invokeShareStatsEvent({name:"ShareObject",resultType:M.e.Success,duration:(new Date).getTime()-B}),t._handleSharedLink(L,m);else{var o=p.t.generic,s=A.ln;-8===n?(o=p.t.objectNotSupported,s=A.qo):-13===n?(o=p.t.invalidEmail,s=w.format(A.In,e.invalidEmails.join(", "))):-7===n&&(o=p.t.generic,s=e.errorMessage),t._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},t._storeContents.sharingInformation),{error:o,errorCategory:p.e.shareObject,errorMessage:s}),t._invokeShareStatsEvent({name:"ShareObject",resultType:M.e.Failure,duration:(new Date).getTime()-B,error:o}),t._emitChange({type:g.t.ShareLink})}})}}}else n.end({resultType:M.e.Success,extraData:Object(i.__assign)({sharingLinkPath:2,settings:r},this._telemetryExtraData)}),this._shareLink(r,C,s,c,m,a,h,b);m&&this._storeContents.defaultLink&&this._storeContents.defaultLink.audience!==r.audience&&this._cleanupDefaultLink()}},e.prototype.unshareLink=function(e,t){var n=this,a={item:this._item,kind:e,shareId:t};V.A()?this._sharingProvider.unshareLink(a).done(function(e){!0===e&&(n._removeLinkByShareId(t),n._updateIsShared(),n._emitChange({type:g.t.UnshareLink}))}):this._sharingProvider.unshareLink(a).then(function(e){!0===e&&(n._removeLinkByShareId(t),n._updateIsShared(),n._emitChange({type:g.t.UnshareLink}))}).then(function(){n._sharingInformationInvalidated=!0,n.fetchSharingInformation(!0)})},e.prototype.getSharingLinkCreated=function(){return this._storeContents.sharingLinkCreated},e.prototype.getLinksCount=function(){return this.getActiveLinks().length},e.prototype.getAllPrincipals=function(){var e=this._storeContents.sharingInformation.sharingPrincipals,t=this.getActiveLinks();this._addPrincipals(e);for(var n=0,a=t;n<a.length;n++){var i=a[n];(i.principals.length||i.invitees.length)&&(this._addPrincipals(i.principals),i.isActive&&(!i.expiration||i.expiration.getTime()>Date.now())&&this._addPrincipals(i.invitees))}return this._storeContents.filteredPrincipals},e.prototype.parsePermissions=function(){for(var e=[],t=[],n=this.getSharingInformation(),a=n.permissionsInformation.links.results,r=n.permissionsInformation.principals.results,o=0,s=n.permissionsInformation.siteAdmins.results;o<s.length;o++){var c=s[o],d=Object(i.__assign)(Object(i.__assign)({},c.principal),{primaryText:c.principal.name,secondaryText:c.principal.jobTitle,type:c.principal.principalType,imageUrl:c.principal.loginName?Object(U.t)()(c.principal.loginName):"",role:m.e.owner});this._buildPrincipalAccessMap({addedIds:e,principals:t,sharingPrincipal:d})}for(var l=0,u=a;l<u.length;l++)for(var f=u[l],p=void 0,_=0,h=f.linkMembers.results;_<h.length;_++){var b=h[_];p=Object(i.__assign)(Object(i.__assign)({},b),{primaryText:b.name,secondaryText:b.jobTitle,type:b.principalType,imageUrl:b.imageUrl||b.loginName?Object(U.t)()(b.loginName):"",role:b.role||this._getRoleFromLink(f)}),this._buildPrincipalAccessMap({addedIds:e,principals:t,sharingPrincipal:p,link:f})}for(var g=0,v=r;g<v.length;g++)b=v[g],p=Object(i.__assign)(Object(i.__assign)({},b.principal),{primaryText:b.principal.name,secondaryText:b.principal.jobTitle,type:b.principal.principalType,imageUrl:b.principal.loginName?Object(U.t)()(b.principal.loginName):"",role:b.role}),this._buildPrincipalAccessMap({addedIds:e,principals:t,sharingPrincipal:p,link:void 0,isDirectAccess:!0});this._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},this._storeContents.sharingInformation),{sharingPrincipals:t})},e.prototype.getSensitivityLabels=function(e){var t=new P.e({name:"Sharing.sensitivityLabelGraphAPI"});return n.e(82).then(n.bind(null,2324)).then(function(n){return new n.SensitivityLabelsDataSource({getOAuthToken:e},{pageContext:window._spPageContextInfo}).getSensitivityLabels().then(function(e){return t.end({resultType:M.e.Success}),e}).catch(function(e){return t.end({resultType:M.e.Failure,resultCode:Object(q.i)(e),extraData:Object(q.a)(e)}),O.n.resolve(null)})})},e.prototype.getOptInSendNavIdInShareLink=function(){return this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink},e.prototype.onDocumentInformation=function(e){this._storeContents.documentInformation=e,this._emitChange()},e.prototype.getDocumentInformation=function(){return this._storeContents.documentInformation},e.prototype._buildPrincipalAccessMap=function(e){var t,n,a,r,o=e.addedIds,s=e.principals,c=e.sharingPrincipal,d=e.link,l=e.isDirectAccess;d?(r=d.linkDetails.ShareId,a=this._getRoleFromLink(d),n=d.linkDetails.ShareId):l?(r=c.id.toString(),a=this._getRoleForPrincipal(c)||c.role,n=c.id.toString()):(r=c.id.toString(),a=this._getRoleForPrincipal(c)||c.role,n=c.loginName);var u={id:r,role:a,isSPO:!0,rawPermission:{shareId:r,scope:null===(t=null==d?void 0:d.linkDetails)||void 0===t?void 0:t.Scope}};if(-1===o.indexOf(c.id)){var f=new Map;f.set(n,u),c=Object(i.__assign)(Object(i.__assign)({},c),{accessMap:f})}else s.filter(function(e){return e.id===c.id})[0].accessMap.set(n,u);c&&(s.push(c),o.push(c.id))},e.prototype._getRoleFromLink=function(e){switch(e.linkDetails.LinkKind){case u.e.organizationEdit:case u.e.anonymousEdit:return m.e.edit;case u.e.organizationView:case u.e.anonymousView:return m.e.view;case u.e.flexible:default:return this._getRoleFromLinkDetails(e.linkDetails)}},e.prototype._getRoleForPrincipal=function(e){switch(e.sharingLinkKind){case u.e.organizationEdit:case u.e.anonymousEdit:return m.e.edit;case u.e.organizationView:case u.e.anonymousView:return m.e.view;default:return m.e.none}},e.prototype._getRoleFromLinkDetails=function(e){return e.IsManageListLink?m.e.manageList:e.IsReviewLink?m.e.review:e.IsEditLink?m.e.edit:m.e.view},e.prototype.parsePrincipals=function(){var e=this.getAllPrincipals(),t=[],n=[],a=[],i=[],r=[];for(var o in e){var s=e[o],c=s.role===m.e.owner;s.type===I.e.user?(c?i.push(s):t.push(s),a.push({alias:o})):s.type!==I.e.securityGroup&&s.type!==I.e.sharePointGroup||(c?r.push(s):n.push(s))}return this._engagementHelper.manageAccessV3NumberOfSharingPrincipals({numberOfUsers:t.length,numberOfGroups:n.length}),{users:i.concat(t),groups:r.concat(n)}},e.prototype.getActiveLinks=function(){return this._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.isActive&&e.sharingLinkKind!==u.e.direct&&(!e.expiration||e.expiration.getTime()>Date.now())&&!(e.isAddressBarLink&&!0===e.isUnhealthy)})},e.prototype.updatePermissions=function(e,t){var n=this;this._sharingProvider.updatePermissions2(e,this._item,t).done(function(t){var r,o,s,c,d,l,u=n._storeContents.sharingInformation.sharingPrincipals;if(t.role===a.NONE)n._storeContents.sharingInformation.sharingPrincipals=u.filter(function(t){return t.id===e.id&&n._removePrincipalById(t.loginName),t.id!==e.id}),n._updateIsShared(),n._studyEmitChangeUsage("updatePermissions0"),n._emitChange();else if(V.H()&&z.n()){for(var f=0,p=u;f<p.length;f++)if((v=p[f]).id===e.id){var _=void 0,h=void 0;switch((_=null===(r=v.accessMap)||void 0===r?void 0:r.get(v.loginName))?h=v.loginName:(_=null===(o=v.accessMap)||void 0===o?void 0:o.get(v.id.toString()))&&(h=v.id.toString()),t.role){case a.VIEW:v.role=m.e.view,null===(s=v.accessMap)||void 0===s||s.set(h,Object(i.__assign)(Object(i.__assign)({},_),{role:m.e.view}));break;case a.EDIT:v.role=m.e.edit,null===(c=v.accessMap)||void 0===c||c.set(h,Object(i.__assign)(Object(i.__assign)({},_),{role:m.e.edit}));break;case a.OWNER:v.role=m.e.owner,null===(d=v.accessMap)||void 0===d||d.set(h,Object(i.__assign)(Object(i.__assign)({},_),{role:m.e.owner}));break;case a.REVIEW:v.role=m.e.review,null===(l=v.accessMap)||void 0===l||l.set(h,Object(i.__assign)(Object(i.__assign)({},_),{role:m.e.review}))}n._studyEmitChangeUsage("updatePermissions1"),n._emitChange()}}else for(var b=0,g=u;b<g.length;b++){var v;if((v=g[b]).id===e.id){switch(t.role){case a.VIEW:v.role=m.e.view;break;case a.EDIT:v.role=m.e.edit;break;case a.OWNER:v.role=m.e.owner;break;case a.REVIEW:v.role=m.e.review}n._studyEmitChangeUsage("updatePermissions1"),n._emitChange()}}})},e.prototype.grantDirectAccess=function(e,t){var n=this,a=this._storeContents.sharingInformation.sharingPrincipals.filter(function(t){return t.id===parseInt(e)})[0],r=this._getRoleString(t),o={items:[this._item],roleValue:r,requireSignIn:!0,propagateSharing:!0},s=Object(i.__assign)(Object(i.__assign)({},a),{userId:a.email,name:a.loginName,email:a.email,rawData:{Key:a.email,isResolved:!1},rawPersonData:{Key:a.email,isResolved:!1},isResolved:!1});this._sharingProvider.share([s],o,!0).then(function(i){switch(i.statusCode){case 0:n._storeContents.addPeopleResult=g.e.CompletedSuccessfully;var r={id:e,role:t,isSPO:!0,rawPermission:{scope:void 0}};a.accessMap.set(e,r),n._storeContents.sharingInformation.sharingPrincipals.map(function(t){return t.id===parseInt(e)?a:t});break;case 1:n._storeContents.addPeopleResult=g.e.AccessRequestsQueued;break;default:n._storeContents.addPeopleResult=g.e.Error}n._emitChange()},function(){n._storeContents.addPeopleResult=!1,n._emitChange()})},e.prototype.updatePermissionById=function(e,t){var n=this.getSharingInformation().sharingPrincipals.filter(function(t){return t.id===parseInt(e)})[0];return this.updatePermissions(n,t),O.n.resolve()},e.prototype.addPeople=function(e,t,n,a){var i=this,r=this._getRoleString(t),o={items:[this._item],roleValue:r,sendEmail:n,message:a,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(e,o,!0).then(function(e){switch(e.statusCode){case 0:i._storeContents.addPeopleResult=g.e.CompletedSuccessfully;break;case 1:i._storeContents.addPeopleResult=g.e.AccessRequestsQueued;break;default:i._storeContents.addPeopleResult=g.e.Error}i._emitChange()},function(){i._storeContents.addPeopleResult=!1,i._emitChange()})},e.prototype.fetchSuiteNavInformation=function(){var e=this;this._suiteNavProvider?this._suiteNavProvider.loadData().then(function(t){var n=t.CompanyDisplayName||e._storeContents.companyName,a=t?JSON.parse(t.ClientData):{HasEXOLicense:!1};e._storeContents.companyName=n,e._storeContents.outlookAvailability=a.HasEXOLicense?y.e.available:y.e.none,e._emitChange()}):(this._storeContents.outlookAvailability=y.e.none,this._emitChange())},e.prototype.getCompanyName=function(){return this._storeContents.companyName},e.prototype.getOutlookAvailability=function(){return this._storeContents.outlookAvailability},e.prototype.navigateToOwa=function(e,t){Object(W.e)()?window.sessionStorage.setItem("OWA_sharingLinkUrl",this._getOwaUrl(e,t)):window.open(this._getOwaUrl(e,t),"_blank")},e.prototype.getNavId=function(){return this._sharingContextInformation&&this._sharingContextInformation.navId},e.prototype.getContextualSharingInformation=function(){return this._sharingContextInformation&&this._sharingContextInformation.contextualSharingInformation},e.prototype.getInvitationId=function(){var e,t;return V.L()&&null!==(t=null===(e=this._sharingContextInformation)||void 0===e?void 0:e.invitationId)&&void 0!==t?t:""},e.prototype.fetchGroupsMemberCount=function(e){for(var t=this,n=0,a=function(e){var a={userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData,principalType:e.principalType};if(e.principalType===I.e.securityGroup){var r=i._groupsMemberCountCache[e.userId];void 0!==r?n+=r:i._peoplePickerProvider.getPickerEntityInformation(a).then(function(a){var i=a.totalMemberCount;t._groupsMemberCountCache[e.userId]=i,n+=i,t._storeContents.groupsMemberCount=n,t._emitChange()}).catch(function(n){t._groupsMemberCountCache[e.userId]=null,t._emitChange()})}},i=this,r=0,o=e;r<o.length;r++)a(o[r]);this._storeContents.groupsMemberCount=n,this._emitChange()},e.prototype.getGroupsMemberCount=function(){return this._storeContents.groupsMemberCount},e.prototype.fetchPolicyTipInformation=function(){var e=this;if(this._policyTipProvider){if(this._storeContents.policyTipInfo.info)return void this._emitChange();var t=this._storeContents.sharingInformation;if(!t)return;if(!this._item)return;var n=!this._isPolicyTipFlagSet(this._item.policyTip,x.a.blockSharing),a=t.sharingAbilities;if(a){if((a&&a.directSharingAbilities&&a.directSharingAbilities.canAddExternalPrincipal.disabledReason)!==_.e.documentIsProtectedByDlp&&n)return}else if(n)return;this._policyTipProvider.getPolicyTip(this._item).then(function(t){t&&(e._storeContents.policyTipInfo.info=t,e._emitChange())})}},e.prototype.getPolicyTipInformation=function(){return this._storeContents.policyTipInfo},e.prototype.updatePolicy=function(e,t){var n=this;if(this._policyTipProvider){var a={item:this._item,action:e};t&&(a.justification=t),this._policyTipProvider.updatePolicy(a).then(function(e){n._storeContents.policyTipInfo.actionResult=e,n._sharingInformationInvalidated=!0,n.fetchSharingInformation(!0),n._emitChange()})}},e.prototype.checkUserAccess=function(e){var t=this,n=new P.e({name:"Sharing.checkUserAccessAPI"});if(0!==e.length){for(var a=[],r=0,o=e;r<o.length;r++){var s=o[r];a.push(s)}return this._sharingProvider.checkPermissions(a,this._item).then(function(e){for(var a=function(e){var a=t._storeContents.sharingInformation.sharingPrincipals.filter(function(t){return t.loginName===e.inputEntity})[0];if(Object(T.r)(e.role,a.role)){var i={id:e.inputEntity,role:e.role,isSPO:!0,rawPermission:{shareId:e.inputEntity}};a.role=e.role,a.accessMap.set(i.id,i),a.hasGSIAndCheckAccessPerms=!0,n.end({resultType:M.e.Success})}},i=0,r=e;i<r.length;i++)a(r[i])}).catch(function(e){t._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},t._storeContents.sharingInformation),{error:e,errorMessage:A.Ee}),n.end({resultType:M.e.Failure,extraData:e})})}},e.prototype.checkPermissions=function(e,t){var n=this;if(0===e.length)return this._storeContents.permissionsMap={},void this._emitChange();var a=[];this._recipients=[];for(var i=0,r=e;i<r.length;i++){var o=r[i];a.push({alias:k.t.isActivated("00bdc590-2d96-4d10-bb1c-66fb6cb59dfd")?o.email:o.userId||o.email}),this._recipients.push(o.email)}t=t||this._storeContents.invitedUsers,this._invitedUsers=[];for(var s=0,c=t;s<c.length;s++){var d=c[s];a.push({alias:d.email}),this._invitedUsers.push(d.email)}var l=a.map(function(e){return e.alias});this._sharingProvider.checkPermissions(a,this._item).then(function(e){n._storeContents.permissionsMap={};for(var t=0,a=e;t<a.length;t++){var i=a[t];n._invitedUsers.indexOf(i.inputEntity)>-1?n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?v.e.hasAccess:v.e.pending:(n._recipients.indexOf(i.inputEntity)>-1||l.indexOf(i.inputEntity)>-1)&&(n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?v.e.hasAccess:v.e.none)}n._emitChange()})},e.prototype.getPermissionsMap=function(){return this._storeContents.permissionsMap},e.prototype.getDefaultRecipients=function(){return this._storeContents.defaultRecipients},e.prototype.consumeDefaultRecipients=function(){this._storeContents.defaultRecipients={isConsumed:!0,recipients:this._storeContents.defaultRecipients.recipients}},e.prototype.grantAccess=function(e,t){var n=this;void 0===t&&(t=!0);var a=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});a=this._dedupeRecipients(a);var r={items:[this._item],roleValue:this._getRoleValue(t),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(a,r,!0).done(function(e){n._storeContents=Object(i.__assign)(Object(i.__assign)({},n._storeContents),{grantAccessResult:0===e.statusCode}),n._emitChange()})},e.prototype.getGrantAccessResult=function(){return this._storeContents.grantAccessResult},e.prototype.getAddPeopleResult=function(){return this._storeContents.addPeopleResult},e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.hasAccessRequestBeenCreated=function(){return this._storeContents.accessRequestCreated},e.prototype.isValidatingDefaultRecipients=function(){return this._storeContents.isValidatingDefaultRecipients},e.prototype.setAddressBarLinkCapability=function(e){var t=this;return this._sharingProvider.setAddressBarLinkCapability(this._item,e).done(function(e){e&&t.fetchSharingInformation(!0,!0)})},e.prototype._addPrincipals=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a.loginName||a.email;this._storeContents.filteredPrincipals[i]||(this._storeContents.filteredPrincipals[i]=a)}},e.prototype._removePrincipals=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a.loginName||a.email;this._removePrincipalById(i)}},e.prototype._removePrincipalById=function(e){this._storeContents.filteredPrincipals[e]&&delete this._storeContents.filteredPrincipals[e]},e.prototype._doesPSLSupportNewExternalUsers=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&e.peopleSharingLinkAbilities.canAddNewExternalPrincipals.enabled}return!1},e.prototype.resetPeoplePickerError=function(){this._storeContents.sharingInformation.peoplePickerError&&(this._storeContents.sharingInformation.peoplePickerError=void 0,this._emitChange())},e.prototype.getSharingClickTime=function(){var e;return null===(e=this._sharingContextInformation)||void 0===e?void 0:e.clickTime},e.prototype.isPasswordModificationAllowed=function(){return!0},e.prototype.isExpirationDateModificationAllowed=function(){return!0},e.prototype.isPremiumExperienceAllowed=function(){return!0},e.prototype.isReportProblemSupported=function(){return!1},e.prototype.shouldInterruptCopyLink=function(e){return new O.n(function(e,t){e(!1)})},e.prototype.isPreventDownloadAllowed=function(){return!0},e.prototype.isBundleShare=function(){return!1},e.prototype.getSupportedAudienceOptions=function(){return[l.e.anyone,l.e.customLabeledSpecificPeople,l.e.existing,l.e.organization,l.e.specificPeople,l.e.specificPeopleFlex]},e.prototype.isOwner=function(){return this._storeContents.sharingInformation.userRole===m.e.owner},e.prototype.isSpecificPeopleExpirationAllowed=function(){return!1},e.prototype.showAudienceLearnMore=function(){return!0},e.prototype.showEmailsInSuggestions=function(){return!1},e.prototype.getFamily=function(){return null},e.prototype.getFamilyMembers=function(){return null},e.prototype.getCurrentUserId=function(){return null},e.prototype.isShared=function(){return this.getSharingInformation().isShared},e.prototype.getSharedObjectType=function(){return this.getSharingInformation().sharedObjectType},e.prototype.getItemInformationForLogging=function(){var e,t,n=!0,a=this.getSharingInformation();return a.fileExtension?(this._itemType=Object(j.e)(a.fileExtension),e=a.fileExtension):a.sharedObjectType?this._itemType=N.e[a.sharedObjectType]:a.item&&(this._itemType=Object(j.t)(a.item),e=a.item.extension,n=a.item.itemType===B.t.File),n&&this._itemType&&"other"!==this._itemType&&(t=e),{itemType:this._itemType,extension:t}},e.prototype.getSharingInformationAPIStats=function(){return this._getSharingInformationStats},e.prototype.getShareLinkAPIStats=function(){return this._getShareLinkStats},e.prototype._cleanupDefaultLink=function(){var e=this._storeContents.defaultLink;e&&(this.unshareLink(e.sharingLinkKind,e.shareId),this._storeContents.defaultLink=void 0)},e.prototype._emitChange=function(e){if(this._storeContents&&this._storeContents.sharingInformation){var t=this._storeContents.sharingInformation,n=this.getItemInformationForLogging(),a=n.itemType,i=n.extension;this._engagementHelper.setEngagementExtraData({webTemplateId:t.webTemplateId,itemUniqueId:t.itemUniqueId,itemType:a,extension:i})}for(var r=0,o=this._listeners;r<o.length;r++)(0,o[r])(e)},e.prototype._studyEmitChangeUsage=function(e){new P.e({name:"emitChangeInvestigation"}).end({resultType:M.e.Success,extraData:Object(i.__assign)({emitChangePath:e},this._telemetryExtraData)})},e.prototype.getPermissionsViewSettings=function(){return{groupPivotHeader:L.w,manageGroupLink:"",itemStopSharingSupported:!0,supportedGroupTypes:[I.e.securityGroup,I.e.sharePointGroup]}},e.prototype.init3s=function(){this._fetchSubstrateToken()},e.prototype._fetchGraphToken=function(){var e=this,t=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t?this._graphPeoplePickerHelper.getGraphToken().then(function(n){t=!!n,e._storeContents.sharingInformation.isGraphAvailable=t}):this._storeContents.sharingInformation.isGraphAvailable=!1},e.prototype._fetchSubstrateToken=function(){var e=this,t=this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t?this._substratePeoplePickerHelper.getSubstrateToken().then(function(n){e._substratePeoplePickerHelper.init(n),t=!!n,e._storeContents.sharingInformation.isTsAvailable=t}):this._storeContents.sharingInformation.isTsAvailable=!1},e.prototype._fetchAdditionalAuthenticationTokens=function(){this._storeContents.sharingInformation&&(this._fetchGraphToken(),this._fetchSubstrateToken())},e.prototype._handleSharedLink=function(e,t){e.createdViaCopyLinkCommand=t||!1;var n=new Y.t(e.url);this._sharingContextInformation&&this._sharingContextInformation.navId&&this._sharingContextInformation.optInSendNavIdInShareLink&&!n.getQueryParameter("nav")&&V._()&&!V.n()&&(n.setQueryParameter("nav",this._sharingContextInformation.navId),e.url=n.toString()),this._storeContents.sharingLinkCreated=e,this._updateIsShared(),this._studyEmitChangeUsage("handleSharedLink"),this._emitChange({type:g.t.ShareLink})},e.prototype._getRoleValue=function(e){return e?S.e:S.a},e.prototype._getRoleString=function(e){return e===m.e.review?"roletype:Reviewer":e===m.e.edit?S.e:e===m.e.owner?S.n:e===m.e.manageList?S.t:S.a},e.prototype._configureLinkIfShareId=function(){var e=this,t=this._sharingContextInformation&&this._sharingContextInformation.shareId;if(t&&this._mode===d.e.copy){if("00000000-0000-0000-0000-000000000000"===t)this._storeContents.sharingLinkCreated=this._storeContents.sharingInformation.directLink;else{var n=this._storeContents.sharingInformation.sharingLinks.filter(function(t){return t.isActive&&t.shareId===e._sharingContextInformation.shareId})[0];this._storeContents.sharingLinkCreated=n||this._storeContents.sharingInformation.directLink}this._storeContents.sharingLinkCreated.createdViaCopyLinkCommand=!0}},e.prototype._removeLinkByShareId=function(e){var t=this;this._storeContents.sharingInformation.sharingLinks=this._storeContents.sharingInformation.sharingLinks.map(function(n){return e===n.shareId&&(n.expiration=null,n.isActive=!1,n.shareId=C.e.Empty,n.url=null,t._removePrincipals(n.principals),t._removePrincipals(n.invitees),n.principals=[]),n})},e.prototype._updateIsShared=function(){var e=this._storeContents.sharingInformation;if(e){for(var t=e.sharingLinks,n=e.sharingPrincipals,a=!1,i=0,r=t;i<r.length;i++){var o=r[i];o.isActive&&o.sharingLinkKind!==u.e.direct&&(a=!0)}a||(a=n.length>0),this._storeContents.sharingInformation.isShared=a}},e.prototype._getOwaUrl=function(e,t){var n,a,i="https://outlook.office.com/owa/",r=null===(a=null===(n=this._storeContents)||void 0===n?void 0:n.sharingInformation)||void 0===a?void 0:a.outlookEndpointHostUrl;r&&(i="https://".concat(r,"/owa/"));var o=encodeURIComponent(t);return"".concat(i,"?body=").concat(o,"&to=").concat(e.join(";"),"&path=/mail/action/compose")},e.prototype._resolveDefaultRecipients=function(e,t,n){var a=this,r=e||[],o=O.n.resolve();if(this._storeContents.isValidatingDefaultRecipients=e.length>0,!t){r=[];for(var s=[],c=0,l=e;c<l.length;c++){var u=l[c];s.push({alias:u})}o=this._sharingProvider.checkPermissions(s,this._item).then(function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];a.hasAccess||r.push(a.inputEntity)}})}o.then(function(){if(0!==r.length){for(var e=[],t=[],o={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},s=0,c=r;s<c.length;s++){var l=c[s];e.push(a._peoplePickerProvider.resolve(l,o).then(function(e){t.push(e)}))}O.n.all(e).then(function(){a._storeContents.defaultRecipients={isConsumed:!1,recipients:t},a._storeContents.isValidatingDefaultRecipients=!1,a._studyEmitChangeUsage("resolveDefaultRecipients1"),a._emitChange()},function(){a._storeContents.defaultRecipients={isConsumed:!1,recipients:[]},a._storeContents.isValidatingDefaultRecipients=!1,a._emitChange()})}else n===d.e.atMention&&(a._storeContents=Object(i.__assign)(Object(i.__assign)({},a._storeContents),{grantAccessResult:!0}),a._studyEmitChangeUsage("resolveDefaultRecipients0"),a._emitChange())})},e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(t.length>1){for(var n=[],a=0,i=t[1].split("&");a<i.length;a++){var r=i[a];-1===r.indexOf("email=")&&n.push(r)}var o=n.join("&");return"".concat(t[0],"?").concat(o)}return e},e.prototype._shareLink=function(e,t,n,a,r,o,s,c){var f=this;Object(G.r)("sharelink._shareLink.start");var _={emailData:n,emailSubject:a,items:[this._item],recipients:t,settings:{createLink:!0,sharingLinkKind:e.sharingLinkKind,expiration:e.expiration,updatePassword:e.updatePassword,password:e.password,shareId:s,inviteesToRemove:c,role:e.sharingRole}};_.settings.role||(_.settings.role=e.isEdit?m.e.edit:m.e.view),e.shareId&&e.shareId.length>0&&(_.settings.shareId=e.shareId,e.fetchLinkOnly&&(_.settings.createLink=!1));var v=(new Date).getTime(),y=new P.e({name:"SharingShareLink.".concat(d.e[this._mode],".").concat(h.e[this._clientId]||"unknown")});this._getShareLinkStats={name:"ShareLinkInit",resultType:M.e.Success,duration:0},(e.updatePassword||e.hasPassword&&e.shareId&&e.shareId.length>0)&&e.audience===l.e.anyone&&(_.settings.sharingLinkKind=u.e.flexible,_.settings.allowAnonymousAccess=!0),e.audience===l.e.anyone?e.trackLinkUsers?(_.settings.allowAnonymousAccess=!1,_.settings.restrictShareMembership=!1,_.settings.trackLinkUsers=!0,_.settings.scope=b.e.anyone,_.settings.sharingLinkKind=u.e.flexible):(_.settings.allowAnonymousAccess=!0,_.settings.restrictShareMembership=!1,_.settings.trackLinkUsers=!1,_.settings.scope=b.e.anyone):e.audience===l.e.organization&&(_.settings.allowAnonymousAccess=!1,_.settings.restrictShareMembership=!1,_.settings.scope=b.e.organization),e.preventDownload&&(_.settings.role=m.e.restrictedview,e.sharingRole=m.e.restrictedview,_.settings.sharingLinkKind=u.e.flexible),e.audience!==l.e.specificPeopleFlex&&e.audience!==l.e.customLabeledSpecificPeople||(_.settings.restrictShareMembership=!0,_.settings.scope=b.e.specificPeople);var S=this.getDefaultRecipients();if(e.audience===l.e.customLabeledSpecificPeople&&S&&(_.recipients=S.recipients),e.isCreateOnlyLink&&(_.settings.role=m.e.submit,_.settings.description=e.description),this._sharingContextInformation&&this._sharingContextInformation.navId&&this._sharingContextInformation.optInSendNavIdInShareLink&&V._()&&(!Object(Q.t)(this._sharingContextInformation.navId)||this._sharingContextInformation.navId.length>1024))return this._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},this._storeContents.sharingInformation),{error:p.t.invalidItem,errorCategory:p.e.shareLink,errorMessage:A.ca}),y.end({resultType:M.e.Failure}),this._getShareLinkStats={name:"ShareLink",resultType:M.e.Failure,duration:(new Date).getTime()-v,error:p.t.invalidItem},this._invokeShareStatsEvent(this._getShareLinkStats),void this._emitChange({type:g.t.ShareLink});this._sharingProvider.shareLink(_).done(function(t){if(Object(G.r)("sharelink._shareLink.end"),t.error){var n=t.error;f._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},f._storeContents.sharingInformation),{error:n,errorCategory:p.e.shareLink,debugErrorMessage:n.message&&n.message.value,errorMessage:A.ln});try{429===n.status&&(f._storeContents.sharingInformation.errorMessage=A.Po)}catch(e){}return y.end({resultType:M.e.Failure}),f._getShareLinkStats={name:"ShareLink",resultType:M.e.Failure,duration:(new Date).getTime()-v,error:t.error},f._invokeShareStatsEvent(f._getShareLinkStats),void f._emitChange({type:g.t.ShareLink})}y.end({resultType:M.e.Success}),f._getShareLinkStats={name:"ShareLink",resultType:M.e.Success,duration:(new Date).getTime()-v},f._invokeShareStatsEvent(f._getShareLinkStats);var a=t.link;e.audience===l.e.customLabeledSpecificPeople&&(a.audience=l.e.customLabeledSpecificPeople),a.sharingLinkKind===f._storeContents.sharingInformation.defaultSharingLink.sharingLinkKind&&o&&r&&0===f._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.shareId===a.shareId}).length&&(f._storeContents.defaultLink=a),s?(c&&f._removePrincipals(c),f._sharingInformationInvalidated=!0,f.fetchSharingInformation(!0),f._emitChange({type:g.t.ShareLink})):f._handleSharedLink(a,r)})},e.prototype._invokeShareStatsEvent=function(e){var t=new P.e,n=this._getSharingInformationStats&&this._getSharingInformationStats.resultType;e&&(n=e.resultType);var a={mode:d.e[this._mode],clientId:h.e[this._clientId]||"unknown",getData:JSON.stringify(this._getSharingInformationStats),setData:JSON.stringify(e)};t.end({name:"SharingStats",resultType:n,extraData:a})},e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},e.prototype._getDefaultLink=function(){var e,t,n=this,a=new P.e({name:"SharingGetDefaultLink"}),i=this._sharingContextInformation.itemUrl;if(!i&&this._sharingContextInformation.serverRelativeItemUrl){var r=new F.e(this._sharingContextInformation.webAbsoluteUrl);i="".concat(r.authority).concat(this._sharingContextInformation.serverRelativeItemUrl)}var o=[];this._sharingContextInformation.defaultRecipients&&this._sharingContextInformation.defaultRecipients.length>0&&(o=this._sharingContextInformation.defaultRecipients.map(function(e){return{email:e}}));var s=this._sharingContextInformation.uniqueId;s||(s=null===(t=null===(e=this._storeContents)||void 0===e?void 0:e.sharingInformation)||void 0===t?void 0:t.itemUniqueId);var c=this._permissions?O.n.resolve(this._permissions):s?this._sharingService.getDefaultLinkByUniqueId(s||"",o,!0):this._sharingService.getDefaultLink(i,o,!0);Object(G.r)("sharelink.getDefaultLink.start"),c.then(function(e){Object(G.r)("sharelink.getDefaultLink.end");var t=e[0],i=t.link,r=t.roles&&t.roles.indexOf("write")>=0;a.end({resultType:M.e.Success});var o=Object(T.O)(i.scope),s=Object(T.A)(o);n._handleSharedLink({allowsAnonymousAccess:"anonymous"===i.scope,audience:o,expiration:t.expirationDateTime,isActive:!0,isEdit:r,principals:[],shareId:t.id,sharingLinkKind:Object(T.w)(i.scope,r),sharingScope:s,url:i.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:""},!0)},function(e){a.end({resultType:M.e.Failure,extraData:{error:e}});var t="";try{t=JSON.stringify(e)}catch(e){}n._storeContents.sharingInformation={error:e,errorCategory:p.e.invite,errorMessage:A.ln,debugErrorMessage:t,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0},n._emitChange()})},e.prototype._dedupeRecipients=function(e){var t=[],n={};return e.forEach(function(e){n[e.userId]=e}),Object.keys(n).forEach(function(e){t.push(n[e])}),t},e.prototype._raceGSI=function(e,t,n){var a=this,i=this._sharingProvider.getSharingInformation(this._item,e,!0,null,t),r=this._prefetchGSI;O.n.race([r,i]).then(function(e){a._setGSIResponse(e,n)},function(e){a._setGSIError(e,n)})},e.prototype._checkPrefetchSupportExpansion=function(e,t){var n=window.g_expand;return!(!n||n.length<1||n.indexOf("pickerSettings")<0||n.indexOf("sharingLinkTemplates")<0||e&&n.indexOf("permissionsInformation")<0||t&&n.indexOf("addressBarLinkSettings")<0)},e.prototype._setGSIResponse=function(e,t){this._getSharingInformationStats={name:"GetSharingInformation",resultType:M.e.Success,duration:(new Date).getTime()-t,GSIsource:e.getSharingInformationSources},this._storeContents.sharingInformation&&this._storeContents.sharingInformation.error||(this._storeContents.sharingInformation=e,V.H()&&z.n()&&void 0!==this.getSharingInformation()&&this.parsePermissions(),this._fetchAdditionalAuthenticationTokens(),this.fetchPolicyTipInformation(),this._configureLinkIfShareId(),Object(U.e)(e.userPhotoCdnBaseUrl),this._emitChange({type:g.t.FetchSharingInformation}))},e.prototype._setGSIError=function(e,t){var n=Object(K.t)(null,K.e.api,e);this._getSharingInformationStats={name:"GetSharingInformation",resultType:M.e.Failure,duration:(new Date).getTime()-t,error:n.error},this._invokeShareStatsEvent(),this._storeContents.sharingInformation=n,this._emitChange({type:g.t.FetchSharingInformation})},e}());t.e=J},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(7),i=n(58),r=n(2022),o=n(1198),s=new a.t({name:"".concat("isOfflineStateLegacyKOObservable.key",".isOfflineStateLegacyKOObservable"),factory:{dependencies:{observablesFactoryTypeKey:i.i,isOfflineStateObservable:r.e},create:function(e){var t=e.isOfflineStateObservable,n=new o.e,a=n.attach(new e.observablesFactoryTypeKey).create(t.get());return n.attach({dispose:t.subscribe(function(){a(t.get())})}),{instance:a,disposable:n}}}})}],Array(13),[function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(1),r=n(2107),o=n(112),s=n(1104),c=n(524),d=n(109),l="backward",u=function(e){function t(t){var n=e.call(this,t)||this;return n._inputElement=i.createRef(),n._autoFillEnabled=!0,n._onCompositionStart=function(e){n.setState({isComposing:!0}),n._autoFillEnabled=!1},n._onCompositionUpdate=function(){Object(r.e)()&&n._updateValue(n._getCurrentInputValue(),!0)},n._onCompositionEnd=function(e){var t=n._getCurrentInputValue();n._tryEnableAutofill(t,n.value,!1,!0),n.setState({isComposing:!1}),n._async.setTimeout(function(){n._updateValue(n._getCurrentInputValue(),!1)},0)},n._onClick=function(){n.value&&""!==n.value&&n._autoFillEnabled&&(n._autoFillEnabled=!1)},n._onKeyDown=function(e){if(n.props.onKeyDown&&n.props.onKeyDown(e),!e.nativeEvent.isComposing)switch(e.which){case o.e.backspace:n._autoFillEnabled=!1;break;case o.e.left:case o.e.right:n._autoFillEnabled&&(n.setState({inputValue:n.props.suggestedDisplayValue||""}),n._autoFillEnabled=!1);break;default:n._autoFillEnabled||-1!==n.props.enableAutofillOnKeyPress.indexOf(e.which)&&(n._autoFillEnabled=!0)}},n._onInputChanged=function(e){var t=n._getCurrentInputValue(e);if(n.state.isComposing||n._tryEnableAutofill(t,n.value,e.nativeEvent.isComposing),!Object(r.e)()||!n.state.isComposing){var a=e.nativeEvent.isComposing,i=void 0===a?n.state.isComposing:a;n._updateValue(t,i)}},n._onChanged=function(){},n._updateValue=function(e,t){if(e||e!==n.value){var a=n.props,i=a.onInputChange,r=a.onInputValueChange;i&&(e=(null==i?void 0:i(e,t))||""),n.setState({inputValue:e},function(){return null==r?void 0:r(e,t)})}},Object(s.e)(n),n._async=new c.e(n),n.state={inputValue:t.defaultVisibleValue||"",isComposing:!1},n}return Object(a.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){if(e.updateValueInWillReceiveProps){var n=e.updateValueInWillReceiveProps();if(null!==n&&n!==t.inputValue&&!t.isComposing)return Object(a.__assign)(Object(a.__assign)({},t),{inputValue:n})}return null},Object.defineProperty(t.prototype,"cursorLocation",{get:function(){if(this._inputElement.current){var e=this._inputElement.current;return"forward"!==e.selectionDirection?e.selectionEnd:e.selectionStart}return-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isValueSelected",{get:function(){return Boolean(this.inputElement&&this.inputElement.selectionStart!==this.inputElement.selectionEnd)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._getControlledValue()||this.state.inputValue||""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._inputElement.current?this._inputElement.current.selectionStart:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._inputElement.current?this._inputElement.current.selectionEnd:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._inputElement.current},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e,t,n){var a=this.props,i=a.suggestedDisplayValue,r=a.shouldSelectFullInputValueInComponentDidUpdate,o=0;if(!a.preventValueSelection)if(this._autoFillEnabled&&this.value&&i&&f(i,this.value)){var s=!1;if(r&&(s=r()),s&&this._inputElement.current)this._inputElement.current.setSelectionRange(0,i.length,l);else{for(;o<this.value.length&&this.value[o].toLocaleLowerCase()===i[o].toLocaleLowerCase();)o++;o>0&&this._inputElement.current&&this._inputElement.current.setSelectionRange(o,i.length,l)}}else this._inputElement.current&&(null===n||this._autoFillEnabled||this.state.isComposing||this._inputElement.current.setSelectionRange(n.start,n.end,n.dir))},t.prototype.componentWillUnmount=function(){this._async.dispose()},t.prototype.render=function(){var e=Object(d.s)(this.props,d.f),t=Object(a.__assign)(Object(a.__assign)({},this.props.style),{fontFamily:"inherit"});return i.createElement("input",Object(a.__assign)({autoCapitalize:"off",autoComplete:"off","aria-autocomplete":"both"},e,{style:t,ref:this._inputElement,value:this._getDisplayValue(),onCompositionStart:this._onCompositionStart,onCompositionUpdate:this._onCompositionUpdate,onCompositionEnd:this._onCompositionEnd,onChange:this._onChanged,onInput:this._onInputChanged,onKeyDown:this._onKeyDown,onClick:this.props.onClick?this.props.onClick:this._onClick,"data-lpignore":!0}))},t.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()},t.prototype.clear=function(){this._autoFillEnabled=!0,this._updateValue("",!1),this._inputElement.current&&this._inputElement.current.setSelectionRange(0,0)},t.prototype.getSnapshotBeforeUpdate=function(){var e,t,n=this._inputElement.current;return n&&n.selectionStart!==this.value.length?{start:null!==(e=n.selectionStart)&&void 0!==e?e:n.value.length,end:null!==(t=n.selectionEnd)&&void 0!==t?t:n.value.length,dir:n.selectionDirection||"backward"}:null},t.prototype._getCurrentInputValue=function(e){return e&&e.target&&e.target.value?e.target.value:this.inputElement&&this.inputElement.value?this.inputElement.value:""},t.prototype._tryEnableAutofill=function(e,t,n,a){!n&&e&&this._inputElement.current&&this._inputElement.current.selectionStart===e.length&&!this._autoFillEnabled&&(e.length>t.length||a)&&(this._autoFillEnabled=!0)},t.prototype._getDisplayValue=function(){return this._autoFillEnabled?(n=e=this.value,(t=this.props.suggestedDisplayValue)&&e&&f(t,n)&&(n=t),n):this.value;var e,t,n},t.prototype._getControlledValue=function(){var e=this.props.value;return void 0===e||"string"==typeof e?e:(console.warn("props.value of Autofill should be a string, but it is "+e+" with type of "+typeof e),e.toString())},t.defaultProps={enableAutofillOnKeyPress:[o.e.down,o.e.up]},t}(i.Component);function f(e,t){return!(!e||!t)&&0===e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())}},,,,,function(e,t,n){"use strict";var a=function(){function e(){}return e.htmlDecodeFromString=function(e){var t=e,n=(new DOMParser).parseFromString(t,"text/html");return n&&n.body&&n.body.innerText?n.body.innerText:t},e.isIE11=function(){return!!window.MSInputMethodContext&&!!document.documentMode},e.isFireFox=function(){return"undefined"!=typeof InstallTrigger},e}();t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=36e5;function i(e){var t="",n=!1;if(e>=a){var i=Math.floor(e/a);e%=a,t+=i+":",n=!0}var r=Math.floor(e/6e4);e%=6e4,r<10&&n&&(t+="0"),t+=r+":";var o=Math.floor(e/1e3);return o<10&&(t+="0"),t+o}}],Array(26),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=/[\{\}]/g,i=/\{\d+\}/g;function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t;function o(e){var t=r[e.replace(a,"")];return null==t&&(t=""),t}return e.replace(i,o)}},function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"e",function(){return a}),n.d(t,"t",function(){return p});var a,i=n(430),r=n(8),o=n(476),s=n(1840),c=n(21),d=n(1),l={ODB:60596};function u(){return!r.e.isActivated("E453BAFB-1A08-4222-89F4-568CF37CA2B8","11/02/2021","Placeholder sharing")&&i.e.isFeatureEnabled(l)}function f(e){var t,n;return u()&&!(!e.invitationId&&!(null===(n=null===(t=e.rawData||e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.invitation))}function p(e,t){void 0===t&&(t={});var n=Object(c.L)(),i=t.fontSize;return{coinProps:{styles:{initials:e===a.standalone?{border:"1px dashed ".concat(n.palette.themePrimary),boxSizing:"border-box",fontSize:null!=i?i:"16px",fontWeight:"normal",color:n.palette.themePrimary}:{border:"none",boxSizing:"border-box",fontSize:null!=i?i:"12px",color:n.palette.themePrimary,paddingLeft:"4px",paddingRight:"4px"}}},initialsColor:s.e.transparent,onRenderInitials:function(){return d.createElement(o.e,{iconName:"Contact",style:{fontWeight:"normal"}})}}}!function(e){e[e.standalone=0]="standalone",e[e.pill=1]="pill"}(a||(a={}))},,,,function(e,t,n){"use strict";var a=n(60),i=function(){function e(){this._pendingPromises={}}return e.prototype.deduplicate=function(e,t){var n=this;if(!this._pendingPromises[e]){var i=t();return this._pendingPromises[e]=i,i.then(function(t){return delete n._pendingPromises[e],t},function(t){return delete n._pendingPromises[e],a.n.reject(t)})}return this._pendingPromises[e]},e}();t.e=i},function(e,t,n){"use strict";var a;!function(e){e[e.LocationAndEventsAPI=0]="LocationAndEventsAPI",e[e.ObjectDetectors=1]="ObjectDetectors",e[e.LocationBasedPlace=2]="LocationBasedPlace",e[e.UserDefined=3]="UserDefined",e[e.SystemDefined=4]="SystemDefined"}(a||(a={})),t.e=a}],Array(17),[function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(1526),i=n(0),r=n(1),o=n(809),s=n(109),c=n(1749),d=Object(o.e)(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.message,n=e.styles,a=e.as,o=void 0===a?"div":a,l=e.className,u=d(n,{className:l});return r.createElement(o,Object(i.__assign)({role:"status",className:u.root},Object(s.s)(this.props,s.r,["className"])),r.createElement(c.e,null,r.createElement("div",{className:u.screenReaderText},t)))},t.defaultProps={"aria-live":"polite"},t}(r.Component),u=n(21),f=Object(a.e)(l,function(e){return{root:e.className,screenReaderText:u.k}})}],Array(29),[function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(2276),i=n(2040),r=n(1875),o=n(39),s=n(2578),c=n(2579);function d(e,t,n,d){if(null===e)return"";if(e.kind===s.e.flexible){if(e.blockDownload){if(e.audience===c.e.anyone)return e.expiration?o.format(e.hasPassword?a.AnonymousViewOnlyWithExpiryAndPassword:a.AnonymousViewOnlyWithExpiry,new Date(e.expiration).toLocaleDateString()):e.hasPassword?a.AnonymousViewOnlyWithPassword:a.AnonymousViewOnlyText;if(e.audience===c.e.organization)return o.format(a.OrganizationViewOnly,t);if(e.audience===c.e.specificPeopleFlex)return a.SpecificPeopleViewOnly}if(e.audience!==c.e.anyone)return e.role===r.e.Edit?a.pslEditLabel:e.role===r.e.Review?a.pslReviewLabel:e.role===r.e.View?a.pslViewLabel:a.peopleSharingLinkLabel;if(e.expiration&&e.hasPassword){if(e.role===r.e.Edit||e.type===i.e.Edit)return u(i.e.Edit,new Date(e.expiration));if(e.role===r.e.View||e.type===i.e.View)return u(i.e.View,new Date(e.expiration))}else if(!e.expiration&&e.hasPassword){if(e.role===r.e.Edit||e.type===i.e.Edit)return a.AnonymousPasswordEditText;if(e.role===r.e.View||e.type===i.e.View)return a.AnonymousPasswordViewText}else if(e.expiration&&!e.hasPassword){if(e.role===r.e.Edit||e.type===i.e.Edit)return l(i.e.Edit,new Date(e.expiration));if(e.role===r.e.View||e.type===i.e.View)return l(i.e.View,new Date(e.expiration))}else{if(e.role===r.e.Edit||e.type===i.e.Edit)return a.AnonymousEditText;if(e.role===r.e.View||e.type===i.e.View)return a.AnonymousViewText}}if(e.type===i.e.Direct&&n&&n.length>0&&d&&1===d){for(var f=n[0].sharingInfo.role,p=1;p<n.length;p++)if(f!==n[p].sharingInfo.role){f=r.e.None;break}return 1===n.length?f===r.e.Edit?o.format(a.InvitedUsersOneEditLinkText,n[0].name):f===r.e.View?o.format(a.InvitedUsersOneViewLinkText,n[0].name):o.format(a.InvitedUsersOneAccessLinkText,n[0].name):2===n.length?f===r.e.Edit?o.format(a.InvitedUsersTwoEditLinkText,n[0].name,n[1].name):f===r.e.View?o.format(a.InvitedUsersTwoViewLinkText,n[0].name,n[1].name):o.format(a.InvitedUsersTwoAccessLinkText,n[0].name,n[1].name):3===n.length?f===r.e.Edit?o.format(a.InvitedUsersThreeEditLinkText,n[0].name,n[1].name):f===r.e.View?o.format(a.InvitedUsersThreeViewLinkText,n[0].name,n[1].name):o.format(a.InvitedUsersThreeAccessLinkText,n[0].name,n[1].name):f===r.e.Edit?o.format(a.InvitedUsersThreePlusEditLinkText,n[0].name,n[1].name,n.length-2):f===r.e.View?o.format(a.InvitedUsersThreePlusViewLinkText,n[0].name,n[1].name,n.length-2):o.format(a.InvitedUsersThreePlusAccessLinkText,n[0].name,n[1].name,n.length-2)}var m=e.expiration?new Date(e.expiration).toLocaleDateString():null;if(4===e.entityType)return a.AnonymousViewText;switch(e.type){case i.e.Organization:return e.role===r.e.Edit?t?o.format(a.OrganizationEditText,t):a.NoNameOrganizationEditText:t?o.format(a.OrganizationViewText,t):a.NoNameOrganizationViewText;case i.e.Direct:return 2===d?e.role===r.e.Edit?a.ToLineEditText:a.ToLineViewText:a.DirectLinkText;case i.e.Edit:return e.supportsExpiration&&m?l(i.e.Edit,new Date(e.expiration)):a.AnonymousEditText;case i.e.View:return e.supportsExpiration&&m?l(i.e.View,new Date(e.expiration)):a.AnonymousViewText;case i.e.Embed:return a.AnonymousEmbedText;case i.e.App:return o.format(a.appText,e.name);case i.e.Form:return a.AnonymousSurveyText;case i.e.AppAccess:return a.OneNoteSharingText;default:return""}}function l(e,t){var n=new Date(t).toLocaleDateString(),r=t.getTime()<Date.now();return e===i.e.Edit?o.format(r?a.AnonymousEditExpiredText:a.AnonymousEditExpiryText,n):e===i.e.View?o.format(r?a.AnonymousViewExpiredText:a.AnonymousViewExpiryText,n):""}function u(e,t){var n=new Date(t).toLocaleDateString(),r=t.getTime()<Date.now();return e===i.e.Edit?o.format(r?a.AnonymousPasswordEditExpiredText:a.AnonymousPasswordEditExpiryText,n):e===i.e.View?o.format(r?a.AnonymousPasswordViewExpiredText:a.AnonymousPasswordViewExpiryText,n):""}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return k}),n.d(t,"t",function(){return P});var a=n(1),i=n(1782),r=n(2775),o=n(2331),s=n(476),c=n(21),d=n(2362),l=n(39),u=n(1673),f=n(129),p=n(17);Object(p.n)([{rawString:'@charset "UTF-8";.analyticsStatsContainer_277fd875{display:flex;max-width:250px}.analyticsStatsLink_277fd875,.analyticsStatsNoLink_277fd875,.analyticsStats_277fd875{padding:0 8px 0 0}.analyticsStatsLink_277fd875 .ms-Link,.analyticsStatsNoLink_277fd875 .ms-Link,.analyticsStats_277fd875 .ms-Link{font-size:12px;font-weight:400;color:'},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.analyticsStatsLink_277fd875 .ms-ActivityItem-activityTypeIcon,.analyticsStatsNoLink_277fd875 .ms-ActivityItem-activityTypeIcon,.analyticsStats_277fd875 .ms-ActivityItem-activityTypeIcon{margin-top:0}html[dir=ltr] .analyticsStatsLink_277fd875 .ms-ActivityItem-activityTypeIcon,html[dir=ltr] .analyticsStatsNoLink_277fd875 .ms-ActivityItem-activityTypeIcon,html[dir=ltr] .analyticsStats_277fd875 .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir=rtl] .analyticsStatsLink_277fd875 .ms-ActivityItem-activityTypeIcon,html[dir=rtl] .analyticsStatsNoLink_277fd875 .ms-ActivityItem-activityTypeIcon,html[dir=rtl] .analyticsStats_277fd875 .ms-ActivityItem-activityTypeIcon{padding-left:5px}.analyticsStatsLink_277fd875 .ms-ActivityItem-activityContent,.analyticsStatsNoLink_277fd875 .ms-ActivityItem-activityContent,.analyticsStats_277fd875 .ms-ActivityItem-activityContent{flex-basis:auto;font-weight:400}html[dir=ltr] .analyticsStatsLink_277fd875 .ms-ActivityItem-activityContent,html[dir=ltr] .analyticsStatsNoLink_277fd875 .ms-ActivityItem-activityContent,html[dir=ltr] .analyticsStats_277fd875 .ms-ActivityItem-activityContent{padding-left:0}html[dir=rtl] .analyticsStatsLink_277fd875 .ms-ActivityItem-activityContent,html[dir=rtl] .analyticsStatsNoLink_277fd875 .ms-ActivityItem-activityContent,html[dir=rtl] .analyticsStats_277fd875 .ms-ActivityItem-activityContent{padding-right:0}.analyticsStatsLink_277fd875 :hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:'}.analyticsStatsNoLink_277fd875{align-self:center}.analyticsStatsViewsNoLink_277fd875{font-weight:400;font-size:12px;padding:0}.analyticsStatsViews_277fd875{padding-bottom:8px;font-size:14px;font-weight:600}.analyticsStatsViewsDivider_277fd875:before{content:" \\B7  "}.analyticsStatsViewsDividerNoDot_277fd875:before{content:"   ";padding:0 4px}.analyticsStatsErrorMessage_277fd875{font-size:12px;font-weight:400;line-height:28px}.fileHoverCardErrorIcon_277fd875{vertical-align:bottom}.analyticsStatsInfo_277fd875,.analyticsStatsTeachingMessage_277fd875{vertical-align:sub;padding:0 8px}.analyticsStatsInfo_277fd875{font-size:12px;color:'},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.analyticsStatsLabel_277fd875{display:flex;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html[dir=ltr] .analyticsStatsCount_277fd875:not(:last-child){padding-right:8px}html[dir=rtl] .analyticsStatsCount_277fd875:not(:last-child){padding-left:8px}"}]);var m="analyticsStatsContainer_277fd875",_="analyticsStatsLink_277fd875",h="analyticsStatsLabel_277fd875",b="analyticsStatsCount_277fd875",g=n(0),v=n(27),y=n(18),S=n(43),D=n(232),I=n(63),x=n(55),C=Object(D.e)(function(){return Object(g.__awaiter)(void 0,void 0,void 0,function(){return Object(g.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(389).then(n.bind(null,4392))];case 1:return[2,e.sent().default]}})})}),O=Object(x.t)(function(e,t){var n=t.itemKey,i=Object(v.o)(function(e){return a.createElement(C,Object(g.__assign)({},e,{itemKey:n}))},{scope:"global"});return a.createElement(S.e,Object(g.__assign)({onExecute:i},Object(I.t)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),w=(Object(y.i)()(O),n(2593)),E=function(e){function t(t){return e.call(this,t)||this}return Object(g.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,o=a.createElement(r.e,{activityDescription:t,isCompact:!0});return a.createElement(v.n,{action:a.createElement(O,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,r=t?function(){n().catch(function(){})}:void 0;return a.createElement(i.e,{disabled:!1,className:w.e,onClick:r},o)})},t}(a.Component),A=n(51),L=new Date("0001-01-01T00:00:00-08:00"),k=function(e){var t,n,p,g,v=e.itemAnalytics,y=e.onClick,S=e.isLink,D=e.status,I=e.isCompact,x=e.disableViewerCount,C=void 0===x||x,O=e.ODBOptOutViewerList,w=void 0!==O&&O,A=e.itemKey,k=P();if(D===o.e.failed){var T=Object(c.L)();t=k.apiError&&(n=k.apiError,p={color:T.palette.redDark},g={paddingRight:"8px",position:"relative"},a.createElement(a.Fragment,null,a.createElement(s.e,{iconName:"ErrorBadge",className:"fileHoverCardErrorIcon_277fd875",styles:{root:Object(c.U)([g,p])}}),n))}if(t)return null;if(!v||!v.viewCount||!v.viewerCount)return a.createElement(r.e,{className:"analyticsStats_277fd875",isCompact:!0});var U=v.viewCount,F=v.viewerCount,H=v.activities,R=v.commentCount,N=v.likeCount,B=v.incompleteData&&v.incompleteData.missingDataBeforeDateTime&&new Date(v.incompleteData.missingDataBeforeDateTime).getTime()!==L.getTime(),j=v.incompleteData&&v.incompleteData.wasThrottled,V=B?d.P:j?d.X:"",z=C?w?d.j:"":d.Q,G=V||z,K=U>1?k.views:k.view,W=F>1?k.viewers:k.viewer,q=R&&R>1?k.comments:k.comment,Q=N&&N>1?k.likes:k.like,Y=R?"".concat(l.format(q,R)):"",J=N?"".concat(l.format(Q,N)):"",X=J&&M(J,void 0),Z=Y&&M(Y,void 0,void 0);return I?S?a.createElement("div",{className:m},a.createElement(i.e,{className:_,onClick:y},a.createElement(r.e,{activityPersonas:H&&0!==H.length?H.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():void 0,activityDescription:a.createElement("div",{className:h},U&&a.createElement("div",{className:b},"".concat(U," ").concat(K))),isCompact:!0})),J&&A?a.createElement(E,{likeLabel:J,itemKey:A}):X,Z):a.createElement("div",{className:m},M("".concat(U," ").concat(K),void 0),M("".concat(F," ").concat(W),void 0),G&&a.createElement(u.e,{content:G,directionalHint:f.e.bottomCenter},a.createElement(s.e,{className:"analyticsStatsTeachingMessage_277fd875",iconName:"Info","aria-describedby":G})),X,Z):a.createElement("div",{className:"analyticsStatsViews_277fd875"},"".concat(F," ").concat(W),a.createElement("span",{className:"analyticsStatsViewsDivider_277fd875"}),"".concat(U," ").concat(K),V&&a.createElement(u.e,{content:V,directionalHint:f.e.bottomCenter},a.createElement(s.e,{className:"analyticsStatsInfo_277fd875",iconName:"Info","aria-describedby":V})))};function M(e,t,n){var o=a.createElement(r.e,{activityDescription:a.createElement("div",{className:Object(A.e)(h,b)},e),isCompact:!0});return t||n?a.createElement(i.e,{className:_,href:"".concat(n,"#comments"),target:"_blank",onClick:t},o):a.createElement("div",{className:"analyticsStatsNoLink_277fd875"},o)}function P(){return{details:d.q,viewer:d.oe,viewers:d.se,view:d.ie,views:d.ce,comment:d.z,comments:d.G,like:d.K,likes:d.W,apiError:d.w,suggestion:d.Y,unsupportMessage:d.ae,accessActivity:d.x,modifiedActivity:d.B,activityTemplate:d.C,inCompleteDataMessage:d.M,throttledMessage:d.J,trendingItem:d.ne,loginUserYou:d.de}}k.defaultProps={isLink:!1}},function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return f});var a=n(0),i=n(1),r=n(17);Object(r.n)([{rawString:".deferredLivePersonaCardRoot_edf9f02f{display:inline-block}.deferredLivePersonaCardRoot_edf9f02f .lpc-hoverTarget:focus-visible[data-is-focusable=true]{position:initial;outline:-webkit-focus-ring-color auto 1px}"}]);var o=n(51),s=n(1529),c=n(1528),d=function(e){function t(t){var n=e.call(this,t)||this;return n._deferLoadComponent=function(){!n.state.ComponentModule&&n.props.moduleLoader&&n.props.modulePath&&n.props.moduleLoader.load(n.props.modulePath,n.props.getModule).then(function(e){if(n.props.moduleLoader.parse&&(e=n.props.moduleLoader.parse(e)),!e){var t="ReactDeferredComponent: component not found when loading ".concat(n.props.modulePath," ")+"- check your load and parse functions";console.error(t)}n._mounted?n.setState({ComponentModule:e}):n.state={ComponentModule:e}})},n._mounted=!1,n.state={ComponentModule:void 0},n._setupDeferLoadCallback(t),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state.ComponentModule;return t?i.createElement(t,Object(a.__assign)({ref:function(t){t&&Object(c.e)(e,t)}},this.props.props),this.props.children):this.props.placeHolder||null},t.prototype.componentDidMount=function(){this._mounted||(this._mounted=!0)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._setupDeferLoadCallback(e)},t.prototype._setupDeferLoadCallback=function(e){var t=e.customWaiter;t?t.then(this._deferLoadComponent):this._deferLoadComponent()},t}(i.Component),l=n(8),u=function(e){function t(t,a){var r=e.call(this,t,a)||this;return r._onActivate=function(e){r.state.hovered||r.setState({hovered:!0,activatedByFocus:"focus"===e.type})},r.modulePath="./SpLivePersonaCard",r.moduleLoader={load:function(){return n.e(547).then(n.bind(null,4387)).then(function(e){return e.SpLivePersonaCard})}},r.state={hovered:t.forceLoad,activatedByFocus:!1},r.containerRef=i.createRef(),r}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state.hovered;this.onFocusRender=function(){if(e.state.activatedByFocus){var t=e.containerRef.current.firstChild;e.props.shouldOnFocusMoveFocusToTarget&&t&&t.className.indexOf("lpc-hoverTarget")>-1&&t.focus()}},this._deferredComponentProps={modulePath:this.modulePath,moduleLoader:this.moduleLoader,props:Object(a.__assign)(Object(a.__assign)({},this.props),{onPersonaCardReady:this.onFocusRender}),customWaiter:this.props.customWaiter,placeHolder:this.props.placeHolder};var n=l.t.isActivated("306d9715-fab4-4c1d-aca6-5fb0e292f65e"),r=Object(o.e)("deferredLivePersonaCardRoot","deferredLivePersonaCardRoot_edf9f02f",this.props.className);return i.createElement("div",{onMouseOver:!n&&t?void 0:this._onActivate,onClick:!n&&t?void 0:this._onActivate,onFocus:!n&&t?void 0:this._onActivate,onMouseDown:!n&&t?void 0:this._onActivate,onKeyDown:!n&&t?void 0:this._onActivate,className:r,tabIndex:!n&&t?void 0:this.props.containerTabIndex,ref:this.containerRef,"data-is-focusable":!(!(this.props.containerTabIndex>-1)||t)},t?i.createElement(d,Object(a.__assign)({},this._deferredComponentProps),this.props.children):this.props.children)},t.defaultProps={containerTabIndex:-1},t}(s.e);function f(e,t){return i.createElement(u,Object(a.__assign)({},e),t)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(60),i=n(2090),r=n(0),o=n(104),s=n(64),c=n(1923),d=n(704),l=function(e){function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;if(n._MaxItems=200,n._Version=5,n._buffer=n.getValue(t._StorageKey),n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer(),n._data={},Date.now()<n._buffer.lastCachePrune+6048e5)for(var a=0;a<n._buffer.dataArray.length;a++){var i=n._buffer.dataArray[a],r=n._getItemKey(i);n._data[r]=i}else n.initializeBuffer(),n.setValue(t._StorageKey,n._buffer);return n}return Object(r.__extends)(t,e),t.clear=function(){new o.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)},t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone},t.prototype.setItem=function(e){var n=this._getItemKey(e),a=this._data[n];if(a){if(t.isCacheEntryFresh(a,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++,this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var r=this._buffer.dataArray[this._buffer.index],o=this._getItemKey(r);delete this._data[o],this._buffer.dataArray[this._buffer.index]=e}else this._buffer.dataArray.push(e),this._buffer.index++;this._data[n]=e,this.setValue(t._StorageKey,this._buffer)},t.prototype.getItems=function(e,t){for(var n=[],a=0;a<this._buffer.dataArray.length;a++){var i=(this._buffer.index-a+this._MaxItems)%this._MaxItems,r=this._buffer.dataArray[i];!(r.email&&r.email.toLowerCase().indexOf(e.toLowerCase())>=0||r.name&&r.name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&r.entityType===c.e.externalUser||n.push(r)}return n},t.prototype.containsItem=function(e){var t=this._getItemKey(e);return Boolean(this._data[t])},t.prototype.initializeBuffer=function(){this._buffer={},this._buffer.dataArray=[],this._buffer.index=-1,this._buffer.version=this._Version,this._buffer.lastCachePrune=Date.now()},t.prototype._getItemKey=function(e){return e.email||e.userId||Object(d.e)(JSON.stringify(e)).toString()},t._Key="ClientPeoplePicker",t._StorageKey="MRU",t._DataStoreCachingType=s.e.local,t}(o.e),u=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new i.e({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,graphPeoplePickerHelper:e.graphPeoplePickerHelper}),this._ppCapabilities=this._dataSource.getCapabilities(),this._ppCapabilities.supportsMruCaching?(this._mruCache=new l,this.MaxCacheSuggestions=5):this.MaxCacheSuggestions=0}return e.prototype.search=function(e,t){var n,i,r=this,o={cached:null,promise:null};return this._mruCache&&!t.groupID&&(i=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(o.cached=i),o.promise=new a.n(function(a,o){n=r._dataSource.search(e,t).then(function(e){if(e)if(i){i.length>0&&(i=r._removeStaleCacheResults(i,e));var t=i.map(function(e){return e.userId});a(e.filter(function(e){return t.indexOf(e.userId)<0}))}else a(e)},function(e){o(e)})},function(){n&&n.cancel()}),o},e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){return n._mruCache&&e.isResolved&&n.addToMruCache(e),e})},e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})},e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)},e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)},e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)},e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})},e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)},e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)},e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()},e.prototype.searchMruCache=function(e,t){var n=[],a=this._mruCache;if(a){n=a.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n},e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),a=[];return t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var r=e[i];l.isCacheEntryFresh(r,t)&&a.push(r)}}),a},e}()},function(e,t,n){"use strict";n.d(t,"n",function(){return I}),n.d(t,"e",function(){return x});var a=n(0),i=n(441),r=n(26),o=n(2778),s=n(39),c=n(29),d=n(10),l=n(58),u=n(290),f=n(7),p=n(119),m=new f.t({name:"Share.key",loader:new p.t(function(){return n.e(419).then(n.bind(null,4714)).then(function(e){return e.resourceKey.local})})}),_=m,h=n(1110),b=n(2382),g=n(190),v=n(2162),y=n(1098),S=n(825),D=n(60),I=v.n,x=v.t,C=v.e,O=v.a,w=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a,r=i.observables,o=i.resources,s=t.renderLabel,l=void 0===s?0:s,u=t.mode,f=t.item,p=t.engagementName,m=t.automationId,_=t.location;return a._automationId=m,a._mode=u,a._overrideSelectedItem=f&&f.peek(),a._overrideEngagementName=p,a._copyLinkShortcut=1===a._mode||3===a._mode,a._hideShareDialogOverflowButton=2===a._mode,a._actionMap=o.consume(c.e),a._itemsStore=o.consume(h.e),Object(d.isFeatureEnabled)(d.ShareV3)&&(a._focusItemResourceKey=a._getShareItemResourceKey(),a._itemBeingShared=o.consume(a._focusItemResourceKey),r.backgroundCompute(a._computeIsOpen)),a._renderLabel=l,a._location=_,a._initializeCommand(),a}return Object(a.__extends)(t,e),t.prototype._initializeCommand=function(){var e=this._getCommandProperties();this.command=new(this.managed(i.e))(e)},t.prototype._computeIsOpen=function(){this._itemBeingShared()&&this.command.isOpen(!0)},t.prototype._computeShouldClearItem=function(){this.command.isOpen()||this._itemBeingShared(void 0)},t.prototype._resizeShare=function(){this._registeredClear||(this._registeredClear=!0,this.observables.backgroundCompute(this._computeShouldClearItem))},t.prototype._dismissShare=function(){this._itemBeingShared(void 0)},t.prototype._getPayload=function(){var e=this,t=this.observables,n=this.createPureComputed(this._computeShareParams),a=this.createPureComputed(function(){return!!e._itemBeingShared()}),i=t.create();return t.backgroundCompute(function(){a.peek()?e.trackPromise(D.n.resolve(e.resources.consumeAsync(_.local))).done(function(e){i(e)}):a()}),this.createPureComputed(function(){var e=i(),t=n();if(e&&t)return e.toSpecification(t)})},t.prototype._computeShareParams=function(){var e=this._itemBeingShared(),t=e?this._itemsStore.getItem(e.items[0].key):void 0;if(t)return{item:t,copyLinkShortcut:this._copyLinkShortcut,onDismiss:this._dismissShare.bind(this),onResize:this._resizeShare.bind(this),hideShareDialogOverflowButton:this._hideShareDialogOverflowButton,mode:4===this._mode?y.e.addPeople:void 0,scenarioId:e.scenarioId,defaultRecipients:e.defaultRecipients,isEdit:e.isEdit,isSecureShare:e.isSecureShare,clickTime:Date.now()}},t.prototype._getShareItemResourceKey=function(){switch(this._mode){default:return I;case 1:return x;case 2:return O;case 3:return C;case 4:return v.i}},t.prototype._getCommandProperties=function(){var e,t={text:void 0,accessibleLabel:void 0,tooltip:void 0,icon:void 0,keys:void 0,action:void 0,payload:void 0,engagementName:void 0,renderLabel:this._renderLabel,enableRecoverFocusBinding:void 0,beakColor:void 0,location:void 0,automationId:this._automationId},n=Object(d.isFeatureEnabled)(d.ShareV3);4===this._mode?(t.text=r.grantAccess,t.icon=new u.e("PlayerSettings"),e=r.grantAccessCommandLabel):this._copyLinkShortcut?(t.text=n?r.CopyLinkCommandText:r.GetLink,e=r.CopyLinkCommandTooltipV3,t.icon=new u.e("Link")):(t.text=r.Share,e=r.ShareCommandTooltipV3,t.icon=new u.e("Share"),t.keys=["S"]),this._overrideEngagementName?t.engagementName=this._overrideEngagementName:this._copyLinkShortcut?t.engagementName="GetLink":t.engagementName="Share",n?(t.action=new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:this._focusItemResourceKey,overrideItem:this._overrideSelectedItem}),t.payload={control:this._getPayload(),timeout:36e5,announce:!1,autoDismiss:!0,preventDismissOnScroll:!0,preventDismissOnResize:!0},t.enableRecoverFocusBinding=!1,t.beakColor=g.e.neutralLighterAlt):this._copyLinkShortcut?t.action=new(this.managed(this._actionMap.GetLinkAction)):t.action=new(this.managed(this._actionMap.ShareByLinkAction))({sharingMethod:2}),t.location=Object(S.a)()?4:this._location;var a=this.resources.consume(b.e),i=this.createPureComputed(function(){return a()}),c=this.createPureComputed(function(){return a()?s.format(o.e,e):e}),l=this.createPureComputed(function(){return a()?s.format(o.e,t.text):t.text});return t.isDisabled=i,t.tooltip=c,t.accessibleLabel=l,t.prependTextToAccessibleLabel=!1,t},t}(l.n);t.t=w}],Array(28),[function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a={none:0,allow:1,allowWithJustification:2},i={none:0,falsePositiveReported:1,overridden:2,falsePositiveReportedAndOverridden:3},r={override:0,reportFalsePositive:1}},,,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".InfoPaneSection-informationBody{margin:0}.InfoPaneSection-informationBody dt{margin-bottom:3px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:14px;font-weight:600}.InfoPaneSection-informationBody dd{margin:0 0 16px 0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px}.InfoPaneSection-entryTile{display:flex;flex-direction:row;align-items:center}[dir=ltr] .InfoPaneSection-copyButton{margin-left:2px}[dir=rtl] .InfoPaneSection-copyButton{margin-right:2px}.InfoPaneSection-information-folderType{display:inline}.InfoPaneSection-information-changeFolderType{margin-left:10px;margin-right:10px;text-decoration:none}.InfoPaneSection-information-changeFolderType:visited{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.InfoPaneSection-information-path{display:inline;word-break:break-all}.InfoPaneSection-information-path:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';padding:0 5px;font-size:8px;font-weight:800;content:"\\e76c"}.InfoPaneSection-information-path:last-child:after{content:"";display:none}html[dir=rtl] .InfoPaneSection-information-path:after{content:"\\e76b"}.od-DetailsPane-LegacySection .InfoPaneSection-informationBody dd{margin-bottom:12px}.od-DetailsPane-LegacySection .InfoPaneSection--information .InfoPane-sectionHeader .InfoPane-sectionHeaderText{border-bottom:.5px solid '},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding-bottom:4px}.od-InfoPane-ReactSections .InfoPaneSection-informationBody dd{margin-bottom:12px}.od-InfoPane-ReactSections .InfoPaneSection--information .InfoPane-sectionHeader{display:none;padding:12px 16px}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(1),i=n(2379),r=n(1981),o=n(39),s=n(3038);function c(){var e=a.createElement("a",{key:"learn_more_link",href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},s.t),t=o.formatToArray(s.e,e);return a.createElement(i.e,{messageBarType:r.e.severeWarning,isMultiline:!0},t)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"t",function(){return a});var a,i=n(0),r=n(1807),o=n(58),s=n(39),c=n(2276),d="30",l=1825;!function(e){e[e.Invalid=0]="Invalid",e[e.Empty=1]="Empty",e[e.Valid=2]="Valid"}(a||(a={}));var u=function(e){function t(t){return e.call(this,t)||this}return Object(i.__extends)(t,e),t.prototype.computeExpirationValidity=function(e){if(""===e)return a.Empty;var t=e.match(/^-?[0-9]+/);if(t&&t[0]!==e||!t)return a.Invalid;var n=parseInt(e,10);return n<=0||n>l?a.Invalid:a.Valid},t.prototype.computeLinkExpiresInputLabel=function(e){if(this.computeExpirationValidity(e)===a.Valid){var t=parseInt(e,10),n=new Date;return n.setDate(n.getDate()+t),s.format(c.daysWithDate,Object(r.d)(n))}return c.days},t.prototype.getDaysFromToday=function(e){var t=new Date;return Math.round((e.getTime()-t.getTime())/864e5)},t.prototype.calculateLinkExpiration=function(e){if(e>0&&e<=l){var t=new Date;return t.setDate(t.getDate()+e),t.toISOString()}return null},t}(o.n);t.a=u},,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(2249),i=n(472),r=n(119),o=n(1975),s=n(2061),c=Object(r.r)("SubstratePeoplePickerHelper",o.t,{oAuthTokenProvider:s.e,pageContext:i.e,sharingContextInformation:a.e.optional})}],Array(18),[function(e,t,n){"use strict";n.d(t,"e",function(){return k});var a=n(1526),i=n(0),r=n(1),o=n(1754),s=n(2034),c=n(809),d=n(823),l=n(109),u=n(51),f=n(112),p=n(435),m=n(2170);function _(e,t){void 0===t&&(t=null);var n,a=r.useRef({ref:(n=function(e){a.ref.current!==e&&(a.cleanup&&(a.cleanup(),a.cleanup=void 0),a.ref.current=e,null!==e&&(a.cleanup=a.callback(e)))},n.current=t,n),callback:e}).current;return a.callback=e,a.ref}var h=n(1751),b=n(111),g=n(1750),v=n(345),y=n(129),S=n(476),D=n(2211),I=Object(c.e)(),x=function(e,t){var n={links:[],keyToIndexMapping:{},keyToTabIdMapping:{}};return r.Children.forEach(r.Children.toArray(e.children),function(a,r){if(C(a)){var o=a.props,s=o.linkText,c=Object(i.__rest)(o,["linkText"]),l=a.props.itemKey||r.toString();n.links.push(Object(i.__assign)(Object(i.__assign)({headerText:s},c),{itemKey:l})),n.keyToIndexMapping[l]=r,n.keyToTabIdMapping[l]=function(e,t,n,a){return e.getTabId?e.getTabId(n,a):t+"-Tab"+a}(e,t,l,r)}else a&&Object(d.e)("The children of a Pivot component must be of type PivotItem to be rendered.")}),n},C=function(e){var t;return r.isValidElement(e)&&(null===(t=e.type)||void 0===t?void 0:t.name)===D.e.name},O=r.forwardRef(function(e,t){var n,a=r.useRef(null),c=r.useRef(null),d=Object(o.e)("Pivot"),D=Object(s.e)(e.selectedKey,e.defaultSelectedKey),O=D[0],w=D[1],E=e.componentRef,A=e.theme,L=e.linkSize,k=e.linkFormat,M=e.overflowBehavior,P=e.overflowAriaLabel,T=e.focusZoneProps,U=e.overflowButtonAs,F={"aria-label":e["aria-label"],"aria-labelledby":e["aria-labelledby"]},H=Object(l.s)(e,l.r,["aria-label","aria-labelledby"]),R=x(e,d);r.useImperativeHandle(E,function(){return{focus:function(){var e;null===(e=a.current)||void 0===e||e.focus()}}});var N=function(e){if(!e)return null;var t=e.itemCount,a=e.itemIcon,i=e.headerText;return r.createElement("span",{className:n.linkContent},void 0!==a&&r.createElement("span",{className:n.icon},r.createElement(S.e,{iconName:a})),void 0!==i&&r.createElement("span",{className:n.text}," ",e.headerText),void 0!==t&&r.createElement("span",{className:n.count}," (",t,")"))},B=function(e,t,a,o){var s,c=t.itemKey,d=t.headerButtonProps,l=t.onRenderItemLink,f=e.keyToTabIdMapping[c],p=a===c;s=l?l(t,N):N(t);var _=t.headerText||"";_+=t.itemCount?" ("+t.itemCount+")":"",_+=t.itemIcon?" xx":"";var h=t.role&&"tab"!==t.role?{role:t.role}:{role:"tab","aria-selected":p};return r.createElement(m.e,Object(i.__assign)({},d,h,{id:f,key:c,className:Object(u.e)(o,p&&n.linkIsSelected),onClick:function(e){return j(c,e)},onKeyDown:function(e){return V(c,e)},"aria-label":t.ariaLabel,name:t.headerText,keytipProps:t.keytipProps,"data-content":_}),s)},j=function(e,t){t.preventDefault(),z(e,t)},V=function(e,t){t.which===f.e.enter&&(t.preventDefault(),z(e))},z=function(t,n){var a;if(w(t),R=x(e,d),e.onLinkClick&&R.keyToIndexMapping[t]>=0){var i=R.keyToIndexMapping[t],o=r.Children.toArray(e.children)[i];C(o)&&e.onLinkClick(o,n)}null===(a=c.current)||void 0===a||a.dismissMenu()};n=I(e.styles,{theme:A,linkSize:L,linkFormat:k});var G,K=null===(G=O)||void 0!==G&&void 0!==R.keyToIndexMapping[G]?O:R.links.length?R.links[0].itemKey:void 0,W=K?R.keyToIndexMapping[K]:0,q=R.links.map(function(e){return B(R,e,K,n.link)}),Q=r.useMemo(function(){return{items:[],alignTargetEdge:!0,directionalHint:y.e.bottomRightEdge}},[]),Y=function(e){var t=e.onOverflowItemsChanged,n=e.rtl,a=e.pinnedIndex,i=r.useRef(),o=r.useRef(),s=_(function(e){var t=function(e,t){if("undefined"!=typeof ResizeObserver){var n=new ResizeObserver(t);return Array.isArray(e)?e.forEach(function(e){return n.observe(e)}):n.observe(e),function(){return n.disconnect()}}var a=function(){return t(void 0)},i=Object(b.e)(Array.isArray(e)?e[0]:e);if(!i)return function(){};var r=i.requestAnimationFrame(a);return i.addEventListener("resize",a,!1),function(){i.cancelAnimationFrame(r),i.removeEventListener("resize",a,!1)}}(e,function(t){o.current=t?t[0].contentRect.width:e.clientWidth,i.current&&i.current()});return function(){t(),o.current=void 0}}),c=_(function(e){return s(e.parentElement),function(){return s(null)}});return Object(h.e)(function(){var e=s.current,r=c.current;if(e&&r){for(var d=[],l=0;l<e.children.length;l++){var u=e.children[l];u instanceof HTMLElement&&u!==r&&d.push(u)}var f=[],p=0;i.current=function(){var e=o.current;if(void 0!==e){for(var t=d.length-1;t>=0;t--){if(void 0===f[t]){var i=n?e-d[t].offsetLeft:d[t].offsetLeft+d[t].offsetWidth;t+1<d.length&&t+1===a&&(p=f[t+1]-i),t===d.length-2&&(p+=r.offsetWidth),f[t]=i+p}if(e>f[t])return void _(t+1)}_(0)}};var m=d.length,_=function(e){m!==e&&(m=e,t(e,d.map(function(t,n){return{ele:t,isOverflowing:n>=e&&n!==a}})))},h=void 0;if(void 0!==o.current){var g=Object(b.e)(e);if(g){var v=g.requestAnimationFrame(i.current);h=function(){return g.cancelAnimationFrame(v)}}}return function(){h&&h(),_(d.length),i.current=void 0}}}),{menuButtonRef:c}}({onOverflowItemsChanged:function(e,t){t.forEach(function(e){var t=e.ele,n=e.isOverflowing;return t.dataset.isOverflowing=""+n}),Q.items=R.links.slice(e).filter(function(e){return e.itemKey!==K}).map(function(t,a){return t.role="menuitem",{key:t.itemKey||""+(e+a),onRender:function(){return B(R,t,K,n.linkInMenu)}}})},rtl:Object(p.e)(A),pinnedIndex:W}).menuButtonRef,J=U||m.e;return r.createElement("div",Object(i.__assign)({ref:t},H),r.createElement(g.e,Object(i.__assign)({componentRef:a,role:"tablist"},F,{direction:v.e.horizontal},T,{className:Object(u.e)(n.root,null==T?void 0:T.className)}),q,"menu"===M&&r.createElement(J,{className:Object(u.e)(n.link,n.overflowMenuButton),elementRef:Y,componentRef:c,menuProps:Q,menuIconProps:{iconName:"More",style:{color:"inherit"}},ariaLabel:P})),K&&R.links.map(function(t){return(!0===t.alwaysRender||K===t.itemKey)&&function(t,a){if(e.headersOnly||!t)return null;var i=R.keyToIndexMapping[t],o=R.keyToTabIdMapping[t];return r.createElement("div",{role:"tabpanel",hidden:!a,key:t,"aria-hidden":!a,"aria-labelledby":o,className:n.itemContainer},r.Children.toArray(e.children)[i])}(t.itemKey,K===t.itemKey)}))});O.displayName="Pivot";var w=n(21),E=n(525),A={count:"ms-Pivot-count",icon:"ms-Pivot-icon",linkIsSelected:"is-selected",link:"ms-Pivot-link",linkContent:"ms-Pivot-linkContent",root:"ms-Pivot",rootIsLarge:"ms-Pivot--large",rootIsTabs:"ms-Pivot--tabs",text:"ms-Pivot-text",linkInMenu:"ms-Pivot-linkInMenu",overflowMenuButton:"ms-Pivot-overflowMenuButton"},L=function(e,t,n){var a,r,o;void 0===n&&(n=!1);var s=e.linkSize,c=e.linkFormat,d=e.theme,l=d.semanticColors,u=d.fonts,f="large"===s,p="tabs"===c;return[u.medium,{color:l.actionLink,padding:"0 8px",position:"relative",backgroundColor:"transparent",border:0,borderRadius:0,selectors:{":hover":{backgroundColor:l.buttonBackgroundHovered,color:l.buttonTextHovered,cursor:"pointer"},":active":{backgroundColor:l.buttonBackgroundPressed,color:l.buttonTextHovered},":focus":{outline:"none"}}},!n&&[{display:"inline-block",lineHeight:44,height:44,marginRight:8,textAlign:"center",selectors:(a={},a["."+E.e+" &:focus"]={outline:"1px solid "+l.focusBorder},a["."+E.e+" &:focus:after"]={content:"attr(data-content)",position:"relative",border:0},a[":before"]={backgroundColor:"transparent",bottom:0,content:'""',height:2,left:8,position:"absolute",right:8,transition:"left "+w.n.durationValue2+" "+w.n.easeFunction2+",\n                        right "+w.n.durationValue2+" "+w.n.easeFunction2},a[":after"]={color:"transparent",content:"attr(data-content)",display:"block",fontWeight:w.r.bold,height:1,overflow:"hidden",visibility:"hidden"},a)},f&&{fontSize:u.large.fontSize},p&&[{marginRight:0,height:44,lineHeight:44,backgroundColor:l.buttonBackground,padding:"0 10px",verticalAlign:"top",selectors:(r={":focus":{outlineOffset:"-1px"}},r["."+E.e+" &:focus::before"]={height:"auto",background:"transparent",transition:"none"},r["&:hover, &:focus"]={color:l.buttonTextCheckedHovered},r["&:active, &:hover"]={color:l.primaryButtonText,backgroundColor:l.primaryButtonBackground},r["&."+t.linkIsSelected]={backgroundColor:l.primaryButtonBackground,color:l.primaryButtonText,fontWeight:w.r.regular,selectors:(o={":before":{backgroundColor:"transparent",transition:"none",position:"absolute",top:0,left:0,right:0,bottom:0,content:'""',height:0},":hover":{backgroundColor:l.primaryButtonBackgroundHovered,color:l.primaryButtonText},"&:active":{backgroundColor:l.primaryButtonBackgroundPressed,color:l.primaryButtonText}},o[w.o]=Object(i.__assign)({fontWeight:w.r.semibold,color:"HighlightText",background:"Highlight"},Object(w.x)()),o)},r)}]]]},k=Object(a.e)(O,function(e){var t,n,a,r,o=e.className,s=e.linkSize,c=e.linkFormat,d=e.theme,l=d.semanticColors,u=d.fonts,f=Object(w.I)(A,d),p="large"===s,m="tabs"===c;return{root:[f.root,u.medium,w.H,{position:"relative",color:l.link,whiteSpace:"nowrap"},p&&f.rootIsLarge,m&&f.rootIsTabs,o],itemContainer:{selectors:{"&[hidden]":{display:"none"}}},link:Object(i.__spreadArray)(Object(i.__spreadArray)([f.link],L(e,f)),[(t={},t["&[data-is-overflowing='true']"]={display:"none"},t)]),overflowMenuButton:[f.overflowMenuButton,(n={visibility:"hidden",position:"absolute",right:0},n["."+f.link+"[data-is-overflowing='true'] ~ &"]={visibility:"visible",position:"relative"},n)],linkInMenu:Object(i.__spreadArray)(Object(i.__spreadArray)([f.linkInMenu],L(e,f,!0)),[{textAlign:"left",width:"100%",height:36,lineHeight:36}]),linkIsSelected:[f.link,f.linkIsSelected,{fontWeight:w.r.semibold,selectors:(a={":before":{backgroundColor:l.inputBackgroundChecked,selectors:(r={},r[w.o]={backgroundColor:"Highlight"},r)},":hover::before":{left:0,right:0}},a[w.o]={color:"Highlight"},a)}],linkContent:[f.linkContent,{flex:"0 1 100%",selectors:{"& > * ":{marginLeft:4},"& > *:first-child":{marginLeft:0}}}],text:[f.text,{display:"inline-block",verticalAlign:"top"}],count:[f.count,{display:"inline-block",verticalAlign:"top"}],icon:f.icon}},void 0,{scope:"Pivot"})},,,,,,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-PersonaTile:focus{border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}"}]);var i=n(0),r=n(1977),o=n(2028),s=n(2067),c=n(1875),d=function(e){function t(t){var n=e.call(this,t)||this;n.personaTagName=o.e.tagName,n.addBindingHandlers({scrollIntoView:s.e});var a=t.tile;return n.tile=a,n.tile.personaParams.disableTab=!0,n.tile.personaParams.canManagePermissions=t.canManagePermissions,n.disableTab=t.disableTab,n._person=n.tile.personaParams.person.peek(),n.ariaLabel=n.createComputed(n._computeAriaLabel),n}return Object(i.__extends)(t,e),t.prototype._computeAriaLabel=function(){var e=this._person.sharingInfo.role,t="",n=this.tile.personaParams.canManagePermissions?r.i:"";return e===c.e.Owner?t=r.o:e===c.e.Edit?(t=r.n,t+=n):e===c.e.View&&(t=r.f,t+=n),"".concat(this._person.name," ").concat(t)},t}(n(196).t),l=n(399).e({tagName:"od-persona-tile",template:'<div class="od-PersonaTile" role="treeitem" data-bind="attr:{tabindex:tile.index===0&&!(disableTab===true)?0:-1,\'aria-label\':ariaLabel},hasFocus:tile.focused,scrollIntoView:{isSelected:tile.focused}"><div class="od-PersonaTile-Persona" data-bind="attr:{\'aria-hidden\':true},component:{name:personaTagName,params:tile.personaParams}"></div></div>',viewModel:d,synchronous:!0});t.e=l},,,function(e,t,n){"use strict";var a=n(0),i=n(17);Object(i.n)([{rawString:".od-addCommentTextField{display:flex;margin:4px 0 16px 0}.od-addCommentTextField .ms-TextField-suffix{margin:8px 0;padding:0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-addCommentTextField-input{flex-grow:1}.od-addCommentTextField-input .ms-TextField-fieldGroup{background:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-addCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset}.od-addCommentTextField-spinner{display:flex;flex-direction:column;justify-content:center;margin:4px}.od-addCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-addNewCommentTextField textarea{overflow-y:auto}"}]),Object(i.n)([{rawString:".od-addNewCommentTextField{display:flex;flex-direction:column;margin:4px 0 16px 0}.od-addNewCommentTextField .ms-TextField-suffix{padding:0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";flex-direction:row-reverse}.od-addNewCommentTextField .od-TextBox-infoMessage{margin:4px 0;padding:8px 4px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";display:flex;vertical-align:middle;flex-direction:row}.od-addNewCommentTextField .od-TextBox-infoMessage .od-info-icon{padding:0 8px;align-self:flex-start}.od-addNewCommentTextField .od-TextBox-infoMessage .od-info-message{padding:0 4px;font-size:10px}.od-addNewCommentTextField-input{flex-grow:1}.od-addNewCommentTextField-input .ms-TextField-fieldGroup{background:"},{theme:"white",defaultValue:"#fff"},{rawString:";flex-direction:column;max-height:174px;min-height:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-radius:2px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field{height:100%;min-height:0}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field:empty{max-height:min-content}.od-addNewCommentTextField-input .ms-TextField-fieldGroup:hover{border-color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";border-radius:2px;background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup:hover{border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-addNewCommentTextField-disabled .ms-TextField-suffix{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-addNewCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset;margin:4px}.od-addNewCommentTextField-spinner{display:flex;flex-direction:column;justify-content:center;margin:4px}.od-addNewCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var r=n(1),o=n(112),s=n(51),c=n(1529),d=n(1786),l=n(434),u=n(2112),f=n(1644),p=n(476),m=n(1673),_=n(129),h=n(2597),b=n(96),g=/(^@|\s@)/m,v=function(e){function t(t){var n,a=this;return(a=e.call(this,t)||this)._textField=r.createRef(),a.COMMENT_TEXT_MAX_LENGTH=2e3,a.charLimitExceededMessage="Maximum character limit exceeded",a._onSend=function(){var e=a.props,t=e.onSend,n=e.engagementSource,i=e.engagementExtraData,r=e.engagementExecutor,o=a.state.text;if(o&&t){a.setState({sending:!0,errorMessage:"",successMessage:""}),t(o,function(){a._onClearTextField(),a.setState({successMessage:h.e})},function(e){a.setState({sending:!1,errorMessage:e})});var s=n?"".concat(n,"."):"AddCommentTextField.";(r||b.e).logData({name:"".concat(s,"Send.Click"),isIntentional:!0,extraData:i})}},a._onClearTextField=function(){a.setState(a._getResetState(),function(){a._textField&&a._textField.current&&a._textField.current.focus()})},a._onTextFieldChange=function(e,t){if(!t||t.length<=a.COMMENT_TEXT_MAX_LENGTH){var n=a._isIE&&g.test(t),i=a.props.isMentionsEnabled&&n?h.a:"";a.setState({text:t||"",errorMessage:"",enableSendButton:!(!t||!t.trim()),infoMessage:i})}else a.setState({text:a.state.text,errorMessage:a.charLimitExceededMessage,enableSendButton:!1,infoMessage:""})},a._onKeyDown=function(e){e.which===o.e.enter&&a.state.enableSendButton&&a._onSend()},a._isIE=!!(null===(n=null==t?void 0:t.platform)||void 0===n?void 0:n.isIE),a.state=a._getResetState(),a}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.commentItemId===this.props.commentItemId&&e.disabled===this.props.disabled||this.setState(Object(a.__assign)(Object(a.__assign)({},this._getResetState()),{errorMessage:"",successMessage:""}))},t.prototype.componentDidMount=function(){this.props.focusOnMount&&!this.props.disabled&&this._textField.current&&this._textField.current.focus()},t.prototype.render=function(){var e=this.props,t=e.overrideStyleName,n=e.enableNewCommentingExperience;return r.createElement("div",{className:Object(s.e)({"od-addCommentTextField":!n},{"od-addNewCommentTextField":n},t)},r.createElement(u.e,Object(a.__assign)({componentRef:this._textField,"data-lpignore":"true"},this._getTextFieldProps())),r.createElement("div",{className:Object(s.e)({"od-addCommentTextField-screenReaderOnly":!n},{"od-addNewCommentTextField-screenReaderOnly":n}),"aria-live":"assertive",role:"status","aria-label":this.state.successMessage},this.state.successMessage),this._renderInfoMessage())},t.prototype._getTextFieldProps=function(){var e=this,t=this.props,n=t.placeholderText,a=t.disabled,i=t.enableNewCommentingExperience,r=this.state,o=r.sending,c=r.text,d=r.errorMessage;return{className:Object(s.e)({"od-addCommentTextField-input":!i},{"od-addNewCommentTextField-input":i},{"od-addNewCommentTextField-disabled":i&&(a||o)}),placeholder:n,onChange:this._onTextFieldChange,value:c||"",disabled:a||o,onKeyDown:this._onKeyDown,autoComplete:"off",errorMessage:d,autoAdjustHeight:i,multiline:i,rows:1,resizable:!1,onRenderSuffix:function(t){return e._onRenderSuffix()},ariaLabel:h.o}},t.prototype._onRenderSuffix=function(){return this.props.enableNewCommentingExperience?this.state.text.length>0&&r.createElement(r.Fragment,null,this._getSendButton()):r.createElement(r.Fragment,null,this._getCancelButton(),this._getSendButton())},t.prototype._getCancelButton=function(){return this.props.enableNewCommentingExperience,r.createElement(m.e,{content:h.r,styles:{root:{display:"inline-block"}},directionalHint:_.e.bottomAutoEdge},r.createElement(f.e,{iconProps:{iconName:"Cancel"},ariaLabel:h.r,onClick:this._onClearTextField}))},t.prototype._getSendButton=function(){var e=this.props,t=e.sendButtonTitle,n=e.enableNewCommentingExperience;return this.state.sending?r.createElement("div",{className:Object(s.e)({"od-addCommentTextField-spinner":!n},{"od-addNewCommentTextField-spinner":n})},r.createElement(d.e,{size:l.e.small})):r.createElement(m.e,{content:h.s||t,styles:{root:{display:"inline-block"}},directionalHint:_.e.bottomAutoEdge},r.createElement(f.e,{className:Object(s.e)({"od-addCommentTextField-sendButton":!n},{"od-addNewCommentTextField-sendButton":n}),iconProps:{iconName:"Send"},ariaLabel:h.s||t,onClick:this._onSend,disabled:!this.state||!this.state.enableSendButton}))},t.prototype._getResetState=function(){return{text:"",enableSendButton:!1,sending:!1,errorMessage:"",infoMessage:""}},t.prototype._renderInfoMessage=function(){return!this.state.errorMessage&&!!this.state.infoMessage&&r.createElement("div",{className:"od-TextBox-infoMessage"},r.createElement("span",{className:"ms-Icon od-info-icon","aria-hidden":!0},r.createElement(p.e,{iconName:"Info"})),r.createElement("span",{className:"od-info-message"},this.state.infoMessage))},t}(c.e);t.e=v},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(119),i=n(1982),r=n(60),o={folderDoesNotExist:!0,itemNotFound:!0,accessDenied:!0,unauthenticated:!0},s=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor,this._itemActivitiesResultProcessor=t.itemActivitiesResultProcessor}return e.prototype.getItemActivities=function(e){var t=this;if(e.environment=e.environment||"sharePoint",e.mockData)return r.n.resolve({activities:e.mockData,isPlaceholder:!1,success:!0});var n=this._getRequestUrl(e);return this._dataRequestor.send({apiName:e.qosPrefix?"".concat(e.qosPrefix,".GetItemActivities"):"GetItemActivities",path:n,headers:e.headers,accessToken:e.item.accessToken,apiVersion:e.apiVersion,expectedErrorCodes:o,useAuthorizationHeaders:-1!==e.item.graphItemUrl.indexOf("my.microsoftpersonalcontent.com")}).then(function(n){return t._itemActivitiesResultProcessor.processResponse({item:e.item,response:n})},function(e){return{error:e,isPlaceholder:!1,activities:[],success:!1}})},e.prototype.getActivitiesByDate=function(e){return e.environment=e.environment||"sharePoint",e.mockData?r.n.resolve({activitiesByDate:e.mockData,success:!0}):this.getActivitiesByInterval({item:e.item,headers:e.headers,interval:"day",startDateTime:e.startDateTime,endDateTime:e.endDateTime}).then(function(e){return{error:e.error,success:e.success,activitiesByDate:e.activitiesByInterval.map(function(e){var t=e.startDateTime;return{createCount:e.createCount,deleteCount:e.deleteCount,editCount:e.editCount,moveCount:e.moveCount,restoreCount:e.restoreCount,copyCount:e.copyCount,totalCount:e.totalCount,date:c(t)}})}},function(e){return r.n.resolve({activitiesByDate:[],error:new Error("Not implemented"),success:!1})})},e.prototype.getActivitiesByInterval=function(e){var t=this,n=e.endDateTime?"&endDateTime=".concat(e.endDateTime.toISOString()):"",a="".concat(e.item.graphItemUrl,"/action.getActivitiesByInterval?startDateTime=").concat(e.startDateTime.toISOString(),"&interval=day").concat(n);return this._dataRequestor.send({apiName:"GetActivitiesByInterval",headers:e.headers,path:a}).then(function(e){return t._itemActivitiesResultProcessor.processActivitiesByIntervalResponse(e)},function(e){return{error:e,activitiesByInterval:[],success:!1}})},e.prototype._getRequestUrl=function(e){var t=e.pageSize?e.pageSize:25,n="sharePointList"===e.environment?"".concat(e.item.graphItemUrl,"/activities?$expand=listItem($select=id,name,webUrl)"):"".concat(e.item.graphItemUrl,"/activities?$expand=driveItem($select=id,name,webUrl,parentReference,file,folder)");return n+="&$top=".concat(t),e.filter&&(n+="&$filter=".concat(e.filter)),e.orderBy&&(n+="&$orderby=".concat(e.orderBy)),e.nextRequestToken&&(n+="&$skiptoken=".concat(e.nextRequestToken)),n},e}();function c(e){function t(e){return e<10?"0".concat(e):e}return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()))}var d=n(2529),l=Object(a.r)("ItemActivitiesService",s,{vroomDataRequestor:i.e,itemActivitiesResultProcessor:d.e})},,function(e,t,n){"use strict";var a=n(0),i=n(347),r=n(29),o=n(10),s=n(1898),c=n(1964),d=n(24),l=n(60),u=n(1114),f=n(2040),p=n(39),m=n(291),_=n(196),h=n(1622),b=n(94),g=n(1875),v=n(2032),y=n(2048),S=n(290),D=n(1209),I=n(36),x=function(e){function t(){var t=e.call(this)||this;return t.keyboardOptions=[{target:null,mappings:{Enter:t.onKeyEnter}},{target:window,mappings:{}}],t.focusedTile=t.observables.create(),t.focusableTiles=t.observables.createArray(),t}return Object(a.__extends)(t,e),t.prototype.onKeyEnter=function(e,t){var n=e.keyNav.focusedTile();return n&&(n.personaParams.inputEvent(t),n.personaParams.openContextMenu(!0)),t.stopPropagation(),!0},t}(n(58).n),C=n(1853),O=function(e){function t(t){var n=e.call(this,t)||this;n.sharingApiErrorMessage=n.createObservable(""),n._people=n.createObservable(Array()),n.keyNav=new x,n.personaTileCollection=n._getPersonaTileCollection(),n.personaTileByUser=n._getPersonaTileByUser(),n.principalKeepSharing=n._getPrincipalKeepSharing(),n.keyNav.focusableTiles=n.personaTileCollection,n.isNewSharingFlowEnabled=Object(o.isFeatureEnabled)(o.SharingDialogRedux),n.isLoading=d.observable(!1),n.scopes=d.observableArray(),n.links=d.observableArray(),n._scopesLinks=n.observables.createArray(),n.hasFocus=t.hasFocus,n.personaSize=4,n.hasSettings=d.observable(!1),n.advancedUrl=d.observable(""),n.canUnshare=d.observable(!1),n.showEmailLink=d.observable(!1),n.readPermissionsUpdated=n.createObservable(!1),n.updateComplete=n.createObservable(""),n.canManagePermissions=n.createObservable(!1),n.hasInheritedLink=n.createObservable(!1);var a=n.resources.consume(r.e);return n.privateDescription=n.createPureComputed(n._computeShareStatus),n._engagement=n.resources.consume(i.e),n._currentItemShareAction=n.isNewSharingFlowEnabled?new(n.managed(a.ShareByLinkAction)):new(n.managed(a.ShareAction)),n._sharingProvider=n.resources.consume(c.resourceKey),n._item=t.item,n.isShareLinkVisible=n.createComputed(n._computeIsShareLinkVisible),n.fileItem=n._item(),n.createComputed(function(){var e=n._item();n._onItemChanged(e)}),n.totalNumberOfLinks=n.createPureComputed(n._computeTotalNumberOfLinks),n.statusText=n.createComputed(n._computeStatusText),n.fileName=n.createObservable(""),n.personaTileKeepSharing=n.createComputed(n._getPersonaKeepSharing),n.keepSharingHasAccess=n.createComputed(n._getkeepSharingHasAccess),n.mailto=n.createComputed(function(){if(!n.hasSettings())return"";for(var e,t="mailto:",a=[],i=0,r=n.scopes();i<r.length;i++)for(var o=0,s=r[i].people;o<s.length;o++){var c=s[o];c.email&&a.push(c.email)}return n.showEmailLink(a.length>0&&a.length<30),t+=m.e.encodeURIComponent(a.join(";")),t+="?subject="+m.e.encodeURIComponent(n._settings.itemName),e=h.e(n._settings.itemUrl),t+="&body="+m.e.encodeURIComponent(n._normalizeUrl(e)),n.fileName(n._settings.itemName),n.canManagePermissions(n._settings.canManagePermissions),n.hasInheritedLink(n._settings.hasInheritedLink),n.sharingApiErrorMessage(n._settings.sharingApiErrorMessage),t}),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._getPermissionsPromise&&(this._sharingData.cancelGetPermissionsPromise(),this._getPermissionsPromise=null),this._getLinksPromise&&(this._sharingData.cancelGetLinksPromise(),this._getLinksPromise=null)},t.prototype.onLinkRemoved=function(){this._engagement.logData({name:"RemoveLinkFromPanel.Sharing.InfoPaneSection.Click",isIntentional:!0}),this._onItemChanged(this._item.peek())},t.prototype.onScopeClick=function(e){return this._executeShare(e),!1},t.prototype.notifyPermissionsUpdated=function(){this.updateComplete(s.sharingPermissionsUpdated),this.readPermissionsUpdated(!0)},t.prototype.cleanPermissionsUpdated=function(){this.updateComplete(""),this.readPermissionsUpdated(!1)},t.prototype.onShareClick=function(){return this._executeShare(this._item.peek()),!1},t.prototype.stopSharing=function(e){this._engagement.logData({name:"StopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0}),this._stopSharingConfirm(e)},t.prototype.convertPersonToPersonaTile=function(e,t,n){return{personaParams:{inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),item:n,person:e,personaSize:this.personaSize,showPresence:!0,sharingRoleMenuRootElementClass:"OneDriveApp"},key:t,focused:this.observables.create(!1)}},t.prototype._computeIsShareLinkVisible=function(){return this._currentItemShareAction.isAvailable()},t.prototype._stopSharing=function(){return this._sharingProvider.unshare(this._item.peek())},t.prototype._stopSharingConfirm=function(e){var t=this,n=this.resources.consume(u.e),a=this._engagement,i=d.observable(!0);n.requestDialog({title:s.stopSharingConfirmationTitle,size:"Medium",component:{name:y.e.tagName,params:{message:s.stopSharingConfirmationMessage}},actions:[{name:s.stopSharingConfirmationButton,execute:function(){return a.logData({name:"Unshare.Sharing.InfoPaneSection.Click",isIntentional:!0}),i(!1),t._stopSharing().then(function(n){return t._item.peek().queryType===I.e.SharedByMe&&e(),2},function(e){return 3})},isDefault:!0,isAvailable:i,icon:new S.e("Save"),automationId:"UnshareConfirm"},{name:s.stopSharingCancelButton,execute:function(){return a.logData({name:"CancelStopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0}),l.n.wrap(3)},isDefault:!1,icon:new S.e("Cancel"),automationId:"UnshareCancel"}],focusOnPrimaryAction:!0,dismissOnEsc:!0,shouldPreserveFocus:!0,executeDefaultAction:!1})},t.prototype._executeShare=function(e,t){void 0===t&&(t=this.resources);var n=this.resources.consume(r.e);(this.isNewSharingFlowEnabled?this.addDisposable(new(t.injected(n.ShareByLinkAction))):this.addDisposable(new(t.injected(n.ShareAction))({item:d.observable(e),startState:3}))).execute(null)},t.prototype._computeStatusText=function(){var e=this._item.peek(),t=this.isLoading(),n="",a=this.scopes();return this._hasError&&(n=this._errorText),t?n=s.sharingLoadingStatus:0!==this.totalNumberOfLinks()||this._hasNonOwnerScopes(a)||(n=e.type===b.e.Folder?s.sharingUnsharedFolderStatus:s.sharingUnsharedFileStatus),n},t.prototype._hasNonOwnerScopes=function(e){var t=!0,n=!1;if(e&&0!==e.length||(t=!1),t)for(var a=0;a<e.length&&!n;a++)for(var i=e[a].people,r=0;r<i.length&&!n;r++)i[r].sharingInfo.role!==g.e.Owner&&(n=!0);return t&&n},t.prototype._computeShareStatus=function(){var e=this.scopes(),t="";if(0===this.totalNumberOfLinks()&&!this._hasNonOwnerScopes(e)&&this._item().sharingRole===g.e.Owner)if(e&&0!==e.length){if(1===e.length&&this._areAllOwners(e[0].people)){var n=e[0].people[0];t=1===e[0].people.length&&n.entityType===v.e.group?p.format(s.sharingUnsharedOwnedByGroup,n.name):s.sharingUnsharedNotShared}}else t=s.sharingUnsharedNotShared;return t},t.prototype._areAllOwners=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a.sharingInfo&&a.sharingInfo.role!==g.e.Owner)return!1}return!0},t.prototype._computeTotalNumberOfLinks=function(){var e=this.links(),t=this._scopesLinks();return e.length+t.length},t.prototype._onItemChanged=function(e){var t=this;this.cleanPermissionsUpdated(),this._getPermissionsPromise&&(this.isLoading(!1),this._sharingData.cancelGetPermissionsPromise(),this._getPermissionsPromise=null),this._getLinksPromise&&(this._sharingData.cancelGetLinksPromise(),this._getLinksPromise=null),e&&e.key!==this._itemKey&&(this._itemKey=e.key,this.scopes([]),this.links([]),this.isLoading(!0)),e&&(this._sharingData=this._sharingProvider.getSharingData(e),this._sharingData.getSettings().then(function(e){t._settings=e,t.advancedUrl(e.advancedUrl),t.hasSettings(!0)},function(e){}),this._hasError=!1,this._getPermissionsPromise=this._sharingData.getPermissions(),this._sharingData.doSharingScopesContainLinks()||(this._getLinksPromise=this._sharingData.getLinks()),this.trackPromise(this._getPermissionsPromise.then(function(n){t.isLoading(!1),t.scopes(t._processScopes(e,n))},function(e){e&&403===e.status?t._errorText=s.accessDenied:e&&e.code&&e.code.indexOf("-2130575139")>-1?t._errorText=s.noscriptErrorStatus:t._errorText=s.serverError,t._hasError=!0,t.isLoading(!1)})),this._getLinksPromise&&this._getLinksPromise.then(function(e){e&&t.links(e.filter(function(e){return e.isActive&&e.type!==f.e.Direct}))},function(e){}),this.fileItem=e)},t.prototype._processScopes=function(e,t){var n=this,i=[];t.length>0&&this.canUnshare(t[0].canUnshare),this._scopesLinks([]);for(var r=0;r<t.length;r++){var o=t[r];if(o&&o.people.length){var c,d=Object(a.__assign)(Object(a.__assign)({},o),{headerHtml:"",sharingPeople:[]});o.item&&o.item.key!==this._item.peek().key&&(c="<span data-bind=\"component: { name: '".concat(D.e.tagName,"', params: { item: scope.item } }\"></span>"),d.headerHtml=p.format(s.sharingScopeHeaderFormat,c)),o.people.forEach(function(e){var t;if(e.sharingInfo&&e.sharingInfo.link){var a=e.sharingInfo.link;a.type===f.e.RequestAccess&&(a.email=null===(t=e.sharingInfo)||void 0===t?void 0:t.email),n._scopesLinks.push(a)}d.sharingPeople.push({personInfo:e,sharingItem:o.item})}),i.push(d)}}for(var l=new Array,u=0;u<i.length;u++)l=l.concat(i[u].sharingPeople);return this._people().length&&this.notifyPermissionsUpdated(),this._people(l),i},t.prototype._getkeepSharingHasAccess=function(){var e=this.personaTileKeepSharing(),t=this.totalNumberOfLinks();return e.length>0||t>0},t.prototype._getPersonaKeepSharing=function(){for(var e=this.principalKeepSharing(),t={},n=0,a=e;n<a.length;n++)t[(u=a[n]).personaParams.person().userId]=!0;for(var i=0,r=this.links();i<r.length;i++){var o=r[i];if(o.linkMembers)for(var s=0,c=o.linkMembers;s<c.length;s++){var d=c[s],l=d.userId,u=this.convertPersonToPersonaTile(this.createObservable(d),d.userId);t[l]||(t[l]=!0,e.push(u))}}return e},t.prototype._getPrincipalKeepSharing=function(){return this._getPersonaTileHelper(!0)},t.prototype._getPersonaTileCollection=function(){return this._getPersonaTileHelper()},t.prototype._getPersonaTileHelper=function(e){var t=this,n=this.createPureComputed(e?this._getPeopleKeepSharing:this._getPeopleByUserId),i=this.observables.createArray();return this.createBackgroundComputed(function(){i.splice.apply(i,Object(a.__spreadArray)([0,i.peek().length],t._people().map(function(e){return e.personInfo.userId}),!1))}),i.filter(function(e){return e in n()}).map({mappingWithDisposeCallback:function(e){var a=t.createObservable(),i=t.createComputed(function(){a(n()[e].personInfo||a.peek())});return{mappedValue:t.convertPersonToPersonaTile(a,e,n()[e].sharingItem),dispose:function(){i.dispose()}}}})},t.prototype._getPeopleKeepSharing=function(){return this._getPeopleByUserId(!1,!0)},t.prototype._getPeopleByUserId=function(e,t){for(var n={},a=0,i=this._people();a<i.length;a++){var r=i[a],o=r.personInfo,s=o&&o.sharingInfo;s&&3===s.type||e&&o.principalType===C.e.sharePointGroup||t&&o&&o.sharingInfo&&o.sharingInfo.role===g.e.Owner||(n[o.userId]=r)}return n},t.prototype._getPersonaTileByUser=function(){var e=this;return this.createComputed(function(){for(var t={},n=0,a=e.personaTileCollection();n<a.length;n++){var i=a[n];t[i.key]=i}return t})},t.prototype._normalizeUrl=function(e){var t=document.createElement("A");return t.href=e,t.href},t}(_.t);t.e=O},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(0),i=n(17);Object(i.n)([{rawString:".od-PolicyTip-container{display:flex;flex-direction:column}.od-PolicyTip-title{font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:100;margin:0 0 8px 0}.od-PolicyTip-description{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-top:20px}.od-PolicyTip-header{display:flex;margin:20px 0}.od-PolicyTip-blockedIcon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:21px;padding-top:2px}.od-PolicyTip-headerText{font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300;font-weight:600}[dir=ltr] .od-PolicyTip-headerText{margin-left:12px}[dir=rtl] .od-PolicyTip-headerText{margin-right:12px}.od-PolicyTip-issue{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-bottom:12px}[dir=ltr] .od-PolicyTip-issue{margin-left:33px}[dir=rtl] .od-PolicyTip-issue{margin-right:33px}.od-PolicyTip-minorText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PolicyTip-learnMoreContainer{display:flex}[dir=ltr] .od-PolicyTip-learnMoreContainer a{padding-right:4px}[dir=rtl] .od-PolicyTip-learnMoreContainer a{padding-left:4px}.od-PolicyTip-actions{margin-top:60px}.od-PolicyTip-action{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;margin-bottom:8px}.od-PolicyTip-actionLabel{font-weight:600;cursor:pointer}[dir=ltr] .od-PolicyTip-label{margin-left:4px}[dir=rtl] .od-PolicyTip-label{margin-right:4px}.od-PolicyTip-status{display:flex;margin-top:34px;margin-bottom:8px}.od-PolicyTip-status{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PolicyTip-statusText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400}[dir=ltr] .od-PolicyTip-statusText{margin-left:4px}[dir=rtl] .od-PolicyTip-statusText{margin-right:4px}.od-PolicyTip-justificationInputContainer{overflow-y:auto;max-height:110px}.od-PolicyTip-submitButton{margin-top:8px}.od-PolicyTip-error{margin-top:36px;font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300}"}]);var r=n(1529),o=n(1642),s=n(1786),c=n(2112),d=n(1),l=n(39),u=n(476),f=function(e){function t(t){var n=e.call(this,t)||this;return n._onReportClicked=function(){n.setState(Object(a.__assign)(Object(a.__assign)({},n.state),{isLoading:!0,reportButtonClicked:!0}),function(){n.props.onReportClicked()})},n._onOverrideClicked=function(){n.setState(Object(a.__assign)(Object(a.__assign)({},n.state),{overrideButtonClicked:!0}),function(){n.props.onOverrideClicked()})},n._onOverrideSubmitClicked=function(){n.setState(Object(a.__assign)(Object(a.__assign)({},n.state),{isLoading:!0,overrideSubmitClicked:!0}),function(){n.props.onOverrideSubmitClicked(n.state.justificationText)})},n._onJustificationChanged=function(e,t){n.props.overrideRequiresJustification&&n.setState(Object(a.__assign)(Object(a.__assign)({},n.state),{justificationText:t||"",overrideSubmitDisabled:!t}))},n.state={isLoading:!1,justificationText:"",reportButtonClicked:!1,overrideButtonClicked:!1,overrideSubmitClicked:!1,overrideSubmitDisabled:t.overrideRequiresJustification},n}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.state.isLoading&&e.confirmationText&&this.setState(Object(a.__assign)(Object(a.__assign)({},this.state),{isLoading:!1}))},t.prototype.componentWillUnmount=function(){this.props.onDismissed()},t.prototype.render=function(){var e=this.props.strings,t=e.noPolicyTipInfoError?d.createElement("div",{className:"od-PolicyTip-container"},d.createElement("span",{className:"od-PolicyTip-error"},e.noPolicyTipInfoError)):d.createElement("div",{className:"od-PolicyTip-container"},d.createElement("span",{className:"od-PolicyTip-description"},e.policyTipDescription),d.createElement("div",{className:"od-PolicyTip-header"},d.createElement(u.e,{iconName:"Blocked2",className:"od-PolicyTip-blockedIcon"}),d.createElement("span",{className:"od-PolicyTip-headerText"},e.headerText)),this._renderIssues(),d.createElement("span",{className:"od-PolicyTip-minorText"},e.lastScannedText),this._renderLearnMore(),d.createElement("div",{className:"od-PolicyTip-actions"},this._renderActions()),this._renderJustificationInput(),this._renderStatus());return d.createElement("div",null,d.createElement("h2",{className:"od-PolicyTip-title"},e.titleText),t)},t.prototype._renderIssues=function(){for(var e=[],t=0,n=0,a=this.props.strings.issues;n<a.length;n++){var i=a[n];e.push(d.createElement("span",{className:"od-PolicyTip-issue",key:t++},i))}return e},t.prototype._renderLearnMore=function(){var e=this.props.strings;if(e.learnMoreUrl){var t=d.createElement("a",{href:e.learnMoreUrl,target:"_blank"},e.learnMoreActionLabel),n=l.formatToArray(e.learnMoreLabel,t);return d.createElement("div",{className:"od-PolicyTip-learnMoreContainer od-PolicyTip-minorText"},n)}},t.prototype._getAction=function(e,t,n,a){if(n)return d.createElement("div",{className:"od-PolicyTip-action"},d.createElement("span",null,"".concat(l.format(e,t))));var i=d.createElement("a",{className:"od-PolicyTip-actionLabel",onClick:a,role:"button",href:"javascript:;"},t),r=l.formatToArray(e,i);return d.createElement("div",{className:"od-PolicyTip-action"},r)},t.prototype._renderActions=function(){var e=this.props,t=this.state,n=e.strings,a=[],i=this._getAction(n.reportLabel,n.reportActionLabel,t.reportButtonClicked,this._onReportClicked);if(a.push(i),n.overrideActionLabel){var r=this._getAction(n.overrideLabel,n.overrideActionLabel,t.overrideButtonClicked,this._onOverrideClicked);a.push(r)}return a},t.prototype._renderStatus=function(){var e=this.props;return this.state.isLoading?d.createElement("div",{className:"od-PolicyTip-status"},d.createElement(s.e,null),d.createElement("span",{className:"od-PolicyTip-statusText"},e.strings.reportInProgressLabel)):e.confirmationText?d.createElement("div",{className:"od-PolicyTip-status"},d.createElement(u.e,{iconName:"CheckMark"}),d.createElement("span",{className:"od-PolicyTip-statusText"},e.confirmationText)):void 0},t.prototype._renderJustificationInput=function(){var e=this.props,t=this.state;if(e.showJustificationInput)return d.createElement("div",{className:"od-PolicyTip-justificationInputContainer"},d.createElement(c.e,{autoAdjustHeight:!0,multiline:!0,value:t.justificationText,onChange:this._onJustificationChanged,underlined:!0,resizable:!1}),!t.overrideSubmitClicked&&d.createElement(o.e,{className:"od-PolicyTip-submitButton",disabled:t.overrideSubmitDisabled,onClick:this._onOverrideSubmitClicked},e.strings.submitButtonLabel))},t}(r.e)}],Array(18),[function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(0),i={formatDay:function(e){return e.getDate().toString()},formatMonth:function(e,t){return t.months[e.getMonth()]},formatYear:function(e){return e.getFullYear().toString()},formatMonthDayYear:function(e,t){return t.months[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()},formatMonthYear:function(e,t){return t.months[e.getMonth()]+" "+e.getFullYear()}},r=Object(a.__assign)(Object(a.__assign)({},{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"]}),{goToToday:"Go to today",weekNumberFormatString:"Week number {0}",prevMonthAriaLabel:"Previous month",nextMonthAriaLabel:"Next month",prevYearAriaLabel:"Previous year",nextYearAriaLabel:"Next year",prevYearRangeAriaLabel:"Previous year range",nextYearRangeAriaLabel:"Next year range",closeButtonAriaLabel:"Close",selectedDateFormatString:"Selected date {0}",todayDateFormatString:"Today's date {0}",monthPickerHeaderAriaLabel:"{0}, change year",yearPickerHeaderAriaLabel:"{0}, change month",dayMarkedAriaLabel:"marked"})},,,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"e",function(){return d});var a=n(17);Object(a.n)([{rawString:".commandLink_968b2259{height:32px;line-height:32px}html[dir=ltr] .commandLink_968b2259{margin-right:15px}html[dir=rtl] .commandLink_968b2259{margin-left:15px}.commandLink_968b2259 i{color:"},{theme:"primaryText",defaultValue:"#333"},{rawString:"}button.link_968b2259,label.link_968b2259{display:inline;line-height:32px;height:32px;-webkit-user-select:none;-ms-user-select:none;user-select:none}html[dir=ltr] button.link_968b2259,html[dir=ltr] label.link_968b2259{margin-left:-7px}html[dir=rtl] button.link_968b2259,html[dir=rtl] label.link_968b2259{margin-right:-7px}html[dir=ltr] button.link_968b2259,html[dir=ltr] label.link_968b2259{margin-right:15px}html[dir=rtl] button.link_968b2259,html[dir=rtl] label.link_968b2259{margin-left:15px}.pageUsageChartContainer_968b2259>.ms-AnalyticsChart{margin-top:0}.root_968b2259{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;display:flex;flex-direction:row;flex-wrap:wrap;margin-top:12px}.socialBarList_968b2259{width:288px}.socialBarPanel_968b2259{top:50px}.socialBarPanelContent_968b2259{overflow-x:hidden;overflow-y:auto}.spSocialPanelPivotContent_968b2259{padding-top:15px}.socialBarPanelHeader_968b2259{flex-shrink:0;padding:0 25px}.socialBarPanelHeader_968b2259 .socialBarPanelHeaderText_968b2259{font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:300;line-height:48px;margin:0}.socialBarPanelPersona_968b2259{font-size:14px;padding:4px 0}.socialBarPanelPersonaDescription_968b2259{font-size:14px;padding:8px 0}.viewsIcon_968b2259{cursor:default;font-size:16px;height:32px;line-height:28px;text-align:center;width:32px;-webkit-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle}html[dir=ltr] .viewsIcon_968b2259{margin-right:8px}html[dir=rtl] .viewsIcon_968b2259{margin-left:8px}.analyticsStatsLink_968b2259{min-width:50px;font-size:14px;padding:0 8px 0 0}.analyticsStatsLink_968b2259 .ms-Link{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.analyticsStatsLink_968b2259 .ms-ActivityItem-activityTypeIcon{margin-top:0}html[dir=ltr] .analyticsStatsLink_968b2259 .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir=rtl] .analyticsStatsLink_968b2259 .ms-ActivityItem-activityTypeIcon{padding-left:5px}.analyticsStatsLink_968b2259 .ms-ActivityItem-activityContent{flex-basis:auto;font-weight:400}html[dir=ltr] .analyticsStatsLink_968b2259 .ms-ActivityItem-activityContent{padding-left:0}html[dir=rtl] .analyticsStatsLink_968b2259 .ms-ActivityItem-activityContent{padding-right:0}.analyticsStatsLink_968b2259 :hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}]);var i="socialBarList_968b2259",r="socialBarPanel_968b2259",o="socialBarPanelContent_968b2259",s="socialBarPanelPersona_968b2259",c="socialBarPanelPersonaDescription_968b2259",d="analyticsStatsLink_968b2259"},,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.DeletedSingle=1]="DeletedSingle",e[e.DeletedAll=2]="DeletedAll",e[e.CommentsEnabled=3]="CommentsEnabled",e[e.CommentsDisabled=4]="CommentsDisabled"}(a||(a={}))}],Array(25),[function(e,t,n){"use strict";n.d(t,"e",function(){return he});var a=n(1526),i=n(0),r=n(1),o=n(2014),s=n(2590),c=n(1891),d=n(809),l=n(2429),u=n(51),f=n(112),p=n(476),m=n(435),_=n(1750),h=function(e,t,n){var a=Object(i.__spreadArray)([],e);return t&&(a=a.filter(function(e){return Object(c.i)(e,t)>=0})),n&&(a=a.filter(function(e){return Object(c.i)(e,n)<=0})),a},b=function(e,t){var n=t.minDate;return!!n&&Object(c.i)(n,e)>=1},g=function(e,t){var n=t.maxDate;return!!n&&Object(c.i)(e,n)>=1},v=function(e,t){var n=t.restrictedDates,a=t.minDate,i=t.maxDate;return!!(n||a||i)&&(n&&n.some(function(t){return Object(c.r)(t,e)})||b(e,t)||g(e,t))},y=n(1583),S=n(1754),D=n(1452),I=function(e){var t=e.showWeekNumbers,n=e.strings,a=e.firstDayOfWeek,i=e.allFocusable,s=e.weeksToShow,c=e.weeks,d=e.classNames,l=n.shortDays.slice(),f=Object(D.a)(c[1],function(e){return 1===e.originalDate.getDate()});if(1===s&&f>=0){var p=(f+a)%o.e;l[p]=n.shortMonths[c[1][f].originalDate.getMonth()]}return r.createElement("tr",null,t&&r.createElement("th",{className:d.dayCell}),l.map(function(e,t){var s=(t+a)%o.e,c=n.days[s];return r.createElement("th",{className:Object(u.e)(d.dayCell,d.weekDayLabelCell),scope:"col",key:l[s]+" "+t,title:c,"aria-label":c,"data-is-focusable":!!i||void 0},l[s])}))},x=function(e){var t=e.targetDate,n=e.initialDate,a=e.direction,r=Object(i.__rest)(e,["targetDate","initialDate","direction"]),o=t;if(!v(t,r))return t;for(;0!==Object(c.i)(n,o)&&v(o,r)&&!g(o,r)&&!b(o,r);)o=Object(c.e)(o,a);return 0===Object(c.i)(n,o)||v(o,r)?void 0:o},C=function(e){var t,n=e.navigatedDate,a=e.dateTimeFormatter,i=e.allFocusable,s=e.strings,d=e.activeDescendantId,l=e.navigatedDayRef,p=e.calculateRoundedStyles,_=e.weeks,h=e.classNames,b=e.day,g=e.dayIndex,v=e.weekIndex,y=e.weekCorners,S=e.ariaHidden,D=e.customDayCellRef,I=e.dateRangeType,C=e.daysToSelectInDayView,O=e.onSelectDate,w=e.restrictedDates,E=e.minDate,A=e.maxDate,L=e.onNavigateDate,k=e.getDayInfosInRangeOfDay,M=e.getRefsFromDayInfos,P=null!==(t=null==y?void 0:y[v+"_"+g])&&void 0!==t?t:"",T=Object(c.r)(n,b.originalDate),U=b.originalDate.getDate()+", "+s.months[b.originalDate.getMonth()]+", "+b.originalDate.getFullYear();return b.isMarked&&(U=U+", "+s.dayMarkedAriaLabel),r.createElement("td",{className:Object(u.e)(h.dayCell,y&&P,b.isSelected&&h.daySelected,b.isSelected&&"ms-CalendarDay-daySelected",!b.isInBounds&&h.dayOutsideBounds,!b.isInMonth&&h.dayOutsideNavigatedMonth),ref:function(e){null==D||D(e,b.originalDate,h),b.setRef(e),T&&(l.current=e)},"aria-hidden":S,"aria-disabled":!S&&!b.isInBounds,onClick:b.isInBounds&&!S?b.onSelected:void 0,onMouseOver:S?void 0:function(e){var t=k(b),n=M(t);n.forEach(function(e,a){var i;if(e&&(e.classList.add("ms-CalendarDay-hoverStyle"),!t[a].isSelected&&I===o.t.Day&&C&&C>1)){e.classList.remove(h.bottomLeftCornerDate,h.bottomRightCornerDate,h.topLeftCornerDate,h.topRightCornerDate);var r=p(h,!1,!1,a>0,a<n.length-1).trim();r&&(i=e.classList).add.apply(i,r.split(" "))}})},onMouseDown:S?void 0:function(e){var t=k(b);M(t).forEach(function(e){e&&e.classList.add("ms-CalendarDay-pressedStyle")})},onMouseUp:S?void 0:function(e){var t=k(b);M(t).forEach(function(e){e&&e.classList.remove("ms-CalendarDay-pressedStyle")})},onMouseOut:S?void 0:function(e){var t=k(b),n=M(t);n.forEach(function(e,a){var i;if(e&&(e.classList.remove("ms-CalendarDay-hoverStyle"),e.classList.remove("ms-CalendarDay-pressedStyle"),!t[a].isSelected&&I===o.t.Day&&C&&C>1)){var r=p(h,!1,!1,a>0,a<n.length-1).trim();r&&(i=e.classList).remove.apply(i,r.split(" "))}})},onKeyDown:S?void 0:function(e){e.which===f.e.enter?null==O||O(b.originalDate):function(e,t){var n=void 0,a=1;if(e.which===f.e.up?(n=Object(c.n)(t,-1),a=-1):e.which===f.e.down?n=Object(c.n)(t,1):e.which===Object(m.t)(f.e.left)?(n=Object(c.e)(t,-1),a=-1):e.which===Object(m.t)(f.e.right)&&(n=Object(c.e)(t,1)),n){var i={initialDate:t,targetDate:n,direction:a,restrictedDates:w,minDate:E,maxDate:A},r=x(i);r||(i.direction=-a,r=x(i)),_&&r&&_.slice(1,_.length-1).some(function(e){return e.some(function(e){return Object(c.r)(e.originalDate,r)})})||r&&(L(r,!0),e.preventDefault())}}(e,b.originalDate)},role:"gridcell",tabIndex:T?0:void 0,"aria-current":b.isSelected?"date":void 0,"aria-selected":b.isInBounds?b.isSelected:void 0,"data-is-focusable":!S&&(i||!!b.isInBounds||void 0)},r.createElement("button",{key:b.key+"button","aria-hidden":S,className:Object(u.e)(h.dayButton,b.isToday&&h.dayIsToday,b.isToday&&"ms-CalendarDay-dayIsToday"),"aria-label":U,id:T?d:void 0,disabled:!S&&!b.isInBounds,type:"button",tabIndex:-1,"data-is-focusable":"false"},r.createElement("span",{"aria-hidden":"true"},a.formatDay(b.originalDate)),b.isMarked&&r.createElement("div",{"aria-hidden":"true",className:h.dayMarker})))},O=function(e){var t=e.classNames,n=e.week,a=e.weeks,o=e.weekIndex,s=e.rowClassName,d=e.ariaRole,u=e.showWeekNumbers,f=e.firstDayOfWeek,p=e.firstWeekOfYear,m=e.navigatedDate,_=e.strings,h=u?Object(c.l)(a.length,f,p,m):null,b=h?_.weekNumberFormatString&&Object(l.e)(_.weekNumberFormatString,h[o]):"";return r.createElement("tr",{role:d,className:s,key:o+"_"+n[0].key},u&&h&&r.createElement("th",{className:t.weekNumberCell,key:o,title:b,"aria-label":b,scope:"row"},r.createElement("span",null,h[o])),n.map(function(t,n){return r.createElement(C,Object(i.__assign)({},e,{key:t.key,day:t,dayIndex:n}))}))},w=Object(d.e)();var E=function(e){var t=r.useRef(null),n=Object(S.e)(),a=function(){var e=r.useRef({});return[e,function(t){return function(n){null===n?delete e.current[t]:e.current[t]=n}}]}(),s=a[0],d=a[1],l=function(e,t,n){return r.useMemo(function(){for(var a,r=function(e){var t,n=e.selectedDate,a=e.dateRangeType,i=e.firstDayOfWeek,r=e.today,s=e.minDate,d=e.maxDate,l=e.weeksToShow,u=e.workWeekDays,f=e.daysToSelectInDayView,p=e.restrictedDates,m=e.markedDays,_={minDate:s,maxDate:d,restrictedDates:p},b=r||new Date,g=e.navigatedDate?e.navigatedDate:b;t=l&&l<=4?new Date(g.getFullYear(),g.getMonth(),g.getDate()):new Date(g.getFullYear(),g.getMonth(),1);for(var y=[];t.getDay()!==i;)t.setDate(t.getDate()-1);t=Object(c.e)(t,-o.e);var S=!1,D=function(e,t,n){return!t||e!==o.t.WorkWeek||function(e,t,n){for(var a=new Set(e),i=0,r=0,o=e;r<o.length;r++){var s=(o[r]+1)%7;(!a.has(s)||n===s)&&i++}return i<2}(t,0,n)&&0!==t.length?e:o.t.Week}(a,u,i),I=[];n&&(I=Object(c.s)(n,D,i,u,f),I=h(I,s,d));for(var x=!0,C=0;x;C++){var O=[];S=!0;for(var w=function(e){var n=new Date(t.getTime()),a={key:t.toString(),date:t.getDate().toString(),originalDate:n,isInMonth:t.getMonth()===g.getMonth(),isToday:Object(c.r)(b,t),isSelected:Object(c.p)(t,I),isInBounds:!v(t,_),isMarked:(null==m?void 0:m.some(function(e){return Object(c.r)(n,e)}))||!1};O.push(a),a.isInMonth&&(S=!1),t.setDate(t.getDate()+1)},E=0;E<o.e;E++)w();x=l?C<l+1:!S||0===C,y.push(O)}return y}(e),s=r[1][0].originalDate,d=r[r.length-1][6].originalDate,l=(null===(a=e.getMarkedDays)||void 0===a?void 0:a.call(e,s,d))||[],u=[],f=0;f<r.length;f++){for(var p=[],m=function(e){var a=r[f][e],o=Object(i.__assign)(Object(i.__assign)({onSelected:function(){return t(a.originalDate)},setRef:n(a.key)},a),{isMarked:a.isMarked||(null==l?void 0:l.some(function(e){return Object(c.r)(a.originalDate,e)}))});p.push(o)},_=0;_<o.e;_++)m(_);u.push(p)}return u},[e])}(e,function(t){var n,a,i=e.firstDayOfWeek,r=e.minDate,o=e.maxDate,s=e.workWeekDays,d=e.daysToSelectInDayView,l={minDate:r,maxDate:o,restrictedDates:e.restrictedDates},u=Object(c.s)(t,C,i,s,d);u=(u=h(u,r,o)).filter(function(e){return!v(e,l)}),null===(n=e.onSelectDate)||void 0===n||n.call(e,t,u),null===(a=e.onNavigateDate)||void 0===a||a.call(e,t,!0)},d),u=function(e){var t=Object(y.e)(e[0][0].originalDate);return t&&t.getTime()!==e[0][0].originalDate.getTime()?!(t<=e[0][0].originalDate):void 0}(l),f=function(e){var t=function(e,t,n,a,i){var r=[],o=!t&&!i,s=!n&&!a,c=!n&&!i;return!t&&!a&&r.push(Object(m.e)()?e.topRightCornerDate:e.topLeftCornerDate),o&&r.push(Object(m.e)()?e.topLeftCornerDate:e.topRightCornerDate),s&&r.push(Object(m.e)()?e.bottomRightCornerDate:e.bottomLeftCornerDate),c&&r.push(Object(m.e)()?e.bottomLeftCornerDate:e.bottomRightCornerDate),r.join(" ")},n=function(t,n,a,i){var r=e.dateRangeType,s=e.firstDayOfWeek,d=e.workWeekDays,l=r===o.t.WorkWeek?o.t.Week:r,u=Object(c.s)(t,l,s,d);return a===i&&(!(!a||!i)||u.filter(function(e){return e.getTime()===n.getTime()}).length>0)};return[function(e,a){var i={},r=a.slice(1,a.length-1);return r.forEach(function(a,o){a.forEach(function(a,s){var c=r[o-1]&&r[o-1][s]&&n(r[o-1][s].originalDate,a.originalDate,r[o-1][s].isSelected,a.isSelected),d=r[o+1]&&r[o+1][s]&&n(r[o+1][s].originalDate,a.originalDate,r[o+1][s].isSelected,a.isSelected),l=r[o][s-1]&&n(r[o][s-1].originalDate,a.originalDate,r[o][s-1].isSelected,a.isSelected),u=r[o][s+1]&&n(r[o][s+1].originalDate,a.originalDate,r[o][s+1].isSelected,a.isSelected),f=[];f.push(t(e,c,d,l,u)),f.push(function(e,t,n,a,i){var r=[];return t||r.push(e.datesAbove),n||r.push(e.datesBelow),a||r.push(Object(m.e)()?e.datesRight:e.datesLeft),i||r.push(Object(m.e)()?e.datesLeft:e.datesRight),r.join(" ")}(e,c,d,l,u)),i[o+"_"+s]=f.join(" ")})}),i},t]}(e),p=f[0],b=f[1];r.useImperativeHandle(e.componentRef,function(){return{focus:function(){var e,n;null===(n=null===(e=t.current)||void 0===e?void 0:e.focus)||void 0===n||n.call(e)}}},[]);var g=e.styles,D=e.theme,x=e.className,C=e.dateRangeType,E=e.showWeekNumbers,A=e.labelledBy,L=e.lightenDaysOutsideNavigatedMonth,k=e.animationDirection,M=w(g,{theme:D,className:x,dateRangeType:C,showWeekNumbers:E,lightenDaysOutsideNavigatedMonth:void 0===L||L,animationDirection:k,animateBackwards:u}),P=p(M,l),T={weeks:l,navigatedDayRef:t,calculateRoundedStyles:b,activeDescendantId:n,classNames:M,weekCorners:P,getDayInfosInRangeOfDay:function(t){var n=function(e,t){if(t&&e===o.t.WorkWeek){for(var n=t.slice().sort(),a=!0,i=1;i<n.length;i++)if(n[i]!==n[i-1]+1){a=!1;break}if(!a||0===t.length)return o.t.Week}return e}(e.dateRangeType,e.workWeekDays),a=Object(c.s)(t.originalDate,n,e.firstDayOfWeek,e.workWeekDays,e.daysToSelectInDayView).map(function(e){return e.getTime()});return l.reduce(function(e,t){return e.concat(t.filter(function(e){return-1!==a.indexOf(e.originalDate.getTime())}))},[])},getRefsFromDayInfos:function(e){return e.map(function(e){return s.current[e.key]})}};return r.createElement(_.e,{className:M.wrapper,preventDefaultWhenHandled:!0},r.createElement("table",{className:M.table,"aria-multiselectable":"false","aria-labelledby":A,"aria-activedescendant":n,role:"grid"},r.createElement("tbody",null,r.createElement(I,Object(i.__assign)({},e,{classNames:M,weeks:l})),r.createElement(O,Object(i.__assign)({},e,T,{week:l[0],weekIndex:-1,rowClassName:M.firstTransitionWeek,ariaRole:"presentation",ariaHidden:!0})),l.slice(1,l.length-1).map(function(t,n){return r.createElement(O,Object(i.__assign)({},e,T,{key:n,week:t,weekIndex:n,rowClassName:M.weekRow}))}),r.createElement(O,Object(i.__assign)({},e,T,{week:l[l.length-1],weekIndex:-2,rowClassName:M.lastTransitionWeek,ariaRole:"presentation",ariaHidden:!0})))))};E.displayName="CalendarDayGridBase";var A,L=n(21);!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(A||(A={}));var k={hoverStyle:"ms-CalendarDay-hoverStyle",pressedStyle:"ms-CalendarDay-pressedStyle",dayIsTodayStyle:"ms-CalendarDay-dayIsToday",daySelectedStyle:"ms-CalendarDay-daySelected"},M=Object(L.M)({"100%":{width:0,height:0,overflow:"hidden"},"99.9%":{width:"100%",height:28,overflow:"visible"},"0%":{width:"100%",height:28,overflow:"visible"}}),P=Object(a.e)(E,function(e){var t,n,a,r,s,c,d,l,u,f,p=e.theme,m=e.dateRangeType,_=e.showWeekNumbers,h=e.lightenDaysOutsideNavigatedMonth,b=e.animateBackwards,g=e.animationDirection,v=p.palette,y=Object(L.I)(k,p),S={};void 0!==b&&(S=g===A.Horizontal?b?L.t.slideRightIn20:L.t.slideLeftIn20:b?L.t.slideDownIn20:L.t.slideUpIn20);var D={},I={};void 0!==b&&g!==A.Horizontal&&(D=b?{animationName:""}:L.t.slideUpOut20,I=b?L.t.slideDownOut20:{animationName:""});var x={selectors:{"&, &:disabled, & button":{color:v.neutralTertiaryAlt,pointerEvents:"none"}}};return{wrapper:{paddingBottom:10},table:[{textAlign:"center",borderCollapse:"collapse",borderSpacing:"0",tableLayout:"fixed",fontSize:"inherit",marginTop:4,width:196,position:"relative",paddingBottom:10},_&&{width:226}],dayCell:[Object(L.D)(p,{inset:-3}),{margin:0,padding:0,width:28,height:28,lineHeight:28,fontSize:L.i.small,fontWeight:L.r.regular,color:v.neutralPrimary,cursor:"pointer",position:"relative",selectors:(t={},t[L.o]=Object(i.__assign)({color:"WindowText",backgroundColor:"Window",zIndex:0},Object(L.x)()),t["&."+y.hoverStyle]={backgroundColor:v.neutralLighter,selectors:(n={},n[L.o]={zIndex:3,backgroundColor:"Window",outline:"1px solid Highlight"},n)},t["&."+y.pressedStyle]={backgroundColor:v.neutralLight,selectors:(a={},a[L.o]={borderColor:"Highlight",color:"Highlight",backgroundColor:"Window"},a)},t["&."+y.pressedStyle+"."+y.hoverStyle]={selectors:(r={},r[L.o]={backgroundColor:"Window",outline:"1px solid Highlight"},r)},t)}],daySelected:[m!==o.t.Month&&{backgroundColor:v.neutralLight+"!important",selectors:(s={"&::before":{content:'""',position:"absolute",top:0,bottom:0,left:0,right:0}},s["&:hover, &."+y.hoverStyle+", &."+y.pressedStyle]=(c={backgroundColor:v.neutralLight+"!important"},c[L.o]={color:"HighlightText!important",background:"Highlight!important"},c),s[L.o]=Object(i.__assign)({background:"Highlight!important",color:"HighlightText!important",borderColor:"Highlight!important"},Object(L.x)()),s)}],weekRow:S,weekDayLabelCell:L.t.fadeIn200,weekNumberCell:{margin:0,padding:0,borderRight:"1px solid",borderColor:v.neutralLight,backgroundColor:v.neutralLighterAlt,color:v.neutralSecondary,boxSizing:"border-box",width:28,height:28,fontWeight:L.r.regular,fontSize:L.i.small},dayOutsideBounds:x,dayOutsideNavigatedMonth:h&&{color:v.neutralSecondary,fontWeight:L.r.regular},dayButton:{width:24,height:24,lineHeight:24,fontSize:L.i.small,fontWeight:"inherit",borderRadius:2,border:"none",padding:0,color:"inherit",backgroundColor:"transparent",cursor:"pointer",overflow:"visible",selectors:{span:{height:"inherit",lineHeight:"inherit"}}},dayIsToday:{backgroundColor:v.themePrimary+"!important",borderRadius:"100%",color:v.white+"!important",fontWeight:L.r.semibold+"!important",selectors:(d={},d[L.o]=Object(i.__assign)({background:"WindowText!important",color:"Window!important",borderColor:"WindowText!important"},Object(L.x)()),d)},firstTransitionWeek:Object(i.__assign)(Object(i.__assign)({position:"absolute",opacity:0,width:0,height:0,overflow:"hidden"},D),{animationName:D.animationName+","+M}),lastTransitionWeek:Object(i.__assign)(Object(i.__assign)({position:"absolute",opacity:0,width:0,height:0,overflow:"hidden",marginTop:-28},I),{animationName:I.animationName+","+M}),dayMarker:{width:4,height:4,backgroundColor:v.neutralSecondary,borderRadius:"100%",bottom:1,left:0,right:0,position:"absolute",margin:"auto",selectors:(l={},l["."+y.dayIsTodayStyle+" &"]={backgroundColor:v.white,selectors:(u={},u[L.o]={backgroundColor:"Window"},u)},l["."+y.daySelectedStyle+" &"]={selectors:(f={},f[L.o]={backgroundColor:"HighlightText"},f)},l[L.o]=Object(i.__assign)({backgroundColor:"WindowText"},Object(L.x)()),l)},topRightCornerDate:{borderTopRightRadius:"2px"},topLeftCornerDate:{borderTopLeftRadius:"2px"},bottomRightCornerDate:{borderBottomRightRadius:"2px"},bottomLeftCornerDate:{borderBottomLeftRadius:"2px"},datesAbove:{"&::before":{borderTop:"1px solid "+v.neutralSecondary}},datesBelow:{"&::before":{borderBottom:"1px solid "+v.neutralSecondary}},datesLeft:{"&::before":{borderLeft:"1px solid "+v.neutralSecondary}},datesRight:{"&::before":{borderRight:"1px solid "+v.neutralSecondary}}}},void 0,{scope:"CalendarDayGrid"}),T=Object(d.e)(),U=function(e){var t=r.useRef(null);r.useImperativeHandle(e.componentRef,function(){return{focus:function(){var e,n;null===(n=null===(e=t.current)||void 0===e?void 0:e.focus)||void 0===n||n.call(e)}}},[]);var n=e.strings,a=e.navigatedDate,o=e.dateTimeFormatter,s=e.styles,c=e.theme,d=e.className,u=e.onHeaderSelect,f=e.showSixWeeksByDefault,p=e.minDate,m=e.maxDate,_=e.restrictedDates,h=e.onNavigateDate,b=e.showWeekNumbers,g=e.dateRangeType,v=e.animationDirection,y=Object(S.e)(),D=T(s,{theme:c,className:d,headerIsClickable:!!u,showWeekNumbers:b,animationDirection:v}),I=o.formatMonthYear(a,n),x=u?"button":"div",C=n.yearPickerHeaderAriaLabel?Object(l.e)(n.yearPickerHeaderAriaLabel,I):I;return r.createElement("div",{className:D.root},r.createElement("div",{className:D.header},r.createElement(x,{"aria-label":u?C:void 0,className:D.monthAndYear,onClick:u,"data-is-focusable":!!u,tabIndex:u?0:-1,onKeyDown:H(u),type:"button"},r.createElement("span",{id:y,"aria-live":"polite","aria-atomic":"true"},I)),r.createElement(F,Object(i.__assign)({},e,{classNames:D}))),r.createElement(P,Object(i.__assign)({},e,{styles:s,componentRef:t,strings:n,navigatedDate:a,weeksToShow:f?6:void 0,dateTimeFormatter:o,minDate:p,maxDate:m,restrictedDates:_,onNavigateDate:h,labelledBy:y,dateRangeType:g})))};U.displayName="CalendarDayBase";var F=function(e){var t,n,a=e.minDate,i=e.maxDate,o=e.navigatedDate,s=e.allFocusable,d=e.strings,l=e.navigationIcons,f=e.showCloseButton,m=e.classNames,_=e.onNavigateDate,h=e.onDismiss,b=function(){_(Object(c.t)(o,1),!1)},g=function(){_(Object(c.t)(o,-1),!1)},v=l.leftNavigation,y=l.rightNavigation,S=l.closeIcon,D=!a||Object(c.i)(a,Object(c.d)(o))<0,I=!i||Object(c.i)(Object(c.c)(o),i)<0;return r.createElement("div",{className:m.monthComponents},r.createElement("button",{className:Object(u.e)(m.headerIconButton,(t={},t[m.disabledStyle]=!D,t)),tabIndex:D?void 0:s?0:-1,"aria-disabled":!D,onClick:D?g:void 0,onKeyDown:D?H(g):void 0,title:d.prevMonthAriaLabel?d.prevMonthAriaLabel+" "+d.months[Object(c.t)(o,-1).getMonth()]:void 0,type:"button"},r.createElement(p.e,{iconName:v})),r.createElement("button",{className:Object(u.e)(m.headerIconButton,(n={},n[m.disabledStyle]=!I,n)),tabIndex:I?void 0:s?0:-1,"aria-disabled":!I,onClick:I?b:void 0,onKeyDown:I?H(b):void 0,title:d.nextMonthAriaLabel?d.nextMonthAriaLabel+" "+d.months[Object(c.t)(o,1).getMonth()]:void 0,type:"button"},r.createElement(p.e,{iconName:y})),f&&r.createElement("button",{className:Object(u.e)(m.headerIconButton),onClick:h,onKeyDown:H(h),title:d.closeButtonAriaLabel,type:"button"},r.createElement(p.e,{iconName:S})))};F.displayName="CalendarDayNavigationButtons";var H=function(e){return function(t){t.which===f.e.enter&&(null==e||e())}},R=Object(a.e)(U,function(e){var t,n=e.className,a=e.theme,r=e.headerIsClickable,o=e.showWeekNumbers,s=a.palette,c={selectors:(t={"&, &:disabled, & button":{color:s.neutralTertiaryAlt,pointerEvents:"none"}},t[L.o]={color:"GrayText",forcedColorAdjust:"none"},t)};return{root:[L.H,{width:196,padding:12,boxSizing:"content-box"},o&&{width:226},n],header:{position:"relative",display:"inline-flex",height:28,lineHeight:44,width:"100%"},monthAndYear:[Object(L.D)(a,{inset:1}),Object(i.__assign)(Object(i.__assign)({},L.t.fadeIn200),{alignItems:"center",fontSize:L.i.medium,fontFamily:"inherit",color:s.neutralPrimary,display:"inline-block",flexGrow:1,fontWeight:L.r.semibold,padding:"0 4px 0 10px",border:"none",backgroundColor:"transparent",borderRadius:2,lineHeight:28,overflow:"hidden",whiteSpace:"nowrap",textAlign:"left",textOverflow:"ellipsis"}),r&&{selectors:{"&:hover":{cursor:"pointer",background:s.neutralLight,color:s.black}}}],monthComponents:{display:"inline-flex",alignSelf:"flex-end"},headerIconButton:[Object(L.D)(a,{inset:-1}),{width:28,height:28,display:"block",textAlign:"center",lineHeight:28,fontSize:L.i.small,fontFamily:"inherit",color:s.neutralPrimary,borderRadius:2,position:"relative",backgroundColor:"transparent",border:"none",padding:0,overflow:"visible",selectors:{"&:hover":{color:s.neutralDark,backgroundColor:s.neutralLight,cursor:"pointer",outline:"1px solid transparent"}}}],disabledStyle:c}},void 0,{scope:"CalendarDay"}),N=function(e){var t,n,a,r,o,s,c,d=e.className,l=e.theme,u=e.hasHeaderClickCallback,f=e.highlightCurrent,p=e.highlightSelected,m=e.animateBackwards,_=e.animationDirection,h=l.palette,b={};void 0!==m&&(b=_===A.Horizontal?m?L.t.slideRightIn20:L.t.slideLeftIn20:m?L.t.slideDownIn20:L.t.slideUpIn20);var g=void 0!==m?L.t.fadeIn200:{};return{root:[L.H,{width:196,padding:12,boxSizing:"content-box",overflow:"hidden"},d],headerContainer:{display:"flex"},currentItemButton:[Object(L.D)(l,{inset:-1}),Object(i.__assign)(Object(i.__assign)({},g),{fontSize:L.i.medium,fontWeight:L.r.semibold,fontFamily:"inherit",textAlign:"left",color:"inherit",backgroundColor:"transparent",flexGrow:1,padding:"0 4px 0 10px",border:"none",overflow:"visible"}),u&&{selectors:{"&:hover, &:active":{cursor:u?"pointer":"default",color:h.neutralDark,outline:"1px solid transparent",backgroundColor:h.neutralLight}}}],navigationButtonsContainer:{display:"flex",alignItems:"center"},navigationButton:[Object(L.D)(l,{inset:-1}),{fontFamily:"inherit",width:28,minWidth:28,height:28,minHeight:28,display:"block",textAlign:"center",lineHeight:28,fontSize:L.i.small,color:h.neutralPrimary,borderRadius:2,position:"relative",backgroundColor:"transparent",border:"none",padding:0,overflow:"visible",selectors:{"&:hover":{color:h.neutralDark,cursor:"pointer",outline:"1px solid transparent",backgroundColor:h.neutralLight}}}],gridContainer:{marginTop:4},buttonRow:Object(i.__assign)(Object(i.__assign)({},b),{marginBottom:16,selectors:{"&:nth-child(n + 3)":{marginBottom:0}}}),itemButton:[Object(L.D)(l,{inset:-1}),{width:40,height:40,minWidth:40,minHeight:40,lineHeight:40,fontSize:L.i.small,fontFamily:"inherit",padding:0,margin:"0 12px 0 0",color:h.neutralPrimary,backgroundColor:"transparent",border:"none",borderRadius:2,overflow:"visible",selectors:{"&:nth-child(4n + 4)":{marginRight:0},"&:nth-child(n + 9)":{marginBottom:0},"& div":{fontWeight:L.r.regular},"&:hover":{color:h.neutralDark,backgroundColor:h.neutralLight,cursor:"pointer",outline:"1px solid transparent",selectors:(t={},t[L.o]=Object(i.__assign)({background:"Window",color:"WindowText",outline:"1px solid Highlight"},Object(L.x)()),t)},"&:active":{backgroundColor:h.themeLight,selectors:(n={},n[L.o]=Object(i.__assign)({background:"Window",color:"Highlight"},Object(L.x)()),n)}}}],current:f?{color:h.white,backgroundColor:h.themePrimary,selectors:(a={"& div":{fontWeight:L.r.semibold},"&:hover":{backgroundColor:h.themePrimary,selectors:(r={},r[L.o]=Object(i.__assign)({backgroundColor:"WindowText",color:"Window"},Object(L.x)()),r)}},a[L.o]=Object(i.__assign)({backgroundColor:"WindowText",color:"Window"},Object(L.x)()),a)}:{},selected:p?{color:h.neutralPrimary,backgroundColor:h.themeLight,fontWeight:L.r.semibold,selectors:(o={"& div":{fontWeight:L.r.semibold},"&:hover, &:active":{backgroundColor:h.themeLight,selectors:(s={},s[L.o]=Object(i.__assign)({color:"Window",background:"Highlight"},Object(L.x)()),s)}},o[L.o]=Object(i.__assign)({background:"Highlight",color:"Window"},Object(L.x)()),o)}:{},disabled:{selectors:(c={"&, &:disabled, & button":{color:h.neutralTertiaryAlt,pointerEvents:"none"}},c[L.o]={color:"GrayText",forcedColorAdjust:"none"},c)}}},B=function(e){return N(e)},j=n(1601),V=n(2015),z=Object(d.e)(),G={prevRangeAriaLabel:void 0,nextRangeAriaLabel:void 0},K=function(e){var t,n,a=e.styles,i=e.theme,o=e.className,s=e.highlightCurrentYear,c=e.highlightSelectedYear,d=e.year,l=e.selected,p=e.disabled,m=e.componentRef,_=e.onSelectYear,h=e.onRenderYear,b=r.useRef(null);r.useImperativeHandle(m,function(){return{focus:function(){var e,t;null===(t=null===(e=b.current)||void 0===e?void 0:e.focus)||void 0===t||t.call(e)}}},[]);var g=z(a,{theme:i,className:o,highlightCurrent:s,highlightSelected:c});return r.createElement("button",{className:Object(u.e)(g.itemButton,(t={},t[g.selected]=l,t[g.disabled]=p,t)),type:"button",role:"gridcell",onClick:p?void 0:function(){null==_||_(d)},onKeyDown:p?void 0:function(e){e.which===f.e.enter&&(null==_||_(d))},disabled:p,"aria-selected":l,ref:b},null!==(n=null==h?void 0:h(d))&&void 0!==n?n:d)};K.displayName="CalendarYearGridCell";var W,q=function(e){var t=e.styles,n=e.theme,a=e.className,o=e.fromYear,s=e.toYear,c=e.animationDirection,d=e.animateBackwards,l=e.minYear,u=e.maxYear,f=e.onSelectYear,p=e.selectedYear,m=e.componentRef,h=r.useRef(null),b=r.useRef(null);r.useImperativeHandle(m,function(){return{focus:function(){var e,t;null===(t=null===(e=h.current||b.current)||void 0===e?void 0:e.focus)||void 0===t||t.call(e)}}},[]);for(var g,v,y,S,D=z(t,{theme:n,className:a,animateBackwards:d,animationDirection:c}),I=function(t){var n,a;return null!==(a=null===(n=e.onRenderYear)||void 0===n?void 0:n.call(e,t))&&void 0!==a?a:t},x=I(o)+" - "+I(s),C=o,O=[],w=0;w<(s-o+1)/4;w++){O.push([]);for(var E=0;E<4;E++)O[w].push((v=(g=C)===p,y=void 0!==l&&g<l||void 0!==u&&g>u,S=g===(new Date).getFullYear(),r.createElement(K,Object(i.__assign)({},e,{key:g,year:g,selected:v,current:S,disabled:y,onSelectYear:f,componentRef:v?h:S?b:void 0,theme:n})))),C++}return r.createElement(_.e,null,r.createElement("div",{className:D.gridContainer,role:"grid","aria-label":x},O.map(function(e,t){return r.createElement("div",{key:"yearPickerRow_"+t+"_"+o,role:"row",className:D.buttonRow},e)})))};q.displayName="CalendarYearGrid",function(e){e[e.Previous=0]="Previous",e[e.Next=1]="Next"}(W||(W={}));var Q=function(e){var t,n=e.styles,a=e.theme,i=e.className,o=e.navigationIcons,s=void 0===o?V.e:o,c=e.strings,d=void 0===c?G:c,l=e.direction,_=e.onSelectPrev,h=e.onSelectNext,b=e.fromYear,g=e.toYear,v=e.maxYear,y=e.minYear,S=z(n,{theme:a,className:i}),D=l===W.Previous?d.prevRangeAriaLabel:d.nextRangeAriaLabel,I=l===W.Previous?-12:12,x=D?"string"==typeof D?D:D({fromYear:b+I,toYear:g+I}):void 0,C=l===W.Previous?void 0!==y&&b<y:void 0!==v&&e.fromYear+12>v,O=function(){l===W.Previous?null==_||_():null==h||h()},w=Object(m.e)()?l===W.Next:l===W.Previous;return r.createElement("button",{className:Object(u.e)(S.navigationButton,(t={},t[S.disabled]=C,t)),onClick:C?void 0:O,onKeyDown:C?void 0:function(e){e.which===f.e.enter&&O()},type:"button",title:x,disabled:C},r.createElement(p.e,{iconName:w?s.leftNavigation:s.rightNavigation}))};Q.displayName="CalendarYearNavArrow";var Y=function(e){var t=e.styles,n=e.theme,a=e.className,o=z(t,{theme:n,className:a});return r.createElement("div",{className:o.navigationButtonsContainer},r.createElement(Q,Object(i.__assign)({},e,{direction:W.Previous})),r.createElement(Q,Object(i.__assign)({},e,{direction:W.Next})))};Y.displayName="CalendarYearNav";var J=function(e){var t=e.styles,n=e.theme,a=e.className,i=e.fromYear,o=e.toYear,s=e.strings,c=void 0===s?G:s,d=e.animateBackwards,u=e.animationDirection,p=function(){var t;null===(t=e.onHeaderSelect)||void 0===t||t.call(e,!0)},m=function(t){var n,a;return null!==(a=null===(n=e.onRenderYear)||void 0===n?void 0:n.call(e,t))&&void 0!==a?a:t},_=z(t,{theme:n,className:a,hasHeaderClickCallback:!!e.onHeaderSelect,animateBackwards:d,animationDirection:u});if(e.onHeaderSelect){var h=c.rangeAriaLabel,b=c.headerAriaLabelFormatString,g=h?"string"==typeof h?h:h(e):void 0,v=b?Object(l.e)(b,g):g;return r.createElement("button",{className:_.currentItemButton,onClick:p,onKeyDown:function(e){e.which!==f.e.enter&&e.which!==f.e.space||p()},"aria-label":v,role:"button",type:"button"},r.createElement("span",{"aria-live":"assertive","aria-atomic":"true"},m(i)," - ",m(o)))}return r.createElement("div",{className:_.current},m(i)," - ",m(o))};J.displayName="CalendarYearTitle";var X,Z=function(e){var t,n=e.styles,a=e.theme,o=e.className,s=e.animateBackwards,c=e.animationDirection,d=e.onRenderTitle,l=z(n,{theme:a,className:o,hasHeaderClickCallback:!!e.onHeaderSelect,animateBackwards:s,animationDirection:c});return r.createElement("div",{className:l.headerContainer},null!==(t=null==d?void 0:d(e))&&void 0!==t?t:r.createElement(J,Object(i.__assign)({},e)),r.createElement(Y,Object(i.__assign)({},e)))};Z.displayName="CalendarYearHeader",function(e){e[e.Previous=0]="Previous",e[e.Next=1]="Next"}(X||(X={}));var $=function(e){var t=function(e){var t=e.selectedYear,n=e.navigatedYear,a=t||n||(new Date).getFullYear(),i=10*Math.floor(a/10),r=Object(y.e)(i);return r&&r!==i?r>i:void 0}(e),n=function(e){var t=e.selectedYear,n=e.navigatedYear,a=r.useReducer(function(e,t){return e+(t===X.Next?12:-12)},void 0,function(){var e=t||n||(new Date).getFullYear();return 10*Math.floor(e/10)}),i=a[0],o=a[1];return[i,i+12-1,function(){return o(X.Next)},function(){return o(X.Previous)}]}(e),a=n[0],o=n[1],s=n[2],c=n[3],d=r.useRef(null);r.useImperativeHandle(e.componentRef,function(){return{focus:function(){var e,t;null===(t=null===(e=d.current)||void 0===e?void 0:e.focus)||void 0===t||t.call(e)}}});var l=e.styles,u=e.theme,f=e.className,p=z(l,{theme:u,className:f});return r.createElement("div",{className:p.root},r.createElement(Z,Object(i.__assign)({},e,{fromYear:a,toYear:o,onSelectPrev:c,onSelectNext:s,animateBackwards:t})),r.createElement(q,Object(i.__assign)({},e,{fromYear:a,toYear:o,animateBackwards:t,componentRef:d})))};$.displayName="CalendarYearBase";var ee=Object(a.e)($,function(e){return N(e)},void 0,{scope:"CalendarYear"}),te=Object(d.e)(),ne={styles:B,strings:void 0,navigationIcons:V.e,dateTimeFormatter:s.t,yearPickerHidden:!1},ae=function(e){var t,n,a=Object(j.e)(ne,e),i=function(e){var t=e.componentRef,n=r.useRef(null),a=r.useRef(null),i=r.useRef(!1),o=r.useCallback(function(){a.current?a.current.focus():n.current&&n.current.focus()},[]);return r.useImperativeHandle(t,function(){return{focus:o}},[o]),r.useEffect(function(){i.current&&(o(),i.current=!1)}),[n,a,function(){i.current=!0}]}(a),o=i[0],s=i[1],d=i[2],f=r.useState(!1),h=f[0],b=f[1],g=function(e){var t=e.navigatedDate.getFullYear(),n=Object(y.e)(t);return void 0===n||n===t?void 0:n>t}(a),v=a.navigatedDate,S=a.selectedDate,D=a.strings,I=a.today,x=void 0===I?new Date:I,C=a.navigationIcons,O=a.dateTimeFormatter,w=a.minDate,E=a.maxDate,A=a.theme,L=a.styles,k=a.className,M=a.allFocusable,P=a.highlightCurrentMonth,T=a.highlightSelectedMonth,U=a.animationDirection,F=a.yearPickerHidden,H=a.onNavigateDate,R=function(e){return function(){return V(e)}},N=function(){H(Object(c.a)(v,1),!1)},B=function(){H(Object(c.a)(v,-1),!1)},V=function(e){var t;null===(t=a.onHeaderSelect)||void 0===t||t.call(a),H(Object(c.m)(v,e),!0)},z=function(){var e;F?null===(e=a.onHeaderSelect)||void 0===e||e.call(a):(d(),b(!0))},G=C.leftNavigation,K=C.rightNavigation,W=O,q=!w||Object(c.i)(w,Object(c.f)(v))<0,Q=!E||Object(c.i)(Object(c.u)(v),E)<0,Y=te(L,{theme:A,className:k,hasHeaderClickCallback:!!a.onHeaderSelect||!F,highlightCurrent:P,highlightSelected:T,animateBackwards:g,animationDirection:U});if(h){var J=function(e){var t=e.strings,n=e.navigatedDate,a=e.dateTimeFormatter,i=function(e){if(a){var t=new Date(n.getTime());return t.setFullYear(e),a.formatYear(t)}return String(e)},r=function(e){return i(e.fromYear)+" - "+i(e.toYear)};return[i,{rangeAriaLabel:r,prevRangeAriaLabel:function(e){return t.prevYearRangeAriaLabel?t.prevYearRangeAriaLabel+" "+r(e):""},nextRangeAriaLabel:function(e){return t.nextYearRangeAriaLabel?t.nextYearRangeAriaLabel+" "+r(e):""},headerAriaLabelFormatString:t.yearPickerHeaderAriaLabel}]}(a),X=J[0],Z=J[1];return r.createElement(ee,{key:"calendarYear",minYear:w?w.getFullYear():void 0,maxYear:E?E.getFullYear():void 0,onSelectYear:function(e){if(d(),v.getFullYear()!==e){var t=new Date(v.getTime());t.setFullYear(e),E&&t>E?t=Object(c.m)(t,E.getMonth()):w&&t<w&&(t=Object(c.m)(t,w.getMonth())),H(t,!0)}b(!1)},navigationIcons:C,onHeaderSelect:function(e){d(),b(!1)},selectedYear:S?S.getFullYear():v?v.getFullYear():void 0,onRenderYear:X,strings:Z,componentRef:s,styles:L,highlightCurrentYear:P,highlightSelectedYear:T,animationDirection:U})}for(var $=[],ae=0;ae<D.shortMonths.length/4;ae++)$.push(ae);var oe=W.formatYear(v),se=D.monthPickerHeaderAriaLabel?Object(l.e)(D.monthPickerHeaderAriaLabel,oe):oe;return r.createElement("div",{className:Y.root},r.createElement("div",{className:Y.headerContainer},r.createElement("button",{className:Y.currentItemButton,onClick:z,onKeyDown:re(z),"aria-label":se,"data-is-focusable":!!a.onHeaderSelect||!F,tabIndex:a.onHeaderSelect||!F?0:-1,type:"button"},r.createElement("span",{"aria-live":"polite","aria-atomic":"true"},oe)),r.createElement("div",{className:Y.navigationButtonsContainer},r.createElement("button",{className:Object(u.e)(Y.navigationButton,(t={},t[Y.disabled]=!q,t)),"aria-disabled":!q,tabIndex:q?void 0:M?0:-1,onClick:q?B:void 0,onKeyDown:q?re(B):void 0,title:D.prevYearAriaLabel?D.prevYearAriaLabel+" "+W.formatYear(Object(c.a)(v,-1)):void 0,type:"button"},r.createElement(p.e,{iconName:Object(m.e)()?K:G})),r.createElement("button",{className:Object(u.e)(Y.navigationButton,(n={},n[Y.disabled]=!Q,n)),"aria-disabled":!Q,tabIndex:Q?void 0:M?0:-1,onClick:Q?N:void 0,onKeyDown:Q?re(N):void 0,title:D.nextYearAriaLabel?D.nextYearAriaLabel+" "+W.formatYear(Object(c.a)(v,1)):void 0,type:"button"},r.createElement(p.e,{iconName:Object(m.e)()?G:K})))),r.createElement(_.e,null,r.createElement("div",{className:Y.gridContainer,role:"grid","aria-label":oe},$.map(function(e){var t=D.shortMonths.slice(4*e,4*(e+1));return r.createElement("div",{key:"monthRow_"+e+v.getFullYear(),role:"row",className:Y.buttonRow},t.map(function(t,n){var a,i=4*e+n,s=Object(c.m)(v,i),d=v.getMonth()===i,l=S.getMonth()===i,f=S.getFullYear()===v.getFullYear(),p=(!w||Object(c.i)(w,Object(c.c)(s))<1)&&(!E||Object(c.i)(Object(c.d)(s),E)<1);return r.createElement("button",{ref:d?o:void 0,role:"gridcell",className:Object(u.e)(Y.itemButton,(a={},a[Y.current]=P&&ie(i,v.getFullYear(),x),a[Y.selected]=T&&l&&f,a[Y.disabled]=!p,a)),disabled:!M&&!p,key:i,onClick:p?R(i):void 0,onKeyDown:p?re(R(i)):void 0,"aria-label":W.formatMonth(s,D),"aria-selected":d,"data-is-focusable":!!p||void 0,type:"button"},t)}))}))))};function ie(e,t,n){return n.getFullYear()===t&&n.getMonth()===e}function re(e){return function(t){t.which===f.e.enter&&e()}}ae.displayName="CalendarMonthBase";var oe=Object(a.e)(ae,B,void 0,{scope:"CalendarMonth"}),se=n(121),ce=n(1002),de=n(111),le=n(2034),ue=Object(d.e)(),fe=[o.n.Monday,o.n.Tuesday,o.n.Wednesday,o.n.Thursday,o.n.Friday],pe={isMonthPickerVisible:!0,isDayPickerVisible:!0,showMonthPickerAsOverlay:!1,today:new Date,firstDayOfWeek:o.n.Sunday,dateRangeType:o.t.Day,showGoToToday:!0,strings:s.e,highlightCurrentMonth:!1,highlightSelectedMonth:!1,navigationIcons:V.e,showWeekNumbers:!1,firstWeekOfYear:o.a.FirstDay,dateTimeFormatter:s.t,showSixWeeksByDefault:!1,workWeekDays:fe,showCloseButton:!1,allFocusable:!1},me=r.forwardRef(function(e,t){var n=Object(j.e)(pe,e),a=function(e){var t=e.value,n=e.today,a=void 0===n?new Date:n,i=e.onSelectDate,o=Object(le.e)(t,a),s=o[0],c=void 0===s?a:s,d=o[1],l=r.useState(t),u=l[0],f=void 0===u?a:u,p=l[1],m=r.useState(t),_=m[0],h=void 0===_?a:_,b=m[1],g=r.useState(t),v=g[0],y=void 0===v?a:v,S=g[1];return t&&y.valueOf()!==t.valueOf()&&(p(t),b(t),S(t)),[c,f,h,function(e,t){b(e),p(e),d(e),null==i||i(e,t)},function(e){b(e),p(e)},function(e){b(e)}]}(n),o=a[0],s=a[1],d=a[2],p=a[3],m=a[4],_=a[5],h=function(e){var t=Object(le.e)(_e(e)?void 0:e.isMonthPickerVisible,!1),n=t[0],a=void 0===n||n,i=t[1],r=Object(le.e)(_e(e)?void 0:e.isDayPickerVisible,!0),o=r[0],s=void 0===o||o,c=r[1];return[a,s,function(){i(!a),c(!s)}]}(n),b=h[0],g=h[1],v=h[2],y=function(e,t,n){var a=e.componentRef,i=r.useRef(null),o=r.useRef(null),s=r.useRef(!1),c=r.useCallback(function(){t&&i.current?Object(se.t)(i.current):n&&o.current&&Object(se.t)(o.current)},[t,n]);return r.useImperativeHandle(a,function(){return{focus:c}},[c]),r.useEffect(function(){s.current&&(c(),s.current=!1)}),[i,o,function(){s.current=!0}]}(n,g,b),S=y[0],D=y[1],I=y[2],x=function(){var e=k;return e&&X&&(e=s.getFullYear()!==X.getFullYear()||s.getMonth()!==X.getMonth()||d.getFullYear()!==X.getFullYear()||d.getMonth()!==X.getMonth()),k&&r.createElement("button",{className:Object(u.e)("js-goToday",te.goTodayButton),onClick:O,onKeyDown:w(O),type:"button",disabled:!e},L.goToToday)},C=_e(n)?function(){v(),I()}:void 0,O=function(){m(X),I()},w=function(e){return function(t){switch(t.which){case f.e.enter:case f.e.space:e()}}},E=n.firstDayOfWeek,A=n.dateRangeType,L=n.strings,k=n.showGoToToday,M=n.highlightCurrentMonth,P=n.highlightSelectedMonth,T=n.navigationIcons,U=n.minDate,F=n.maxDate,H=n.restrictedDates,N=n.id,B=n.className,V=n.showCloseButton,z=n.allFocusable,G=n.styles,K=n.showWeekNumbers,W=n.theme,q=n.calendarDayProps,Q=n.calendarMonthProps,Y=n.dateTimeFormatter,J=n.today,X=void 0===J?new Date:J,Z=_e(n),$=!Z&&!g,ee=Z&&k,te=ue(G,{theme:W,className:B,isMonthPickerVisible:b,isDayPickerVisible:g,monthPickerOnly:$,showMonthPickerAsOverlay:Z,overlaidWithButton:ee,overlayedWithButton:ee,showGoToToday:k,showWeekNumbers:K}),ne="",ae="";Y&&L.todayDateFormatString&&(ne=Object(l.e)(L.todayDateFormatString,Y.formatMonthDayYear(X,L))),Y&&L.selectedDateFormatString&&(ae=Object(l.e)(L.selectedDateFormatString,Y.formatMonthDayYear(o,L)));var ie=ae+", "+ne;return r.createElement("div",{id:N,ref:t,role:"group","aria-label":ie,className:Object(u.e)("ms-DatePicker",te.root,B,"ms-slideDownIn10"),onKeyDown:function(e){var t;switch(e.which){case f.e.enter:case f.e.backspace:e.preventDefault();break;case f.e.escape:null===(t=n.onDismiss)||void 0===t||t.call(n);break;case f.e.pageUp:e.ctrlKey?m(Object(c.a)(s,1)):m(Object(c.t)(s,1)),e.preventDefault();break;case f.e.pageDown:e.ctrlKey?m(Object(c.a)(s,-1)):m(Object(c.t)(s,-1)),e.preventDefault()}}},r.createElement("div",{className:te.liveRegion,"aria-live":"polite","aria-atomic":"true"},r.createElement("span",null,ae)),g&&r.createElement(R,Object(i.__assign)({selectedDate:o,navigatedDate:s,today:n.today,onSelectDate:p,onNavigateDate:function(e,t){m(e),t&&I()},onDismiss:n.onDismiss,firstDayOfWeek:E,dateRangeType:A,strings:L,onHeaderSelect:C,navigationIcons:T,showWeekNumbers:n.showWeekNumbers,firstWeekOfYear:n.firstWeekOfYear,dateTimeFormatter:n.dateTimeFormatter,showSixWeeksByDefault:n.showSixWeeksByDefault,minDate:U,maxDate:F,restrictedDates:H,workWeekDays:n.workWeekDays,componentRef:S,showCloseButton:V,allFocusable:z},q)),g&&b&&r.createElement("div",{className:te.divider}),b?r.createElement("div",{className:te.monthPickerWrapper},r.createElement(oe,Object(i.__assign)({navigatedDate:d,selectedDate:s,strings:L,onNavigateDate:function(e,t){t&&I(),t?($&&p(e),m(e)):_(e)},today:n.today,highlightCurrentMonth:M,highlightSelectedMonth:P,onHeaderSelect:C,navigationIcons:T,dateTimeFormatter:n.dateTimeFormatter,minDate:U,maxDate:F,componentRef:D},Q)),x()):x(),r.createElement(ce.e,null))});function _e(e){var t=e.showMonthPickerAsOverlay,n=e.isDayPickerVisible,a=Object(de.e)();return t||n&&a&&a.innerWidth<=440}me.displayName="CalendarBase";var he=Object(a.e)(me,function(e){var t=e.className,n=e.theme,a=e.isDayPickerVisible,i=e.isMonthPickerVisible,r=e.showWeekNumbers,o=n.palette,s=a&&i?440:220;return r&&a&&(s+=30),{root:[L.H,{display:"flex",width:s},!i&&{flexDirection:"column"},t],divider:{top:0,borderRight:"1px solid",borderColor:o.neutralLight},monthPickerWrapper:[{display:"flex",flexDirection:"column"}],goTodayButton:[Object(L.D)(n,{inset:-1}),{bottom:0,color:o.neutralPrimary,height:30,lineHeight:30,backgroundColor:"transparent",border:"none",boxSizing:"content-box",padding:"0 4px",alignSelf:"flex-end",marginRight:16,marginTop:3,fontSize:L.i.small,fontFamily:"inherit",overflow:"visible",selectors:{"& div":{fontSize:L.i.small},"&:hover":{color:o.themePrimary,backgroundColor:"transparent",cursor:"pointer"},"&:active":{color:o.themeDark},"&:disabled":{color:o.neutralTertiaryAlt,pointerEvents:"none"}}}],liveRegion:{border:0,height:"1px",margin:"-1px",overflow:"hidden",padding:0,width:"1px",position:"absolute"}}},void 0,{scope:"Calendar"})},,,,function(e,t,n){"use strict";n.d(t,"r",function(){return V}),n.d(t,"s",function(){return z}),n.d(t,"t",function(){return G}),n.d(t,"n",function(){return K}),n.d(t,"o",function(){return W}),n.d(t,"f",function(){return q}),n.d(t,"l",function(){return Q}),n.d(t,"d",function(){return Y}),n.d(t,"i",function(){return J}),n.d(t,"a",function(){return X}),n.d(t,"u",function(){return Z}),n.d(t,"e",function(){return $}),n.d(t,"c",function(){return ee});var a=n(0),i=n(1),r=n(1800),o=n(1851),s=n(39),c=n(1750),d=n(345),l=n(435),u=n(112),f=n(1529),p=n(1794),m=n(1782),_=n(2564),h=n(2102),b=n(2775),g=n(2326),v=n(1807),y=(n(2333),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderActivityDescription=function(){return i.createElement("div",{className:"od-ItemActivity-item-textContent"},t.props.reply.getDescription())},t._onRenderActivityTimeStamp=function(e,t){return t?t(e):null},t._onRenderHiddenTimeStamp=function(e,t){return null},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.reply,n=e.hideDate,a=e.additionalClass,r=void 0===a?"":a;return i.createElement(c.e,{direction:d.e.horizontal,"data-is-focusable":!0,"aria-label":this._getAriaLabel()},i.createElement(b.e,{key:t.getKey(),className:"od-ItemActivity-item "+r,activityPersonas:this._activityPersonas(),onRenderActivityDescription:this._onRenderActivityDescription,timeStamp:this._onRenderDate(),onRenderTimeStamp:n?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp}))},t.prototype._onRenderDate=function(){var e=this.props.reply;return(g.e(e.getFriendlyDisplayTime()||"")||v.i(e.getDate())).toString()},t.prototype._getAriaLabel=function(){var e=this.props.reply.getDescription({stringOnly:!0});return"".concat(e.join("")," ").concat(this._onRenderDate())},t.prototype._activityPersonas=function(){return[{imageUrl:this.props.reply.getPersonaImgUrl()}]},t}(i.Component)),S=y,D=n(17);Object(D.n)([{rawString:".od-activityItem-replies-list .ms-List-cell{min-height:0}"}]);var I=n(51),x=function(e){function t(t,n){var a=e.call(this,t,n)||this;a._onFocus=function(){a._focusZone&&a._focusZone.focus()},a._onRenderCell=function(e,t){var n=a.props.onRenderUser,r=a.state,o=r.currentReplies,s=r.numberOfRepliesDisplayed,c=o.comments.length||0,d=s<=c&&c-s||0,l=new C({reply:e,onRenderUser:n});if(e&&t>=d)return i.createElement(S,{key:l.getKey(),reply:l,additionalClass:"od-ItemActivityList-commentReply"})},a._onSend=function(e,t,n){var i=a.props,r=i.parentComment,o=i.commentListItem,s=i.currentUserEmail;a._store&&a._store.addItemCommentReply({itemWrapper:o,currentUserEmail:s},r.id,e).then(function(e){a._store.fetchItemCommentReplies({itemWrapper:o,currentUserEmail:s,startIndex:0},r.id),t&&t()},function(e){var t=e&&e.message&&e.message.value;n&&n(t)})},a._onShowMore=function(){var e=a.props,t=e.onShowMore,n=e.parentComment,i=e.commentListItem,r=e.currentUserEmail,o=a.state.currentReplies,s=a.state.numberOfRepliesDisplayed;s<o.comments.length&&(a.setState({numberOfRepliesDisplayed:10*Math.floor(s/10)+10}),o.nextLink&&a._store.fetchItemCommentReplies({itemWrapper:i,currentUserEmail:r},n.id)),t&&t()},a._store=n.itemCommentsStore,a._engagementSource=n.engagementSource||"";var r=t.parentComment,o=t.commentListItem,s=t.currentUserEmail;a._environment=t.environment;var c=a._store.getItemCommentReplies({itemWrapper:o,currentUserEmail:s},r.id),d=c&&c.comments&&c.comments.length,l=d?2:0;return a.state={numberOfRepliesDisplayed:l,currentReplies:c,hasMore:l<d},a}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.parentComment.id!==this.props.parentComment.id&&this._addListener()},t.prototype.componentDidMount=function(){this._addListener()},t.prototype.componentWillUnmount=function(){this._store.removeRepliesListener(this._storeListener)},t.prototype.UNSAFE_componentWillUpdate=function(){this._focusElement=void 0},t.prototype.render=function(){var e=this.props,t=e.isReadonly,n=e.parentComment,a=this.state.currentReplies.comments||[],r=a.map(function(e){try{return e.action.comment.commentDetail}catch(e){}}),o="sharePointList"===this._environment,s="consumer"===this._environment;return i.createElement("div",{"data-is-focusable":!s&&!o,key:"activityResponse_".concat(n.id),onFocus:this._onFocus,"aria-label":h.activityCommentRepliesList,"aria-hidden":s||o},i.createElement(c.e,{componentRef:this._resolveRef("_focusZone"),className:Object(I.e)("od-ItemActivityList-activity-commentResponse",{"od-ItemActivityList-activity-withHiddenReply":s||o}),direction:d.e.vertical,isCircularNavigation:!1,handleTabKey:d.t.inputOnly,shouldInputLoseFocusOnArrowKey:function(e){return!0},isInnerZoneKeystroke:function(e){return e.which===Object(l.t)(u.e.right)}},this._getShowMoreLink(),a&&a.length>0&&i.createElement(p.e,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),className:"od-activityItem-replies-list",items:r,onRenderCell:this._onRenderCell}),!t&&!s&&!o&&i.createElement(_.e,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),commentItemId:n&&n.id,placeholderText:h.replyPlaceholder,sendButtonTitle:"",onSend:this._onSend,engagementSource:"".concat(this._engagementSource,".AddReply")})))},t.prototype._addListener=function(){var e=this,t=this.props,n=t.parentComment,a=t.commentListItem,i=t.currentUserEmail;this._storeListener=this._store.addRepliesListener(function(){var t=e._store.getItemCommentReplies({itemWrapper:a,currentUserEmail:i},n.id),r=t.comments&&t.comments.length;e.setState({currentReplies:t,numberOfRepliesDisplayed:r>2?e.state.numberOfRepliesDisplayed:r,hasMore:!!t.nextLink||t.comments.length>e.state.numberOfRepliesDisplayed})},{item:a.activityItemWrapper,currentUserEmail:i},n.id)},t.prototype._getShowMoreLink=function(){this.props.parentComment;var e,t=this.state,n=t.currentReplies;if(t.numberOfRepliesDisplayed<(null===(e=n.comments)||void 0===e?void 0:e.length)||n.nextLink)return i.createElement("div",{className:"od-ItemActivityList-commentReply od-ItemActivityList-loadMoreReplies"},i.createElement(m.e,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),onClick:this._onShowMore,href:"javascript:void(0)"},h.commentRepliesGetMore))},t.contextTypes={itemCommentsStore:r.any,engagementSource:r.any},t}(f.e),C=function(){function e(e){var t=this;this._renderUser=function(e,n){var a=e.user;return a||(a=t._getReplyAuthor()),t._renderUserLabel(a,{stringOnly:!1})},this._commentReply=e.reply,this._onRenderUser=e.onRenderUser}return e.prototype.getKey=function(){return"Comment".concat(this._commentReply.parentId,"_Reply").concat(this._commentReply.id)},e.prototype.getPersonaImgUrl=function(){var e=this._commentReply.author;return Object(o.getUserPhotoUrl)(e.email)},e.prototype.getFriendlyDisplayTime=function(){return this._commentReply.friendlyDisplayTime},e.prototype.getDate=function(){return this._commentReply.createdDate},e.prototype.getDescription=function(e){void 0===e&&(e={stringOnly:!1});var t=e.stringOnly,n=this._commentReply.text,a=this._getReplyAuthor(),r=this.renderUser(a,{stringOnly:t}),o=t?n:i.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:n}});return a.self?s.formatToArray(h.youReplied,o):s.formatToArray(h.otherReplied,o,r)},e.prototype.renderUser=function(e,t){var n=t.stringOnly,a=this._renderUserLabel(e,{stringOnly:!0});return!e||n?a:i.createElement("span",{"aria-label":a},this._onRenderUser({user:e},this._renderUser))},e.prototype._renderUserLabel=function(e,t){var n,a=t.stringOnly;return n=e&&e.self?h.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:h.someoneUpperCase,a?n:i.createElement("span",{className:"od-ItemActivity-item-nameText"},n)},e.prototype._getReplyAuthor=function(){return this._commentReply.author},e}(),O=n(1644),w=n(1176),E=n(1774),A=n(582),L=n(1509),k=n(129),M=n(96);Object(D.n)([{rawString:".od-itemActivityMenu-dialogButton-default{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-itemActivityMenu-dialogButton-default:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-itemActivityMenu-dialogButton-default:active{background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-itemActivityMenu-dialogButton-primary{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-itemActivityMenu-dialogButton-primary:hover{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-itemActivityMenu-dialogButton-primary:active{background-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.spo-ItemActivity-menuItems{min-width:120px;padding:0}"}]);var P=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._onDismissDialog=function(){a.setState({hideDialog:!0})},a.state={dialogTitle:"",dialogConfirm:"",onDialogConfirm:void 0,hideDialog:!0},a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.dialogTitle,a=t.dialogConfirm,r=t.onDialogConfirm,o=t.hideDialog,s=this.props.environment,c=this._getMenuItems(),d="sharePointList"===s,l="consumer"===s;if(c)return i.createElement(i.Fragment,null,i.createElement(O.e,{className:Object(I.e)("od-ItemActivity-contextMenu",{"od-ItemActivity-contextMenu-opacity":l||d}),role:"button",iconProps:{iconName:"More"},onRenderMenuIcon:function(){},title:h.activityMenuAriaLabel,menuProps:{directionalHint:k.e.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:c,styles:{root:d?"spo-ItemActivity-menuItems":"od-ItemActivity-menuItems"}}}),i.createElement(E.e,{hidden:o,onDismiss:this._onDismissDialog,dialogContentProps:{type:A.e.normal,title:n}},i.createElement(L.e,null,i.createElement(w.e,{className:Object(I.e)({"od-itemActivityMenu-dialogButton-default":l||d}),disabled:!1,onClick:function(){r(),e._onDismissDialog()},text:a||h.activityMenuDialogConfirm}),i.createElement(w.e,{className:Object(I.e)({"od-itemActivityMenu-dialogButton-primary":l||d}),disabled:!1,primary:!0,onClick:this._onDismissDialog,text:h.activityMenuDialogCancel}))))},t.prototype._getMenuItems=function(){var e=this,t=this.props,n=t.itemActivityMenuItems,a=t.activityId;return n.map(function(t){return{key:t.key,name:t.name,onClick:function(n,i){var r=t.dialogOnConfirm;t.dialogTitle&&r?e.setState({dialogTitle:t.dialogTitle,dialogConfirm:t.dialogConfirm,onDialogConfirm:r,hideDialog:!1}):t.onClickMenuOption&&t.onClickMenuOption(n,i),M.e.logData({name:"ActivityItemMenu.".concat(t.name,".Click"),isIntentional:!0,extraData:{activityId:a}})}}})},t}(i.Component),T=n(1642),U=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._onDialogConfirm=function(){a.props.dialogOnConfirm(),a._onDismissDialog()},a._onShowDialog=function(){a.setState({hideDialog:!1})},a._onDismissDialog=function(){a.setState({hideDialog:!0})},a.state={hideDialog:!0},a}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.state.hideDialog,t=this.props,n=t.name,a=t.dialogTitle,r=t.dialogConfirm,o=t.environment,s="sharePointList"===o,c="consumer"===o;return i.createElement(i.Fragment,null,i.createElement(O.e,{className:Object(I.e)("od-ItemActivity-contextMenu",{"od-ItemActivity-contextMenu-opacity":c||s}),iconProps:{iconName:"Delete"},title:n,onClick:this._onShowDialog}),i.createElement(E.e,{hidden:e,onDismiss:this._onDismissDialog,dialogContentProps:{type:A.e.close,title:a,subText:h.deleteCommentDialogPrompt}},i.createElement(L.e,null,i.createElement(T.e,{className:Object(I.e)({"od-itemActivityMenu-dialogButton-primary":c}),disabled:!1,onClick:this._onDialogConfirm,text:r}),i.createElement(w.e,{autoFocus:!0,className:Object(I.e)({"od-itemActivityMenu-dialogButton-default":c}),disabled:!1,onClick:this._onDismissDialog,text:h.activityMenuDialogCancel}))))},t}(i.PureComponent),F=n(346),H=n(1673),R=n(587),N=n(2401);function B(e){return e?1:3}var j=function(){function e(e){var t=this;this._onRenderUser=function(e,n){var a=e.user;return t._getUserLabel(a,{stringOnly:!1,isAccusative:e.isAccusative})},this.activity=e.activity,this.currentUserEmail=e.currentUserEmail,this.containingItem=e.containingItem,this.isSingleLevel=e.isSingleLevel,this.canOpenItem=e.canOpenItem,this.onItemClick=e.onItemClick,this.strings=e.strings,this.onRenderUser=e.onRenderUser,this.populateItemNameToDisplay=e.populateItemNameToDisplay,this.currentListTitle=e.currentListTitle,this.currentRootTitle=e.currentRootTitle,this.defaultItemTitle=e.defaultItemTitle,this.commentListItem=e.commentListItem,this.isReadonly=e.isReadonly,this.canDeleteActivity=e.canDeleteActivity,this.activityMenuFunctions=e.activityMenuFunctions,this.isNewCommentExperienceEnabled=e.isNewCommentExperienceEnabled,this.isAtMentionEnabled=!!e.isAtMentionEnabled,this.environment=e.environment,this.getpersonaIconUrl=e.getpersonaIconUrl,this.displayLargeText=e.displayLargeText,this.isListItem=e.isSingleLevel&&"sharePointList"===e.environment}return e.prototype.getKey=function(){return this.activity.id},e.prototype.getTitle=function(e){return void 0===e&&(e={}),this.getDescription(e)},e.prototype.getDescription=function(e){return void 0===e&&(e={}),[]},e.prototype.getIconName=function(){return"ActivityFeed"},e.prototype.getPersonaIconUrl=function(){},e.prototype.getDate=function(){return this.activity.time},e.prototype.getFriendlyDisplayTime=function(){return this.activity.friendlyDisplayTime},e.prototype.getActivityTypeString=function(){return""},e.prototype.getResponse=function(){},e.prototype.getContextualMenu=function(){},e.prototype.getenvironment=function(){return this.environment},e.prototype.getCommentAuthorName=function(){},e.prototype.getcommentAuthorEmail=function(){},e.prototype.getCommentThreadId=function(){},e.prototype._getFilteredActors=function(e){for(var t,n,a=e.actors,i=void 0===a?this.activity.actors||[]:a,r=e.isCompact,o=[],s=0,c=i;s<c.length;s++){var d=c[s];d&&d.self?t=d:o.push(d)}t&&(o=[t].concat(o));var l=B(r);return o.length>l&&(n=o.slice(l,o.length)),{youUser:t,additionalUsers:n,sortedUsers:o.length?o:[void 0]}},e.prototype._getAdditionalUsersTooltip=function(e,t){var n=t.stringOnly,a=t.isCompact,r=t.hideDate,o=t.isAccusative,c=void 0!==o&&o,d=a&&r?c?s.getLocalizedCountValue(this.strings.andOtherUsersCountFormShortAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):s.getLocalizedCountValue(this.strings.andOtherActorsCountFormShort,this.strings.otherActorsCountFormIntervals,e.length):c?s.getLocalizedCountValue(this.strings.andOtherUsersCountFormAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):s.getLocalizedCountValue(this.strings.andOtherActorsCountForm,this.strings.otherActorsCountFormIntervals,e.length),l=s.formatToArray(d,e.length);if(n)return l;var u={onRenderContent:function(){var t=e.map(function(e){return i.createElement("li",null,e.displayName)});return i.createElement("ul",{className:"od-ItemActivity-otherActors"},t)},id:Object(R.e)("otherUsersTooltip")};return i.createElement(H.e,{tooltipProps:u,id:u.id},i.createElement("span",{className:"od-ItemActivity-n-Others","aria-describedby":u.id,"data-is-focusable":!0},l))},e.prototype.getRenderedUsers=function(e,t){var n=this,a=t.stringOnly,i=t.isAccusative,r=t.isActor;return e&&0!==e.length?e.map(function(e,t){return n.renderUser(e,{stringOnly:a,isAccusative:i,isActor:r},t)||""}):[this.renderUser(void 0)]},e.prototype.renderUser=function(e,t,n){void 0===n&&(n=0);var a=this.onRenderUser,r=void 0===a?this._onRenderUser:a,o=t.stringOnly,s=t.isAccusative,c=t.isActor,d=this._getUserLabel(e,{stringOnly:!0,isAccusative:s});if(!e||o)return d;var l=(c?"_actor":"_")+n;return i.createElement("span",{key:e.email+l,"aria-label":d},r({user:e,isAccusative:s},this._onRenderUser))},e.prototype.renderMainItemLink=function(e,t,n){return this.isSingleLevel?e:s.formatToArray(t,this.renderItemLink({item:this.activity.item,stringOnly:n}))},e.prototype.renderItemLink=function(e){var t=this,n=e.item,a=e.itemLabel,r=e.stringOnly,o=e.keyPrefix,s=void 0===o?"":o,c=a;if(!c&&n&&!n.name&&this.populateItemNameToDisplay&&(this.populateItemNameToDisplay(n),c=n.name),c||(c=n&&n.isRoot?this._getRootFolderName():void 0),c||(c=n&&n.name?n.name:this._getDefaultItemName()),c){if(r)return c;var d=void 0;if("string"==typeof c){d=c;var l=void 0,u=void 0;if(-1!==c.indexOf(".")){var f=c.split(".");l=f.slice(0,-1).join(),u=f.slice(-1).join()}else l=c,u="";l.length>40&&(c=l.slice(0,37).concat("...").concat(u))}var p,_=c;return this.canOpenItem&&this.canOpenItem(n)?(p=d?i.createElement("span",{className:"od-ItemActivity-item-textContent}",title:d}," ",c," "):i.createElement("span",{className:"od-ItemActivity-item-textContent}"}," ",c," "),i.createElement(m.e,{key:"".concat(s,"_").concat(_,"_link"),className:Object(I.e)("od-ItemActivity-item-linkText","od-ItemActivity-item-clickableLinkText"),onClick:function(){return t.onItemClick(n,t.getActivityTypeString())},href:"javascript:void(0)"},p)):d?i.createElement("span",{key:"".concat(s,"_").concat(_,"_string"),className:"od-ItemActivity-item-linkText",title:d},c):i.createElement("span",{key:"".concat(s,"_").concat(_,"_string"),className:"od-ItemActivity-item-linkText"},c)}},e.prototype._getRootFolderName=function(){return this.currentRootTitle},e.prototype._getDefaultItemName=function(){return(this.currentListTitle?this.currentListTitle:this.defaultItemTitle)||void 0},e.prototype._getUserLabel=function(e,t){var n,a=t.stringOnly,r=t.isAccusative;return n=e&&e.self?r?this.strings.you:this.strings.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:this.strings.someoneUpperCase,a?n:i.createElement("span",{className:"od-ItemActivity-item-nameText"},n)},e}(),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,r=t.hideDate,o=this.strings.editThisFile;this.isListItem&&(o=this.strings.thisItem);var c,d=this.renderMainItemLink(o,this.strings.editArbitraryFile,i),l=this._getFilteredActors({isCompact:n}),u=l.youUser,f=l.sortedUsers,p=l.additionalUsers,m=B(n);if(f.length>m){var _=n?!this.isNewCommentExperienceEnabled&&u?this.strings.youEditedCountFormShort:this.strings.othersEditedCountFormShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youEditedCountForm:this.strings.othersEditedCountForm;return s.formatToArray.apply(F,Object(a.__spreadArray)(Object(a.__spreadArray)([_,d],this.getRenderedUsers(f.slice(0,m),{stringOnly:i,isActor:!0}),!1),[this._getAdditionalUsersTooltip(p,{stringOnly:i,isCompact:n,hideDate:r})],!1))}var h=n?!this.isNewCommentExperienceEnabled&&u?this.strings.youEditedListFormShort:this.strings.othersEditedListFormShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youEditedListForm:this.strings.othersEditedListForm;return c=s.getLocalizedCountValue(h,n?this.strings.editedListFormShortIntervals:this.strings.editedListFormIntervals,f.length),s.formatToArray.apply(F,Object(a.__spreadArray)([c,d],this.getRenderedUsers(f,{stringOnly:i,isActor:!0}),!1))},t.prototype.getIconName=function(){return"Edit"},t.prototype.getActivityTypeString=function(){return"edit"},t}(j),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,a=n.isCompact,i=n.stringOnly,r=this.renderMainItemLink(this.strings.moveThisFile,this.strings.moveArbitraryFile,i),o=this._getFilteredActors({isCompact:a}),c=o.youUser,d=this.renderUser(o.sortedUsers[0],{stringOnly:i,isActor:!0});if(!a&&this.activity.action&&this.activity.action.move){var l=this.activity.action.move;if(l.from&&l.to){var u=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"}),f=this.renderItemLink({item:l.to,stringOnly:i});return t=!this.isNewCommentExperienceEnabled&&c?this.strings.youMovedFromFolderToFolder:this.strings.otherMovedFromFolderToFolder,s.formatToArray(t,r,d,u,f)}if(l.from)return u=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"}),t=!this.isNewCommentExperienceEnabled&&c?this.strings.youMovedFromFolder:this.strings.otherMovedFromFolder,s.formatToArray(t,r,d,u);if(l.to)return f=this.renderItemLink({item:l.to,stringOnly:i}),t=!this.isNewCommentExperienceEnabled&&c?this.strings.youMovedToFolder:this.strings.otherMovedToFolder,s.formatToArray(t,r,d,void 0,f)}return t=a?!this.isNewCommentExperienceEnabled&&c?this.strings.youMovedShort:this.strings.otherMovedShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youMoved:this.strings.otherMoved,s.formatToArray(t,r,d)},t.prototype.getIconName=function(){return"FabricMovetoFolder"},t.prototype.getActivityTypeString=function(){return"move"},t}(j),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,r=t.hideDate,o=this.strings.commentedOnThisFile;this.isListItem&&(o=this.strings.thisItem);var c,d,l=this.renderMainItemLink(o,this.strings.commentedOnArbitraryFile,i),u=this._getFilteredActors({isCompact:n}),f=u.youUser,p=u.sortedUsers,m=u.additionalUsers,_=B(n),h=this._isOnFileComment();if(h&&p.length<=1){var b=void 0;if(n)c=!this.isNewCommentExperienceEnabled&&f?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort;else{var g=this._getCommentMessage(i);this.isSingleLevel&&g?(b=g,c=!this.isNewCommentExperienceEnabled&&f?this.strings.youCommentedOnThisFile:this.strings.othersCommentedOnThisFile):(b=l,c=!this.isNewCommentExperienceEnabled&&f?this.strings.youCommentedOnFile:this.strings.othersCommentedOnFile)}d=s.formatToArray.apply(F,Object(a.__spreadArray)([c,b],this.getRenderedUsers(p,{stringOnly:i,isActor:!0}),!1))}else if(p.length>_){var v=n?!this.isNewCommentExperienceEnabled&&f?this.strings.youCommentedCountFormShort:this.strings.othersCommentedCountFormShort:!this.isNewCommentExperienceEnabled&&f?h?this.strings.youCommentedCountFormOnItem:this.strings.youCommentedCountForm:h?this.strings.othersCommentedCountFormOnItem:this.strings.othersCommentedCountForm;d=s.formatToArray.apply(F,Object(a.__spreadArray)(Object(a.__spreadArray)([v,l],this.getRenderedUsers(p.slice(0,_),{stringOnly:i,isActor:!0}),!1),[this._getAdditionalUsersTooltip(m,{stringOnly:i,isCompact:n,hideDate:r})],!1))}else{var y=n?!this.isNewCommentExperienceEnabled&&f?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort:!this.isNewCommentExperienceEnabled&&f?h?this.strings.youCommentedListFormOnItem:this.strings.youCommentedListForm:h?this.strings.othersCommentedListFormOnItem:this.strings.othersCommentedListForm;c=s.getLocalizedCountValue(y,n?this.strings.commentedListFormShortIntervals:this.strings.commentedListFormIntervals,p.length),d=s.formatToArray.apply(F,Object(a.__spreadArray)([c,l],this.getRenderedUsers(p,{stringOnly:i,isActor:!0}),!1))}return d},t.prototype.getIconName=function(){if(this.isNewCommentExperienceEnabled){var e=this._getCommentDetail();return this.commentListItem&&e?void 0:"Comment"}return this.commentListItem?void 0:"Comment"},t.prototype.getPersonaIconUrl=function(){var e,t=this._getCommentDetail();if(void 0===this.getpersonaIconUrl){var n=null===(e=window._spPageContextInfo)||void 0===e?void 0:e.isSiteListsHost,a=this.commentListItem&&t&&(n?"":t.author.email);return a&&Object(o.getUserPhotoUrl)(a)||void 0}var i=this.commentListItem&&t&&t.author.id;return i&&this.getpersonaIconUrl(i)||void 0},t.prototype.getActivityTypeString=function(){return"comment"},t.prototype.getContextualMenu=function(){var e=this,t=[],n=this.activityMenuFunctions&&this.activityMenuFunctions.delete,r=this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId;if(this.canDeleteActivity&&this.canDeleteActivity(this.activity.type)&&n&&this.commentListItem&&r){var o={key:"od-itemActivity.deleteComment"+r,name:h.activityMenuOptionDelete,dialogTitle:h.deleteCommentDialogTitle,dialogConfirm:h.deleteCommentConfirm,dialogOnConfirm:function(){return n(e.commentListItem.activityItemWrapper,e.currentUserEmail,{commentItem:e.commentListItem,commentId:r})}};t.push(o)}return this.isNewCommentExperienceEnabled&&1===t.length?i.createElement(U,Object(a.__assign)({},t[0],{environment:this.environment})):t.length?i.createElement(P,{itemActivityMenuItems:t,activityId:this.activity.id,environment:this.environment}):void 0},t.prototype.getResponse=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail(),n=t&&t.replies&&t.replies.comments&&t.replies.comments.length>0;if(this.commentListItem&&t&&(n||!this.isReadonly))return i.createElement(x,{key:"".concat(this.containingItem.graphItemUrl,"_").concat(t.id),parentComment:t,commentListItem:this.commentListItem,currentUserEmail:this.currentUserEmail,onRenderUser:this.onRenderUser,isReadonly:this.isReadonly,environment:this.environment})},t.prototype.getCommentAuthorName=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.displayName},t.prototype.getcommentAuthorEmail=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.email},t.prototype.getCommentThreadId=function(){return this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId},t.prototype._getCommentMessage=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail();if(t&&t.text){if(e){var n=void 0;return n="sharePoint"===this.environment||"sharePointList"===this.environment?N.e.htmlDecodeFromString(t.text):t.text,this.isAtMentionEnabled&&t.mentioned&&(n=n.replace(/@mention{(\d+)}/g,function(e,n){var a=parseInt(n),i=t.mentioned[a];return i?"@".concat(i.displayName||i.email):e})),n}return!0===this.isNewCommentExperienceEnabled&&this.displayLargeText?i.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",key:"commentContent_".concat(this.getKey())},this.displayLargeText({seeMoreText:this.strings.seeMoreLabel,seeLessText:this.strings.seeLessLabel,text:"sharePointList"===this.environment?N.e.htmlDecodeFromString(t.text):t.text,mentioned:t.mentioned,isAtMentionEnabled:this.isAtMentionEnabled,environment:this.environment,onRenderUser:this.onRenderUser})):i.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:t.text},key:"commentContent_".concat(this.getKey())})}},t.prototype._getCommentDetail=function(){var e=this.activity.action;return e&&e.comment&&e.comment.commentDetail},t.prototype._isOnFileComment=function(){var e=this.activity.action&&this.activity.action.comment;return!(!e||!e.commentId)},t}(j),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,r=t.hideDate,o=this.activity.action.commentResponse,c=this._getFilteredActors({isCompact:n}),d=c.youUser,l=c.sortedUsers,u=c.additionalUsers,f=B(n),p=this.renderItemLink({item:this.activity.item,itemLabel:this.strings.commentResponseComment,stringOnly:i});if(o&&o.commentAuthor){var m=o.commentAuthor.self,_=this.renderUser(o.commentAuthor,{stringOnly:i,isAccusative:!0}),h=void 0;if(l.length>f){h=m?n?!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToYouCountFormShort:this.strings.otherRepliedToYouCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToYouCountForm:this.strings.otherRepliedToYouCountForm:n?!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToOtherCountFormShort:this.strings.otherRepliedToOtherCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToOtherCountForm:this.strings.otherRepliedToOtherCountForm;var b=Object(a.__spreadArray)(Object(a.__spreadArray)([_],this.getRenderedUsers(l.slice(0,f),{stringOnly:i,isActor:!0}),!0),[this._getAdditionalUsersTooltip(u,{stringOnly:i,isCompact:n,hideDate:r})],!1);return n||b.unshift(p),s.formatToArray.apply(F,Object(a.__spreadArray)([h],b,!1))}var g=void 0;return g=m?n?!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToYouListFormShort:this.strings.otherRepliedToYouListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToYouListForm:this.strings.otherRepliedToYouListForm:n?!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToOtherListFormShort:this.strings.otherRepliedToOtherListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToOtherListForm:this.strings.otherRepliedToOtherListForm,h=s.getLocalizedCountValue(g,n?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length),b=Object(a.__spreadArray)([_],this.getRenderedUsers(l.slice(0,f),{stringOnly:i,isActor:!0}),!0),n||b.unshift(p),s.formatToArray.apply(F,Object(a.__spreadArray)([h],b,!1))}return h=void 0,l.length>f?(h=n?!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToMissingAuthorCountFormShort:this.strings.otherRepliedToMissingAuthorCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToMissingAuthorCountForm:this.strings.otherRepliedToMissingAuthorCountForm,s.formatToArray.apply(F,Object(a.__spreadArray)(Object(a.__spreadArray)([h,p],this.getRenderedUsers(l.slice(0,f),{stringOnly:i,isActor:!0}),!1),[this._getAdditionalUsersTooltip(u,{stringOnly:i,isCompact:n,hideDate:r})],!1))):(g=n?!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToMissingAuthorListFormShort:this.strings.otherRepliedToMissingAuthorListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youRepliedToMissingAuthorListForm:this.strings.otherRepliedToMissingAuthorListForm,h=s.getLocalizedCountValue(g,n?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length),s.formatToArray.apply(F,Object(a.__spreadArray)([h,p],this.getRenderedUsers(l,{stringOnly:i,isActor:!0}),!1)))},t.prototype.getIconName=function(){return"Reply"},t.prototype.getActivityTypeString=function(){return"commentResponse"},t}(j),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,r=t.hideDate,o=this.strings.mentionedThisFile;this.isListItem&&(o=this.strings.thisItem);var c,d,l,u=this.renderMainItemLink(o,this.strings.mentionArbitraryFile,i),f=this._getFilteredActors({actors:this.activity.action.mention.mentionees,isCompact:n}),p=this.getRenderedUsers(f.sortedUsers,{stringOnly:i}),m=f.youUser,_=f.additionalUsers,h=this._getFilteredActors({isCompact:n}),b=h.youUser,g=h.sortedUsers,v=B(n);return p.length>v?(d=m?n?!this.isNewCommentExperienceEnabled&&b?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedYouAndOthersCountFormShort:!this.isNewCommentExperienceEnabled&&b?this.strings.youMentionedYouAndOthersCountForm:b?this.strings.youMentionedYourselfAndOthersCountForm:this.strings.othersMentionedYouAndOthersCountForm:n?!this.isNewCommentExperienceEnabled&&b?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedOthersCountFormShort:!this.isNewCommentExperienceEnabled&&b?this.strings.youMentionedOthersCountForm:this.strings.othersMentionedOthersCountForm,s.formatToArray.apply(F,Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([d,u],this.getRenderedUsers(g,{stringOnly:i,isActor:!0}),!1),p.slice(0,v),!1),[this._getAdditionalUsersTooltip(_,{stringOnly:i,isCompact:n,hideDate:r})],!1))):(l=m?n?!this.isNewCommentExperienceEnabled&&b?this.strings.youMentionedYouListFormShort:this.strings.otherMentionedYouListFormShort:!this.isNewCommentExperienceEnabled&&b?this.strings.youMentionedYouAndOthersListForm:b?this.strings.youMentionedYourselfAndOthersListForm:this.strings.othersMentionedYouAndOthersListForm:n?!this.isNewCommentExperienceEnabled&&b?this.strings.youMentionedOthersListFormShort:this.strings.othersMentionedOthersListFormShort:!this.isNewCommentExperienceEnabled&&b?this.strings.youMentionedOthersListForm:this.strings.othersMentionedOthersListForm,c=s.getLocalizedCountValue(l,n?this.strings.mentionedListFormShortIntervals:this.strings.mentionedListFormIntervals,p.length),s.formatToArray.apply(F,Object(a.__spreadArray)(Object(a.__spreadArray)([c,u],this.getRenderedUsers(g,{stringOnly:i,isActor:!0}),!1),p.slice(0,v),!1)))},t.prototype.getIconName=function(){return"Accounts"},t.prototype.getActivityTypeString=function(){return"mention"},t}(j),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,a=t.stringOnly;if(this.activity.action&&this.activity.action.version&&this.activity.action.version.newVersion){var i=this._getFilteredActors({isCompact:n}),r=i.youUser,o=this.renderUser(i.sortedUsers[0],{stringOnly:a,isActor:!0}),c=n?!this.isNewCommentExperienceEnabled&&r?this.strings.youCreatedVersionShort:this.strings.otherCreatedVersionShort:!this.isNewCommentExperienceEnabled&&r?this.isSingleLevel?this.strings.youCreatedVersionThisFile:this.strings.youCreatedVersion:this.isSingleLevel?this.strings.otherCreatedVersionThisFile:this.strings.otherCreatedVersion,d=this.renderMainItemLink(this.strings.versionThisFile,this.strings.versionArbitraryFile,a),l=this.activity.action.version.newVersion;return s.formatToArray(c,d,o,l)}return[]},t.prototype.getIconName=function(){return"FabricMovetoFolder"},t.prototype.getActivityTypeString=function(){return"version"},t}(j),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=(t.isCompact,t.stringOnly),a=this.strings.restoreThisFile;this.isListItem&&(a=this.strings.restoreThisItem);var i=this.renderMainItemLink(a,this.strings.restoreArbitraryFile,n),r=this.isSingleLevel?this.strings.thisFileRestored:this.strings.arbitraryFileRestored;return s.formatToArray(r,i)},t.prototype.getIconName=function(){return"Refresh"},t.prototype.getActivityTypeString=function(){return"restore"},t}(j),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,a=n.isCompact,i=n.stringOnly,r=this._getFilteredActors({isCompact:a}),o=r.youUser,c=this.renderUser(r.sortedUsers[0],{stringOnly:i,isActor:!0});if(this.activity.action&&this.activity.action.rename&&this.activity.action.rename.oldItem){var d=this.renderItemLink({item:this.activity.action.rename.oldItem,stringOnly:i,keyPrefix:"old"}),l=this.renderItemLink({item:this.activity.item,stringOnly:i});return t=a?!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileToFileShort:this.strings.otherRenamedFileToFileShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileToFile:this.strings.otherRenamedFileToFile,s.formatToArray(t,c,d,l)}var u=this.renderMainItemLink(this.strings.renameThisFile,this.strings.renameArbitraryFile,i);return t=a?!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileShort:this.strings.otherRenamedFileShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFile:this.strings.otherRenamedFile,s.formatToArray(t,c,u)},t.prototype.getIconName=function(){return"Rename"},t.prototype.getActivityTypeString=function(){return"restore"},t}(j),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,a=t.stringOnly,i=this.strings.deleteThisFile;this.isListItem&&(i=this.strings.thisItem);var r=this.renderMainItemLink(i,this.strings.deleteArbitraryFile,a),o=this._getFilteredActors({isCompact:n}),c=o.youUser,d=this.renderUser(o.sortedUsers[0],{stringOnly:a,isActor:!0}),l=n?!this.isNewCommentExperienceEnabled&&c?this.strings.youDeletedShort:this.strings.otherDeletedShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youDeleted:this.strings.otherDeleted;if(this.isSingleLevel)return s.formatToArray(l,r,d);var u=this.renderItemLink({item:this.activity.parentItem,stringOnly:a});return l=!n&&u?!this.isNewCommentExperienceEnabled&&c?this.strings.youDeletedFromFolder:this.strings.otherDeletedFromFolder:l,u?s.formatToArray(l,r,d,u):s.formatToArray(l,r,d)},t.prototype.getIconName=function(){return"Trash"},t.prototype.getActivityTypeString=function(){return"delete"},t}(j),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,a=t.stringOnly,i=this.strings.createThisFile;this.isListItem&&(i=this.strings.thisItem);var r=this.renderMainItemLink(i,this.strings.createArbitraryFile,a),o=this._getFilteredActors({isCompact:n}),c=o.youUser,d=this.renderUser(o.sortedUsers[0],{stringOnly:a,isActor:!0}),l=n?!this.isNewCommentExperienceEnabled&&c?this.strings.youCreatedShort:this.strings.otherCreatedShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youCreated:this.strings.otherCreated;if(this.isSingleLevel)return s.formatToArray(l,r,d);var u=this.renderItemLink({item:this.activity.parentItem,stringOnly:a});return l=!n&&u?!this.isNewCommentExperienceEnabled&&c?this.strings.youCreatedInLocation:this.strings.otherCreatedInLocation:l,u?s.formatToArray(l,r,d,u):s.formatToArray(l,r,d)},t.prototype.getIconName=function(){return"Add"},t.prototype.getActivityTypeString=function(){return"create"},t}(j),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,r=t.hideDate,o=this.strings.shareThisFile;this.isListItem&&(o=this.strings.thisItem);var c,d=this.renderMainItemLink(o,this.strings.shareArbitraryFile,i),l=this._getFilteredActors({isCompact:n}),u=l.youUser,f=this.activity.action.share.recipients;if(f&&f.length>0){var p,m=this.renderUser(l.sortedUsers[0],{stringOnly:i,isActor:!0}),_=this._getFilteredActors({actors:f,isCompact:n}),h=_.sortedUsers,b=_.youUser,g=_.additionalUsers,v=B(n);if(h.length>v)return p=b?n?!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedWithYouCountFormShort:this.strings.otherSharedWithYouCountFormShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedWithYouCountForm:this.strings.otherSharedWithYouCountForm:n?!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedWithOthersCountFormShort:this.strings.otherSharedWithOthersCountFormShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedWithOthersCountForm:this.strings.otherSharedWithOthersCountForm,s.formatToArray.apply(F,Object(a.__spreadArray)(Object(a.__spreadArray)([p,d,m],this.getRenderedUsers(h.slice(0,v),{stringOnly:i,isAccusative:!0}),!1),[this._getAdditionalUsersTooltip(g,{stringOnly:i,isCompact:n,hideDate:r,isAccusative:!0})],!1));var y=void 0;y=b?n?!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedWithYouListFormShort:this.strings.otherSharedWithYouListFormShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedWithYouListForm:this.strings.otherSharedWithYouListForm:n?!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedWithOthersListFormShort:this.strings.otherSharedWithOthersListFormShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedWithOthersListForm:this.strings.otherSharedWithOthersListForm;var S=s.getLocalizedCountValue(y,n?this.strings.sharedWithOthersListFormShortIntervals:this.strings.sharedWithOthersListFormIntervals,h.length);return s.formatToArray.apply(F,Object(a.__spreadArray)([S,d,m],this.getRenderedUsers(h,{stringOnly:i,isAccusative:!0}),!1))}var D=l.sortedUsers,I=l.additionalUsers,x=B(n);return D.length>x?(c=n?!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedCountFormShort:this.strings.othersSharedCountFormShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedCountForm:this.strings.othersSharedCountForm,s.formatToArray.apply(F,Object(a.__spreadArray)(Object(a.__spreadArray)([c,d],this.getRenderedUsers(D.slice(0,x),{stringOnly:i,isActor:!0}),!1),[this._getAdditionalUsersTooltip(I,{stringOnly:i,isCompact:n,hideDate:r})],!1))):(y=n?!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedListFormShort:this.strings.othersSharedListFormShort:!this.isNewCommentExperienceEnabled&&u?this.strings.youSharedListForm:this.strings.othersSharedListForm,c=s.getLocalizedCountValue(y,n?this.strings.sharedListFormShortIntervals:this.strings.sharedListFormIntervals,D.length),s.formatToArray.apply(F,Object(a.__spreadArray)([c,d],this.getRenderedUsers(D,{stringOnly:i,isActor:!0}),!1)))},t.prototype.getIconName=function(){return"Share"},t.prototype.getActivityTypeString=function(){return"share"},t}(j),$=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,a=t.stringOnly,i=this.renderMainItemLink(this.strings.shareThisFile,this.strings.createArbitraryFile,a),r=this._getFilteredActors({isCompact:n}),o=r.youUser,c=this.renderUser(r.sortedUsers[0],{stringOnly:a,isActor:!0}),d=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredDocumentLibraryShort:this.strings.otherRestoredDocumentLibraryShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredDocumentLibrary:this.strings.otherRestoredDocumentLibrary,l=this.activity.action&&this.activity.action.pointInTimeRestore,u=l&&l.restoreToDateTime;return s.formatToArray(d,c,i,v.s(u))},t.prototype.getIconName=function(){return"Refresh"},t.prototype.getActivityTypeString=function(){return"pointInTimeRestore"}}(j),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,a=t.stringOnly,i=this.renderMainItemLink(this.strings.restoredVersionThisFile,this.strings.restoredVersionArbitraryFile,a),r=this._getFilteredActors({isCompact:n}),o=r.youUser,c=this.renderUser(r.sortedUsers[0],{stringOnly:a}),d=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredVersionShort:this.strings.otherRestoredVersionShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredVersion:this.strings.otherRestoredVersion,l=this.activity.action&&this.activity.action.restoreVersion,u=l&&l.fromVersion;return s.formatToArray(d,c,i,u)},t.prototype.getIconName=function(){return"Refresh"},t.prototype.getActivityTypeString=function(){return"restoreVesion"}}(j),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,a=t.stringOnly,i=(t.hideDate,this.renderMainItemLink(this.strings.shortcutThisFolder,this.strings.shortcutArbitraryFolder,a)),r=this._getFilteredActors({isCompact:n}),o=r.youUser,c=this.renderUser(r.sortedUsers[0],{stringOnly:a}),d=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youAddedAShortcutShort:this.strings.OtherAddedAShortcutShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youAddedAShortcut:this.strings.OtherAddedAShortcut;return s.formatToArray(d,c,i)},t.prototype.getIconName=function(){return"FabricFolderLink"},t.prototype.getActivityTypeString=function(){return"addShortcutToOneDrive"},t}(j)),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,a=t.stringOnly,i=(t.hideDate,this.activity.action.removeShortcutFromOneDrive),r=this.renderItemLink({item:this.activity.item,itemLabel:i.mountPointName,stringOnly:a}),o=this._getFilteredActors({isCompact:n}),c=o.youUser,d=this.renderUser(o.sortedUsers[0],{stringOnly:a}),l=n?!this.isNewCommentExperienceEnabled&&c?this.strings.youRemovedAShortcutShort:this.strings.OtherRemovedAShortcutShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youRemovedAShortcut:this.strings.OtherRemovedAShortcut;return s.formatToArray(l,d,r)},t.prototype.getIconName=function(){return"FabricFolderLink"},t.prototype.getActivityTypeString=function(){return"removeShortcutFromOneDrive"},t}(j)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return O});var a=n(1526),i=n(0),r=n(1),o=n(809),s=n(1104),c=n(587),d=n(109),l=n(2252),u=n(484),f=n(1529),p=n(1105),m=n(21),_=n(102),h=n(480),b=Object(_.t)(function(e,t,n){var a=Object(h.e)(e),r=Object(m.v)(a,n);return Object(i.__assign)(Object(i.__assign)({},r),{root:[a.root,t,e.fonts.medium,n&&n.root]})}),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,a=Object(i.__rest)(e,["className","styles"]),o=b(this.props.theme,t,n);return r.createElement(u.e,Object(i.__assign)({},a,{variantClassName:"ms-Button--facepile",styles:o,onRenderDescription:f.t}))},Object(i.__decorate)([Object(p.e)("FacepileButton",["theme","styles"],!0)],t)}(r.Component),v=n(476),y=n(2452),S=n(2105),D=n(1840),I=Object(o.e)(),x=function(e){function t(t){var n=e.call(this,t)||this;return n._classNames=I(n.props.styles,{theme:n.props.theme,className:n.props.className}),n._getPersonaControl=function(e){var t=n.props,a=t.getPersonaProps,o=t.personaSize;return r.createElement(y.e,Object(i.__assign)({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:o},a?a(e):null,{styles:{details:{flex:"1 0 auto"}}}))},n._getPersonaCoinControl=function(e){var t=n.props,a=t.getPersonaProps,o=t.personaSize;return r.createElement(S.e,Object(i.__assign)({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:o},a?a(e):null))},Object(s.e)(n),n._ariaDescriptionId=Object(c.e)(),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props.overflowButtonProps,t=this.props,n=t.chevronButtonProps,a=t.maxDisplayablePersonas,i=t.personas,o=t.overflowPersonas,s=t.showAddButton,c=t.ariaLabel,d=t.showTooltip,l=void 0===d||d,u=this._classNames,f="number"==typeof a?Math.min(i.length,a):i.length;n&&!e&&(e=n);var p=o&&o.length>0,m=p?i:i.slice(0,f),_=(p?o:i.slice(f))||[];return r.createElement("div",{className:u.root},this.onRenderAriaDescription(),r.createElement("div",{className:u.itemContainer},s?this._getAddNewElement():null,r.createElement("ul",{className:u.members,"aria-label":c},this._onRenderVisiblePersonas(m,0===_.length&&1===i.length,l)),e?this._getOverflowElement(_):null))},t.prototype.onRenderAriaDescription=function(){var e=this.props.ariaDescription,t=this._classNames;return e&&r.createElement("span",{className:t.screenReaderOnly,id:this._ariaDescriptionId},e)},t.prototype._onRenderVisiblePersonas=function(e,t,n){var a=this,i=this.props,o=i.onRenderPersona,s=void 0===o?this._getPersonaControl:o,c=i.onRenderPersonaCoin,d=void 0===c?this._getPersonaCoinControl:c,l=i.onRenderPersonaWrapper;return e.map(function(e,i){var o=t?s(e,a._getPersonaControl):d(e,a._getPersonaCoinControl),c=e.onClick?function(){return a._getElementWithOnClickEvent(o,e,n,i)}:function(){return a._getElementWithoutOnClickEvent(o,e,n,i)};return r.createElement("li",{key:(t?"persona":"personaCoin")+"-"+i,className:a._classNames.member},l?l(e,c):c())})},t.prototype._getElementWithOnClickEvent=function(e,t,n,a){var o=t.keytipProps;return r.createElement(g,Object(i.__assign)({},Object(d.s)(t,d.n),this._getElementProps(t,n,a),{keytipProps:o,onClick:this._onPersonaClick.bind(this,t)}),e)},t.prototype._getElementWithoutOnClickEvent=function(e,t,n,a){return r.createElement("div",Object(i.__assign)({},Object(d.s)(t,d.n),this._getElementProps(t,n,a)),e)},t.prototype._getElementProps=function(e,t,n){var a=this._classNames;return{key:(e.imageUrl?"i":"")+n,"data-is-focusable":!0,className:a.itemButton,title:t?e.personaName:void 0,onMouseMove:this._onPersonaMouseMove.bind(this,e),onMouseOut:this._onPersonaMouseOut.bind(this,e)}},t.prototype._getOverflowElement=function(e){switch(this.props.overflowButtonType){case l.e.descriptive:return this._getDescriptiveOverflowElement(e);case l.e.downArrow:return this._getIconElement("ChevronDown");case l.e.more:return this._getIconElement("More");default:return null}},t.prototype._getDescriptiveOverflowElement=function(e){var t=this.props.personaSize;if(!e||e.length<1)return null;var n=e.map(function(e){return e.personaName}).join(", "),a=Object(i.__assign)({title:n},this.props.overflowButtonProps),o=Math.max(e.length,0),s=this._classNames;return r.createElement(g,Object(i.__assign)({},a,{ariaDescription:a.title,className:s.descriptiveOverflowButton}),r.createElement(S.e,{size:t,onRenderInitials:this._renderInitialsNotPictured(o),initialsColor:D.e.transparent}))},t.prototype._getIconElement=function(e){var t=this.props,n=t.overflowButtonProps,a=t.personaSize,o=this._classNames;return r.createElement(g,Object(i.__assign)({},n,{className:o.overflowButton}),r.createElement(S.e,{size:a,onRenderInitials:this._renderInitials(e,!0),initialsColor:D.e.transparent}))},t.prototype._getAddNewElement=function(){var e=this.props,t=e.addButtonProps,n=e.personaSize,a=this._classNames;return r.createElement(g,Object(i.__assign)({},t,{className:a.addButton}),r.createElement(S.e,{size:n,onRenderInitials:this._renderInitials("AddFriend")}))},t.prototype._onPersonaClick=function(e,t){e.onClick(t,e),t.preventDefault(),t.stopPropagation()},t.prototype._onPersonaMouseMove=function(e,t){e.onMouseMove&&e.onMouseMove(t,e)},t.prototype._onPersonaMouseOut=function(e,t){e.onMouseOut&&e.onMouseOut(t,e)},t.prototype._renderInitials=function(e,t){var n=this._classNames;return function(){return r.createElement(v.e,{iconName:e,className:t?n.overflowInitialsIcon:""})}},t.prototype._renderInitialsNotPictured=function(e){var t=this._classNames;return function(){return r.createElement("span",{className:t.overflowInitialsIcon},e<100?"+"+e:"99+")}},t.defaultProps={maxDisplayablePersonas:5,personas:[],overflowPersonas:[],personaSize:D.n.size32},t}(r.Component),C={root:"ms-Facepile",addButton:"ms-Facepile-addButton ms-Facepile-itemButton",descriptiveOverflowButton:"ms-Facepile-descriptiveOverflowButton ms-Facepile-itemButton",itemButton:"ms-Facepile-itemButton ms-Facepile-person",itemContainer:"ms-Facepile-itemContainer",members:"ms-Facepile-members",member:"ms-Facepile-member",overflowButton:"ms-Facepile-overflowButton ms-Facepile-itemButton"},O=Object(a.e)(x,function(e){var t,n=e.className,a=e.theme,i=e.spacingAroundItemButton,r=void 0===i?2:i,o=a.palette,s=a.fonts,c=Object(m.I)(C,a),d={textAlign:"center",padding:0,borderRadius:"50%",verticalAlign:"top",display:"inline",backgroundColor:"transparent",border:"none",selectors:{"&::-moz-focus-inner":{padding:0,border:0}}};return{root:[c.root,a.fonts.medium,{width:"auto"},n],addButton:[c.addButton,Object(m.D)(a,{inset:-1}),d,{fontSize:s.medium.fontSize,color:o.white,backgroundColor:o.themePrimary,marginRight:2*r+"px",selectors:{"&:hover":{backgroundColor:o.themeDark},"&:focus":{backgroundColor:o.themeDark},"&:active":{backgroundColor:o.themeDarker},"&:disabled":{backgroundColor:o.neutralTertiaryAlt}}}],descriptiveOverflowButton:[c.descriptiveOverflowButton,Object(m.D)(a,{inset:-1}),d,{fontSize:s.small.fontSize,color:o.neutralSecondary,backgroundColor:o.neutralLighter,marginLeft:2*r+"px"}],itemButton:[c.itemButton,d],itemContainer:[c.itemContainer,{display:"flex"}],members:[c.members,{display:"flex",overflow:"hidden",listStyleType:"none",padding:0,margin:"-"+r+"px"}],member:[c.member,{display:"inline-flex",flex:"0 0 auto",margin:r+"px"}],overflowButton:[c.overflowButton,Object(m.D)(a,{inset:-1}),d,{fontSize:s.medium.fontSize,color:o.neutralSecondary,backgroundColor:o.neutralLighter,marginLeft:2*r+"px"}],overflowInitialsIcon:[{color:o.neutralPrimary,selectors:(t={},t[m.o]={color:"WindowText"},t)}],screenReaderOnly:m.k}},void 0,{scope:"Facepile"})},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return y});var a=n(0),i=n(1),r=n(823),o=n(1641),s=n(1176),c=n(1624),d=n(484),l=n(1105),u=n(21),f=n(102),p=n(480),m=n(612),_=n(1029),h=Object(f.t)(function(e,t,n){var i,r,o,s,c,d=e.fonts,l=e.palette,f=Object(p.e)(e),h=Object(m.e)(e),b={root:{maxWidth:"280px",minHeight:"72px",height:"auto",padding:"16px 12px"},flexContainer:{flexDirection:"row",alignItems:"flex-start",minWidth:"100%",margin:""},textContainer:{textAlign:"left"},icon:{fontSize:"2em",lineHeight:"1em",height:"1em",margin:"0px 8px 0px 0px",flexBasis:"1em",flexShrink:"0"},label:{margin:"0 0 5px",lineHeight:"100%",fontWeight:u.r.semibold},description:[d.small,{lineHeight:"100%"}]},g={description:{color:l.neutralSecondary},descriptionHovered:{color:l.neutralDark},descriptionPressed:{color:"inherit"},descriptionChecked:{color:"inherit"},descriptionDisabled:{color:"inherit"}},v={description:{color:l.white,selectors:(i={},i[u.o]=Object(a.__assign)({backgroundColor:"WindowText",color:"Window"},Object(u.x)()),i)},descriptionHovered:{color:l.white,selectors:(r={},r[u.o]={backgroundColor:"Highlight",color:"Window"},r)},descriptionPressed:{color:"inherit",selectors:(o={},o[u.o]=Object(a.__assign)({color:"Window",backgroundColor:"WindowText"},Object(u.x)()),o)},descriptionChecked:{color:"inherit",selectors:(s={},s[u.o]=Object(a.__assign)({color:"Window",backgroundColor:"WindowText"},Object(u.x)()),s)},descriptionDisabled:{color:"inherit",selectors:(c={},c[u.o]={color:"inherit"},c)}};return Object(u.v)(f,b,n?Object(_.e)(e):Object(_.t)(e),n?v:g,h,t)}),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,r=e.styles,o=e.theme;return i.createElement(d.e,Object(a.__assign)({},this.props,{variantClassName:n?"ms-Button--compoundPrimary":"ms-Button--compound",styles:h(o,r,n)}))},Object(a.__decorate)([Object(l.e)("CompoundButton",["theme","styles"],!0)],t)}(i.Component),g=n(1644),v=n(1642),y=function(e){function t(t){var n=e.call(this,t)||this;return Object(r.e)("The Button component has been deprecated. Use specific variants instead. (PrimaryButton, DefaultButton, IconButton, ActionButton, etc.)"),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props;switch(e.buttonType){case o.e.command:return i.createElement(c.e,Object(a.__assign)({},e));case o.e.compound:return i.createElement(b,Object(a.__assign)({},e));case o.e.icon:return i.createElement(g.e,Object(a.__assign)({},e));case o.e.primary:return i.createElement(v.e,Object(a.__assign)({},e));default:return i.createElement(s.e,Object(a.__assign)({},e))}},t}(i.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(1526),i=n(0),r=n(1),o=n(809),s=n(109),c=n(112),d=n(2034),l=n(1600),u=n(1754),f=n(1644),p=n(476),m="SearchBox",_={root:{height:"auto"},icon:{fontSize:"12px"}},h={iconName:"Clear"},b={ariaLabel:"Clear text"},g=Object(o.e)(),v=r.forwardRef(function(e,t){var n=e.ariaLabel,a=e.className,o=e.defaultValue,v=void 0===o?"":o,y=e.disabled,S=e.underlined,D=e.styles,I=e.labelText,x=e.placeholder,C=void 0===x?I:x,O=e.theme,w=e.clearButtonProps,E=void 0===w?b:w,A=e.disableAnimation,L=void 0!==A&&A,k=e.showIcon,M=void 0!==k&&k,P=e.onClear,T=e.onBlur,U=e.onEscape,F=e.onSearch,H=e.onKeyDown,R=e.iconProps,N=e.role,B=e.onChange,j=e.onChanged,V=r.useState(!1),z=V[0],G=V[1],K=r.useRef(),W=Object(d.e)(e.value,v,function(e,t){e&&e.timeStamp===K.current||(K.current=null==e?void 0:e.timeStamp,null==B||B(e,t),null==j||j(t))}),q=W[0],Q=W[1],Y=String(q),J=r.useRef(null),X=r.useRef(null),Z=Object(l.e)(J,t),$=Object(u.e)(m,e.id),ee=E.onClick,te=g(D,{theme:O,className:a,underlined:S,hasFocus:z,disabled:y,hasInput:Y.length>0,disableAnimation:L,showIcon:M}),ne=Object(s.s)(e,s.f,["className","placeholder","onFocus","onBlur","value","role"]),ae=r.useCallback(function(e){var t;null==P||P(e),e.defaultPrevented||(Q(""),null===(t=X.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault())},[P,Q]),ie=r.useCallback(function(e){null==ee||ee(e),e.defaultPrevented||ae(e)},[ee,ae]),re=r.useCallback(function(e){G(!1),null==T||T(e)},[T]),oe=function(e){Q(e.target.value,e)};return function(e,t,n){r.useImperativeHandle(e,function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()},hasFocus:function(){return n}}},[t,n])}(e.componentRef,X,z),r.createElement("div",{role:N,ref:Z,className:te.root,onFocusCapture:function(t){var n;G(!0),null===(n=e.onFocus)||void 0===n||n.call(e,t)}},r.createElement("div",{className:te.iconContainer,onClick:function(){X.current&&(X.current.focus(),X.current.selectionStart=X.current.selectionEnd=0)},"aria-hidden":!0},r.createElement(p.e,Object(i.__assign)({iconName:"Search"},R,{className:te.icon}))),r.createElement("input",Object(i.__assign)({},ne,{id:$,className:te.field,placeholder:C,onChange:oe,onInput:oe,onBlur:re,onKeyDown:function(e){switch(e.which){case c.e.escape:null==U||U(e),Y&&!e.defaultPrevented&&ae(e);break;case c.e.enter:F&&(F(Y),e.preventDefault(),e.stopPropagation());break;default:null==H||H(e),e.defaultPrevented&&e.stopPropagation()}},value:Y,disabled:y,role:"searchbox","aria-label":n,ref:X})),Y.length>0&&r.createElement("div",{className:te.clearButton},r.createElement(f.e,Object(i.__assign)({onBlur:re,styles:_,iconProps:h},E,{onClick:ie}))))});v.displayName=m;var y=n(21),S=n(435),D={root:"ms-SearchBox",iconContainer:"ms-SearchBox-iconContainer",icon:"ms-SearchBox-icon",clearButton:"ms-SearchBox-clearButton",field:"ms-SearchBox-field"},I=Object(a.e)(v,function(e){var t,n,a,i,r,o=e.theme,s=e.underlined,c=e.disabled,d=e.hasFocus,l=e.className,u=e.hasInput,f=e.disableAnimation,p=e.showIcon,m=o.palette,_=o.fonts,h=o.semanticColors,b=o.effects,g=Object(y.I)(D,o),v={color:h.inputPlaceholderText,opacity:1},I=m.neutralSecondary,x=m.neutralPrimary,C=m.neutralLighter,O=m.neutralLighter,w=m.neutralLighter;return{root:[g.root,_.medium,y.H,{color:h.inputText,backgroundColor:h.inputBackground,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",padding:"1px 0 1px 4px",borderRadius:b.roundedCorner2,border:"1px solid "+h.inputBorder,height:32,selectors:(t={},t[y.o]={borderColor:"WindowText"},t[":hover"]={borderColor:h.inputBorderHovered,selectors:(n={},n[y.o]={borderColor:"Highlight"},n)},t[":hover ."+g.iconContainer]={color:h.inputIconHovered},t)},!d&&u&&{selectors:(a={},a[":hover ."+g.iconContainer]={width:4},a[":hover ."+g.icon]={opacity:0,pointerEvents:"none"},a)},d&&["is-active",{position:"relative"},Object(y.w)(h.inputFocusBorderAlt,s?0:b.roundedCorner2,s?"borderBottom":"border")],p&&[{selectors:(i={},i[":hover ."+g.iconContainer]={width:32},i[":hover ."+g.icon]={opacity:1},i)}],c&&["is-disabled",{borderColor:C,backgroundColor:w,pointerEvents:"none",cursor:"default",selectors:(r={},r[y.o]={borderColor:"GrayText"},r)}],s&&["is-underlined",{borderWidth:"0 0 1px 0",borderRadius:0,padding:"1px 0 1px 8px"}],s&&c&&{backgroundColor:"transparent"},u&&"can-clear",l],iconContainer:[g.iconContainer,{display:"flex",flexDirection:"column",justifyContent:"center",flexShrink:0,fontSize:16,width:32,textAlign:"center",color:h.inputIcon,cursor:"text"},d&&{width:4},c&&{color:h.inputIconDisabled},!f&&{transition:"width "+y.n.durationValue1},p&&d&&{width:32}],icon:[g.icon,{opacity:1},d&&{opacity:0,pointerEvents:"none"},!f&&{transition:"opacity "+y.n.durationValue1+" 0s"},p&&d&&{opacity:1}],clearButton:[g.clearButton,{display:"flex",flexDirection:"row",alignItems:"stretch",cursor:"pointer",flexBasis:"32px",flexShrink:0,padding:0,margin:"-1px 0px",selectors:{"&:hover .ms-Button":{backgroundColor:O},"&:hover .ms-Button-icon":{color:x},".ms-Button":{borderRadius:Object(S.e)(o)?"1px 0 0 1px":"0 1px 1px 0"},".ms-Button-icon":{color:I}}}],field:[g.field,y.H,Object(y.E)(v),{backgroundColor:"transparent",border:"none",outline:"none",fontWeight:"inherit",fontFamily:"inherit",fontSize:"inherit",color:h.inputText,flex:"1 1 0px",minWidth:"0px",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:.5,selectors:{"::-ms-clear":{display:"none"}}},c&&{color:h.disabledText}]}},void 0,{scope:"SearchBox"})}],Array(47),[function(e,t,n){"use strict";n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a=n(128),i=n(47),r=!1,o=!1;function s(){o||(o=!0,function(){if(!r&&o){r=!0,new a.e({name:"ItemAnalytics.PageFinishedLoading",startTimeOverride:window._itemAnalyticsStartTime}).end({resultType:i.e.Success});try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"item_analytics_ready"}),"*")}}}())}function c(e){try{window.external.PageError(e,e.message)}catch(n){var t={name:"item_analytics_error",error:e,errorMessage:e.message};window.parent.postMessage(JSON.stringify(t),"*")}}},,,,,,function(e,t,n){"use strict";var a;!function(e){e[e.anyone=0]="anyone",e[e.workGroup=1]="workGroup",e[e.specificPeople=2]="specificPeople",e[e.onlyYou=3]="onlyYou",e[e.existing=4]="existing",e[e.chat=5]="chat",e[e.mail=6]="mail"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(1),r=n(1943),o=n(40);function s(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Object(a.__extends)(n,t),n.prototype.render=function(){var t=this.props,n=t.resources,o=Object(a.__rest)(t,["resources"]);return i.createElement(r.e,{specification:Object(r.t)(e,o),resources:n})},n}(i.PureComponent);return Object(o.i)()(t)}}],Array(37),[function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-SharingLink{margin-bottom:.625rem;display:block}.od-SharingLink-cell{display:inline-block}.od-SharingLink-iconCell{vertical-align:top;width:3rem;height:3rem;position:relative}[dir=ltr] .od-SharingLink-iconCell{padding-right:.625rem}[dir=rtl] .od-SharingLink-iconCell{padding-left:.625rem}.od-SharingLink-icon{display:inline-block;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-size:1.125rem;min-width:3rem;height:3rem;text-align:center;line-height:3rem;position:absolute;background-color:transparent;border-width:.0625rem;border-style:solid;border-radius:50%}.od-SharingLink-iconBackground{display:inline-block;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";border-radius:50%;min-width:3rem;height:3rem;border-style:solid;border-width:.0625rem;position:absolute}[dir=ltr] .od-SharingLink-iconBackground{margin-right:.625rem}[dir=rtl] .od-SharingLink-iconBackground{margin-left:.625rem}.od-SharingLink-url .od-SharingLink-cell{width:100%}.od-SharingLink-table{display:table;width:100%}.od-SharingLink-row{display:flex;flex-wrap:wrap}.od-SharingLink-input{width:100%;text-overflow:ellipsis;margin-bottom:.1875rem;margin-top:.3125rem;font-size:.875rem;min-width:5rem;height:2rem}.od-SharingLink-removeLinkButton{margin:0;padding:.3125rem;border:0;background:0 0;cursor:pointer;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-SharingLink-removeLinkButton-leftMargin{margin-left:.25rem}[dir=rtl] .od-SharingLink-removeLinkButton-leftMargin{margin-right:.25rem}.od-SharingLink-linkSwitcher{display:inline;cursor:pointer}.od-SharingLink-linkMember{display:inline-block;padding:.125rem .25rem}.od-SharingLink-linkMember .ms-Icon{font-size:.75rem;width:1.5rem;text-align:center;line-height:1.5rem}.od-SharingLink-linkUser{width:12.5rem}.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronDown,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp{width:1.5rem;height:1.5rem;border-radius:50%;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";display:inline-block;margin:0 .25rem;line-height:1.5rem}.od-SharingLink-linkUser .ms-Icon--ChevronDown:before,.od-SharingLink-linkUser .ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--chevronDown:before{line-height:1.5rem;display:table-cell;width:1.5rem;text-align:center}.od-SharingLink-chevron{font-size:.6875rem}[dir=ltr] .od-SharingLink-chevron{margin-left:.25rem}[dir=rtl] .od-SharingLink-chevron{margin-right:.25rem}.od-SharingLink-sharingHint{display:inline;border:none;background:0 0;padding:0;cursor:pointer;font-size:.75rem}html[dir=ltr] .od-SharingLink-sharingHint{text-align:left}html[dir=rtl] .od-SharingLink-sharingHint{text-align:right}.od-SharingLink-anonymous{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-SharingLink-csl{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-SharingLink-psl{color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:"}.od-SharingLink-generic{border-color:transparent}.od-SharingLink-anonymous-bg{background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";border-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";opacity:.1}.od-SharingLink-csl-bg{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";opacity:.1}.od-SharingLink-psl-bg{background-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";border-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";opacity:.1}.od-SharingLink-generic-bg{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html[dir=ltr] .od-SharingLink-lock{margin-left:.75rem}html[dir=rtl] .od-SharingLink-lock{margin-right:.75rem}.od-SharingLink-sharingHintContainer{display:flex}.od-SharingLink-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400;font-size:1.0625rem;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis;padding-bottom:.1875rem;display:inline;padding-right:.3125rem}.od-SharingLink-emailText,.od-SharingLink-sharingRole-Text{font-weight:400;font-size:.75rem;padding-bottom:.1875rem;white-space:nowrap;height:auto;overflow:hidden;text-overflow:ellipsis}.od-SharingLink-secondaryText{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingLink-readonly{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-SharingLink-tooltipHost{display:inline}.od-SharingLink-infoIconToolTipBind{vertical-align:baseline;font-size:.75rem}.od-SharingLink-infoTooltipContent{font-size:.75rem}.od-SharingLink-learnMoreText{padding-left:.3125rem}"}]);var i=n(0),r=n(24),o=n(347),s=n(1964),c=n(1143),d=n(60),l=n(1114),u=n(2483),f=n(2017),p=n(2041),m=n(1139),_=n(2535),h=n(1898),b=n(39),g=n(196),v=n(2040),y=n(2028),S=n(2578),D=n(2579),I=n(2179),x=n(2599);Object(a.n)([{rawString:".od-EditLink{margin-top:20px}.od-EditLink-linkExpiresInputDiv{display:inline-block;margin:12px 0 14px}.od-EditLink-linkExpiresInput{width:40px}.od-EditLink-linkExpiresCheckbox{display:flex;flex-direction:column}.od-EditLink-setPasswordInputContainer{margin-top:12px}.od-EditLink-setPasswordInput{height:28px}.od-EditLink-invalidPasswordOutline{outline:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-EditLink-invalidPasswordError{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:12px;margin-top:8px}.od-EditLink-setPasswordCheckbox{display:flex;flex-direction:column}.od-EditLink-removeLinkHolder{align-items:center;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";display:flex;margin:34px 0}.od-EditLink-removeLinkText{font-size:14px;font-weight:400;background:0 0;border:none;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";cursor:pointer}[dir=ltr] .od-EditLink-removeLinkText{margin-left:4px}[dir=rtl] .od-EditLink-removeLinkText{margin-right:4px}.od-EditLink-passwordProtectedLinkInformationArea{margin-top:8px;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";display:flex}.od-EditLink-passwordProtectedLinkInformationTextArea{padding:10px;font-size:14px}.od-EditLink-passwordProtectedLinkInformationIcon{font-size:17px;padding-top:14px}html[dir=ltr] .od-EditLink-passwordProtectedLinkInformationIcon{padding-left:10px}html[dir=rtl] .od-EditLink-passwordProtectedLinkInformationIcon{padding-right:10px}"}]);var C=n(1805),O=n(2276),w=n(2534),E=n(10),A=function(e){function t(t){var n=e.call(this,t)||this;n.setPasswordAriaLabel=x.r;var a=t.onClose,i=t.onLinkRemoved,r=t.sharingLink;return n._onClose=a,n._onLinkRemoved=i,n._sharingLink=r,n.addBindingHandlers({selectOnFocus:p.e}),n._itemProvider=n.resources.consume(C.resourceKey),n._sharingProvider=n.resources.consume(s.resourceKey),n._engagement=n.resources.consume(o.e),n._sharingLinkExpirationHelper=new(n.managed(w.a)),n.cancelButtonText=x.e,n.createBackgroundComputed(n._computeValidInput),n.invalidPasswordText=O.invalidPasswordError,n.linkExpirationInDays=n.createObservable(n._getDefaultLinkExpirationInDays(n._sharingLink.expiration)),n.linkExpiresChecked=n.createObservable(!!n._sharingLink.expiration),n.linkExpiresInputLabel=n.createPureComputed(n._computeLinkExpiresInputLabel),n.linkExpiresText=x.i,n.passwordChanged=n.createObservable(!1),n.passwordValue=n.createObservable(""),n.updateButtonText=x.d,n.setPasswordPermissionsWarning=O.SetPasswordPermissionsWarning,n.removeLinkButtonText=x.a,n.arePasswordLinksEnabled=Object(E.isFeatureEnabled)(E.EnablePasswordProtectedLinks),n.isSetPasswordChecked=n.createObservable(!!n._sharingLink.hasPassword),n.setPasswordLabel=x.o,n.arePasswordLinksEnabled&&n._onSetPasswordChecked(),n.isPasswordInvalid=n.createComputed(n._computeIsPasswordInvalid),n.isUpdateButtonDisabled=n.createComputed(n._computeIsUpdateButtonDisabled),n}return Object(i.__extends)(t,e),t.prototype.onUpdateClick=function(){var e=this;this._logEngagementEvent("Update");var t=this._sharingLink,n=[t.item],a=this.linkExpiresChecked.peek()?this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(this.linkExpirationInDays.peek(),10)):null,i={type:t.type,role:t.role,create:!0,expiration:a,name:t.name,id:t.id};if(this.arePasswordLinksEnabled){var r=this.isSetPasswordChecked.peek(),o=r&&this.passwordChanged.peek(),s=!r&&t.hasPassword;o&&(i.password=this.passwordValue.peek()),s&&(i.password="")}this._sharingProvider.manageSharingLinks(n,i).then(function(t){e._itemProvider.invalidateItem(n[0].key,{triggerFetch:!0}),e._onClose()})},t.prototype.changePasswordInput=function(){this.passwordChanged(!0),this.passwordValue("")},t.prototype.onCancelClick=function(){this._logEngagementEvent("Cancel"),this._onClose()},t.prototype.onRemoveLinkClicked=function(){var e=this,t=this._sharingLink,n=this.resources.consume(l.e);this._logEngagementEvent("RemoveLink"),f.e(function(){e._engagement.logData({name:"Disable ".concat(t.tag," Link.SharingLink.Click"),isIntentional:!0});var a={link:t,type:t.type,role:t.role,create:!1};return e._sharingProvider.manageSharingLinks([t.item],a).then(function(t){return e._onLinkRemoved&&e._onLinkRemoved(),d.n.wrap(!0)},function(e){var t=e&&e.message||x.s;return f.t(t,x.c,n),!1})},function(e){},n,"EditLink")},t.prototype._onSetPasswordChecked=function(){this._sharingLink&&this._sharingLink.hasPassword&&this.passwordValue("        ")},t.prototype._computeValidInput=function(){var e=this.linkExpirationInDays(),t=parseInt(e,10),n=t.toString();t<=0&&t>w.n&&(n="",this.linkExpiresChecked(!1)),this.linkExpirationInDays(n)},t.prototype._computeIsPasswordInvalid=function(){var e=this.passwordValue();return this.isSetPasswordChecked()&&this.passwordChanged()&&e.length>0&&0===e.trim().length},t.prototype._computeIsUpdateButtonDisabled=function(){var e=this.linkExpiresChecked(),t=this.isSetPasswordChecked(),n=this.isPasswordInvalid();if(!e&&!t)return!1;var a=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeExpirationValidity(a)!==w.t.Valid||n},t.prototype._computeLinkExpiresInputLabel=function(){var e=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeLinkExpiresInputLabel(e)},t.prototype._getDefaultLinkExpirationInDays=function(e){var t=parseInt(w.e,10);return e&&(t=this._sharingLinkExpirationHelper.getDaysFromToday(new Date(e))),t.toString()},t.prototype._logEngagementEvent=function(e){this._engagement.logData({name:"".concat("EditLinkPanel",".").concat(e,".Click"),isIntentional:!0,extraData:{linkExpiration:this.linkExpirationInDays.peek(),hasPassword:0!==this.passwordValue.peek().length}})},t}(g.t),L=n(399),k=L.e({tagName:"od-editLink",template:'<div class="od-EditLink"><div class="od-CheckBox od-EditLink-linkExpiresCheckbox"><input type="checkbox" id="od-EditLink-linkExpires" data-bind="checked:linkExpiresChecked" class="od-CheckBox-input"><label for="od-EditLink-linkExpires" class="od-CheckBox-field" data-bind="css:{\'is-checked\':linkExpiresChecked}"><span data-bind="text:linkExpiresText,automation:\'linkExpiresText\'" class="od-Label"></span></label>\x3c!--ko if:linkExpiresChecked()--\x3e<div class="od-EditLink-linkExpiresInputDiv"><input id="od-EditLink-linkExpiresInput" class="od-EditLink-linkExpiresInput" type="number" data-bind="value:linkExpirationInDays,selectOnFocus:{isPermanent:false,isReentrant:true}"><label for="od-EditLink-linkExpiresInput"><span class="od-EditLink-linkExpiresInputLabel" data-bind="text:linkExpiresInputLabel"></span></label></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:arePasswordLinksEnabled--\x3e<div class="od-CheckBox od-EditLink-setPasswordCheckbox"><input type="checkbox" id="od-EditLink-setPassword" data-bind="checked:isSetPasswordChecked" class="od-CheckBox-input"><label for="od-EditLink-setPassword" class="od-CheckBox-field" data-bind="css:{\'is-checked\':isSetPasswordChecked}"><span data-bind="text:setPasswordLabel,automation:\'setPasswordLabel\'" class="od-Label"></span></label>\x3c!--ko if:isSetPasswordChecked()--\x3e<div class="od-EditLink-setPasswordInputContainer"><input id="od-EditLink-setPasswordInput" class="od-EditLink-setPasswordInput" type="password" data-bind="attr:{\'aria-label\':setPasswordAriaLabel,\'aria-invalid\':isPasswordInvalid()},value:passwordValue,valueUpdate:\'input\',click:changePasswordInput,selectOnFocus:{isPermanent:false,isReentrant:true},css:{\'od-EditLink-invalidPasswordOutline\':isPasswordInvalid()}"></div>\x3c!--ko if:isPasswordInvalid()--\x3e<div class="od-EditLink-invalidPasswordError" role="alert" data-bind="text:invalidPasswordText"></div>\x3c!--/ko--\x3e<div class="od-EditLink-passwordProtectedLinkInformationArea"><i class="ms-Icon ms-Icon--Info od-EditLink-passwordProtectedLinkInformationIcon" data-bind="icon:true"></i><div class="od-EditLink-passwordProtectedLinkInformationTextArea" data-bind="text:setPasswordPermissionsWarning"></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="od-EditLink-removeLinkHolder"><i class="ms-Icon ms-Icon--Delete" data-bind="icon:true"></i><button class="od-EditLink-removeLinkText" data-bind="click:onRemoveLinkClicked,text:removeLinkButtonText"></button></div><div class="od-EditLink-buttons"><button class="od-Button od-Button--primary" role="button" id="LegacyManageAccessEditLinkUpdateButton" data-bind="click:onUpdateClick,disable:isUpdateButtonDisabled"><span class="od-Button-label" data-bind="text:updateButtonText"></span></button><button class="od-Button" role="button" data-bind="click:onCancelClick"><span class="od-Button-label" data-bind="text:cancelButtonText"></span></button></div></div>',viewModel:A,synchronous:!0}),M=n(592),P=n(998),T=n(1129),U=n(1),F=n(1529),H=n(1782),R=n(1673),N=_.l,B=_.u,j={onRenderContent:function(){return U.createElement("p",{className:"od-SharingLink-infoTooltipContent"},N,U.createElement(H.e,{className:"od-SharingLink-learnMoreText",target:"_blank",href:"https://go.microsoft.com/fwlink/?linkid=2150444"},B))}},V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){return U.createElement(R.e,{tooltipProps:j,hostClassName:"od-SharingLink-tooltipHost"},U.createElement(P.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info od-SharingLink-infoIconToolTipBind"}))},t}(F.e),z=V,G=n(8),K=function(e){function t(t){var n,a=this;(a=e.call(this,t)||this).passwordProtectedLinkIndicatorLabel=x.n,a._engagement=a.resources.consume(o.e),a.link=t.link;var i=!t.isShareLinkVisible||t.isShareLinkVisible,d=a.link.kind===S.e.flexible?a._dedupeLinkMembers(a.link.linkInvitees.concat(a.link.linkMembers)):a.link.linkMembers;a.totalLinkMembers=a.createObservable(d),a._extraMembersCount=a.createPureComputed(a._getExtraMembers),a.extraMembersText=a.createPureComputed(a._getExtraMemberText),a.briefLinkMembers=a.createPureComputed(a._getBriefLinkMembers),a.extraLinkMembers=a.createPureComputed(a._getExtraLinkMembers),a.extraMembersName=a.createPureComputed(a._getExtraMembersName),a.showTotal=a.createObservable(!1),a.personaTagName=y.e.tagName,a.personaSize=7,a.isLinkVisible=a.link.type!==v.e.AppAccess&&i,a._onLinkRemoved=t.onLinkRemoved,a.isEditable=t.isEditable||!1,a.arePasswordLinksEnabled=Object(E.isFeatureEnabled)(E.EnablePasswordProtectedLinks),a.isPasswordProtectedLink=a.link&&a.link.hasPassword,a.linkEmail=a.link.email,a.sharingRoleText=f.a(null===(n=a.link)||void 0===n?void 0:n.role),a.panelOverlayTagName=I.e.tagName,a.editLinkTagName=k.tagName,a.editLinkPanelTitle=x.t,a.editLinkParams={onClose:a.onClosePanel.bind(a),onLinkRemoved:a._onLinkRemoved,sharingLink:a.link},a.showEditLinkPanel=a.createObservable(!1),a._sharingProvider=a.resources.consume(s.resourceKey),a.disableLinkText=x.a,a.shareableLinkText=_.m,a.requestAccessLinkText=_.d,a.isInheritedText=a.link.isInherited?_.r:"",a.sharingHintText=r.observable("");var l=a.resources.consume(c.resourceKey.optional);return l&&l.loadData().then(function(e){a.sharingHintText(u.e(a.link,e.CompanyDisplayName))}),a.canManageLinks=r.observable(!1),a._sharingProvider.getSharingData(a.link.item).getSettings().then(function(e){Object(E.isFeatureEnabled)(E.EnableLinkLevelManageAccess)?a.canManageLinks(a.link.linkMembers&&!a.link.isInherited&&!T.i(a.link.item)):a.canManageLinks(e.canManageLinks&&!a.link.isInherited&&!T.i(a.link.item))}),a.addBindingHandlers({tooltip:m.e,selectOnFocus:p.e,react:M.t}),a.iconComponent=P.e,a.iconComponentProps=a._getLinkIconProps(a.link),a.showNewRequestAccessUi=a.isRequestAccess&&!G.e.isActivated("49B0CDBC-BF28-4C95-AE68-ED06B971C714","10/21/2021","Show Request Access Link UI"),a.showNewRequestAccessUi&&(a.tooltipComponent=z),a}return Object(i.__extends)(t,e),t.prototype.logCopy=function(){return this._engagement.logData({name:this.link.tag+"Link.SharingLink.Copy",isIntentional:!0}),!0},t.prototype.removeSharingLink=function(){var e=this,t=this.resources.consume(l.e);f.e(function(){e._engagement.logData({name:"Disable ".concat(e.link.tag," Link.SharingLink.Click"),isIntentional:!0});var t={link:e.link,type:e.link.type,role:e.link.role,create:!1};return e._sharingProvider.manageSharingLinks([e.link.item],t).then(function(t){return e._onLinkRemoved&&e._onLinkRemoved(),d.n.wrap(!0)},function(e){return!1})},function(t){e.isReady=t},t,"SharingLink")},t.prototype.onSharingHintClick=function(){this.isEditable&&(this._engagement.logData({name:"".concat(this.link.tag,"Link.SharingLink.EditPermissions"),isIntentional:!0}),this.showEditLinkPanel(!0))},t.prototype.onClosePanel=function(){this.showEditLinkPanel(!1)},t.prototype.showTotalLinkMembers=function(){this.showTotal(!0)},t.prototype.hideTotalLinkMembers=function(){this.showTotal(!1)},t.prototype._getExtraMembers=function(){var e=(this.link.linkMembers?this.link.linkMembers.length:0)-6;return e>0?e+1:0},t.prototype._getExtraMemberText=function(){var e="",t=this._extraMembersCount();return t&&(t>99&&(e=h.sharingExtraNumberOverflow),e=b.format(h.sharingExtraNumberText,t)),e},t.prototype._getBriefLinkMembers=function(){var e=this.totalLinkMembers(),t=e?e.slice(0,5):[];return this._extraMembersCount()?t:e},t.prototype._getExtraLinkMembers=function(){var e=this.totalLinkMembers();return e?e.slice(5):[]},t.prototype._getExtraMembersName=function(){return this.totalLinkMembers().slice(5).map(function(e){return e.name}).join(_.c)},t.prototype._dedupeLinkMembers=function(e){for(var t=[],n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=r.email;t[o]||(t[o]=!0,n.push(r))}return n},t.prototype._getLinkIconProps=function(e){var t=e.kind;this.isAnonymousLink=e.audience===D.e.anyone||t===S.e.anonymousEdit||t===S.e.anonymousView,this.isCSL=e.audience===D.e.organization||t===S.e.organizationEdit||t===S.e.organizationView,this.isPSL=e.audience===D.e.specificPeople||e.audience===D.e.specificPeopleFlex,this.isGeneric=!this.isAnonymousLink&&!this.isCSL&&!this.isPSL,this.isRequestAccess=e.type===v.e.RequestAccess;var n="Link";return this.isAnonymousLink?n="Globe":this.isCSL?n="Work":this.isPSL?n="PeopleAdd":this.isRequestAccess&&(n="Mail"),{iconName:n}},t}(g.t),W=L.e({tagName:"od-sharingLink",template:'<div class="od-SharingLink" role="group" data-bind="attr:{\'aria-label\':sharingHintText}"><div class="od-SharingLink-cell od-SharingLink-iconCell"><div class="od-SharingLink-iconBackground" data-bind="css:{\'od-SharingLink-anonymous-bg\':isAnonymousLink,\'od-SharingLink-csl-bg\':isCSL,\'od-SharingLink-psl-bg\':isPSL,\'od-SharingLink-generic-bg\':isGeneric}"></div><div class="od-SharingLink-icon" role="presentation" data-bind="react:{componentType:iconComponent,props:iconComponentProps},css:{\'od-SharingLink-anonymous\':isAnonymousLink,\'od-SharingLink-csl\':isCSL,\'od-SharingLink-psl\':isPSL,\'od-SharingLink-generic\':isGeneric}"></div></div><div class="od-SharingLink-cell"><div class="od-Sharinglink-table od-Sharinglink-url"><div class="od-Sharinglink-row"><div class="od-SharingLink-cell">\x3c!--ko if:isLinkVisible--\x3e\x3c!--ko if:showNewRequestAccessUi--\x3e<div><div class="od-SharingLink-primaryTextContainer"><div class="od-SharingLink-primaryText" data-bind="text:requestAccessLinkText"></div><div class="od-SharingLink-tooltipHost" data-bind="react:{componentType:tooltipComponent}"></div></div><div class="od-SharingLink-emailText od-SharingLink-secondaryText" data-bind="text:linkEmail"></div><div class="od-SharingLink-sharingRole-Text od-SharingLink-readonly" data-bind="text:sharingRoleText"></div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:showNewRequestAccessUi--\x3e<input class="od-SharingLink-input od-TextField-field" type="text" readonly data-bind="value:link.url,selectOnFocus:{isPermanent:true},attr:{title:shareableLinkText,\'aria-label\':shareableLinkText},event:{copy:$component.logCopy.bind($component)}">\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:isLinkVisible--\x3e<span class="od-SharingLink-linkSwitcher" data-bind="text:sharingHintText"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if:canManageLinks--\x3e<div class="od-SharingLink-cell od-SharingLink-removeLinkCell"><button class="od-SharingLink-removeLinkButton" data-bind="css:{\'od-SharingLink-removeLinkButton-leftMargin\':isLinkVisible},click:removeSharingLink,attr:{title:disableLinkText,\'aria-label\':disableLinkText}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:isLinkVisible--\x3e<div class="od-SharingLink-linkSwitcher">\x3c!--ko if:isEditable--\x3e<div class="od-SharingLink-sharingHintContainer"><button class="od-SharingLink-sharingHint" data-bind="click:onSharingHintClick">\x3c!--ko text:sharingHintText--\x3e\x3c!--/ko--\x3e<i class="ms-Icon ms-Icon--ChevronDown od-SharingLink-chevron" data-bind="icon:true"></i></button>\x3c!--ko if:arePasswordLinksEnabled--\x3e\x3c!--ko if:isPasswordProtectedLink--\x3e<i class="ms-Icon ms-Icon--Lock od-SharingLink-lock" role="img" data-bind="icon:true,attr:{\'aria-label\':passwordProtectedLinkIndicatorLabel}"></i>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:!isEditable--\x3e<div class="od-SharingLink-sharingHint" data-bind="text:sharingHintText"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:link.linkMembers--\x3e<div class="od-SharingLink-linkUser"><div class="od-Sharing-briefLinkMembers">\x3c!--ko foreach:briefLinkMembers--\x3e<div class="od-SharingLink-linkMember" data-bind="component:{name:$parent.personaTagName,params:{person:$data,personaSize:$parent.personaSize}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:extraMembersText()--\x3e\x3c!--ko if:!showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronDown" role="button" data-bind="icon:true,click:showTotalLinkMembers,tooltip:{content:extraMembersName}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronUp" role="button" data-bind="icon:true,click:hideTotalLinkMembers"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:showTotal()--\x3e<div class="od-Sharing-extraLinkMembers">\x3c!--ko foreach:extraLinkMembers--\x3e<div class="od-SharingLink-linkMember" data-bind="component:{name:$parent.personaTagName,params:{person:$data,personaSize:$parent.personaSize}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:showEditLinkPanel--\x3e\x3c!--ko component:{name:panelOverlayTagName,params:{onClose:$component.onClosePanel.bind($component),title:editLinkPanelTitle}}--\x3e\x3c!--ko component:{name:editLinkTagName,params:editLinkParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:K,synchronous:!0});t.e=W},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(119),i=n(0),r=n(60),o=n(2596),s=n(2434),c=function(){function e(e,t){this._itemCommentsDataSource=t.itemCommentsDataSource,this._lastListenerId=-1,this._lastRepliesListenerId=-1,this._dictListener={},this._dictRepliesListener={},this._dictItemComments={},this._dictItemCommentReplies={},this._dictItemCommentIsDiabled={},this._dictItemCommentSettingsListener={},this._promiseDeduplicator=new s.e}return e.prototype.addListener=function(e,t){this._lastListenerId++;var n=t.commentItemWrapper,a={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(a);return this._dictListener[i]||(this._dictListener[i]={}),this._dictListener[i][this._lastListenerId]=e,this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled,{key:this._lastListenerId,itemKey:i}},e.prototype.removeListener=function(e){this._dictListener[e.itemKey]&&this._dictListener[e.itemKey][e.key]?delete this._dictListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")},e.prototype.fetchItemComments=function(e){var t=this,n={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},a=this._getItemActivitiesDictionaryKey(n),o=this._dictItemComments[a];(!o||0===e.startIndex)&&(o={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var s=o.itemComments;if(s.nextLink||e.itemWrapper.item&&0===e.startIndex){var c=this._dictItemComments[a]&&this._dictItemComments[a].noOfUnsuccessfulRequests||0,d=(s.nextLink||e.itemWrapper.item.id)+"_"+c;this._promiseDeduplicator.deduplicate(d,function(){var d={itemWrapper:e.itemWrapper,nextLink:s.nextLink,currentUserEmail:e.currentUserEmail,qosPrefix:e.qosPrefix,qosExtraData:e.qosExtraData};return t._itemCommentsDataSource.getComments(d).then(function(r){if(r&&r.success||o.noOfUnsuccessfulRequests>3){var d=t._updatedComments(s,r);t._dictItemComments[a]={itemComments:d,noOfUnsuccessfulRequests:0};for(var l=0,u=d.comments;l<u.length;l++){var f=u[l],p=f.action&&f.action.comment&&f.action.comment.commentDetail,m=t._getItemCommentRepliesDictionaryKey(n,p.id);t._dictItemCommentReplies[m]={itemComments:p.replies,noOfUnsuccessfulRequests:0}}t._emitChange(n)}else r&&r.isPermanentFailure||c>=3?(t._dictItemComments[a]={itemComments:Object(i.__assign)(Object(i.__assign)({},s),{missingComments:!0}),noOfUnsuccessfulRequests:c+1},e.onError&&e.onError(),t._emitChange(n)):(t._dictItemComments[a]={itemComments:s,noOfUnsuccessfulRequests:c+1},t.fetchItemComments(e))},function(t){return e.onError&&e.onError(),r.n.reject(t)})})}},e.prototype.addRepliesListener=function(e,t,n){this._lastRepliesListenerId++;var a=this._getItemCommentRepliesDictionaryKey(t,n);return this._dictRepliesListener[a]||(this._dictRepliesListener[a]={}),this._dictRepliesListener[a][this._lastRepliesListenerId]=e,{key:this._lastRepliesListenerId,itemKey:a}},e.prototype.removeRepliesListener=function(e){this._dictRepliesListener[e.itemKey]&&this._dictRepliesListener[e.itemKey][e.key]?delete this._dictRepliesListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")},e.prototype.getItemComments=function(e){var t={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},n=this._getItemActivitiesDictionaryKey(t),a=this._dictItemComments[n];return a?a.noOfUnsuccessfulRequests>3?Object(i.__assign)(Object(i.__assign)({},a.itemComments),{missingComments:!0}):a.itemComments:(this.fetchItemComments(Object(i.__assign)(Object(i.__assign)({},e),{startIndex:a?e.startIndex:0})),{isPlaceHolder:!0,comments:void 0,success:!0})},e.prototype.addComment=function(e,t,n,a){return this._itemCommentsDataSource.addComment(e,t,n,a)},e.prototype.addItemCommentReply=function(e,t,n){return this._itemCommentsDataSource.addReply(e.itemWrapper,t,n,e.qosPrefix)},e.prototype.getItemCommentReplies=function(e,t){var n={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},a=this._getItemCommentRepliesDictionaryKey(n,t),r=this._dictItemCommentReplies[a];return r?r.itemComments:(this.fetchItemCommentReplies(Object(i.__assign)(Object(i.__assign)({},e),{startIndex:0}),t),{isPlaceHolder:!0,comments:void 0,success:!0})},e.prototype.addCommentSettingsListener=function(e,t){var n=t.commentItemWrapper,a={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(a);return this._dictItemCommentSettingsListener[i]=e,this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled,{key:1,itemKey:i}},e.prototype.removeCommentSettingsListener=function(e){this._dictItemCommentSettingsListener[e.itemKey]&&this._dictItemCommentSettingsListener[e.itemKey][e.key]?delete this._dictItemCommentSettingsListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")},e.prototype.fetchIsCommentsDisabled=function(e){return this._itemCommentsDataSource.getIsCommentsDisabled(e)},e.prototype.getIsCommentsDisabled=function(e,t){var n={item:e.activityItemWrapper,currentUserEmail:t},a=this._getItemActivitiesDictionaryKey(n);return this._dictItemCommentIsDiabled[a]},e.prototype.setCommentsDisabled=function(e,t,n){var a=this;return this._itemCommentsDataSource.setCommentsDisabled(e,t).then(function(i){var r={item:e.activityItemWrapper,currentUserEmail:n},o=a._getItemActivitiesDictionaryKey(r);return a._dictItemCommentIsDiabled[o]=t,a._emitCommentsSettingChange(r),i})},e.prototype.deleteCommentById=function(e,t,n,a){var s=this;return this._itemCommentsDataSource.deleteCommentById(e,t,a).then(function(){var a={item:e.activityItemWrapper,currentUserEmail:n},c=s._getItemActivitiesDictionaryKey(a),d=s._dictItemComments[c],l=d&&d.itemComments&&d.itemComments.comments;if(l){var u=l.filter(function(e){return(e&&e.action&&e.action.comment&&e.action.comment.commentId)!==t});s._dictItemComments[c]=Object(i.__assign)(Object(i.__assign)({},d),{itemComments:Object(i.__assign)(Object(i.__assign)({},d.itemComments),{comments:u})}),s._emitChange(a,o.e.DeletedSingle)}return r.n.resolve(!0)},function(e){return r.n.reject(e)})},e.prototype.deleteAllComments=function(e,t){var n=this;return this._itemCommentsDataSource.deleteAllComments(e).then(function(){var a={item:e.activityItemWrapper,currentUserEmail:t},i=n._getItemActivitiesDictionaryKey(a);return n._dictItemComments[i]=void 0,n._emitChange(a,o.e.DeletedAll),r.n.resolve(!0)},function(e){return r.n.reject(e)})},e.prototype.fetchItemCommentReplies=function(e,t){var n=this,a={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},i=this._getItemCommentRepliesDictionaryKey(a,t),o=this._dictItemCommentReplies[i];(!o||0===e.startIndex)&&(o={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var s=o.itemComments;if(s.nextLink||e.itemWrapper.item&&0===e.startIndex){var c=(s.nextLink||e.itemWrapper.item.id)+"_"+o.noOfUnsuccessfulRequests;this._promiseDeduplicator.deduplicate(c,function(){var c={itemWrapper:e.itemWrapper,nextLink:s.nextLink,currentUserEmail:e.currentUserEmail,qosPrefix:e.qosPrefix};return n._itemCommentsDataSource.getReplies(c,t).then(function(r){var c=n._dictItemCommentReplies[i]&&n._dictItemCommentReplies[i].noOfUnsuccessfulRequests||0;r&&r.success||c>3?(n._dictItemCommentReplies[i]={itemComments:n._updatedCommentWithReplies(s,r),noOfUnsuccessfulRequests:c},n._emitChangeForReplies(a,t)):(n._dictItemComments[i]={itemComments:s,noOfUnsuccessfulRequests:o.noOfUnsuccessfulRequests+1},n.fetchItemCommentReplies(e,t))},function(e){return r.n.reject(e)})})}},e.prototype._emitChange=function(e,t){var n=this._getItemActivitiesDictionaryKey(e),a=this._dictListener[n];if(a)for(var i=0,r=Object.getOwnPropertyNames(a);i<r.length;i++)(0,a[r[i]])(t)},e.prototype._emitChangeForReplies=function(e,t){var n=this._getItemCommentRepliesDictionaryKey(e,t),a=this._dictRepliesListener[n];if(a)for(var i=0,r=Object.getOwnPropertyNames(a);i<r.length;i++)(0,a[r[i]])()},e.prototype._emitCommentsSettingChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictItemCommentSettingsListener[t];n&&n()},e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item&&(e.item.graphItemUrl||e.item.absolutePath);return e.currentUserEmail&&(t+="_"+e.currentUserEmail),t},e.prototype._getItemCommentRepliesDictionaryKey=function(e,t){var n=e.item&&(e.item.graphItemUrl||e.item.absolutePath);return e.currentUserEmail&&t&&(n+="_".concat(e.currentUserEmail,"_").concat(t)),n},e.prototype._updatedComments=function(e,t){return{comments:(e&&e.comments||[]).concat(t.comments),nextLink:t.nextLink,success:!0}},e.prototype._updatedCommentWithReplies=function(e,t){var n=e&&e.comments||[];return{comments:t.comments.concat(n),nextLink:t.nextLink,success:!0}},e}(),d=n(67),l=Object(a.r)("ItemCommentsStore",c,{itemCommentsDataSource:d.L.optional})}],Array(33),[function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(1),r=n(2363),o=n(2364),s=n(2105),c=n(1840),d=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderIcon=function(e){return e.activityPersonas?n._onRenderPersonaArray(e):n.props.activityIcon},n._onRenderActivityDescription=function(e){var t=n._getClassNames(e),a=e.activityDescription||e.activityDescriptionText;return a?i.createElement("span",{className:t.activityText},a):null},n._onRenderComments=function(e){var t=n._getClassNames(e),a=e.comments||e.commentText;return!e.isCompact&&a?i.createElement("div",{className:t.commentText},a):null},n._onRenderTimeStamp=function(e){var t=n._getClassNames(e);return!e.isCompact&&e.timeStamp?i.createElement("div",{className:t.timeStamp},e.timeStamp):null},n._onRenderPersonaArray=function(e){var t=n._getClassNames(e),r=null,o=e.activityPersonas;if(o[0].imageUrl||o[0].imageInitials){var d=[],l=o.length>1||e.isCompact,u=e.isCompact?3:4,f=void 0;e.isCompact&&(f={display:"inline-block",width:"10px",minWidth:"10px",overflow:"visible"}),o.filter(function(e,t){return t<u}).forEach(function(e,n){d.push(i.createElement(s.e,Object(a.__assign)({},e,{key:e.key||n,className:t.activityPersona,size:l?c.n.size16:c.n.size32,style:f})))}),r=i.createElement("div",{className:t.personaContainer},d)}return r},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.onRenderIcon,n=void 0===t?this._onRenderIcon:t,a=e.onRenderActivityDescription,r=void 0===a?this._onRenderActivityDescription:a,o=e.onRenderComments,s=void 0===o?this._onRenderComments:o,c=e.onRenderTimeStamp,d=void 0===c?this._onRenderTimeStamp:c,l=e.animateBeaconSignal,u=e.isCompact,f=this._getClassNames(this.props);return i.createElement("div",{className:f.root,style:this.props.style},(this.props.activityPersonas||this.props.activityIcon||this.props.onRenderIcon)&&i.createElement("div",{className:f.activityTypeIcon},l&&u&&i.createElement("div",{className:f.pulsingBeacon}),n(this.props)),i.createElement("div",{className:f.activityContent},r(this.props,this._onRenderActivityDescription),s(this.props,this._onRenderComments),d(this.props,this._onRenderTimeStamp)))},t.prototype._getClassNames=function(e){return Object(r.e)(Object(o.e)(void 0,e.styles,e.animateBeaconSignal,e.beaconColorOne,e.beaconColorTwo,e.isCompact),e.className,e.activityPersonas,e.isCompact)},t}(i.Component)}],Array(37),[function(e,t,n){"use strict";n.d(t,"t",function(){return F});var a='<div class="InfoPane-section InfoPaneSection--information" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}">\x3c!--ko if:!isHeaderHidden--\x3e<div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h3 class="InfoPane-sectionHeaderText" data-bind="text:informationHeader"></h3></div>\x3c!--/ko--\x3e<div class="InfoPane-sectionContent"><dl class="InfoPaneSection-informationBody" data-bind="template:{name:getEntryType,foreach:entries}"></dl></div></div>',i=(n(2531),n(0)),r=n(196),o=n(6),s=n(2110),c=n(1898),d=n(2628),l=n(1870),u=n(94),f=n(2353),p=n(1144),m=n(351),_=n(14),h=n(65),b=n(597),g=n(39),v=n(36),y=n(474),S=n(439),D=n(2402),I=n(1129),x=n(1973),C=n(1807),O=n(377),w=n(67),E=n(2175),A=n(1861),L=n(16);function k(e){var t=e.condition,n=e.value;return t?t():n()&&n().length>0}var M=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.useItemsScope,r=n.itemCacheObservablesFactory;a._itemCacheObservablesFactory=r;var o=a._changeFolderTypeAction=new(a.managed(d.e))({}),u=a.resources;a._urlDataSource=u.consume(w.Se),a._itemParentHelper=u.consume(l.e),a._fileHandlerProvider=u.consume(A.e.local),a._useItemsScope=i,a._item=t.item;var f=a.observables;if(a._isCustomList=f.pureCompute(a._computeIsCustomList),i.peek()){var p=u.consume(b.e);a._itemsScopeItemKey=p.itemsScopeItemKey,a._itemsScopePath=a._itemCacheObservablesFactory.pureCompute(function(e){return a._computeItemsScopePath(e)})}a.strings=c,a.isHeaderHidden=!!t.isHeaderHidden,a.informationHeader=a.strings.generalInformationHeader,a.sectionHelper=new(a.managed(E.e)),a.addBindingHandlers({toggle:s.e}),a._audio=f.pureCompute(a._computeAudio);var m=u.consume(w.D).getIdentity().type===O.e.anonymous?f.create():f.pureCompute(a._computePath),_=f.createArray([{title:c.informationFiletype,value:f.pureCompute(a._computeFileType)},{title:c.informationFolderType,condition:f.pureCompute(a._computeIsFolderTypeVisible),value:f.pureCompute(a._computeFolderType),className:"InfoPaneSection-information-folderType",editClassName:"InfoPaneSection-information-changeFolderType",onEdit:function(e){return o.execute(e),!1},editText:c.informationFolderTypeChange},{title:c.informationVisitorViews,value:f.pureCompute(a._computeVisitorViews)},{title:c.informationDateTaken,value:f.pureCompute(a._computeDateTaken)},{title:c.informationDimensions,value:f.pureCompute(a._computeDimensions)},{title:c.informationDuration,value:f.pureCompute(a._computeDuration)},{title:c.informationBitrate,value:f.pureCompute(a._computeBitRate)},{title:c.informationCamera,value:f.pureCompute(a._computeCamera)},{title:c.informationShot,value:f.pureCompute(a._computeShot)},{title:c.informationTitle,value:f.pureCompute(a._computeTitle)},{title:c.informationAlbum,value:f.pureCompute(a._computeAlbum)},{title:c.informationAlbumArtist,value:f.pureCompute(a._computeAlbumArtist)},{title:c.informationArtist,value:f.pureCompute(a._computeArtist)},{title:c.informationTrack,value:f.pureCompute(a._computeTrack)},{title:c.informationDisc,value:f.pureCompute(a._computeDisc)},{title:c.informationComposers,value:f.pureCompute(a._computeComposers)},{title:c.informationGenre,value:f.pureCompute(a._computeGenre)},{title:c.informationYear,value:f.pureCompute(a._computeYear)},{title:c.informationCopyright,value:f.pureCompute(a._computeCopyright)},{title:c.informationLocations,value:f.pureCompute(a._computeLocations)},{title:c.informationModified,value:f.pureCompute(a._computeModified)},{title:c.informationDeleted,value:f.pureCompute(a._computeDeleted)},{title:c.informationAddedBy,value:f.pureCompute(a._computeAddedBy)},{title:c.informationDateCreated,value:f.pureCompute(a._computeCreated)},{title:c.informationDateShared,value:f.pureCompute(a._computeDateShared)},{title:c.informationPath,value:m,className:"InfoPaneSection-information-path"},{title:c.informationOriginalLocation,value:f.pureCompute(a._computeOriginalLocation)},{title:c.informationSize,value:f.pureCompute(a._computeSize)},{title:c.informationPanoramaResolution,value:f.pureCompute(a._computePanoramaResolution)},{title:c.informationPanoramaRange,value:f.pureCompute(a._computePanoramaRange)}]);return a.entries=a.addDisposable(_.filter(k)),a}return Object(i.__extends)(t,e),t.prototype.getEntryType=function(e){return e.editText?"ms-information-editableentry":Array.isArray(e.value())?"ms-information-iterableentry":"ms-information-basicentry"},t.prototype._computeAudio=function(){return this._item().audio},t.prototype._computeTitle=function(){var e=this._audio();return e&&e.title},t.prototype._computeAlbum=function(){var e=this._audio();return e&&(e.album||c.informationUnknownAlbum)},t.prototype._computeAlbumArtist=function(){var e=this._audio();return e&&e.albumArtist},t.prototype._computeArtist=function(){var e=this._audio();return e&&(e.artist||c.informationUnknownArtist)},t.prototype._computeTrack=function(){var e=this._audio(),t=e&&e.track,n=e&&e.trackCount;return t?n?g.format(c.informationTrackAndDiscFormat,t,n):"".concat(t):""},t.prototype._computeDisc=function(){var e=this._audio(),t=e&&e.disc,n=e&&e.discCount;if(e&&(t>1||n>1))return n>=t?g.format(c.informationTrackAndDiscFormat,t,n):t&&"".concat(t)},t.prototype._computeComposers=function(){var e=this._audio();return e&&e.composers},t.prototype._computeGenre=function(){var e=this._audio();return e&&e.genre},t.prototype._computeYear=function(){var e=this._audio();return e&&e.year&&"".concat(e.year)},t.prototype._computeCopyright=function(){var e=this._audio();return e&&e.copyright},t.prototype._computeFileType=function(){var e=this._item();if(!e.isBundle&&void 0===e.virtualItemType){var t=this._fileHandlerProvider,n=e.extension,a=t&&n&&t.getFileTypeName(n);return I.t(e,this._isCustomList(),a)}},t.prototype._computeIsFolderTypeVisible=function(){var e=this._item();return e.type===u.e.Folder&&!e.isBundle&&!e.isSpecialFolder&&(!e.vault||!e.vault.isLocked)&&void 0===e.virtualItemType&&this._changeFolderTypeAction.isAvailable()},t.prototype._computeDateTaken=function(){var e=this._item(),t=(e.photo||e.video)&&e;return t?t.dateTakenTime?Object(C.r)(t.dateTakenTime,!0):t.dateTaken:""},t.prototype._computeFolderType=function(){switch(this._item().category){case f.e.documents:return c.informationFolderTypeDocuments;case f.e.photos:return c.informationFolderTypePhotos;case f.e.favorites:return c.informationFolderTypeFavorites}return""},t.prototype._computeVisitorViews=function(){var e=this._item().statistics.views;return e&&"".concat(e)},t.prototype._computeDimensions=function(){var e=this._item(),t=e.video||!e.panorama&&e.photo||{},n=t.width,a=t.height;return n&&a?g.format(c.informationDimensionsFormat,n,a):""},t.prototype._computeDuration=function(){var e=this._item().video,t=e&&e.duration;return t>0?D.e(t):""},t.prototype._computeBitRate=function(){var e=this._item().video,t=e&&e.bitrate;if(t){var n=1e6,a=t>n?"Mega":"Kilo",i=t>n?n:1e3;return g.format(c["information"+a+"BitrateFormat"],Math.floor(t/i))}},t.prototype._computeCamera=function(){var e=this._item(),t=e.photo,n=e.video;return t&&t.cameraModel||n&&n.cameraModel},t.prototype._computeShot=function(){var e=this._item().photo;if(e){var t=e.exposureNumerator,n=e.exposureDenominator,a=t&&"".concat(t);n&&1!==n&&(a=g.format(c.informationShotExposureFormat,t,n));var i=e.focalRatio?"".concat(e.focalRatio):"";i=i&&g.format(c.informationShotFStopFormat,i);var r=e.focalLength?"".concat(e.focalLength):"";return[a,i,r=r&&g.format(c.informationShotFocalLengthFormat,r)].join(" ").trim()}},t.prototype._computeLocations=function(){var e=this._item().locations;if(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];i&&t.push(i)}return t}},t.prototype._computeModified=function(){var e=this._item(),t=e.dateModified&&e.dateModified.trim().length>0;if(!this._urlDataSource.isRecycleBin(e.queryType)&&t)return e.dateModifiedTime?Object(C.r)(e.dateModifiedTime):e.dateModified},t.prototype._computeDeleted=function(){var e=this._item();if(this._urlDataSource.isRecycleBin(e.queryType))return e.dateDeletedTime?Object(C.r)(e.dateDeletedTime):e.dateDeleted},t.prototype._computeAddedBy=function(){return this._item().creatorName},t.prototype._computeCreated=function(){var e=this._item();return e.dateCreatedTime?Object(C.r)(e.dateCreatedTime):e.dateCreated},t.prototype._computeDateShared=function(){var e=this._item();return e.dateSharedTime?Object(C.r)(e.dateSharedTime):e.dateShared},t.prototype._computePath=function(){var e=this._item();if(this._useItemsScope&&this._useItemsScope()&&!L.e.isActivated("360FC0DF-53A3-40D6-BBE9-DBF4AA62F9F2","2/26/2021","use itemsScope data path"))return this._itemsScopePath();if(!e.audio&&e.UNSAFE_parent&&!this._urlDataSource.isRecycleBin(e.queryType)){for(var t=[],n=e;n;n=n.UNSAFE_parent)t.unshift(n.name);return t}},t.prototype._computeOriginalLocation=function(){var e=this._item();if(this._urlDataSource.isRecycleBin(e.queryType)||Object(y.e)(e.queryType)||e.queryType===v.e.SharedWithMe)return e.location},t.prototype._computeSize=function(){var e=this._item();return e.size&&S.e.getDisplayString(e.size,{ignoreZero:!0})},t.prototype._computePanoramaResolution=function(){var e=this._item().panorama,t=e&&e.resolution;if(t)return g.format(c.informationPanoramaResolutionFormat,t)},t.prototype._computePanoramaRange=function(){var e=this._item().panorama||{},t=e.horizontalFov,n=e.verticalFov;if(t&&n)return g.format(c.informationPanoramaRangeFormat,Math.round(t),Math.round(n))},t.prototype._computeIsCustomList=function(){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item(),"list"));return!!e&&!e.list.isDocumentLibrary},t.prototype._computeItemsScopePath=function(e){var t,n,a,i,r,s,c,d=e.demandItemFacet(h.e,this._itemsScopeItemKey)||{};if((null===(n=(t=this._urlDataSource).isCurrentQuerySharedWithMe)||void 0===n?void 0:n.call(t,d))||(null===(i=(a=this._urlDataSource).isCurrentQuerySharedByMe)||void 0===i?void 0:i.call(a,d))||(null===(s=(r=this._urlDataSource).isCurrentQueryRecent)||void 0===s?void 0:s.call(r,d)))return[];for(var l=this._item(),u=this._urlDataSource.getKeyParams(l.key),f=e.demandItemFacet(m.e,_.i),p=m.e.evaluate(f)(e,{viewParams:u,isNavigation:!1}).itemKey,b=[];p;){var g=e.demandItemFacet(o.u,p);g&&b.unshift(g),p=null===(c=e.demandItemFacet(o.k,p))||void 0===c?void 0:c.itemKey}return b},t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.t.dependencies),{itemCacheObservablesFactory:p.e,useItemsScope:x.e}),t}(r.t),P=n(399),T=n(179),U=Object(P.e)({tagName:"ms-information-info-pane-section",template:a,viewModel:M,synchronous:!0}),F=Object(T.t)({automationName:"ms-information-info-pane-section",name:"InformationSection",template:a,viewModelType:M});Object(P.t)("ms-information-basicentry",'<dt data-bind="text:title"></dt><dd data-bind="class:$data.className,text:value"></dd>'),Object(P.t)("ms-information-editableentry",'<dt data-bind="text:title"></dt><dd><div data-bind="class:$data.className,text:value"></div><a href="javascript:;" data-bind="class:$data.editClassName,click:onEdit,text:editText"></a></dd>'),Object(P.t)("ms-information-iterableentry",'<dt data-bind="text:title"></dt><dd data-bind="foreach:{data:value}"><div data-bind="class:$parent.className,text:$data"></div></dd>'),t.e=U}],Array(67),[function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-DetailsPane-ItemActivityFeedSection{margin:12px 0;padding:0 16px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";padding:14px 16px;border-radius:2px}.isFluentVNext .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.isFluentVNext .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.isFluentVNext .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{border-radius:4px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-grouplistTitle{margin-bottom:8px;margin-top:16px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivity-item-focusZone{margin:8px 0}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{margin:0 -38px 0 0;width:calc(100% - 32px);display:inline-block}html[dir=rtl] .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{margin:0 0 0 -38px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities{font-size:12px;margin:8px 0}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 0 0 16px}html[dir=rtl] .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 16px 0 0}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-timeStamp{padding-top:2px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-missingActivity{margin-bottom:8px}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityTypeIcon{font-size:16px!important;width:32px;text-align:center;margin-top:8px}.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.isFluentVNext .od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.isFluentVNext .od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.isFluentVNext .od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.Files-rightPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{width:calc(100% - 32px)}.Files-infoPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse,.OneUp-infoPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{width:calc(100% - 32px)}"}])}],Array(64),[function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"Unknown",function(){return Q}),n.d(a,"HasAccess",function(){return Y}),n.d(a,"NoAccess",function(){return J});var i={};n.r(i),n.d(i,"ACCESS_TYPE",function(){return X}),n.d(i,"DATA_MENTION_EMAIL_ID",function(){return Z}),n.d(i,"CONTENT_EDITABLE",function(){return $});var r=n(0),o=n(1),s=n(1800),c=n(2366),d=n(17);Object(d.n)([{rawString:".od-ItemActivityFeed-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-ItemActivityFeed{-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:14px;display:flex;flex-direction:column;flex:1 1 auto}.od-ItemActivityFeedListEmpty{flex:1 1 auto;display:flex;flex-direction:column;justify-content:center}"}]);var l=n(2481),u=n(2596),f=n(96),p=n(3036),m=n(435),_=n(112),h=n(1786),b=n(434),g=n(1750),v=n(345),y=n(2279),S=n(1781);Object(d.n)([{rawString:".od-ItemActivityList-activity-withCommentResponse{display:inline-block;margin-bottom:0;margin-right:-38px}.od-ItemActivityList-activity-commentWithContent .od-ItemActivity-item-textContent{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ItemActivityList-activity-Shimmer{width:calc(100% - 32px);background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";padding:14px 16px}.od-ItemActivityList-activity-Shimmer .ms-Shimmer-container{width:100%}.od-ItemActivityList-activity{width:calc(100% - 32px)}.od-ItemActivityList-activity .od-ItemActivity-item-textContent{word-wrap:break-word}.od-ItemActivityList-activity .od-ItemActivity-item{max-width:100%}.od-ItemActivity-item .livePersonaCardAdapterRoot{display:inline}.od-ItemActivity-item-focusZone{flex-grow:1;max-width:100%}.od-ItemActivity-item-focusZone:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ItemActivity-item-focusZone:focus-visible{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ItemActivity-contextMenu{display:inline-block;vertical-align:top;margin-top:6px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-ItemActivity-contextMenu.is-expanded,.od-ItemActivity-contextMenu:active,.od-ItemActivity-contextMenu:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.isTeamsApp .od-ItemActivity-contextMenu.ms-Button:hover,.od-DetailsPane-SecondaryPane-body .od-ItemActivity-contextMenu.ms-Button:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.isTeamsApp .od-ItemActivity-contextMenu.ms-Button.is-expanded,.isTeamsApp .od-ItemActivity-contextMenu.ms-Button:active,.od-DetailsPane-SecondaryPane-body .od-ItemActivity-contextMenu.ms-Button.is-expanded,.od-DetailsPane-SecondaryPane-body .od-ItemActivity-contextMenu.ms-Button:active{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.od-ItemActivity-item-focusZone .od-ItemActivity-contextMenu-opacity{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";opacity:0}.od-ItemActivity-item-focusZone .od-ItemActivity-contextMenu-opacity.is-expanded{opacity:1}.od-ItemActivity-item-focusZone:focus .od-ItemActivity-contextMenu-opacity,.od-ItemActivity-item-focusZone:hover .od-ItemActivity-contextMenu-opacity{opacity:1}.od-ItemActivity-item-focusZone:focus-within .od-ItemActivity-contextMenu-opacity{opacity:1}.od-itemActivity-commentActivity-commentContent{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";white-space:pre-wrap;word-wrap:break-word}.od-itemActivity-commentActivity-commentContent a,.od-itemActivity-commentActivity-commentContent a:active,.od-itemActivity-commentActivity-commentContent a:hover,.od-itemActivity-commentActivity-commentContent a:visited{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none}@media (forced-colors:active){.od-itemActivity-commentActivity-commentContent a.lpc-hoverTarget,.od-itemActivity-commentActivity-commentContent a:active.lpc-hoverTarget,.od-itemActivity-commentActivity-commentContent a:hover.lpc-hoverTarget,.od-itemActivity-commentActivity-commentContent a:visited.lpc-hoverTarget{color:ButtonText}}.od-ItemActivityList-missingActivity{justify-content:center}.od-ItemActivityList-activity-commentResponse{padding:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";margin-bottom:8px}.od-ItemActivityList-commentReply{padding:8px 8px 8px 24px}[dir=rtl] .od-ItemActivityList-commentReply{padding:8px 24px 8px 8px}.od-ItemActivityList-loadMoreReplies{text-align:center;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemActivityList-grouplistTitle{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:"},{theme:"smallFontWeight",defaultValue:"400"},{rawString:";font-weight:600;margin-top:16px;margin-bottom:8px}.od-ItemActivity-menuItems{min-width:108px;padding:0}.od-ItemActivityList-activity-withHiddenReply{padding:0}"}]);var D=n(1499),I=n(318),x={display:"flex",flexWrap:"wrap",width:"100%"},C=function(){return o.createElement("div",{style:x},o.createElement(D.e,{shimmerElements:[{type:I.e.circle,height:32,verticalAlign:"top"},{type:I.e.gap,width:14,height:54}]}),o.createElement(D.e,{flexWrap:!0,width:"calc(100% - 46px)",shimmerElements:[{type:I.e.line,width:"50%",height:12,verticalAlign:"top"},{type:I.e.gap,width:"50%",height:18},{type:I.e.line,width:"90%",height:12,verticalAlign:"top"},{type:I.e.gap,width:"10%",height:18},{type:I.e.line,width:"40%",height:10,verticalAlign:"top"},{type:I.e.gap,width:"60%",height:10,verticalAlign:"top"}]}))},O=function(){return o.createElement("div",{style:x},o.createElement(D.e,{shimmerElements:[{type:I.e.line,height:32,width:32},{type:I.e.gap,width:12,height:44}]}),o.createElement(D.e,{flexWrap:!0,width:"calc(100% - 44px)",shimmerElements:[{type:I.e.line,width:"90%",height:12},{type:I.e.gap,width:"10%",height:22},{type:I.e.line,width:"40%",height:10},{type:I.e.gap,width:"60%",height:10}]}))},w=n(801),E=n(1529),A=new(n(164).e),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onScrollEvent=function(e){var n=t.props,a=n.onGetMoreActivities,i=n.activityIndex;A.setTimeout(function(){t._isCurrentElementInView()&&a(i,!0)},100)},t}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.onGetMoreActivities,n=e.activityIndex;this._containingScrollablePane=this._findContainingScrollablePane(),this._isCurrentElementInView()&&t(n),this._containingScrollablePane&&this._events.on(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)},t.prototype.componentWillUnmount=function(){this._containingScrollablePane&&this._events.off(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)},t.prototype.render=function(){var e=this;return o.createElement("div",{ref:function(t){return e._missingActivityElement=t}},o.Children.only(this.props.children))},t.prototype._findContainingScrollablePane=function(){return Object(w.i)(this._missingActivityElement)},t.prototype._isCurrentElementInView=function(){if(this._missingActivityElement&&this._containingScrollablePane){var e=this._missingActivityElement.getBoundingClientRect(),t=this._containingScrollablePane.getBoundingClientRect(),n=e.top,a=e.bottom,i=t.top,r=t.bottom;return n<=r&&n>=i||a>=i&&a<=r}return!1},t}(E.e),k=L,M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderCell=function(e,n,a){var i=t.props,r=i.onRenderMissingActivity,s=i.enableShimmer,c=i.isDataReady,d=i.isNewCommentExperienceEnabled,l=i.deeplinkCommentThreadId,u=i.onHighlightCommentCard,f=i.commentsOnly;if(n){if(!c&&s)return o.createElement("div",{className:"od-ItemActivityList-activity-Shimmer"},o.createElement(S.e,{customElementsGroup:f?C():O()}));var m=n.getCommentThreadId(),_=m&&m===l;return _&&u&&u(),o.createElement(p.default,{key:n.getKey(),activity:n,isInGrid:!0,isNewCommentExperienceEnabled:d,isFocusedOnFirstLoad:_})}if(r)return o.createElement(k,{activityIndex:a,onGetMoreActivities:t._onRequestMissingItemActivity},o.createElement("div",{className:"od-ItemActivityList-activity od-ItemActivityList-missingActivity"},o.createElement(h.e,{size:b.e.large})))},t._onRenderHeader=function(e){var n=e.group,a=t.props.groupHeadingLevel,i=void 0===a?4:a;return o.createElement("div",{role:"heading","aria-level":i,className:"od-ItemActivityList-grouplistTitle"},n.name)},t._onRequestMissingItemActivity=function(e,n){var a=t.props.onRenderMissingActivity;n&&f.e.logData({name:"ItemActivityFeed.scrolled",isIntentional:!0}),a&&a(e,n)},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.activities,n=e.groups;return o.createElement(g.e,{direction:v.e.vertical,isCircularNavigation:!1,isInnerZoneKeystroke:function(e){return e.which===Object(m.t)(_.e.right)}},o.createElement(y.e,{items:t,onRenderCell:this._onRenderCell,groupProps:{onRenderHeader:this._onRenderHeader},groups:n,onShouldVirtualize:function(){return!1}}))},t}(o.Component),P=M,T=n(2564);Object(d.n)([{rawString:".od-mentionableTextBox-buttons{display:flex;flex-direction:row-reverse;cursor:text}.od-addNewCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset;margin:4px}.od-addNewCommentTextField-spinner{display:flex;flex-direction:column;justify-content:center;margin:4px}.od-addNewCommentTextField-mentionableTextBox-outer{width:auto;height:auto;background:"},{theme:"white",defaultValue:"#fff"},{rawString:";padding:1px;border-width:1px;border-style:solid;border-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";box-sizing:border-box;border-radius:2px;display:flex;flex-direction:column}.od-addNewCommentTextField-mentionableTextBox-outer-disabled{width:auto;height:auto;background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:0;border-width:1px;border-style:solid;border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";box-sizing:border-box;border-radius:2px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-addNewCommentTextField-mentionableTextBox-outer:focus-within{background:"},{theme:"white",defaultValue:"#fff"},{rawString:";padding:0;border-width:2px;border-style:solid;border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-sizing:border-box;border-radius:2px}.od-addNewCommentTextField-mentionableTextBox-outer:hover:not(:focus-within){background:"},{theme:"white",defaultValue:"#fff"},{rawString:";padding:1px;border-width:1px;border-style:solid;border-color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";box-sizing:border-box;border-radius:2px}.od-addNewCommentTextField-mentionableTextBox{width:auto;height:auto;background:"},{theme:"white",defaultValue:"#fff"},{rawString:";border:none;outline:0;padding:4px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";overflow-y:auto;overflow-x:hidden;white-space:pre-wrap;cursor:text;position:relative;max-height:144px;-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text}.od-addNewCommentTextField-mentionableTextBox a,.od-addNewCommentTextField-mentionableTextBox a:active,.od-addNewCommentTextField-mentionableTextBox a:hover,.od-addNewCommentTextField-mentionableTextBox a:visited{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-addNewCommentTextField-mentionableTextBox .no-access-mention{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-bottom:1px dashed "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:';text-decoration:none}.od-addNewCommentTextField-mentionableTextBox .no-access-mention::before{color:#a4262c;font-family:FabricMDL2Icons-17;font-size:16px;font-weight:700;content:"\\f13b";vertical-align:text-top}.od-addNewCommentTextField-mentionableTextBox .no-access-mention:active,.od-addNewCommentTextField-mentionableTextBox .no-access-mention:hover,.od-addNewCommentTextField-mentionableTextBox .no-access-mention:visited{color:'},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ItemActivityFeed .PlaceholderExclamationIcon{display:inline;font-size:1px}.od-addNewCommentTextField-mentionableTextBox:not(:empty){color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-addNewCommentTextField-mentionableTextBox-disabled{width:auto;height:auto;background:0 0;pointer-events:none;border:none;outline:0;padding:5px}@media (forced-colors:active){.od-addNewCommentTextField-mentionableTextBox-disabled{color:GrayText}}.od-addNewCommentTextField-mentionableTextBox[placeholder]:empty:before{content:attr(placeholder)}.od-addNewCommentTextField-mentionableTextBox-disabled[placeholder]:empty:before{content:attr(placeholder)}.od-TextBox-errorMessage{-webkit-font-smoothing:antialiased;font-size:12px;font-weight:400;color:#a4262c;margin:0;padding-top:5px;display:flex;align-items:center}.od-addNewCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var U=n(2401),F=n(51),H=n(1644),R=n(1673),N=n(129),B=n(2597),j=n(104),V=n(64),z=n(2452),G=n(1840),K=n(1853),W=n(60),q=n(3228),Q="?",Y="1",J="0",X="access-type",Z="email-id",$="contenteditable",ee=a,te=i,ne=n(2148),ae=n(2342),ie=n(1312),re=function(){function e(e){this._inputElement=e}return Object.defineProperty(e.prototype,"current",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursorLocation",{get:function(){return-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValueSelected",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionStart",{get:function(){return-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._inputElement},enumerable:!1,configurable:!0}),e.prototype.focus=function(){this._inputElement&&this._inputElement.focus()},e.prototype.clear=function(e){this._inputElement&&e&&(this._inputElement.innerHTML=""),this.value=""},e.prototype.setAriaLabels=function(e){var t=this;e.forEach(function(e){void 0===e.label?t._inputElement.removeAttribute("aria-".concat(e.attr)):t._inputElement.setAttribute("aria-".concat(e.attr),e.label.toString())})},e.prototype.setAriaAttributesOnParent=function(e){var t,n=null===(t=this._inputElement)||void 0===t?void 0:t.parentElement;n&&e.forEach(function(e){void 0===e.label?n.removeAttribute("aria-".concat(e.attr)):n.setAttribute("aria-".concat(e.attr),e.label.toString())})},e}(),oe=n(430),se={ODC:"LogPeoplePickerMounting"},ce=function(e){function t(t){var n=e.call(this,t)||this,a=!1;return n._logPeoplePickerMounting=oe.e.isFeatureEnabled(se)?function(){a||(f.e.logData({name:"AtMention.PeoplePickerMounted",isIntentional:!0}),a=!0)}:void 0,n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e;return!(null===(e=this.input)||void 0===e?void 0:e.current)&&this.props.calloutTarget&&(this.input.current=new re(this.props.calloutTarget)),o.createElement("div",{ref:this.root},this.renderSuggestions(),this.props.children)},t.prototype.componentDidMount=function(){this._updateAriaAttributes()},t.prototype.componentWillUnmount=function(){this._updateAriaAttributes(),this.input=void 0},t.prototype.componentDidUpdate=function(e){this.props.mentionQuery!==e.mentionQuery&&(this.input.current.value=this.props.mentionQuery,this.updateValue(this.props.mentionQuery)),this._updateAriaAttributes()},t.prototype.handleKeyDown=function(e){if(this.state.suggestionsVisible){var t=e.keyCode,n=e.shiftKey;switch(t){case _.e.tab:case _.e.enter:this.suggestionElement.current&&this.suggestionElement.current.hasSuggestedActionSelected()?this.suggestionElement.current.executeSelectedAction():!n&&this.suggestionStore.hasSelectedSuggestion()&&(this.addItem(this.suggestionStore.currentSuggestion&&this.suggestionStore.currentSuggestion.item),this.updateValue(""));break;case _.e.up:case _.e.down:this.onKeyDown(e)}}},t.prototype.renderSuggestions=function(){return this.state.suggestionsVisible&&this.input&&this.input.current&&o.createElement(ie.e,{isBeakVisible:!1,gapSpace:5,target:this.input.current.inputElement,onDismiss:this.dismissSuggestions,calloutWidth:this.props.calloutTarget.clientWidth,directionalHint:N.e.bottomLeftEdge,directionalHintForRTL:N.e.bottomRightEdge,onLayerMounted:this._logPeoplePickerMounting},o.createElement(ne.e,Object(r.__assign)({suggestionsListId:this._ariaMap.suggestionList,onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel},this.props.pickerSuggestionsProps)))},t.prototype._updateAriaAttributes=function(){var e;if(null===(e=this.input)||void 0===e?void 0:e.current){var t=!!this.state.suggestionsVisible,n=this.props.enableSelectedSuggestionAlert?this._ariaMap.selectedSuggestionAlert:"",a=t?this._ariaMap.suggestionList:"",i=this.getActiveDescendant();this.input.current.setAriaLabels([{attr:"activedescendant",label:t?i:void 0},{attr:"controls",label:a||n?"".concat(a," ").concat(n).trim():void 0}]),this.input.current.setAriaAttributesOnParent([{attr:"owns",label:a||void 0},{attr:"expanded",label:t}])}},t}(ae.e),de=n(8);Object(d.n)([{rawString:".mentionSuggestions_4fa68d14{min-width:100%;width:auto!important;border:solid 1px "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";border-radius:3px;box-sizing:border-box}.mentionSuggestions_4fa68d14 .ms-Suggestions-title{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var le,ue,fe="#text",pe=/no-?reply/i,me=function(e){function t(n){var a=e.call(this,n)||this;return a._cache=new j.e("MentionsControl",V.e.sharedMemory),a._relevantSuggestionsKey="RelevantSuggestions",a._ppQueryParamsKey="PeoplePickerQueryParams",a._isNoReplyEmail=function(e){return null==e?void 0:e.match(pe)},a._getPeoplePickerFilters=function(e){return{removeNoReplyEmail:!0,principalType:null==e?void 0:e.principalType,allowExternalUsers:!(null==e?void 0:e.filterExternalUsers)}},a._onBeforeInputText=function(e){var t,n=null===(t=a.props.editorElementRef)||void 0===t?void 0:t.current;n===e.target&&(a._previousEditorInnerText=n.innerText)},a._onInputText=function(e){var t,n,i=null===(t=a.props.editorElementRef)||void 0===t?void 0:t.current;if(i===e.target){var r=i.innerText;r&&a._previousEditorInnerText&&"paste"!==e.type&&((null===(n=null==e?void 0:e.inputType)||void 0===n?void 0:n.indexOf("deleteContent"))>-1||r.length<a._previousEditorInnerText.length)&&(a._processBackSpace()||a._isBackspaceKSActivated)&&(e.preventDefault(),e.stopPropagation()),a._handleMention(),a.props.onUpdateText&&a.props.onUpdateText()}},a._shortenDisplayName=function(e){var n=e.innerText;return t.BRACKET_REGEX.test(n)?n=n.replace(t.BRACKET_REGEX,""):t.LAST_NAME_SECTION_REGEX.test(n)?n=n.replace(t.LAST_NAME_SECTION_REGEX,""):(n="",e.remove?e.remove():e.parentElement.removeChild(e),e=void 0),n&&(e.innerText=n.trim(),a._moveCursorToEnd(e)),e},a._moveCursorToEnd=function(e){var t,n;if(e){null===(n=null===(t=a.props.editorElementRef)||void 0===t?void 0:t.current)||void 0===n||n.focus();var i=document.createRange();e.insertAdjacentText("afterend",a._isBackspaceKSActivated?" ":"⁠ "),i.selectNodeContents(e.nextSibling),i.collapse(!1);var r=document.getSelection();null==r||r.removeAllRanges(),null==r||r.addRange(i)}},a._isMentionAnchor=function(e){return!(!e||"A"!==e.nodeName||!e.getAttribute(te.DATA_MENTION_EMAIL_ID))},a._convertPasteToPlainText=function(e){var t=a.props.editorElementRef,n=null==t?void 0:t.current;if(n){var i="";e.clipboardData||e.originalEvent.clipboardData?i=(e.originalEvent||e).clipboardData.getData("text/plain"):window.clipboardData&&(i=window.clipboardData.getData("Text"));var r=document.getSelection();if(r.rangeCount){r.deleteFromDocument();var o=n.scrollTop,s=document.createTextNode(i);r.getRangeAt(0).insertNode(s),r.collapse(s,i.length),e.preventDefault();var c=document.createElement("span");c.innerText=i,c.setAttribute("style","visibility: hidden;"),n.appendChild(c),n.scrollHeight>144&&(n.scrollTop=o+c.offsetHeight),n.removeChild(c),n.normalize(),a._onInputText(e)}}},a._fetchRelevantSuggestions=function(){var e;if(a._isRelevantUsersFetched&&(null===(e=a._relevantUsers)||void 0===e?void 0:e.length)&&a._relevantUsers.length>0)return W.n.wrap(a._relevantUsers);var t=a._getValueFromCache(a._relevantSuggestionsKey);return t?(a._relevantUsers=t,W.n.wrap(a._relevantUsers)):a._getPeoplePickerQueryParams().then(function(e){return a._dataProvider.search("",e).promise.then(function(t){return a._relevantUsers=a._filterPeoplePickerResults(t,a._getPeoplePickerFilters(e)),a._updateCache(a._relevantSuggestionsKey,a._relevantUsers),a._isRelevantUsersFetched=!0,a.setState({mentionQuery:""}),a._handleMention(),a._relevantUsers}).catch(function(e){return a._isRelevantUsersFetched=!1,a._relevantUsers})})},a._handleSuggestionsDisplay=function(e){a._async.setTimeout(function(){0===e.length&&a.state.mentionQuery.length>0?document.getElementsByClassName("ms-Suggestions-title")[0].innerHTML!==q.t&&(document.getElementsByClassName("ms-Suggestions-title")[0].style.display="none"):document.getElementsByClassName("ms-Suggestions-title")[0].style.display="inherit"},0)},a._updateCache=function(e,t){var n={valueObject:t,timestamp:Date.now()};a._cache.setValue(e,n,V.e.sharedMemory,!0)},a._getValueFromCache=function(e){var t=Date.now(),n=a._cache.getValue(e,V.e.sharedMemory,!0,!1);if((null==n?void 0:n.timestamp)&&t-144e5<n.timestamp&&n.valueObject)return n.valueObject;a._cache.remove(e,V.e.sharedMemory,!0)},a._handleResolveSuggestions=a._handleResolveSuggestions.bind(a),a._handleMention=a._handleMention.bind(a),a._handleFilterChanged=a._handleFilterChanged.bind(a),a._onPersonaSelected=a._onPersonaSelected.bind(a),a._getTextFromItem=a._getTextFromItem.bind(a),a._onGetMoreResults=a._onGetMoreResults.bind(a),a._onRenderSuggestionItem=a._onRenderSuggestionItem.bind(a),a._handleKeydown=a._handleKeydown.bind(a),a._handleKeyUp=a._handleKeyUp.bind(a),a._filterPeoplePickerResults=a._filterPeoplePickerResults.bind(a),a._dataProvider=a.props.peoplePickerProvider,a._newMentionNode=document.createElement("a"),a._relevantUsers=[],a._lastPersonListLength=0,a._lastPersonListAtSpaceLength=0,a.state={mentionQuery:""},a._isRelevantUsersFetched=!1,a._isIE11=!!window.MSInputMethodContext&&!!document.documentMode,a._isBackspaceKSActivated=de.t.isActivated("34EA2080-5D1C-44D6-BF88-9BD3C06F1AB9","9/6/2021","Disable new backspace behavior for @mention text box"),a}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props.editorElementRef,n=this.state.mentionQuery===t.RELEVANT_USER_QUERY&&this._relevantUsers.length<1,a={className:"mentionSuggestions_4fa68d14",loadingText:q.e,suggestionsHeaderText:n?q.t:q.r,noResultsFoundText:q.n,suggestionsAvailableAlertText:q.a,suggestionsContainerAriaLabel:q.i};return o.createElement(ce,{onResolveSuggestions:this._handleResolveSuggestions,onRenderSuggestionsItem:this._onRenderSuggestionItem,getTextFromItem:this._getTextFromItem,pickerSuggestionsProps:a,componentRef:this._resolveRef("_picker"),resolveDelay:300,mentionQuery:this.state.mentionQuery,calloutTarget:null==e?void 0:e.current,onItemSelected:this._onPersonaSelected,onGetMoreResults:this._onGetMoreResults})},t.prototype.shouldComponentUpdate=function(e,t){return this.state.lastInvalidMention!==t.lastInvalidMention||!this._lastResolvedQuery||this._lastResolvedQuery!==t.mentionQuery},t.prototype.componentDidMount=function(){var e=this.props.editorElementRef,t=null==e?void 0:e.current;null==t||t.addEventListener("keydown",this._handleKeydown),null==t||t.addEventListener("beforeinput",this._onBeforeInputText),null==t||t.addEventListener("input",this._onInputText),null==t||t.addEventListener("keyup",this._handleKeyUp),null==t||t.addEventListener("paste",this._convertPasteToPlainText)},t.prototype.componentWillUnmount=function(){var e=this.props.editorElementRef,t=null==e?void 0:e.current;null==t||t.removeEventListener("keydown",this._handleKeydown),null==t||t.removeEventListener("input",this._onInputText),null==t||t.removeEventListener("beforeinput",this._onBeforeInputText),null==t||t.removeEventListener("keyup",this._handleKeyUp),null==t||t.removeEventListener("paste",this._convertPasteToPlainText)},t.prototype.getMentionData=function(){var e,n="",a="",i=-1,r=-1,o=1,s=this._caretRange;return s&&s.endContainer.nodeName===fe&&(i=(a=(e=s.endContainer).textContent).substring(0,s.endOffset).lastIndexOf("@"),this.props.allowEmailAddresses&&(r=a.substring(0,s.endOffset).lastIndexOf("@",i-1))," "===a[a.length-1]&&(this._lastPersonListAtSpaceLength=this._lastPersonListLength),(0===i||i>0&&this._isTerminatingCharacter(a[i-1]))&&(""===(n=a.substring(i+1,s.endOffset).trim())&&(n=t.RELEVANT_USER_QUERY),-1!==a.substring(i,s.endOffset).indexOf(" ")&&0===this._lastPersonListAtSpaceLength&&(n="",o=0)),""===n&&this.props.allowEmailAddresses&&o&&(0===r||r>0&&this._isTerminatingCharacter(a[r-1]))&&(-1!==a.substring(r,s.endOffset).indexOf(" ")?n="":(n=a.substring(r+1,s.endOffset).trim(),i=r)),n.length>=320&&(n="")),{currentNode:e,lastAtIndex:i,mentionQuery:n,nodeText:a}},t.prototype._filterPeoplePickerResults=function(e,t){var n=this;return t&&e?e.filter(function(e){return!((null==e?void 0:e.email)&&t.removeNoReplyEmail&&n._isNoReplyEmail(e.email)&&!n._isNoReplyEmail(n.state.mentionQuery)||t.principalType&&e.principalType&&t.principalType!==K.e.all&&e.principalType!==t.principalType||!t.allowExternalUsers&&e.isExternal)}):e},t.prototype._getPeoplePickerQueryParams=function(){var e=this,t=this._getValueFromCache(this._ppQueryParamsKey);if(t)return W.n.wrap(t);var n=this.props.getPeoplePickerQueryParams;return n?W.n.wrap(n()).then(function(t){return e._updateCache(e._ppQueryParamsKey,t),t}):void 0},t.prototype._handleKeyUp=function(e){if(e&&"keyup"===e.type&&"Shift"===e.key)return e.preventDefault(),void e.stopPropagation()},t.prototype._handleKeydown=function(e){var t=this.state.mentionQuery,n=this.props.onPostComment;switch(e.which){case _.e.escape:t&&(e.preventDefault(),e.stopPropagation(),this.setState({mentionQuery:""}));break;case _.e.del:case _.e.backspace:this._selection&&this._processBackSpace()&&(e.preventDefault(),e.stopPropagation());break;case _.e.tab:case _.e.up:case _.e.down:!e.shiftKey&&t.length>0&&(e.preventDefault(),e.stopPropagation(),this._picker.handleKeyDown(e));break;case _.e.enter:e.shiftKey||this._lastPersonListLength?t.length>0&&(e.preventDefault(),e.stopPropagation(),this._picker.handleKeyDown(e)):(this.setState({mentionQuery:""}),e.preventDefault(),e.stopPropagation(),n());break;default:return}},t.prototype._handleMention=function(e){var t=this,n=this.getMentionData(),a=n.currentNode,i=n.mentionQuery;i===this.state.mentionQuery||e&&(e.which===_.e.escape||e.which===_.e.enter)||this.setState({currentNode:a,mentionQuery:i}),setTimeout(function(){t._normalizeContent()},0)},t.prototype._transformMentionQuery=function(e){var t,n=this._caretRange,a=e.email,i=e.name,r=null===(t=this.props.editorElementRef)||void 0===t?void 0:t.current;if(n&&i&&a&&r){var o=this.props.platform,s=this.getMentionData(),c=s.currentNode,d=s.lastAtIndex;if(s.mentionQuery.length>0&&c&&this._selection){var l=this._newMentionNode.cloneNode(!0);l.setAttribute(te.DATA_MENTION_EMAIL_ID,a),l.setAttribute(te.CONTENT_EDITABLE,(!!(null==o?void 0:o.isMobile)).toString()),l.setAttribute(te.ACCESS_TYPE,ee.Unknown),l.appendChild(document.createTextNode("@".concat(i)));var u=document.createTextNode(this._isBackspaceKSActivated?" ":"⁠ "),f=document.createRange();f.setStart(c,d),f.setEnd(c,n.endOffset),f.deleteContents(),f.insertNode(u),f.insertNode(l),r.focus(),this._selection.collapse(u,this._isBackspaceKSActivated?1:2),this.setState({mentionQuery:""}),this._normalizeContent(),this._verifyUserAccess(a,l)}}},t.prototype._verifyUserAccess=function(e,t){var n=this.props,a=n.onCheckUserAccess,i=n.isShareAndNotifyDialogDisabled;a&&a(e,function(e,n){e||i&&n?t.setAttribute(te.ACCESS_TYPE,ee.HasAccess):(t.setAttribute(te.ACCESS_TYPE,ee.NoAccess),i&&t.setAttribute("class","no-access-mention"))})},t.prototype._handleFilterChanged=function(e,t){return e.filter(function(e){return 0===e.name.indexOf(t)||0===e.email.split("@")[0].indexOf(t)})},t.prototype._onPersonaSelected=function(e){return this._transformMentionQuery(e),e},t.prototype._getTextFromItem=function(e){return e.primaryText},t.prototype._processBackSpace=function(){var e=this._selection.anchorNode,t=this._selection.anchorOffset;if(this._selection.isCollapsed){var n=void 0;return n=e.nodeName===fe?0===t?e.previousSibling:e.parentElement:e.hasChildNodes()&&t>0?e.childNodes[t-1]:e,this._isMentionAnchor(n)?((n=this._shortenDisplayName(n))?this.setState({lastInvalidMention:n}):this.setState({lastInvalidMention:void 0,mentionQuery:""}),!0):(this.setState({lastInvalidMention:void 0,mentionQuery:""}),!1)}},t.prototype._normalizeContent=function(){var e=this.props.editorElementRef,t=null==e?void 0:e.current;if(t){if(!this._isIE11){var n=t.querySelectorAll("br[end_break]"),a=!0;if(1===n.length){var i=n[0],r=i.previousSibling;t.lastChild===i&&r&&(a=!1)}if(a){var o=n.length;if(o>0)for(var s=0;s<o;s++)t.removeChild(n[s]);if(t.lastChild){var c=document.createElement("br");c.setAttribute("end_break","true"),t.appendChild(c)}}}t.normalize()}},Object.defineProperty(t.prototype,"_selection",{get:function(){var e=document.getSelection(),t=this.props.editorElementRef,n=null==t?void 0:t.current;return e&&e.focusNode&&((null==n?void 0:n.contains(e.focusNode))||(null==n?void 0:n.contains(e.focusNode.parentNode)))?e:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_caretRange",{get:function(){var e=this._selection;if(e&&e.isCollapsed&&e.rangeCount>0)return e.getRangeAt(0)},enumerable:!1,configurable:!0}),t.prototype._isTerminatingCharacter=function(e){return t.TERMINATING_CHAR_REGEX.test(e)},t.prototype._handleResolveSuggestions=function(e){var n,a,i,r=this;return this._peoplePickerSearchPromise&&(this._peoplePickerSearchPromise.cancel(),this._peoplePickerSearchPromise=void 0),e?(this.state.mentionQuery===t.RELEVANT_USER_QUERY?(this._lastResolvedQuery=t.RELEVANT_USER_QUERY,this._lastPersonListAtSpaceLength=0,a={promise:this._fetchRelevantSuggestions().then(function(e){return r._relevantUsers=e,n=e,r._relevantUsers}),cached:null},i=W.n.wrap(a)):e.length<1?(this._lastResolvedQuery=this.state.mentionQuery,n=this._handleFilterChanged(this._relevantUsers,e),a={promise:W.n.wrap(n),cached:n},i=W.n.wrap(a)):i=this._getPeoplePickerQueryParams().then(function(t){return r._dataProvider.search(e.trim(),t)}),i?i.then(function(t){return r._resolvePeoplePickerSearch(t).then(function(t){return r._lastResolvedQuery=e,r._handleSuggestionsDisplay(t),r._lastPersonListLength=t.length,t})}):W.n.resolve(this._handleFilterChanged(this._relevantUsers,e))):(this._lastResolvedQuery="",n=[],this._lastPersonListLength=n.length,W.n.resolve(n))},t.prototype._onGetMoreResults=function(e,t){var n=this;return e.length<1?[]:this._getPeoplePickerQueryParams().then(function(t){var a=n._dataProvider.search(e.trim(),t);return n._resolvePeoplePickerSearch(a).then(function(t){return n._lastResolvedQuery=e,t})})},t.prototype._resolvePeoplePickerSearch=function(e){var t=this,n=e.cached||[];return this._peoplePickerSearchPromise=e.promise,this._peoplePickerSearchPromise.then(function(e){return t._peoplePickerSearchPromise=void 0,t._getPeoplePickerQueryParams().then(function(a){return e?n.concat(t._filterPeoplePickerResults(e,t._getPeoplePickerFilters(a))):[]})}).catch(function(e){return W.n.reject(e)})},t.prototype._onRenderSuggestionItem=function(e){return o.createElement("div",{className:"ms-PeoplePicker-personaContent"},o.createElement(z.e,{text:e.name||"",secondaryText:e.email||"",tertiaryText:"",presence:G.t.none,size:G.n.size40,className:"ms-PeoplePicker-pickerPersona",imageUrl:e.image}))},t.BRACKET_REGEX=/\s\(([^)]*)\)[^(]*$/g,t.LAST_NAME_SECTION_REGEX=/\s[^\s]*$/g,t.TERMINATING_CHAR_REGEX=/[\s\t\r\n]/,t.RELEVANT_USER_QUERY="@@",t}(E.e),_e=n(476),he=n(232),be=n(2209),ge=Object(he.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(305).then(n.bind(null,4399))];case 1:return[2,e.sent().TextBoxTeachingBubble]}})})}),ve=function(e){function t(t){var n=e.call(this,t)||this;return n._warningIcon=function(){return o.createElement(o.Fragment,null,o.createElement(_e.e,{key:"StatusTriangleExclamationIcon","aria-hidden":!0,"data-is-focusable":!1,iconName:"StatusTriangleExclamation",className:"PlaceholderExclamationIcon"}))},n._removeNoAccessMentionees=function(e,t){if(!(null==t?void 0:t.length))return e;for(var n=[],a=t.map(function(e){var t;return null===(t=e.user)||void 0===t?void 0:t.email}),i=0;i<e.length;i++){var r=e[i];a.indexOf(r.user.email)<0&&n.push(r)}return n},n._onClearTextField=function(e){n.setState(n._getResetState()),n._checkAccessPromises=[],n._inputElement.current&&(n._inputElement.current.innerHTML="",e&&n._inputElement.current.focus())},n._doesTextContainMentionsWithNoAccess=function(){var e,t,a,i=null===(a=null===(t=null===(e=n._inputElement)||void 0===e?void 0:e.current)||void 0===t?void 0:t.getElementsByClassName("no-access-mention"))||void 0===a?void 0:a.length;return i&&i>0},n._onCommentPost=n._onCommentPost.bind(n),n._startPostComment=n._startPostComment.bind(n),n._updateText=n._updateText.bind(n),n._onCheckUserAccess=n._onCheckUserAccess.bind(n),n._dismissTeachingBubble=n._dismissTeachingBubble.bind(n),n.state=n._getResetState(),n._peoplePickerProvider=n.props.peoplePickerProvider,n._allMentionees=[],n._noAccessMentionees=[],n._inputElement=o.createRef(),n._isIE11=U.e.isIE11(),n._isFirefox=U.e.isFireFox(),n._checkAccessPromises=[],n._isBackspaceKSActivated=de.t.isActivated("34EA2080-5D1C-44D6-BF88-9BD3C06F1AB9","9/6/2021","Disable new backspace behavior for @mention text box"),n}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return e.disabled?{enableSendButton:!1,sending:!1,errorMessage:"",successMessage:""}:t},t.prototype.render=function(){var e=this.props,t=e.disabled,n=e.isPublicEmailAddressSupported,a=e.platform,i=e.getPeoplePickerQueryParams,r=e.isShareAndNotifyDialogDisabled,s=this.state,c=s.sending,d=s.showTeachingBubble;return o.createElement(o.Fragment,null,o.createElement("div",{className:Object(F.e)({"od-addNewCommentTextField-mentionableTextBox-outer":!t},{"od-addNewCommentTextField-mentionableTextBox-outer-disabled":t}),role:t?void 0:"combobox","aria-haspopup":!t&&"listbox","aria-expanded":!!t&&void 0,"aria-label":B.o},o.createElement("div",{className:Object(F.e)({"od-addNewCommentTextField-mentionableTextBox":!t},{"od-addNewCommentTextField-mentionableTextBox-disabled":t}),contentEditable:!t&&!c&&(!(!this._isIE11&&!this._isFirefox)||"plaintext-only"),placeholder:this.props.placeholderText,ref:this._inputElement,tabIndex:t?void 0:0,role:"textbox","aria-disabled":!!t,"aria-label":B.o}),this._renderButtons(),o.createElement(me,{allowEmailAddresses:n,editorElementRef:this._inputElement,onUpdateText:this._updateText,onPostComment:this._onCommentPost,peoplePickerProvider:this._peoplePickerProvider,getPeoplePickerQueryParams:i,onCheckUserAccess:this._onCheckUserAccess,platform:a,isShareAndNotifyDialogDisabled:r})),this._renderErrorMessage(),o.createElement("div",{className:"od-addNewCommentTextField-screenReaderOnly","aria-live":"assertive",role:"status","aria-atomic":!0,"aria-label":this.state.successMessage},this.state.successMessage),o.createElement(be.e,null,d&&!!this._inputElement.current&&!t&&o.createElement(ge,{target:this._inputElement.current,onDismiss:this._dismissTeachingBubble})),!!r&&this._warningIcon())},t.prototype._dismissTeachingBubble=function(){this.setState({showTeachingBubble:!1}),this._inputElement.current&&this._inputElement.current.focus()},t.prototype._onCheckUserAccess=function(e,t,n){var a=this,i=t;this.props.isShareAndNotifyDialogDisabled&&(i=function(e,n){e&&n||a.setState({errorMessage:B.i}),t(e,n)}),this._checkAccessPromises.push(W.n.resolve(this.props.onCheckUserAccess(e,i,n)))},t.prototype._renderErrorMessage=function(){return""!==this.state.errorMessage&&o.createElement("span",null,o.createElement("div",{role:"alert"},o.createElement("p",{className:"od-TextBox-errorMessage"},o.createElement("span",null,this.state.errorMessage))))},t.prototype.commentInputValid=function(){return this._textLength()>0&&this._textLength()<=2e3},t.prototype.componentDidMount=function(){this.props.focusOnMount&&!this.props.disabled&&this._inputElement.current&&this._inputElement.current.focus(),this.checkAndShowTeachingBubble()},t.prototype.componentDidUpdate=function(e){this.props.commentItemId!==e.commentItemId&&(this._onClearTextField(),this.checkAndShowTeachingBubble())},t.prototype.componentWillUnmount=function(){clearTimeout(this._statusMessageTimer),clearTimeout(this._teachingBubbleTimer)},t.prototype.checkAndShowTeachingBubble=function(){var e,t=this;(null===(e=this.props.showTeachingBubbleOnTextBox)||void 0===e?void 0:e.isPending)&&!this.props.disabled&&this._inputElement.current&&(this.props.showTeachingBubbleOnTextBox.isPending=!1,this._teachingBubbleTimer=setTimeout(function(){t.setState({showTeachingBubble:!0})},500))},t.prototype._renderButtons=function(){return this.state.enableSendButton&&o.createElement("div",{className:"od-mentionableTextBox-buttons"},this._renderSendButton())},t.prototype._renderSendButton=function(){return this.state.sending?o.createElement("div",{className:"od-addNewCommentTextField-spinner"},o.createElement(h.e,{size:b.e.small})):o.createElement(R.e,{content:B.s,styles:{root:{display:"inline-block"}},directionalHint:N.e.bottomAutoEdge},o.createElement(H.e,{className:"od-addNewCommentTextField-sendButton",iconProps:{iconName:"Send"},ariaLabel:B.s,onClick:this._onCommentPost}))},t.prototype._limitConsecutiveNewlines=function(e){return e.replace(/\n{3,}/gm,"\n\n")},t.prototype._cleanupMentionedAttributes=function(){if(this._inputElement.current)for(var e=this._inputElement.current.querySelectorAll("a[".concat(te.DATA_MENTION_EMAIL_ID,"]")),t=0;t<e.length;t++){var n=e[t];n.removeAttribute(te.ACCESS_TYPE),n.removeAttribute(te.CONTENT_EDITABLE)}},t.prototype._removeDuplicateIdentities=function(e){for(var t={},n=[],a=0;a<e.length;a++)e[a]&&e[a].user&&e[a].user.email&&!t[e[a].user.email]&&(t[e[a].user.email]=!0,n.push(e[a]));return n},t.prototype._updateMentionedData=function(){if(this._inputElement.current){for(var e=[],t=[],n=this._inputElement.current.querySelectorAll("a[".concat(te.DATA_MENTION_EMAIL_ID,"]")),a=0;a<n.length;a++){var i=n[a],r=i.getAttribute(te.DATA_MENTION_EMAIL_ID),o=i.textContent.substr(1),s=i.getAttribute(te.ACCESS_TYPE);e.push({user:{displayName:o,email:r.trim().toLowerCase()}}),s!==ee.NoAccess&&s!==ee.Unknown||t.push({user:{displayName:o,email:r.trim().toLowerCase()}})}this._allMentionees=e,this._noAccessMentionees=this._removeDuplicateIdentities(t),this.props.isShareAndNotifyDialogDisabled&&(this._allMentionees=this._removeNoAccessMentionees(e,t))}},t.prototype._sendComment=function(){var e=this,t=this.props,n=t.onSend,a=t.engagementSource,i=t.engagementExtraData,o=t.engagementExecutor;n&&(this.setState({sending:!0,successMessage:"",errorMessage:""}),this._cleanupMentionedAttributes(),n(this._textContent(),function(){e._onClearTextField(!0);var t=a?"".concat(a,"."):"AddCommentTextField.";(o||f.e).logData({name:"".concat(t,"Send.Click"),isIntentional:!0,extraData:Object(r.__assign)(Object(r.__assign)({},i),{mentionCount:e._allMentionees.length})}),e._allMentionees=[],e._noAccessMentionees=[],clearTimeout(e._statusMessageTimer),e.setState({successMessage:B.e},function(){clearTimeout(e._statusMessageTimer),e._statusMessageTimer=setTimeout(function(){e.setState({successMessage:""})},15e3)})},function(t){e.setState({sending:!1,errorMessage:t})},this._allMentionees))},t.prototype._onCommentPost=function(){this.state.enableSendButton&&!this.state.sending&&this.commentInputValid()&&(this.setState({sending:!0,errorMessage:"",successMessage:""}),W.n.all(this._checkAccessPromises).then(this._startPostComment,this._startPostComment))},t.prototype._startPostComment=function(){var e=this,t=this.props,n=t.onGrantAccess,a=t.engagementSource,i=t.engagementExtraData,o=t.isShareAndNotifyDialogDisabled,s=void 0!==o&&o,c=t.engagementExecutor;if(this.setState({sending:!1}),this._updateMentionedData(),!s&&n&&this._noAccessMentionees&&this._noAccessMentionees.length>0){var d=function(t){e.setState({sending:!1,errorMessage:t||B.n})};n(this._noAccessMentionees,function(t){if("share_grantAccessCompleted"===t){e._sendComment();var n=a?"".concat(a,"."):"AtMention.ShareDialog.";(c||f.e).logData({name:"".concat(n,"Share.Click"),isIntentional:!0,extraData:Object(r.__assign)(Object(r.__assign)({},i),{shareCount:e._noAccessMentionees.length})})}else"share_dismiss"!==t&&d(B.n)},d)}else this._sendComment()},t.prototype._removeAllTags=function(e){return e.replace(/<(?:.|\n)*?>/gm,"")},t.prototype._replaceDivsWithNewLines=function(e){return e.replace(/<div>/gi,"\n").replace(/<\/div>/gi,"")},t.prototype._textLength=function(){return this._inputElement.current?this._textLengthCache&&this._lastHTML===this._inputElement.current.innerHTML?this._textLengthCache:(this._lastHTML=this._inputElement.current.innerHTML,this._textLengthCache=this._textContent().length):0},t.prototype._textContent=function(){var e=this._inputElement.current?this._inputElement.current.innerHTML:"";return e=this._replaceDivsWithNewLines(e),e=this._limitConsecutiveNewlines(e),e=this._trimSurroundingWhitespace(e),this._isBackspaceKSActivated||(e=this._removeTerminatingWJ(e)),e=this._replaceMentionsWithPlaceholders(e),e=this._removeAllTags(e),U.e.htmlDecodeFromString(e)},t.prototype._removeTerminatingWJ=function(e){return e.replace(/(<\s*\/\s*a\s*>)\u2060/gi,"$1")},t.prototype._replaceMentionsWithPlaceholders=function(e){var t=0;return this.props.isShareAndNotifyDialogDisabled&&(e=e.replace(/<\s*a\s*email-id[^<>]*access-type\s*=\s*[\\"]+0[\\"]+[^<>]*>([^<]*)<\s*\/\s*a\s*>/g,"$1")),e.replace(/<\s*a\s*email-id\s*=\s*"[^"]+"\s*>[^<]*<\s*\/\s*a\s*>/gi,function(){return"@mention{".concat(t++,"}")})},t.prototype._trimSurroundingWhitespace=function(e){return e.replace(/^\s+|\s+$/g,"")},t.prototype._updateText=function(){var e=this._textLength()>2e3?B.t:"";this.props.isShareAndNotifyDialogDisabled&&this._doesTextContainMentionsWithNoAccess()&&(e=B.i),this.setState({enableSendButton:this.commentInputValid(),errorMessage:e})},t.prototype._getResetState=function(){return{enableSendButton:!1,sending:!1,errorMessage:"",showTeachingBubble:!1}},t}(o.Component),ye=n(2626),Se=n(163),De=n(2530),Ie=864e5;!function(e){e.today="Today",e.yesterday="Yesterday",e.thisWeek="This week",e.lastWeek="Last week",e.twoWeeksAgo="Two weeks ago",e.threeWeeksAgo="Three weeks ago",e.thisMonth="This month",e.lastMonth="Last month",e.older="Older"}(ue||(ue={}));var xe=((le={})[ue.today]=De.g,le[ue.yesterday]=De.S,le[ue.thisWeek]=De.h,le[ue.lastWeek]=De.u,le[ue.twoWeeksAgo]=De.v,le[ue.threeWeeksAgo]=De.b,le[ue.thisMonth]=De._,le[ue.lastMonth]=De.l,le);function Ce(e){var t=e.time,n=new Date;return t?function(e,t){return Oe(t,e)}(t,n)?ue.today:function(e,t){return Oe(new Date(t.getTime()-Ie),e)}(t,n)?ue.yesterday:function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*Ie;return e.getTime()>n}(t,n)?ue.thisWeek:function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+7)*Ie;return e.getTime()>n}(t,n)?ue.lastWeek:function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n}(t,n)?ue.twoWeeksAgo:function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n}(t,n)?ue.threeWeeksAgo:function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()}(t,n)?ue.thisMonth:function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1}(t,n)?ue.lastMonth:function(e,t){return t.getFullYear()===e.getFullYear()}(t,n)?t.toLocaleString(Se.t.language,{month:"long"}):function(e,t){return t.getFullYear()>e.getFullYear()}(t,n)?t.toLocaleString(Se.t.language,{month:"long",year:"numeric"}):ue.older:ue.older}function Oe(e,t){return e.toDateString()===t.toDateString()}var we=n(2102);Object(d.n)([{rawString:'.od-ItemActivity-SeeMoreText{font-family:"Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;font-style:normal;font-size:12px;color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background:0 0;padding:0 2px 2px 2px;border:transparent;cursor:pointer;height:fit-content;min-width:min-content}.od-ItemActivity-SeeMoreText:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";text-decoration:underline;background:0 0}.od-ItemActivity-SeeMoreText .ms-Button-label{margin-left:0;margin-right:0;font-weight:400}"}]);var Ee,Ae,Le,ke=n(1176),Me=function(e){function t(t){var n=e.call(this,t)||this;return n.state={charLimit:t.charLimit?t.charLimit:140,expanded:!1},n}return Object(r.__extends)(t,e),t.prototype.render=function(){return o.createElement("div",null,this.getSeeMoreContent())},t.prototype.getSeeMoreContent=function(){var e,t=this.state,n=t.charLimit,a=t.expanded,i=this.props,r=i.text,s=i.seeMoreText,c=i.seeLessText;return e=r.length<=n?r:a?r+" ":r.substr(0,n)+"... ",o.createElement("span",null,e,r.length>n&&o.createElement(ke.e,{className:"od-ItemActivity-SeeMoreText",onClick:this.toggleExpanded.bind(this),"aria-expanded":a},a?c:s))},t.prototype.toggleExpanded=function(){var e=this.state.expanded;this.setState({expanded:!e})},t}(o.PureComponent),Pe=n(39),Te=function(e){var t=e.user,n=e.onRenderUser,a=e.environment,i=t.email,r={user:t,isAccusative:!1};return"sharePointList"===a&&n?o.createElement(o.Fragment,null,n(r,Ue)):o.createElement(R.e,{content:i,styles:{root:{display:"inline-block",overflowWrap:"anywhere"}}},Ue(r))},Ue=function(e){var t=e.user,n=t.email,a="@".concat(t.displayName||n||De.y);return o.createElement("a",{"aria-label":Pe.format(De.f,a,n)},a)},Fe=function(e){var t,n=o.useState(!1),a=n[0],i=n[1],s=e.text,c=e.mentioned,d=e.seeLessText,l=e.seeMoreText,u=e.charLimit,f=void 0===u?140:u,p=o.useMemo(function(){return function(e){for(var t,n=e.text,a=e.onRenderUser,i=e.environment,r=e.mentioned,s=void 0===r?[]:r,c=/@mention\{(\d+)\}/g,d=0,l=[];t=c.exec(n);){var u=s[parseInt(t[1])];if(t.index>d&&l.push(n.substring(d,t.index)),d=c.lastIndex,u){var f=o.createElement(Te,{key:l.length,user:u,onRenderUser:a,environment:i});l.push(f)}else l.push(t[0])}return d!==n.length&&l.push(n.substring(d,n.length)),l}(e)},[s,c]),m=0;if(a)t=Object(r.__spreadArray)([],p,!0);else{t=[];for(var _=0,h=p;_<h.length;_++){var b=h[_];if("string"==typeof b?(m+=b.length)>f?t.push(b.substr(0,f-m+b.length)):t.push(b):(t.push(b),m+=12),m>f)break}}return a?t.push(" "):m>f&&t.push("..."),o.createElement("span",null,t,(a||m>f)&&o.createElement(ke.e,{className:"od-ItemActivity-SeeMoreText",onClick:function(){i(!a)},"aria-expanded":a},a?d:l))},He=n(542),Re=n(130),Ne=n(1651),Be=!de.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),je={isPlaceholder:!1,activities:[],success:!0},Ve=function(e){function t(t,n){var a=e.call(this,t,n)||this;a._onRenderMissingActivity=function(e,t){var n=a.state,i=n.isEndOfActivities,r=n.showComments,o=n.deeplinkCommentThreadId,s=a.props,c=s.commentsOnly,d=s.containingItem,l=s.currentUserEmail,u=s.environment,f=s.activityApiHeaders,p=s.commentListItem;if(!i&&!c){var m="sharePointList"===u?"ItemActivityFeed-spList":"ItemActivityFeed";a._store.fetchItemActivities({item:d,startIndex:e,currentUserEmail:l,qosPrefix:m,environment:u,isScrollEvent:t,activityApiHeaders:f})}r&&a._itemCommentsStore.fetchItemComments({itemWrapper:p,currentUserEmail:l,qosPrefix:"sharePointList"===u?"SPList":void 0}),a.setState({deeplinkCommentThreadId:t?void 0:o})},a._onFetchCommentsError=function(e){var t=a.props.onFetchCommentsError;t&&t(e),a.setState({showAllCommentActivities:!0,itemCommentsQueried:!0})},a._displayLargeText=function(e){return a._displayMentionEnabled?o.createElement(Fe,Object(r.__assign)({},e)):o.createElement(Me,Object(r.__assign)({},e))};var i="sharePointList"===t.environment;a._displayMentionEnabled="consumer"===t.environment||i,a._store=n.itemActivityFeedStore,a._itemCommentsStore=n.itemCommentsStore,a._engagementSource=n.engagementSource||"ActivityFeed";var s=!!t.commentListItem,c=t.commentsOnly?je:a._store.getItemActivities({item:a.props.containingItem,currentUserEmail:t.currentUserEmail}),d=s&&a._itemCommentsStore.getItemComments({itemWrapper:t.commentListItem,currentUserEmail:t.currentUserEmail,startIndex:0,qosPrefix:i?"SPList":void 0,onError:a._onFetchCommentsError,isReplyDisabled:i})||void 0;return a.state={activities:c,itemComments:d,isEndOfActivities:!1,itemCommentsQueried:d&&!d.isPlaceHolder,showAllCommentActivities:!s,showComments:s,feedUpdatedMessage:"",isSPCustomListFeed:i,deeplinkCommentThreadId:t.deeplinkCommentThreadId},a}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.containingItem.graphItemUrl!==this.props.containingItem.graphItemUrl||e.currentUserEmail!==this.props.currentUserEmail){var t="sharePointList"===e.environment,n=!!e.commentListItem,a=e.commentsOnly?je:this._store.getItemActivities({item:this.props.containingItem,currentUserEmail:e.currentUserEmail}),i=n&&this._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,startIndex:0,qosPrefix:t?"SPList":void 0,onError:this._onFetchCommentsError,isReplyDisabled:t})||void 0;this.setState({activities:a,showComments:n,itemComments:i,showAllCommentActivities:!n,itemCommentsQueried:i&&!i.isPlaceHolder,isEndOfActivities:!1,feedUpdatedMessage:"",isSPCustomListFeed:t}),clearTimeout(this._feedUpdatedMessageTimer),this._removeCurrentListeners(),this._addListeners(e)}this.props.isAtMentionEnabled?e.containingItem.graphItemUrl!==this.props.containingItem.graphItemUrl&&this._refreshActivityFeed(e):e.containingItem!==this.props.containingItem&&this._refreshActivityFeed(e),e.commentsOnly!==this.props.commentsOnly&&(this.props.isAtMentionEnabled&&this._refreshActivityFeed(e),this.setState({isEndOfActivities:!1}))},t.prototype.componentDidMount=function(){this._addListeners(this.props)},t.prototype.componentWillUnmount=function(){this._removeCurrentListeners(),clearTimeout(this._feedUpdatedMessageTimer)},t.prototype.render=function(){var e=this.state,t=e.activities,n=e.itemComments,a=e.showComments,i=e.itemCommentsQueried,r=e.deeplinkCommentThreadId,s=this.props,c=s.isReadonly,d=s.commentsOnly,l=s.isNewCommentExperienceEnabled,u=s.onHighlightCommentCard,f=s.groupHeadingLevel,p=this._getViewableItemActivitiesAndGroups(t,n),m=p.activities,_=p.dateGroups;if((!d&&(t.isPlaceholder||t.nextRequestToken)||n&&n.nextLink)&&(!d||!this._noCommentActivities())){var h=_.length;m.push(void 0),0===h?_.push({key:"",name:"",startIndex:0,count:1}):h>0&&(_[_.length-1].count+=1)}var b=this._renderNoActivitiesNote(m),g=this._renderError(),v=m.slice(0,m.length),y=0===v.length?"od-ItemActivityFeedListEmpty":"";return o.createElement("div",{className:"od-ItemActivityFeed"},o.createElement("div",{"aria-live":"assertive",role:"status","aria-atomic":"true",className:"od-ItemActivityFeed-screenReaderOnly"},this.state.feedUpdatedMessage),this._renderAddCommentField(),o.createElement("div",{className:y,"aria-label":De.e},b,o.createElement(P,{activities:v,groups:_,onRenderMissingActivity:this._onRenderMissingActivity,enableShimmer:!0,isDataReady:!a||!!i,commentsOnly:d,groupHeadingLevel:f,isReadonly:c,isNewCommentExperienceEnabled:l,deeplinkCommentThreadId:r,onHighlightCommentCard:u}),g))},t.prototype._renderError=function(){var e=this.state,t=e.activities,n=e.itemComments,a=!!this.props.commentsOnly;if(a||t.success)return a&&n&&n.missingComments?(i=n.comments.length>0?De.c:De.o,o.createElement("div",{className:"od-ItemActivityFeed-error"},i)):null;var i=t.activities.length>0?De.d:De.s;return o.createElement("div",{className:"od-ItemActivityFeed-error"},i)},t.prototype._renderNoActivitiesNote=function(e){var t=this.state,n=t.activities,a=t.showComments,i=t.itemComments,r=t.isEndOfActivities,s=this.props,c=s.commentsOnly,d=s.NoCommentsView;return!n.success||n.isPlaceholder||0!==n.activities.length&&e&&0!==e.length||n.nextRequestToken||!r||a&&!this._noCommentActivities()||c?c&&this._noCommentActivities()&&i&&!i.missingComments?d&&o.createElement(d,null)||o.createElement("div",{className:"od-ItemActivityFeed-noActivities"},De.m):null:o.createElement("div",{className:"od-ItemActivityFeed-noActivities"},De.p)},t.prototype._noCommentActivities=function(){var e=this.state,t=e.itemComments;return e.showComments&&(!t||t&&t.comments&&t.comments.length<1)},t.prototype._renderAddCommentField=function(){var e=this,t=this.props,n=t.commentListItem,a=t.isReadonly,i=t.environment,r=t.onGrantAccess,s=t.onCheckUserAccess,c=t.commentTextBoxPlaceholder,d=t.isPublicEmailAddressMentionSupported,l=t.focusCommentInputOnMount,u=t.refreshCurrentItemCallback,f=t.isWXPCommentingDisabled,p=t.platform,m=t.getPeoplePickerQueryParams,_=t.isAtMentionEnabled,h=t.isShareAndNotifyDialogDisabled,b=void 0!==h&&h,g=t.engagementExecutor,v="consumer"===i,y="sharePointList"===i,S=y?"SPList":void 0;if((!a||v||y)&&n&&!f){var D=function(t,a,i,r){e._itemCommentsStore.addComment(n,t,r,S).then(function(t){e._refreshActivityFeed(e.props),a&&a(),u&&u()},function(e){var t=e&&e.message&&e.message.value;i&&i(t)})},I=n&&n.item,x=Be&&I.extension?Object(Ne.e)(I.extension):I.extension,C=I.isRootFolder?"driveRoot":I.folder?"folder":x||"file",O=void 0!==I.sharingType?He.e[I.sharingType]:void 0;return _?o.createElement(ve,{commentItemId:n.item&&n.item.id,isPublicEmailAddressSupported:d,placeholderText:c,peoplePickerProvider:this.context.peoplePickerProvider,getPeoplePickerQueryParams:m,onSend:D,onGrantAccess:r,onCheckUserAccess:s,disabled:a,focusOnMount:l,engagementSource:"".concat(this._engagementSource,".AddComment"),engagementExtraData:{itemType:C,sharingType:O,environment:i},platform:p||new Re.e,showTeachingBubbleOnTextBox:this.props.showTeachingBubbleOnTextBox,isShareAndNotifyDialogDisabled:b,engagementExecutor:g}):o.createElement(T.e,{commentItemId:n.item&&n.item.id,placeholderText:a?c:De.t,sendButtonTitle:"",onSend:D,engagementSource:"".concat(this._engagementSource,".AddComment"),engagementExtraData:{itemType:C,sharingType:O,environment:i},disabled:a,focusOnMount:l,enableNewCommentingExperience:v||y,platform:p||new Re.e,isMentionsEnabled:!0,engagementExecutor:g})}},t.prototype._refreshActivityFeed=function(e){var t="sharePointList"===e.environment?"ItemActivityFeed-spList":"ItemActivityFeed";!e.commentsOnly&&this._store&&this._store.fetchItemActivities({item:e.containingItem,startIndex:0,currentUserEmail:e.currentUserEmail,qosPrefix:t,environment:e.environment,activityApiHeaders:e.activityApiHeaders});var n=!!e.commentListItem;n&&this._itemCommentsStore.fetchItemComments({itemWrapper:e.commentListItem,startIndex:0,currentUserEmail:e.currentUserEmail,qosPrefix:"sharePointList"===e.environment?"SPList":void 0}),this.setState({itemCommentsQueried:!1,showComments:n,isEndOfActivities:!1,deeplinkCommentThreadId:void 0}),this._removeCurrentListeners(),this._addListeners(e)},t.prototype._getViewableItemActivitiesAndGroups=function(e,t){var n,a=this.props.commentsOnly,i=[],r=[],o=function(){if(0===r.length)return 0;var e=r[r.length-1];return e.startIndex+e.count};if(e)for(var s=this.canAppendCommentsAfterOldestActivity(!!a,e,t),c=0,d=this._prepareActivitiesList(e.activities,t,s);c<d.length;c++){var u=d[c];if(u){var f=void 0;if((!a||u instanceof ye.t||u.type===l.e.comment)&&(f=this._getViewableItemActivity(u)),f){i.push(f);var p=Ce(u),m=xe[p]||p;m!==n?(r.push({key:"activityDateGroup-"+r.length,name:m,count:1,startIndex:o()}),n=m):r[r.length-1].count+=1}}}return{activities:i,dateGroups:r}},t.prototype.canAppendCommentsAfterOldestActivity=function(e,t,n){return!!((e||t&&t.success&&!t.isPlaceholder&&!t.nextRequestToken)&&n&&n.comments)},t.prototype._prepareActivitiesList=function(e,t,n){var a=this.props,i=a.commentsOnly,r=a.commentListItem,o=a.isAtMentionEnabled;if(i)return(null==t?void 0:t.comments)||[];if(!(t&&t.comments&&t.comments.length>0)){if(!r&&o){var s=new Set(e.filter(function(e){return e.type===l.e.mention&&!!e.action.mention.commentId}).map(function(e){return"".concat(e.item.graphItemUrl,"_").concat(e.action.mention.commentId)}));return e.filter(function(e){return e.type!==l.e.comment||!e.action.comment.commentId||!s.has("".concat(e.item.graphItemUrl,"_").concat(e.action.comment.commentId))})}return e}var c=e.length>0?e[e.length-1].time:new Date,d=t.comments,u=new Set;return e.concat(d).filter(function(e){return!(e.time<c&&!n||(e instanceof ye.t||e.type===l.e.comment)&&(u.has(e.action.comment.commentId)||(u.add(e.action.comment.commentId),0)))}).sort(function(e,t){return e.time>t.time?-1:e.time<t.time?1:0})},t.prototype._getViewableItemActivity=function(e){var t=this.props,n=t.currentUserEmail,a=t.containingItem,i=t.canOpenItem,o=t.onItemClick,s=t.isSingleLevel,c=t.onRenderUser,d=t.populateItemNameToDisplay,u=t.currentListTitle,f=t.currentRootTitle,p=t.defaultItemTitle,m=t.commentListItem,_=t.commentsOnly,h=t.isReadonly,b=t.canDeleteActivity,g=t.activityMenuFunctions,v=t.isNewCommentExperienceEnabled,y=t.isAtMentionEnabled,S=t.environment,D=t.getpersonaIconUrl,I=this.state,x=I.showComments,C=I.itemComments,O=I.isSPCustomListFeed,w={currentUserEmail:n,containingItem:a,canOpenItem:i,onItemClick:o,isSingleLevel:s,activity:e,strings:we,onRenderUser:c,populateItemNameToDisplay:d,currentListTitle:u,currentRootTitle:f,defaultItemTitle:p,commentListItem:m,isReadonly:h,canDeleteActivity:b,activityMenuFunctions:g&&g[e.type],isNewCommentExperienceEnabled:v,isAtMentionEnabled:y,environment:S,getpersonaIconUrl:D,displayLargeText:this._displayLargeText,isListItem:O};if(!_||e.type===l.e.comment)switch(e.type){case l.e.edit:return new ye.r(w);case l.e.move:return"sharePointList"!==S&&new ye.s(w);case l.e.comment:var E=void 0;if(x&&C){var A=this._getPopulatedCommentActivity(e);if(A&&A.isDeleted)return;E=Object(r.__assign)(Object(r.__assign)({},w),{activity:A})}return new ye.t(E||w);case l.e.commentResponse:return new ye.n(w);case l.e.mention:if(m)return;return new ye.o(w);case l.e.version:return new ye.f(w);case l.e.restore:return new ye.l(w);case l.e.rename:return new ye.d(w);case l.e.delete:return"sharePointList"!==S&&new ye.i(w);case l.e.create:return new ye.a(w);case l.e.share:return new ye.u(w);case l.e.addShortcutToOneDrive:return new ye.e(w);case l.e.removeShortcutFromOneDrive:return new ye.c(w);default:return}},t.prototype._addStoreListener=function(e){var t=this;this._storeListener=this._store&&this._store.addListener(function(){var n=t._store.getItemActivities({item:e.containingItem,currentUserEmail:e.currentUserEmail});t.setState({activities:n,isEndOfActivities:n.success&&!n.isPlaceholder&&!n.nextRequestToken})},{item:e.containingItem,currentUserEmail:e.currentUserEmail,environment:e.environment,activityApiHeaders:e.activityApiHeaders})},t.prototype._addCommentsStoreListener=function(e){var t=this,n=e.currentUserEmail,a=e.commentsOnly,i=e.commentListItem;this._commentsStoreListener=this._itemCommentsStore.addListener(function(n){var i=t._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,qosPrefix:t.state.isSPCustomListFeed?"SPList":void 0,onError:t._onFetchCommentsError,isReplyDisabled:t.state.isSPCustomListFeed});t.setState({itemComments:i,itemCommentsQueried:!!i.comments,showAllCommentActivities:!i.isPlaceHolder&&i.missingComments,isEndOfActivities:a&&i.success&&!i.isPlaceHolder&&!i.nextLink}),n&&t._announceCommentUpdate(n)},{commentItemWrapper:i,currentUserEmail:n})},t.prototype._addCommentSettingsListener=function(e){var t=this,n=e.onCommentSettingsChanged,a=e.currentUserEmail,i=e.commentListItem;this._commentSettingsListener=this._itemCommentsStore.addCommentSettingsListener(function(){var e=t._itemCommentsStore.getIsCommentsDisabled(i,a);"boolean"==typeof e&&n&&(n(e),t._announceCommentUpdate(e?u.e.CommentsDisabled:u.e.CommentsEnabled))},{commentItemWrapper:i,currentUserEmail:a})},t.prototype._addListeners=function(e){this._addStoreListener(e),e.commentListItem&&(this._addCommentsStoreListener(e),this._addCommentSettingsListener(e))},t.prototype._removeCurrentListeners=function(){this._storeListener&&this._store&&this._store.removeListener(this._storeListener),this._commentsStoreListener&&(this._itemCommentsStore.removeListener(this._commentsStoreListener),this._commentsStoreListener=void 0),this._commentSettingsListener&&(this._itemCommentsStore.removeCommentSettingsListener(this._commentSettingsListener),this._commentSettingsListener=void 0)},t.prototype._getPopulatedCommentActivity=function(e){var t=e.action&&e.action.comment;if(t&&t.commentId){var n=this._getCommentById(t.commentId);if(n)return Object(r.__assign)(Object(r.__assign)({},n),{time:e.time,friendlyDisplayTime:e.friendlyDisplayTime});if(this.state.itemCommentsQueried&&!this.state.showAllCommentActivities)return Object(r.__assign)(Object(r.__assign)({},e),{isDeleted:!0})}return e},t.prototype._getCommentById=function(e){var t=this.state.itemComments,n=t&&t.comments;if(n)for(var a=0,i=n;a<i.length;a++){var r=i[a],o=r.action&&r.action.comment&&r.action.comment.commentDetail;if(o&&o.id===e)return r}},t.prototype._announceCommentUpdate=function(e){var t=this,n="";e===u.e.DeletedAll?n=De.i:e===u.e.DeletedSingle?n=De.r:e===u.e.CommentsEnabled?n=De.a:e===u.e.CommentsDisabled&&(n=De.n),clearTimeout(this._feedUpdatedMessageTimer),this.setState({feedUpdatedMessage:n},function(){clearTimeout(t._feedUpdatedMessageTimer),t._feedUpdatedMessageTimer=window.setTimeout(function(){t.setState({feedUpdatedMessage:""})},15e3)})},t.contextTypes={itemActivityFeedStore:s.object,itemCommentsStore:s.object.isRequired,peoplePickerProvider:s.object,engagementSource:s.string},t}(o.Component),ze="CheckMark",Ge=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isActivityClicked:!n.props.isCommentsOnlyView,isCommentClicked:n.props.isCommentsOnlyView},n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.item,n=e.extraClassName;return o.createElement(o.Fragment,null,this._isMenuVisible()?o.createElement(ke.e,{className:Object(F.e)("od-ItemActivityFeed-viewOption",n),text:this._getCurrentViewOption(),menuProps:this._getViewMenuProps(t),ariaLabel:Pe.format(c.f,this._getCurrentViewOption())}):void 0)},t.prototype._isCommentsAvailable=function(e){return this.props.itemActivityFeedHelper.isActivityContextMenuAvailable(e)},t.prototype._getViewMenuProps=function(e){return{directionalHint:N.e.bottomLeftEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:this._getMenuItems(),styles:{root:"od-ItemActivityFeed-menuItems"},calloutProps:{className:"od-smallWidth"}}},t.prototype._getMenuItems=function(){var e=this,t=this.props.onSelectMenuOption;return[{key:"activityFeed.viewAll",name:c.l,ariaLabel:c.l,checked:!!this.state.isActivityClicked,onClick:function(n,a){t&&(t(!1),e.setState({isActivityClicked:!0,isCommentClicked:!1}))},iconProps:{iconName:this.state.isActivityClicked?ze:void 0}},{key:"activityFeed.commentOnly",name:c.c,ariaLabel:c.c,checked:!!this.state.isCommentClicked,onClick:function(n,a){t&&(t(!0),e.setState({isActivityClicked:!1,isCommentClicked:!0}))},iconProps:{iconName:this.state.isCommentClicked?ze:void 0}}]},t.prototype._isMenuVisible=function(){var e=this.props.item;return this._isCommentsAvailable(e)},t.prototype._getCurrentViewOption=function(){return this.props.isCommentsOnlyView?c.c:c.l},t}(o.Component),Ke=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props.item;return o.createElement(o.Fragment,null,this._isMenuVisible()?o.createElement(ke.e,{className:"od-ItemActivityFeed-viewOption-old",text:Pe.format(c.u,this._getCurrentViewOption()),menuProps:this._getViewMenuProps(e),ariaLabel:Pe.format(c.f,this._getCurrentViewOption())}):void 0)},t.prototype._isCommentsAvailable=function(e){return this.props.itemActivityFeedHelper.isActivityContextMenuAvailable(e)},t.prototype._getViewMenuProps=function(e){return{directionalHint:N.e.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:this._getMenuItems(),styles:{root:"od-ItemActivityFeed-menuItems"}}},t.prototype._getMenuItems=function(){var e=this.props.onSelectMenuOption;return[{key:"activityFeed.viewAll",name:c.l,onClick:function(t,n){e&&e(!1)}},{key:"activityFeed.commentOnly",name:c.c,onClick:function(t,n){e&&e(!0)}}]},t.prototype._isMenuVisible=function(){var e=this.props.item;return this._isCommentsAvailable(e)&&!this.props.isCommentDisabledInItemSetting},t.prototype._getCurrentViewOption=function(){return this.props.isCommentsOnlyView?c.c:c.l},t}(o.Component),We=n(1814),qe=n(67),Qe=n(119),Ye=n(533),Je=n(173),Xe=!de.e.isActivated("A757F519-CA63-49B1-A29C-F57F673BF69A","11/23/2022","Show move activities even they were done under SharePoint App, otherwise it is hard for people to know where their files went"),Ze={sharePoint:(Ee={},Ee[l.e.edit]=30,Ee[l.e.commentResponse]=30,Ee),consumer:(Ae={},Ae[l.e.edit]=30,Ae[l.e.commentResponse]=30,Ae),sharePointList:(Le={},Le[l.e.edit]=720,Le[l.e.share]=720,Le[l.e.comment]=30,Le)},$e={"SharePoint App":!0,"System Account":!0},et=function(){function e(e,t){this._baseStore=t.itemActivityFeedStore,this._dictItemActivities={}}return e.prototype.addListener=function(e,t){var n=this,a=this._getItemActivitiesDictionaryKey(t);return this._dictItemActivities[a]=this._transformItemActivities(t,this._baseStore.getItemActivities(t)),this._baseStore.addListener(function(){n._dictItemActivities[a]=n._transformItemActivities(t,n._baseStore.getItemActivities(t)),e()},t)},e.prototype.fetchItemActivities=function(e){this._baseStore.fetchItemActivities(e)},e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t]:this._baseStore.getItemActivities(e)},e.prototype.removeListener=function(e){this._baseStore.removeListener(e)},e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item.graphItemUrl;return e.currentUserEmail&&(t+="_"+e.currentUserEmail),t},e.prototype._areNewActivitiesFetched=function(e,t){var n=this._getItemActivitiesDictionaryKey(e);return!this._dictItemActivities[n]||this._dictItemActivities[n].activities.length!==t.length},e.prototype._transformItemActivities=function(e,t){var n=[];if(t.activities.length>0)for(var a={},i=0;i<t.activities.length;i++){var r=t.activities[i];if(!this._shouldHideActivity(r,e.currentUserEmail)){var o=t.activities[i-1],s=this._getCacheItemKeyAndGroupingRange(r,e.environment),c=s.cacheItemKey,d=s.groupingRange,l=r.actors[0];o&&this._isMergableMoveActivity(o,r)?this._handleMergableMoveActivity(o,r,n):c&&l?this._handleGroupableActivity(a,c,d,r,n):n.push(r)}}return!this._areNewActivitiesFetched(e,n)&&t.nextRequestToken&&this.fetchItemActivities(e),{isPlaceholder:t.isPlaceholder,activities:n,nextRequestToken:t.nextRequestToken,success:t.success}},e.prototype._handleMergableMoveActivity=function(e,t,n){n[n.length-1]={id:e.id,type:e.type,actors:e.actors,item:e.item,parentItem:e.parentItem,time:e.time,friendlyDisplayTime:e.friendlyDisplayTime,action:{move:{from:e&&e.action&&e.action.move&&e.action.move.from,to:t&&t.action&&t.action.move&&t.action.move.to}}}},e.prototype._handleGroupableActivity=function(e,t,n,a,i){var r=a.actors[0],o=this._getActorKey(r),s=e[t],c=s&&this._shouldResetGroupingItem(s,a,n);if(!s||c){var d={};d[o]=r,e[t]={activity:a,lastActivityTime:a.time,actors:d,groupedIndex:i.length},i.push(a)}else if(!s.actors[o]){if(s.actors[o]=r,1===s.activity.actors.length){var l=s.activity,u={id:l.id,type:l.type,actors:[l.actors[0]],item:l.item,parentItem:l.parentItem,time:l.time,action:l.action,friendlyDisplayTime:l.friendlyDisplayTime};s.activity=u,i[s.groupedIndex]=u}s.activity.actors.push(r)}},e.prototype._shouldResetGroupingItem=function(e,t,n){return e.lastActivityTime.getTime()-6e4*n>t.time.getTime()},e.prototype._getCacheItemKeyAndGroupingRange=function(e,t){var n,a,i=t&&Ze[t]&&Ze[t][e.type]||0;if(i){var r=void 0;e.item.driveItem&&e.item.driveItem.id?r=e.type.toString()+"_"+e.item.driveItem.id:e.item.graphItemUrl&&(r=e.type.toString()+"_"+e.item.graphItemUrl);var o=e.action.commentResponse;if(r&&o&&o.commentAuthor&&(r+="_"+o.commentAuthor.email),e.type===l.e.share){var s=null===(a=null===(n=null==e?void 0:e.action)||void 0===n?void 0:n.share)||void 0===a?void 0:a.recipients;if(s&&0!==s.length)return{}}return{cacheItemKey:r,groupingRange:i}}return{}},e.prototype._shouldHideActivity=function(e,t){var n=!1,a=e.item&&e.item.name&&e.item.name.toLowerCase();if(a){var i=a.lastIndexOf(".");if(-1!==i){var r=a.substring(i+1);Je.t.File,Ye.i(r)===Je.t.OneNote&&(n=!0)}}return n||this._isSystemAccount(e)&&!(Xe&&this._isSharePointAppMove(e))||e.type===l.e.version||!e.item},e.prototype._isSharePointAppMove=function(e){var t=e.actors.length>0&&e.actors[0];return"SharePoint App"===(null==t?void 0:t.displayName)&&e.type===l.e.move},e.prototype._isSystemAccount=function(e){var t=e.actors.length>0&&e.actors[0];return t&&$e[t.displayName]},e.prototype._isMergableMoveActivity=function(e,t){return e.type===l.e.move&&t.type===l.e.move&&e.action.move&&t.action.move&&!!e.action.move.from&&!e.action.move.to&&!t.action.move.from&&!!t.action.move.to&&e.item&&t.item&&e.item.name===t.item.name},e.prototype._getActorKey=function(e){return e.email||"@@noemail@@_"+e.displayName},e}(),tt=n(2434),nt=function(){function e(e,t){this._itemActivitiesService=t.itemActivitiesService,this._lastListenerId=-1,this._dictListener={},this._dictItemActivities={},this._promiseDeduplicator=new tt.e}return e.prototype.addListener=function(e,t){var n=this._getItemActivitiesDictionaryKey(t);return this._lastListenerId++,this._dictListener[n]||(this._dictListener[n]={}),this._dictListener[n][this._lastListenerId]=e,{key:this._lastListenerId,itemKey:n}},e.prototype.fetchItemActivities=function(e){var t=this,n=this._getItemActivitiesDictionaryKey(e),a=this._dictItemActivities[n];if(!a||0===e.startIndex){var i=0;a&&0===a.startIndex&&(i=a.noOfUnsuccessfulRequests),a={activities:{isPlaceholder:!0,activities:[],success:!0},noOfUnsuccessfulRequests:i,startIndex:0}}var r=a.activities;if(r.nextRequestToken||e.item.graphItemUrl){var o=(r.nextRequestToken||e.item.graphItemUrl)+"_"+(e.startIndex||0),s={};"consumer"===e.environment&&(s.Prefer=e.activityApiHeaders?e.activityApiHeaders:"Get-Self,Force-VaultItems-Filter"),this._promiseDeduplicator.deduplicate(o,function(){var i={item:e.item,nextRequestToken:r.nextRequestToken,qosPrefix:e.qosPrefix,headers:s,environment:e.environment};return t._itemActivitiesService.getItemActivities(i).then(function(i){i&&i.success||a.noOfUnsuccessfulRequests+1>=2?(t._dictItemActivities[n]={activities:t._mergeItemActivities(r,i,e.isScrollEvent,e.environment),noOfUnsuccessfulRequests:0,startIndex:e.startIndex},t._emitChange(e)):(t._dictItemActivities[n]={activities:r,noOfUnsuccessfulRequests:a.noOfUnsuccessfulRequests+1,startIndex:a.startIndex},t.fetchItemActivities(e))},function(e){return W.n.reject(e)})})}},e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t].activities:{isPlaceholder:!0,activities:[],success:!0}},e.prototype.removeListener=function(e){if(!this._dictListener[e.itemKey]||!this._dictListener[e.itemKey][e.key])throw"Listener with key "+e.key+" for item "+e.itemKey+" not found";delete this._dictListener[e.itemKey][e.key]},e.prototype._emitChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictListener[t];if(n)for(var a=0,i=Object.getOwnPropertyNames(n);a<i.length;a++)(0,n[i[a]])()},e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item&&(e.item.graphItemUrl||e.item.absolutePath);return e.currentUserEmail&&(t+="_"+e.currentUserEmail),t},e.prototype._mergeItemActivities=function(e,t,n,a){this._logActivitiesTelemetry(t.activities,n,a);var i=(e.activities||[]).concat(t.activities||[]);return{isPlaceholder:!e&&!t||e.isPlaceholder&&t.isPlaceholder,activities:i,nextRequestToken:t.nextRequestToken||!t&&e.nextRequestToken,success:e.success&&t&&t.success}},e.prototype._logActivitiesTelemetry=function(e,t,n){f.e.logData({name:"ActivityFeed.activitiesFetched",isIntentional:!0,extraData:{isScrollEvent:!!t,noOfActivities:e.length,environment:n}})},e}(),at=n(2568),it=Object(Qe.r)("ItemActivityFeedStore",nt,{itemActivitiesService:at.e}),rt=Object(Qe.r)("GroupedItemActivityFeedStore",et,{itemActivityFeedStore:it}),ot=n(347),st=n(2741),ct=n(1805),dt=n(70),lt=n(275),ut=n(374),ft=n(535),pt=n(169),mt=n(188),_t=n(1852),ht=n(1617);Object(d.n)([{rawString:".InfoPane-itemDetails-notificationBellODB{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";height:auto;margin-bottom:2px;font-size:16px;margin-top:3px}.InfoPane-itemDetails-notificationBellODB--loading{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";height:auto;margin-bottom:2px;font-size:16px;margin-top:3px}"}]);var bt=n(3227),gt=n(587),vt={on:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB",bellButtonIconName:"Ringer",tooltips:bt.s,isAriaChecked:!0,ariaLabel:bt.a},off:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB",bellButtonIconName:"RingerOff",tooltips:bt.o,isAriaChecked:!1,ariaLabel:bt.n},loading:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB--loading",bellButtonIconName:"Ringer",tooltips:bt.r,ariaLabel:bt.t},error:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB--loading",bellButtonIconName:"Ringer",tooltips:bt.i,ariaLabel:bt.e}},yt=function(e){function t(t,n){var a=e.call(this,t,n)||this;a._toggleNotifications=function(){if(3!==a.state.notificationState&&2!==a.state.notificationState){a.setState(function(e){return{notificationState:0===e.notificationState?1:0}});var e=a.state.notificationState,t=0===e||1!==e&&void 0;a._updateNotificationState(t)}},a._loadNotificationState=function(e){a._itemMuteNotificationDataSource.getNotificationState(e,"getNotification").then(function(e){void 0!==e?a.setState(function(){return{notificationState:e?0:1}}):a.setState({notificationState:3})})},a._updateNotificationState=function(e){void 0!==e&&a._itemMuteNotificationDataSource.updateNotificationState(e,a.props.item,"updateNotification",a._getSiteDetailsForUpdate())};var i=a.context.dependencies;return a._itemCacheStore=a.props.itemCacheStore||i.itemCacheStore,a._itemsScopeItemKey=a.props.itemsScopeItemKey||i.itemsScopeItemKey,a._scope=new mt.e,a._itemMuteNotificationDataSource=a.props.itemMuteNotificationDataSource||a._scope.attach(i.itemMuteNotificationDataSource),a.state={notificationState:2},a}return Object(r.__extends)(t,e),t.prototype.render=function(){var e;switch(this.state.notificationState){case 0:e=vt.on;break;case 1:e=vt.off,this.props.isODC&&(e.bellButtonIconName="RingerRemove");break;case 2:e=vt.loading;break;case 3:e=vt.error}return o.createElement(R.e,{content:e.tooltips,id:Object(gt.e)("bellIconTooltipHost"),styles:{root:{display:"inline-block"}},directionalHint:N.e.bottomAutoEdge},o.createElement(H.e,{className:e.bellButtonClassName,onClick:this._toggleNotifications,iconProps:{iconName:e.bellButtonIconName},role:"switch","aria-checked":e.isAriaChecked,"aria-label":e.ariaLabel,id:"od-DetailsPane-ItemMuteNotification-BellIcon-button"}))},t.prototype.componentDidMount=function(){this._loadNotificationState(this.props.item)},t.prototype.componentWillUnmount=function(){this._scope.dispose()},t.prototype.UNSAFE_componentWillUpdate=function(e){e.item!==this.props.item&&this._loadNotificationState(e.item)},t.prototype._getSiteDetailsForUpdate=function(){var e="",t="",n=this._itemsScopeItemKey;return this._itemCacheStore&&this._itemCacheStore.dispatch(Object(pt.e)(function(a){var i=Object(dt.e)(a,{itemsScopeItemKey:n}),r=Object(lt.e)(a,i);t=(null==r?void 0:r.siteId)||"",e=(null==r?void 0:r.webId)||""})),{webId:e,siteId:t}},t.contextTypes=_t.e,t}(o.PureComponent),St=Object(ht.e)("ItemMuteNotification",yt,{itemMuteNotificationDataSource:qe.M,itemCacheStore:ut.e,itemsScopeItemKey:ft.e}),Dt=n(2691),It=n(1897);Object(d.n)([{rawString:".od-ItemActivityFeedWrapper .sp-livePersonaCardAdapter-root{font-family:inherit;font-size:inherit}.od-ItemActivityFeedWrapper{display:flex;flex-direction:column}.isFluentVNext .od-ItemActivityFeedWrapper .od-addNewCommentTextField-mentionableTextBox-outer{border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:";padding:2px}.isFluentVNext .od-ItemActivityFeedWrapper .od-addNewCommentTextField-mentionableTextBox-outer:focus-within{padding:1px}.od-SharingDialogWrapper .ms-Dialog-header{display:none}.od-SharingDialogWrapper .ms-Dialog-inner{padding:0}.od-SharingDialogWrapper .ms-Dialog-inner .ms-Dialog-content{padding:0;margin:0}.od-SharingDialogWrapper .od-AtMention{min-width:unset}.od-ItemActivityFeed-header-old{display:flex;align-items:center;margin-bottom:4px}.od-ItemActivityFeed-header{display:flex;align-items:center}.od-ItemActivityFeed-header .ms-TooltipHost{margin-left:auto}.od-ItemActivityFeed-title-old{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin:0;font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font-weight:600}.od-ItemActivityFeed-title{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin:0 0 5px;font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font-weight:600}.od-ItemActivityFeed-viewOption{padding:0;align-self:flex-end;width:auto;border:none;margin-left:-4px;font-weight:600;background-color:transparent;box-shadow:none}.od-ItemActivityFeed-viewOption .ms-Button-menuIcon{font-weight:600;margin-top:3px}.od-ItemActivityFeed-viewOption.inListForm{font-size:18px;height:28px;padding:0 4px;margin-left:-8px;margin-bottom:8px;margin-top:2px}.od-ItemActivityFeed-viewOption.inListForm:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.od-ItemActivityFeed-viewOption.inListForm.is-expanded{background-color:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.od-ItemActivityFeed-viewOption.inListForm.is-expanded:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.od-DetailsPane-PrimaryPane-body .od-ItemActivityFeed-viewOption:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-DetailsPane-PrimaryPane-body .od-ItemActivityFeed-viewOption.is-expanded{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.od-DetailsPane-PrimaryPane-body .od-ItemActivityFeed-viewOption.is-expanded:hover{background-color:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.od-DetailsPane-SecondaryPane-body .od-ItemActivityFeed-viewOption:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-DetailsPane-SecondaryPane-body .od-ItemActivityFeed-viewOption.is-expanded{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-DetailsPane-SecondaryPane-body .od-ItemActivityFeed-viewOption.is-expanded:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.od-ItemActivityFeed-viewOption-old{background-color:transparent;padding:0;align-self:flex-end;margin-left:auto;width:auto}.od-ItemActivityFeed-viewOption-old .ms-Button-label{font-weight:400}.od-ItemActivityFeed-menuItems{min-width:180px;padding:0}.od-ItemActivityFeed-menuItems .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media (forced-colors:active){.od-ItemActivityFeed-menuItems .ms-ContextualMenu-icon{color:HighlightText}}.od-ItemActivityFeed-NoCommentsView{text-align:center;top:282px;position:absolute;width:calc(100% - 32px)}.od-ItemActivityFeed-NoCommentsView .noCommentsView-Image{margin-bottom:12px}.od-ItemActivityFeed-NoCommentsView .noCommentsView-Message{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400}.od-ItemActivityFeed-NoCommentsView .noCommentsView-MessagePrimary{font-size:16px;margin-top:5px;margin-bottom:10px;color:"},{theme:"black",defaultValue:"#000"},{rawString:";font-weight:600}.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .ms-ActivityItem-timeStamp,.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivity-item-textContent,.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivityList-grouplistTitle,.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-addNewCommentTextField-mentionableTextBox,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .ms-ActivityItem-timeStamp,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivity-item-textContent,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivityList-grouplistTitle,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-addNewCommentTextField-mentionableTextBox{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivity-item-nameText,.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-addNewCommentTextField-mentionableTextBox:not(:empty),.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-itemActivity-commentActivity-commentContent,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivity-item-nameText,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-addNewCommentTextField-mentionableTextBox:not(:empty),.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-itemActivity-commentActivity-commentContent{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}"}]);var xt=n(1774),Ct=n(582),Ot=n(121),wt=n(2066),Et=n(825),At=window.require.toUrl("odsp-media/images/commentspane/nocomments.svg"),Lt=function(e){var t=Object(Et.a)();return o.createElement("div",{className:"od-ItemActivityFeed-NoCommentsView"},o.createElement("div",{className:"noCommentsView-Image","aria-hidden":!0},o.createElement("img",{src:e.illustrationUrl||At})),t?o.createElement("div",{className:"noCommentsView-MessagePrimary"},c._):void 0,o.createElement("div",{className:"noCommentsView-Message"},e.message||(t?c.h:c.m)))},kt=n(146),Mt=n(215),Pt=n(1249),Tt=n(4),Ut=n(10),Ft=!de.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Ht=Object(Dt.e)(St.local.bypass),Rt=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._isAtMentionEnabled=function(e){var t;return!(null===(t=a._platform)||void 0===t?void 0:t.isIE)&&a._itemActivityFeedHelper.isAtMentionEnabled(e)},a._populateItemNameToDisplay=function(e){var t=a._itemActivityFeedHelper.getItemNameToDisplay(a.props.item,e);return e.name=t,t},a._canOpenItem=function(e){return!!a._getItemUrl(e)},a._onItemClick=function(e,t){var n=a.props.item,i=a._getItemUrl(e);a._itemActivityFeedHelper.navigateToItem(n,e,i,function(e){a._engagement.logData({name:"ActivityFeed.ItemClicked",isIntentional:!0,extraData:{activityType:t||"",itemType:e||""}})})},a._onItemCommentsSettingChanged=function(e){var t=a.props.item;if(e!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)){var n=Object(r.__assign)(Object(r.__assign)({},t.comments&&t.comments.settings),{isCommentDisabled:e}),i=a._resources.consume(ct.resourceKey);i.invalidateItem(t.key),i.invalidateItem(t.parentKey),a._itemActivityFeedHelper.updateItem(t,{comments:Object(r.__assign)(Object(r.__assign)({},t.comments),{settings:n})});var o=t&&t.properties&&t.properties.ID;a._isItemsScopeEnabled()&&a._resources.consumeAsync(qe.k).then(function(e){e.refreshItemsInCurrentItemSet([o])})}},a._refreshCurrentItem=function(){var e=a.props.item,t=e&&e.properties&&e.properties.ID;t&&a._isItemsScopeEnabled()&&a._resources.consumeAsync(qe.k).then(function(e){e.refreshItemsInCurrentItemSet([t])})},a._canDeleteActivity=function(e){var t=a.props.item;return e===l.e.comment&&a._isCommentsAvailable(t)&&a._itemActivityFeedHelper.checkHasDeletePermission(t)&&!a._itemActivityFeedHelper.isReadOnly(t)},a._onRenderUser=function(e,t){return a._itemActivityFeedHelper.renderUser(e,t)},a._deleteCommentActivity=function(e,t,n){var i=n.commentItem,r=n.commentId,o=a.props.item,s=Ft&&o.extension?Object(Ne.e)(o.extension):o.extension,c=o.isRootFolder?"driveRoot":o.folder?"folder":s||"file",d=void 0!==o.sharingType?It.e[o.sharingType]:void 0;if(e&&i&&r){var l="sharePointList"===a._itemActivityFeedHelper.getAPIEnvironment(o),u=l?"SPList":void 0;a._itemCommentsStore.deleteCommentById(i,r,t,u).then(function(){l&&a._refreshCurrentItem()}),a._engagement.logData({name:"ActivityFeed.DeleteComment",isIntentional:!0,extraData:{itemType:c,sharingType:d}})}},a._onHighlightCommentCard=function(){var e;a._deeplinkCommentThreadId&&(a._engagement.logData({name:"ActivityFeed.DeeplinkComment.Success",isIntentional:!0,extraData:{itemId:null===(e=a.props.item)||void 0===e?void 0:e.itemId,deeplinkCommentId:a._deeplinkCommentThreadId}}),a._cleanupDeeplinkCommentId())},a._cleanupDeeplinkCommentId=function(){a._itemActivityFeedHelper.cleanupDeeplinkCommentId(),a._deeplinkCommentThreadId&&(a._deeplinkCommentThreadId=void 0)},a._onCheckUserAccess=function(e,t,n){var i=a.props.item;return a._itemActivityFeedHelper.checkUserAccess(i,a.state.graphDataSource,e,t,n)},a._onGrantAccess=function(e,t,n){t&&(a._grantAccessStatusCallback=t),e&&0===e.length?a._sharingStatusCallBack("share_grantAccessCompleted"):(a._itemActivityFeedSharingHelper.setGrantees(e),a._itemActivityFeedSharingHelper.setDismissCallback(a._onDismissSharingDialog),a._itemActivityFeedSharingHelper.setStatusCallback(a._sharingStatusCallBack),a._itemActivityFeedSharingHelper.setResizeCallback(a._onResizeSharingDialog),a._itemActivityFeedSharingHelper.waitUntilReady().then(function(e){"ready"===e?a.setState({showSharingDialog:!0}):n&&n(e)}))},a._onDismissSharingDialog=function(){a.setState({showSharingDialog:!1}),a._grantAccessStatusCallback&&a._grantAccessStatusCallback("share_dismiss"),a._itemActivityFeedSharingHelper.init(a._resources,a.props.item),a._wrapperDiv.current&&Object(Ot.n)(a._wrapperDiv.current)},a._onResizeSharingDialog=function(){},a._sharingStatusCallBack=function(e){a.setState({showSharingDialog:!1}),a._grantAccessStatusCallback&&(e?a._grantAccessStatusCallback(e):a._grantAccessStatusCallback("share_error")),a._itemActivityFeedSharingHelper.init(a._resources,a.props.item)},a._resources=t.resources,a._itemActivityFeedStore=a._resources.consume(rt),a._itemCommentsStore=a._resources.consume(st.e),a._itemActivityFeedHelper=a._resources.consume(qe.O),Object(Tt.po)(Ut.MentionTeachingUIAA)&&(a._showTeachingBubbleOnTextBox=a._resources.consume(Pt.e)),a._engagement=a._resources.consume(ot.e),a._isItemsScopeEnabled=a._resources.consume(We.u.lazy),a._platform=a._resources.consume(Mt.e.optional),a._focusActivityFeedOnMount=!1,a._wrapperDiv=o.createRef(),a._isAtMentionEnabled(t.item)&&(a._itemActivityFeedSharingHelper=a._resources.consume(qe.w),a._isSharingDialogEnabled=a._itemActivityFeedSharingHelper.isShareAndNotifyDialogEnabled(a.props.item)),a._deeplinkCommentThreadId=a._itemActivityFeedHelper.getDeepLinkCommentThreadId(),a.state={graphDataSource:a._resources.consume(qe.y.optional),commentsOnly:"comments"===t.defaultViewOption||void 0!==a._deeplinkCommentThreadId,showSharingDialog:!1},a}return Object(r.__extends)(t,e),t.prototype.getChildContext=function(){return{itemActivityFeedStore:this._itemActivityFeedStore,itemCommentsStore:this._itemCommentsStore,peoplePickerProvider:this._itemActivityFeedHelper.getPeoplePickerProvider(),engagementSource:"ActivityFeed"}},t.prototype.componentDidMount=function(){this._focusActivityFeedOnMount&&this._wrapperDiv.current&&Object(Ot.n)(this._wrapperDiv.current),this.state.graphDataSource||this._loadGraphDataSource(),this._itemActivityFeedSharingHelper&&(this._itemActivityFeedSharingHelper.init(this._resources,this.props.item),this._isSharingDialogEnabled=this._itemActivityFeedSharingHelper.isShareAndNotifyDialogEnabled(this.props.item)),this._logActivityFeedRendersEvent()},t.prototype.componentDidUpdate=function(e){this._itemActivityFeedSharingHelper&&e.item&&this.props.item&&e.item.key!==this.props.item.key&&(this._itemActivityFeedSharingHelper.init(this._resources,this.props.item),this._isSharingDialogEnabled=this._itemActivityFeedSharingHelper.isShareAndNotifyDialogEnabled(this.props.item)),this._logActivityFeedRendersEvent()},t.prototype.shouldComponentUpdate=function(e,t){var n=e.item,a=this.props.item;return n&&a&&n.key!==a.key&&(Object(Tt.po)(Tt.Wr)||0===n.revision)||this._isCommentSettingsChanged(n,a)||e.resources!==this.props.resources||t.graphDataSource!==this.state.graphDataSource||t.commentsOnly!==this.state.commentsOnly||t.showSharingDialog!==this.state.showSharingDialog},t.prototype.render=function(){var e,t=this.props,n=t.item,a=t.focusCommentInputOnMount,i=t.scenario,r=t.onCloseButtonClick,s=this.state,d=s.commentsOnly,l=s.showSharingDialog,u=this._itemActivityFeedHelper.getAPIEnvironment(n),f="sharePointList"===u,p="consumer"===u||f,m=n.displayName||"",_=this._itemActivityFeedHelper.getGraphItemUrl(n,this.state.graphDataSource),h=f?{accessToken:""}:this._itemActivityFeedHelper.getAccessToken(n,this.state.graphDataSource),b=_&&(!this._itemActivityFeedHelper.isAccessTokenRequired()||h),g=this._itemActivityFeedHelper.isCommentOnItemDisabled(n);if(b){var v={name:m,graphItemUrl:_,accessToken:h},y=this._itemActivityFeedHelper.getCommentListItem(n,v)||void 0,S=this._itemActivityFeedHelper.isCommentsOnly(n,!!d),D=this._itemActivityFeedHelper.isReadOnly(n)||this._itemActivityFeedHelper.isCommentingDisabledOnTenant(u)||this._itemActivityFeedHelper.isCommentingDisabledOnList(n);this._focusActivityFeedOnMount=!(!D||!a);var I=this._itemActivityFeedHelper.isSingleLevel(n);return"consumer"===u&&y&&this._itemActivityFeedHelper.isAnonymousUser()?o.createElement(Lt,{message:c.a}):o.createElement(kt.e,{componentName:"ItemActivityFeed"},r&&o.createElement("div",{className:"activityFeed-Close"},o.createElement(H.e,{onClick:r,iconProps:{iconName:"Cancel"},title:c.b})),o.createElement("div",{className:"od-ItemActivityFeedWrapper",ref:this._wrapperDiv},o.createElement(kt.e,{componentName:"ItemActivityFeed.ViewOption"},p?this._renderItemActivityFeedViewOption(d,n,g):this._renderOldItemActivityFeedViewOption(d,n,g)),o.createElement(kt.e,{componentName:"ItemActivityFeed.MentionSharingDialog"},!0===this._isSharingDialogEnabled&&this._itemActivityFeedSharingHelper&&l&&o.createElement(xt.e,{hidden:!l,onDismiss:this._onDismissSharingDialog,"aria-label":wt._,dialogContentProps:{className:"od-SharingDialogWrapper",type:Ct.e.normal,title:""}},this._itemActivityFeedSharingHelper.renderGrantAccess())),o.createElement(Ve,{currentUserEmail:this._itemActivityFeedHelper.getCurrentUserEmail(),containingItem:v,isSingleLevel:I,canOpenItem:this._canOpenItem,onItemClick:this._onItemClick,onRenderUser:this._onRenderUser,populateItemNameToDisplay:f&&!I?this._populateItemNameToDisplay:void 0,currentRootTitle:this._itemActivityFeedHelper.getCurrentRootTitle(n),defaultItemTitle:this._itemActivityFeedHelper.getDefaultItemTitle(n),commentListItem:y,isReadonly:D,commentsOnly:S,groupHeadingLevel:"spListForm"===i?2:4,canDeleteActivity:this._canDeleteActivity,activityMenuFunctions:this._getActionMenuFunctions(),onCommentSettingsChanged:this._onItemCommentsSettingChanged,environment:u,isNewCommentExperienceEnabled:p,getpersonaIconUrl:this._itemActivityFeedHelper.getPersonaIconUrl(),commentTextBoxPlaceholder:this._getCommentTextBoxPlaceholder(n,u),activityApiHeaders:this._itemActivityFeedHelper.getActivityApiHeaders(n),isAtMentionEnabled:this._isAtMentionEnabled(n),isPublicEmailAddressMentionSupported:this._itemActivityFeedHelper.isPublicEmailAddressMentionSupported(n),onCheckUserAccess:this._onCheckUserAccess,focusCommentInputOnMount:a,onGrantAccess:this._onGrantAccess,deeplinkCommentThreadId:this._deeplinkCommentThreadId,refreshCurrentItemCallback:f?this._refreshCurrentItem:void 0,NoCommentsView:"spListForm"!==i||D?void 0:Lt,isWXPCommentingDisabled:this._itemActivityFeedHelper.isWXPCommentingDisabled(n),onHighlightCommentCard:this._onHighlightCommentCard,platform:this._platform,getPeoplePickerQueryParams:null===(e=this._itemActivityFeedSharingHelper)||void 0===e?void 0:e.getPeoplePickerQueryParams,showTeachingBubbleOnTextBox:this._showTeachingBubbleOnTextBox,isShareAndNotifyDialogDisabled:!this._isSharingDialogEnabled,engagementExecutor:this._engagement})))}return o.createElement("div",null)},t.prototype._logActivityFeedRendersEvent=function(){var e=this.props.item,t=Ft&&e.extension?Object(Ne.e)(e.extension):e.extension,n=e.isRootFolder?"driveRoot":e.folder?"folder":t||"file";this._engagement.logData({name:"ActivityFeed.Renders",isIntentional:!0,extraData:{itemType:n||""}})},t.prototype._isCommentsAvailable=function(e){return this._itemActivityFeedHelper.isNonOfficeFileCommentsAvailable(e)},t.prototype._isCommentSettingsChanged=function(e,t){return(e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled)!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)},t.prototype._getItemUrl=function(e){return this._itemActivityFeedHelper.getActivityItemUrl(e)},t.prototype._loadGraphDataSource=function(){var e=this;this._resources.consumeAsync(qe.y).then(function(t){e.setState({graphDataSource:t})})},t.prototype._getActionMenuFunctions=function(){var e;return(e={})[l.e.comment]={delete:this._deleteCommentActivity},e},t.prototype._renderItemActivityFeedViewOption=function(e,t,n){var a=this,i=this._itemActivityFeedHelper.activityHeaderToDisplay(t);return o.createElement("div",{className:"od-ItemActivityFeed-header"},i&&o.createElement("h3",{className:"od-ItemActivityFeed-title"},i),o.createElement(Ge,{isCommentsOnlyView:!!e,item:t,onSelectMenuOption:function(e){a.state.commentsOnly!==e&&a._engagement.logData({name:"ActivityFeedViewOption.Toggle.".concat(e?"Comments_Only":"All_Activity"),isIntentional:!0}),a.setState({commentsOnly:e})},itemActivityFeedHelper:this._itemActivityFeedHelper,isCommentsInActivityFeedEnabled:this._itemActivityFeedHelper.isCommentsInActivityFeedEnabled(),isCommentDisabledInItemSetting:n,extraClassName:"spListForm"===this.props.scenario?"inListForm":void 0}),this._itemActivityFeedHelper.isItemNotificationActive(t)&&o.createElement(Ht,{item:t,isODC:"consumer"===this._itemActivityFeedHelper.getAPIEnvironment(t)}))},t.prototype._renderOldItemActivityFeedViewOption=function(e,t,n){var a=this;return o.createElement("div",{className:"od-ItemActivityFeed-header-old"},o.createElement("h3",{className:"od-ItemActivityFeed-title-old"},c.d),this._itemActivityFeedHelper.isItemNotificationActive(t)&&o.createElement(Ht,{item:t}),o.createElement(Ke,{isCommentsOnlyView:e,item:t,onSelectMenuOption:function(e){a.state.commentsOnly!==e&&a._engagement.logData({name:"ActivityFeedViewOption.Toggle.".concat(e?"Comments_Only":"All_Activity"),isIntentional:!0}),a.setState({commentsOnly:e})},itemActivityFeedHelper:this._itemActivityFeedHelper,isCommentsInActivityFeedEnabled:this._itemActivityFeedHelper.isCommentsInActivityFeedEnabled(),isCommentDisabledInItemSetting:n}))},t.prototype._getCommentTextBoxPlaceholder=function(e,t){return this._itemActivityFeedHelper.isCommentingDisabledOnTenant(t)?c.o:this._itemActivityFeedHelper.isCommentingDisabledOnList(e)?c.r:this._itemActivityFeedHelper.isCommentOnItemDisabled(e)?c.s:this._itemActivityFeedHelper.isAnonymousUser()?c.n:this._itemActivityFeedHelper.checkHasCommentingPermission(e)?this._isAtMentionEnabled(e)?c.t:c.e:c.i},t.childContextTypes={itemActivityFeedStore:s.object.isRequired,itemCommentsStore:s.object.isRequired,peoplePickerProvider:s.object,engagementSource:s.string.isRequired},t}(o.Component);t.e=Rt},,,function(e,t,n){"use strict";n.d(t,"t",function(){return W});var a='\x3c!--ko if:component--\x3e\x3c!--ko if:!hasThumbnailError()--\x3e<div class="InfoPaneSection--preview" data-bind="clientRect:{size:size},component:component"></div>\x3c!--/ko--\x3e\x3c!--ko if:enableAnalyticsActionBar--\x3e<div class="InfoPaneSection--viewCountLink" data-bind="react:{componentType:analyticsActionBarComponent,props:analyticsActionBarProps}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',i=n(17);Object(i.n)([{rawString:".InfoPaneSection--preview{width:auto;height:180px;position:relative;margin-bottom:8px}.InfoPaneSection--preview .od-ImageStack-tile{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.InfoPaneSection--preview .ms-IFrameCtrl-iFrame{min-height:180px;height:180px}.InfoPaneSection--viewCountLink{font-size:14px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField{padding:5px 20px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item{height:40px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--notSupported{height:0}"}]);var r=n(0),o=n(196),s=n(1900),c=n(1859);Object(i.n)([{rawString:".ms-IFrameCtrl-title{font-size:17px}.ms-IFrameCtrl-iFrame{width:100%;border:0;min-height:200px}"}]);var d=function(e){function t(t){var n=e.call(this,t)||this,a=n.observables;n.url=a.wrap(t.url),n.title=a.wrap(t.title),n.iFrameTitle=a.wrap(t.iFrameTitle||"iFrame");var i=t.isExcludeFromScreenReader;return n.tabindex=i?"-1":null,n.role=i?"presentation":null,n._isEmailAttestationPage=a.create(!1),n.isVisible=a.pureCompute(n._computeIsVisible),n.isTitleVisible=a.pureCompute(n._computeIsTitleVisible),n.iframeOnLoad=function(e,a){try{a.target.contentWindow.location.href.toLowerCase().indexOf("emailattestation.aspx")>-1&&n._isEmailAttestationPage(!0)}catch(a){}t.onload&&t.onload(a)},n}return Object(r.__extends)(t,e),t.prototype._computeIsVisible=function(){return!!this.url()&&!this._isEmailAttestationPage()},t.prototype._computeIsTitleVisible=function(){return!!this.title()},t}(o.t),l=n(399),u=l.e({tagName:"ms-iframe",template:'\x3c!--ko if:isVisible--\x3e<div class="IFrame">\x3c!--ko if:title--\x3e<div class="ms-IFrameCtrl-title" data-bind="text:title"></div>\x3c!--/ko--\x3e<iframe class="ms-IFrameCtrl-iFrame" data-bind="attr:{src:url,role:role,tabindex:tabindex,title:iFrameTitle},event:{load:iframeOnLoad}"></iframe></div>\x3c!--/ko--\x3e',viewModel:d,synchronous:!0}),f=n(1873),p=n(2009),m=n(1),_=n(24),h=n(3130),b=n(7),g=n(67),v=n(2331),y=n(2434),S=n(2684),D=n(1116),I=n(68),x=n(438),C=function(){function e(e,t){this._pageContext=t.pageContext,this._dataRequestor=new t.dataRequestorType({qosName:"FileHoverCardFeedback"}),this._itemUrlHelper=new x.e({},{pageContext:this._pageContext})}return e.prototype.dismissRecommendedAction=function(e,t,n,a,i){var r=this._itemUrlHelper.getUrlParts({path:e.path}),o=r.webRelativeItemUrl.replace("/".concat(t),""),s={ListId:this._pageContext.listId,ListItemUniqueId:a,Operation:"RecommendationActedOn",AffectedResourceUrl:r.fullItemUrl,ItemType:"File",json:JSON.stringify({FileName:t,Scenario:"RecommendedActions",SourceRelativeUrl:o,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(i+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:n,Canvas:"Web",Workload:"SharePoint",WebId:this._pageContext.webId,SiteId:this._pageContext.siteId,SiteUrl:this._pageContext.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:t,SourceFileExtension:e.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:n,ActionType:"Dismiss"})},c=new I.t("".concat(this._pageContext.webAbsoluteUrl,"/_api/web/ActivityLogger/FeedbackDirect"));this._dataRequestor.getData({url:c.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(s),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})},e}(),O=0,w=function(){function e(e,t){this._dictListener={},this._itemAnalyticsDataSource=t.itemAnalyticsDataSource,this._dictItemAnalytics={},this._promiseDeduplicator=new y.e,t.pageContext&&(this._feedbackProvider=new C({},{pageContext:t.pageContext,dataRequestorType:function(e){function n(n){return e.call(this,n,{pageContext:t.pageContext})||this}return Object(r.__extends)(n,e),n}(D.e)})),setInterval(this._cleanCache.bind(this),18e5)}return e.prototype.addListener=function(e,t){var n="".concat(++O);return this._dictListener[t.itemId]||(this._dictListener[t.itemId]={}),this._dictListener[t.itemId][n]=e,{key:n}},e.prototype.fetchItemAnalytics=function(e,t){this._clearErrorResponse(),this._dictItemAnalytics[e.itemId]&&this._dictItemAnalytics[e.itemId].data||(this._dictItemAnalytics[e.itemId]={status:v.e.failed,data:void 0,actions:void 0},this._getAllAnalyticsData(e))},e.prototype.getItemAnalytics=function(e){return this._dictItemAnalytics[e.itemId]},e.prototype.removeListener=function(e,t){this._dictListener[t.itemId][e.key]&&delete this._dictListener[t.itemId][e.key]},e.prototype.getDailyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e)},e.prototype.getMonthlyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e,720)},e.prototype.getAllTimeItemAnalytics=function(e){return this._itemAnalyticsDataSource.getItemAnalytics(e).then(function(e){var t=e.incompleteData&&e.incompleteData.missingDataBeforeDateTime;return Object(r.__assign)({activity:{},incompleteData:{missingDataBeforeDateTime:t&&new Date(t),wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},startDateTime:e.startDateTime&&new Date(e.startDateTime)},e)})},e.prototype.cleanCachedItem=function(e){this._dictItemAnalytics[e.itemId]&&delete this._dictItemAnalytics[e.itemId]},e.prototype.updateItemKeyPoints=function(e,t){var n=this;return this._itemAnalyticsDataSource.updateItemKeyPoints(e,t).then(function(t){var a=n._dictItemAnalytics[e.itemId];if(a&&a.data&&a.data.keyPointsData&&a.data.keyPointsData.keyPoints){var i=t.filter(function(e){return"Deleted"!==e.state});a.data.keyPointsData.keyPoints=i}n._emitChange(e)},function(){n._dictItemAnalytics[e.itemId]&&(n._dictItemAnalytics[e.itemId].status=v.e.failed),n._emitChange(e)})},e.prototype.dismissRecommendedAction=function(e,t,n,a,i){this._feedbackProvider.dismissRecommendedAction(e,t,n,a,i)},e.prototype._getItemAnalyticsByInterval=function(e,t){var n=new Date;n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()));var a=new Date,i=new Date;return a.setDate(a.getDate()-90),i.setHours(a.getHours()-1440),this._itemAnalyticsDataSource.getItemAnalyticsByInterval(e,a,n,t)},e.prototype._clearErrorResponse=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status===v.e.failed&&delete this._dictItemAnalytics[e]},e.prototype._emitChange=function(e){var t=this._dictListener[e.itemId];for(var n in t)t&&t[n]()},e.prototype._cleanCache=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status!==v.e.unsupport&&delete this._dictItemAnalytics[e]},e.prototype._getAllAnalyticsData=function(e){var t=this;this._promiseDeduplicator.deduplicate(e.itemId,function(){return t._itemAnalyticsDataSource.getItemAnalyticsSections(e)}).then(function(n){t._dictItemAnalytics[e.itemId].status=v.e.succeed,t._dictItemAnalytics[e.itemId].data=n,t._emitChange(e)},function(n){var a,i=n&&n.allTimeItemAnalytics;if(i&&"FileTypeNotSupported"===i.message)a=v.e.unsupport;else{if(i&&"Canceled"===i.message||"Canceled"===n)return;a=v.e.failed}t._dictItemAnalytics[e.itemId].status=a,t._dictItemAnalytics[e.itemId].data=void 0,i&&i.error&&S.e(i.error),t._emitChange(e)})},e}(),E=n(226),A=n(2194),L=new b.t({name:"FileHoverCardStore",factory:{dependencies:{itemAnalyticsDataSource:g.t,pageContext:E.s,dataRequestorType:A.t},create:function(e){var t=new w({item:void 0},e);return{instance:t,disposable:t}}}}),k=n(29),M=n(36),P=n(347),T=n(2499),U=n(1651),F=!n(8).e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),H=function(e){function t(t){var n=e.call(this,t)||this;return n.getAccessToken=function(){return e=n.state.graphDataSource,t=n.props.item,e.getAccessToken(t,{apiVersion:"v2.1"});var e,t},n.onView=function(e){var t,a,i,r=null!==(i=null===(a=null===(t=n.props)||void 0===t?void 0:t.item)||void 0===a?void 0:a.extension)&&void 0!==i?i:"";n._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ViewClick",extraData:{extension:F&&r?Object(U.e)(r):r}}),new(n.resources.injected(n.actionMap.ShowItemAnalyticsAction))({item:_.observable(n.props.item)}).execute(e)},n.resources=t.resources,n.state={fileHoverCardStore:n.resources.consume(L.optional),graphDataSource:n.resources.consume(g.y.optional)},n.actionMap=n.resources.consume(k.e),n._engagement=n.resources.consume(P.e),n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.resources.consumeAsync(L).then(function(t){e.setState({fileHoverCardStore:t})}),this.resources.consumeAsync(g.y).then(function(t){e.setState({graphDataSource:t})})},t.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,n=e.graphDataSource,a=function(e,t){return e&&e.getItemUrl(t,{useDirectEndpoint:!0,apiVersion:"v2.1"})}(n,this.props.item),i={itemId:this.props.item.itemId,graph:this.props.item.graph,extension:this.props.item.extension,queryType:M.e[this.props.item.queryType],graphItemUrl:a,getAccessToken:this.getAccessToken};return m.createElement("div",{className:"AnalyticsActionBarField"},t&&n&&m.createElement(R,{item:i,fileHoverCardStore:t,onView:this.onView,actionBarItems:[],isViewCountClickable:!0}))},t.prototype.onShare=function(e){this._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ShareClick"}),new(this.resources.injected(this.actionMap.SelectAction))({item:_.observable(this.props.item),showProperties:!1}).execute(e),new(this.resources.injected(this.actionMap.ShowShareAction))({focusItemResourceKey:T.n}).execute(e)},t}(m.Component),R=function(e){function t(t){var n=e.call(this,t)||this;return n.state={itemAnalyticsResult:n.props.fileHoverCardStore.getItemAnalytics(n.props.item)},n}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this.setState({itemAnalyticsResult:this.props.fileHoverCardStore.getItemAnalytics(e.item)})},t.prototype.componentDidMount=function(){this._addListener()},t.prototype.componentDidUpdate=function(e){var t=this.props.fileHoverCardStore;this.props.item.itemId!==e.item.itemId&&(t.removeListener(this._storeListener,e.item),this._addListener())},t.prototype.componentWillUnmount=function(){this.props.fileHoverCardStore.removeListener(this._storeListener,this.props.item)},t.prototype.render=function(){var e=this.state.itemAnalyticsResult,t={itemAnalytics:e&&e.data,onClick:this.props.onView,isNotSupported:!1,status:e&&e.status,isCompact:!0,disableViewerCount:this.props.isViewCountClickable,isLink:this.props.isViewCountClickable},n=t&&t.itemAnalytics;return m.createElement("div",{className:"AnalyticsActionBar--item"},n?m.createElement(h.e,{analyticsStats:t,items:this.props.actionBarItems,isLink:this.props.isViewCountClickable,showActionBar:!1,farItems:[]}):null)},t.prototype._addListener=function(){var e=this,t=this.props.fileHoverCardStore;this._storeListener=t.addListener(function(){e.setState({itemAnalyticsResult:t.getItemAnalytics(e.props.item)})},this.props.item),t.fetchItemAnalytics(this.props.item)},t}(m.Component),N=n(2532),B=n(592),j=n(94),V=n(1898),z=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a._item=t.item,a.addBindingHandlers({clientRect:s.e,react:B.t});var i=a.observables;return a.size=i.create(),a._thumbnailError=i.create(),a._imageSize=i.pureCompute(a._computeImageSize),a._thumbnail=i.pureCompute(a._computeThumbnail),a._rotation=i.pureCompute(a._computeRotation),a.hasThumbnailError=i.pureCompute(a._computeHasThumbnailError),a._isImage=i.pureCompute(a._computeIsImage),a._isFolder=i.pureCompute(a._computeIsFolder),a._iframeUrl=i.pureCompute(a._computeIFrameUrl),a._isIFrame=i.pureCompute(a._computeIsIFrame),a._isItemMalicious=i.pureCompute(a._computeItemMalicious),a.component=i.pureCompute(a._computeComponent),a.analyticsActionBarComponent=H,a.analyticsActionBarProps=a.createPureComputed(a._updateAnalyticsActionBarProps),a.enableAnalyticsActionBar=a.createPureComputed(a._computeAnalyticsActionBarAvailable),a.malwareDetectedMessageComponent=N.e,a}return Object(r.__extends)(t,e),t.prototype._computeAnalyticsActionBarAvailable=function(){var e;return this._item().type!==j.e.Folder&&"personal"!==(null===(e=this._item().graph)||void 0===e?void 0:e.driveType)},t.prototype._updateAnalyticsActionBarProps=function(){return{item:this._item(),resources:this.resources}},t.prototype._computeComponent=function(){if(!this._isItemMalicious()){if(this._isIFrame())return{name:u.tagName,params:{iFrameTitle:V.previewSectionIframeTitle,title:"",url:this._iframeUrl,isExcludeFromScreenReader:!0}};if(this._isFolder())return{name:p.e.tagName,params:{item:this._item,imageRect:this._imageSize}};if(this._isImage())return{name:f.e.tagName,params:{image:this._thumbnail,rotation:this._rotation,desiredSize:this._imageSize,alignment:["fitWidth","top"],error:this._thumbnailError}}}},t.prototype._computeIsFolder=function(){var e=this._item();return!(!e||!e.folder)},t.prototype._computeIFrameUrl=function(){var e=this._item();return e&&e.previewIFrameUrl},t.prototype._computeIsIFrame=function(){return!!this._iframeUrl()},t.prototype._computeThumbnail=function(){var e=this._item();return e&&(e.orientedThumbnail||e).thumbnail},t.prototype._computeRotation=function(){var e=this._item(),t=e&&e.orientedThumbnail;return t?t.rotation:c.e.none},t.prototype._computeIsImage=function(){return!!this._thumbnail()},t.prototype._computeHasThumbnailError=function(){return this.hasThumbnailError.peek()||!!this._thumbnailError()},t.prototype._computeImageSize=function(){var e=this.size();return{width:e&&e.width||319,height:180}},t.prototype._computeItemMalicious=function(){var e=this._item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected},t.dependencies=Object(r.__assign)({},o.t.dependencies),t}(o.t),G=n(179),K=l.e({tagName:"od-infoPane-preview",template:a,viewModel:z,synchronous:!0}),W=Object(G.t)({automationName:"od-infoPane-preview",name:"PreviewSection",template:a,viewModelType:z});t.e=K},,function(e,t,n){"use strict";n.d(t,"t",function(){return pe});var a='\x3c!--ko if:!sharingApiErrorMessage()--\x3e<div class="od-SharingSection-PermissionsPile" role="group" data-bind="attr:{\'aria-label\':sharingSectionSummary}"><div class="InfoPane-sectionHeader"><h3 class="InfoPane-sectionHeaderText" data-bind="text:strings.sharingHasAccess"></h3></div>\x3c!--ko if:isLoading()--\x3e<div class="SharingSection-status" data-bind="text:statusText"></div>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e<div class="od-SharingSection-PermissionsPile-personas">\x3c!--ko if:isShareLinkVisible--\x3e<div class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:addPeopleText},keyboard:{Enter:onShareClick,Space:onShareClick},click:onShareClick,attr:{\'aria-label\':addPeopleScreenReaderText,disabled:disabledPermissionsPanelActions,\'aria-disabled\':disabledPermissionsPanelActions}"><div class="od-SharingSection-PermissionsPile-addFriend"><i class="ms-Icon ms-Icon--AddFriend" data-bind="icon:true"></i></div></div>\x3c!--ko if:shareCalloutActive()--\x3e<div data-bind="react:{componentType:shareCalloutComponent,props:shareCalloutProps}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:!privateDescription()--\x3e<div class="od-PermissionPile-accessibleLabel" data-bind="text:accessSummaryScreenReaderText"></div><ul class="od-PermissionPile-FacePile">\x3c!--ko foreach:permissionsFacepileCollection--\x3e\x3c!--ko if:linkNum--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:$parent.linksDetails()},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText,setsize:$parent.totalFacePileCount(),posinset:index+1}"><div class="od-SharingSection-PermissionsPile-personaIcon" data-bind="css:{\'od-SharingSection-PermissionsPile-personaIcon--many\':$parent.hasMultiLinks()}"><i class="ms-Icon ms-Icon--Link" data-bind="icon:true"></i>\x3c!--ko if:linkNum>1--\x3e<div class="od-SharingSection-PermissionsPile-numberText" data-bind="text:linkNum.toString()"></div>\x3c!--/ko--\x3e</div></div></li>\x3c!--/ko--\x3e\x3c!--ko if:groupNum>1--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:$parent.groupsDetails()},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText}"><div class="od-SharingSection-PermissionsPile-personaIcon" data-bind="css:{\'od-SharingSection-PermissionsPile-personaIcon--many\':groupNum>1}"><i class="ms-Icon ms-Icon--Group" data-bind="icon:true"></i><div class="od-SharingSection-PermissionsPile-numberText" data-bind="text:groupNum"></div></div></div></li>\x3c!--/ko--\x3e\x3c!--ko if:personaTile&&(!groupNum||groupNum===1&&!$parent.showPermissionsPanel())--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:personaTile.personaParams.person().name},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText}"><div class="od-PersonaTile-Persona" data-bind="component:{name:\'od-persona\',params:personaTile.personaParams}"></div></div></li>\x3c!--/ko--\x3e\x3c!--ko if:extraPersona--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:$parent.extraPersonaTooltipText},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($data),attr:{\'aria-label\':screenReadText}"><div class="od-SharingSection-PermissionsPile-personaMore"><div class="od-SharingSection-PermissionsPile-moreNumber" data-bind="text:$parent.extraPersonaText"></div></div></div></li>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</ul>\x3c!--/ko--\x3e\x3c!--ko if:privateDescription()&&!hasInheritedLink()&&isNewHasAccessControlEnable--\x3e<ul class="od-PermissionPile-FacePile od-PermissionPile-Unshared"><li class="od-Persona od-Persona--xs od-Pointer"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder"><i data-bind="icon:true" class="ms-Icon ms-Icon--Lock"></i></div></li><li class="od-Persona od-Persona--xs od-HasAccessControl od-Pointer"><div class="od-SharingSection-PermissionsPile-descriptionText" data-bind="text:privateDescription"></div></li></ul>\x3c!--/ko--\x3e</div>\x3c!--ko if:privateDescription()&&!hasInheritedLink()&&!isNewHasAccessControlEnable--\x3e<div class="od-SharingSection-PermissionsPile-description"><i class="ms-Icon ms-Icon--Lock" data-bind="icon:true"></i><div class="od-SharingSection-PermissionsPile-descriptionText" data-bind="text:privateDescription"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:hasGuest--\x3e<div class="od-SharingSection-PermissionsPile-description"><i class="ms-Icon ms-Icon--Globe" data-bind="icon:true"></i><div class="od-SharingSection-PermissionsPile-descriptionText" data-bind="text:sharedWithGuestText"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:isNewManageAccessEnabled--\x3e<div data-bind="react:{componentType:manageAccessLinkComponent,props:manageAccessLinkProps}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:isNewManageAccessEnabled()--\x3e\x3c!--ko if:isShortcut--\x3e<div data-bind="react:{componentType:manageAccessLinkComponent,props:manageAccessLinkProps}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:isShortcut()||isVault()--\x3e<div class="od-SharingSection-ManageAccessLink"><button class="od-SharingSection-ManageAccessLink-Button" data-bind="click:launchPermissionsPanel,attr:{\'aria-label\':showPermissionsPanelTooltipText,title:showPermissionsPanelTooltipText,disabled:disabledPermissionsPanelActions,\'aria-disabled\':disabledPermissionsPanelActions}"><span data-bind="text:showPermissionsPanelHintText"></span></button></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e',i=(n(2665),n(2028),n(2729),n(0)),r=n(347),o=n(1884),s=n(29),c=n(1898),d=n(39),l=n(2110),u=n(1139),f=n(196),p=n(2179),m=n(2143),_=n(2570),h=n(24),b=function(){function e(e){this.focused=h.observable(!1),this.index=e.key,this.linkNum=e.linkNum,this.groupNum=e.groupNum,this.personaTile=e.personaTile,this.extraPersona=e.extraPersona,this.screenReadText=e.screenReadText,this._disablePictureAlt()}return e.prototype._disablePictureAlt=function(){this.personaTile&&(this.personaTile.personaParams.disablePictrueAlt=!0)},e}(),g=n(1108),v=n(2561),y=n(2032),S=n(1933),D=n(2578),I=n(592),x=n(1880),C=n(2228),O=n(1964),w=n(1143),E=n(2193),A=n(1312),L=n(1796),k=n(2312),M=n(1),P=function(e){function t(t){return e.call(this,t)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props.calloutProps,t=this.props.shareProps;return M.createElement(A.e,Object(i.__assign)({},e),M.createElement(L.e,{isClickableOutsideFocusTrap:!0},M.createElement(k.e,Object(i.__assign)({onDismiss:e.onDismiss},t))))},t}(M.Component),T=n(129),U=n(10),F=n(4),H=n(1098),R=n(2380),N=n(1185),B=n(382),j=n(158),V=n(27),z=n(128),G=n(47),K=n(374),W=n(17);Object(W.n)([{rawString:".od-SharingSection-manageAccess{cursor:pointer}"}]);var q=Object(j.t)({withContext:{component:"InfoPane.SharingSection"}});function Q(e){var t=e.resources.consume(K.e);return M.createElement(q,null,M.createElement(N.e,{store:t},M.createElement(V.n,{action:M.createElement(B.t,null)},function(e){var t=e.isAvailable,n=e.execute,a=function(){var e=new z.e({name:"InfoPane.ManageAccessLink.onClick"});t?(n(),e.end({resultType:G.e.Success})):e.end({resultType:G.e.Failure})};return t?M.createElement("div",{className:"od-SharingSection-manageAccess","data-is-focusable":!!a,onClick:a,onKeyPress:function(e){!e||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),a())},tabIndex:0},M.createElement("a",{className:"ms-font-s"},c.sharingOpenPermissionsPanelHintText)):M.createElement(M.Fragment,null)})))}var Y=n(1951),J=n(119),X=n(2090),Z=n(1953),$=n(472),ee=n(2078),te=n(2061),ne=n(2536),ae=n(60),ie=function(){function e(e,t){this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider}return e.prototype.getUserPrincipalName=function(){return this._pageContext.userLoginName},e.prototype.getLppOptions=function(){var e=this;return{hostAppPlatform:"Web",hostAppRing:this._pageContext.env2,hostAppName:"ShareDialog",clientCorrelationId:this._pageContext.CorrelationId,clientType:"ShareDialog",refreshAuthToken:function(){return e.getLokiToken()},offline:this._pageContext.isExternalGuestUser}},e.prototype.getLokiToken=function(){if(this._oAuthTokenProvider){var e=new z.e({name:"PeoplePicker.GetLokiToken"});return this._oAuthTokenProvider.getToken("https://loki.delve.office.com").then(function(t){return e.end({resultType:G.e.Success}),t},function(t){if(ae.n.isCanceled(t))return e.end({resultType:G.e.ExpectedFailure,resultCode:"Canceled"}),ae.n.reject(t);e.end({resultCode:"PeoplePicker.GetLokiTokenError",resultType:G.e.Failure,extraData:{serverErrorCode:t._serverErrorCode,message:t.message}})})}},e}(),re=Object(J.r)("LivePeoplePickerHelper",ie,{oAuthTokenProvider:te.e,pageContext:$.e}),oe=Object(J.r)("PeoplePickerDataSourceWithLivePeoplePickerHelper",X.e,{apiUrlHelper:Z.e,pageContext:$.e,dataRequestor:ee.e,oAuthTokenProvider:te.e,graphPeoplePickerHelper:C.e,substratePeoplePickerHelper:ne.e,livePeoplePickerHelper:re}),se=n(2382),ce=n(8),de=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.personaTileTagName=v.e.tagName,a.panelOverlayTagName=p.e.tagName,a.dialogHostTagName=m.e.tagName,a.addBindingHandlers({toggle:l.e,bindableHtml:o.e,keyboard:g.e,selection:S.e,tooltip:u.e,react:I.t}),a._engagement=a.resources.consume(r.e);var i=a.resources.consume(se.e),f=a.observables;a.permissionsFacepileCollection=f.createArray(),a.infoPanePersonaTileCollection=f.createArray([]),a.groupPersonaTileCollection=f.createArray([]),a.peoplePersonaTileCollection=f.createArray([]),a.isExpanded=a.resources.consume(s.I.optional)||f.create(!0),a.strings=c,a.hasFocus=t.hasFocus,a.openPanelActionText=c.openPanel,a.advancedText=c.advanced,a.stopSharingText=c.stopSharing,a.emailText=c.emailEveryone,a.showPermissionsPanel=f.create(!1),a.shouldShowLinks=f.create(!1),a.hasMultiLinks=f.create(!1),a.linksDetails=f.create(""),a.groupsDetails=f.create(""),a.numberOfGroups=f.create(0),a.totalFacePileCount=f.create(0),a.extraPersonaTooltipText=f.create(""),a.addPeopleText=f.pureCompute(function(){return i()?d.format(c.OfflineCommandFormat,c.addPeople):c.addPeople}),a.addPeopleScreenReaderText=f.pureCompute(function(){return i()?d.format(c.OfflineCommandFormat,c.addPeopleButtonName):c.addPeopleButtonName}),a.disabledPermissionsPanelActions=f.pureCompute(function(){return i()}),a.showPermissionsPanelTooltipText=f.pureCompute(function(){return i()?d.format(c.OfflineCommandFormat,c.sharingOpenPermissionsPanelHintText):c.sharingOpenPermissionsPanelHintText}),a.showPermissionsPanelHintText=c.sharingOpenPermissionsPanelHintText,a.extraPersonaText=f.create(""),a.extraPersonaNumber=f.create(0),a.sharedWithGuestText=c.sharingGuestShared,a.permissionsPanelName=c.sharingPermissionsPanelName,a.isAddPeopleInReactEnabled=Object(U.isFeatureEnabled)(U.AddPeopleReact),a.shareCalloutComponent=P,a.shareCalloutProps=a.createPureComputed(a._computeShareCalloutComponentProps),a.manageAccessLinkComponent=Q,a.isNewManageAccessEnabled=f.create(Object(U.isFeatureEnabled)(U.EnableWideCenteredManageAccess)&&Object(U.isFeatureEnabled)(F.xn)&&!ce.t.isActivated("fe858624-b4db-46dc-839d-136517b1f8b6","10/12/21","launch manage access in centered, wide dialog")),a.manageAccessLinkProps=a.createObservable({resources:a.resources}),a.shareCalloutTarget=f.create(null),a.shareCalloutActive=f.create(!1);var h=t.item;a.item=h,a.isVault=f.pureCompute(function(){return!!a.item().vault});var b=a._sharingSectionHelper=new(a.managed(_.e))({item:h,hasFocus:t.hasFocus});return a.fileName=b.fileName,a.accessSummaryScreenReaderText=f.pureCompute(a._setAccessSummary),a.sharingSectionSummary=f.pureCompute(function(){return d.format(c.sharingSectionSummary,a.fileName())}),a.privateDescription=b.privateDescription,a.hasInheritedLink=b.hasInheritedLink,a.isShareLinkVisible=b.isShareLinkVisible,a.isShortcut=a.createComputed(a._computeIsShortcut),a.isLoading=b.isLoading,a.scopes=b.scopes,a.links=b.links,a.canUnshare=b.canUnshare,a.personaTileCollection=b.personaTileCollection,a.hasSettings=b.hasSettings,a.advancedUrl=b.advancedUrl,a.keyNav=b.keyNav,a.mailto=b.mailto,a.showEmailLink=b.showEmailLink,a.sharingApiErrorMessage=b.sharingApiErrorMessage,a._totalNumberOfLinks=b.totalNumberOfLinks,a.statusText=b.statusText,a.hasGuest=a.createPureComputed(a._calculateExternalUser),a.accessSummaryScreenReaderText=f.pureCompute(a._setAccessSummary),a.sharingSectionSummary=f.pureCompute(function(){return d.format(c.sharingSectionSummary,a.fileName())}),a._actionMap=a.resources.consume(s.e),a._showAction=new(a.managed(a._actionMap.ShowPermissionsAction))({item:h,engagementSource:"InfoPane"}),a.isNewHasAccessControlEnable=Object(U.isFeatureEnabled)(U.EnableNewHasAccessControl),f.compute(a._computeSparateGroupAndPeoplePersona),f.compute(a._calculateExtraPersona),f.compute(a._updateLinksData),a}return Object(i.__extends)(t,e),t.prototype.launchPermissionsPanel=function(e,t){this.disabledPermissionsPanelActions()||(this._engagement.logData({name:"ViewPermission.Sharing.InfoPaneSection.Click",isIntentional:!0}),this._executeShowPermissionsPanel(t))},t.prototype.closeDialog=function(){this.onLinkRemoved()},t.prototype.onScopeClick=function(e){this._sharingSectionHelper.onScopeClick(e.scope.item)},t.prototype.onShareClick=function(e,t){this.disabledPermissionsPanelActions()||(this._engagement.logData({name:"AddPeopleFromInfoPane.Sharing.InfoPaneSection.Click",isIntentional:!0}),this.isAddPeopleInReactEnabled?(this.shareCalloutTarget(t.target),this.shareCalloutActive(!0)):this._sharingSectionHelper.onShareClick())},t.prototype.onLinkRemoved=function(){this._sharingSectionHelper.onLinkRemoved()},t.prototype.onAdvancedClick=function(){return this._engagement.logData({name:"AdvancedSettings.Sharing.InfoPaneSection.Click",isIntentional:!0}),!0},t.prototype.stopSharing=function(){this._sharingSectionHelper.stopSharing()},t.prototype.clickEmail=function(){return this._engagement.logData({name:"EmailEveryone.Sharing.InfoPaneSection.Click",isIntentional:!0}),!0},t.prototype.moreThanOneLink=function(){return this._totalNumberOfLinks()>1},t.prototype._updateLinksData=function(){var e=this._totalNumberOfLinks();this.linksDetails(this._getLinksDetails());var t=0!==e;this.shouldShowLinks(t);var n=e>1;this.hasMultiLinks(n)},t.prototype._getLinksDetails=function(){return this._totalNumberOfLinks()>1?d.format(c.sharingLinkTitleMulti,this._totalNumberOfLinks()):c.sharingLinkTitleSingle},t.prototype._executeShowPermissionsPanel=function(e){this._showAction.execute(e).done()},t.prototype._computeIsShortcut=function(){return!!this.item().remoteItem},t.prototype._computeSparateGroupAndPeoplePersona=function(){var e=this.personaTileCollection(),t=[],n=[];if(!this.showPermissionsPanel())for(var a=0,i=e;a<i.length;a++){var r=i[a];r.personaParams.person().entityType===y.e.group?t.push(r):n.push(r)}this.groupPersonaTileCollection(t.slice()),this.peoplePersonaTileCollection(n),this.numberOfGroups(t.length),this.groupsDetails(this._getGroupsDetails())},t.prototype._getGroupsDetails=function(){return this.numberOfGroups()>1?d.format(c.sharingGroupTitleMulti,this.numberOfGroups()):c.sharingGroupTitleSingle},t.prototype._getAllUsers=function(e){for(var t={},n=0,a=e;n<a.length;n++)t[(d=a[n]).personaParams.person().userId]=!0;for(var i=0,r=this.links();i<r.length;i++){var o=r[i];if(o.linkMembers)for(var s=0,c=o.linkMembers;s<c.length;s++){var d,l=c[s],u=(d=this._sharingSectionHelper.convertPersonToPersonaTile(this.createObservable(l),l.userId)).personaParams.person.peek().userId;t[u]||(t[u]=!0,e.push(d))}}return e},t.prototype._calculateExternalUser=function(){for(var e=0,t=this.peoplePersonaTileCollection();e<t.length;e++)if(t[e].personaParams.person().isExternal)return!0;for(var n=0,a=this.links();n<a.length;n++){var i=a[n];if(i.kind===D.e.anonymousEdit||i.kind===D.e.anonymousView)return!0;for(var r=0,o=i.linkInvitees;r<o.length;r++)if(o[r].isExternal)return!0}return!1},t.prototype._calculateExtraPersona=function(){var e=(0===this._totalNumberOfLinks()?0:1)+(0===this.numberOfGroups()?0:1),t=this._getAllUsers(this.peoplePersonaTileCollection()),n=t.length,a=0;1+e+t.length>7?(n=7-e-2,a=6):a=e+t.length;var i=t.length-n;this.extraPersonaNumber(i),i>=99?this.extraPersonaText(c.sharingExtraNumberOverflow):this.extraPersonaText(d.format(c.sharingExtraNumberText,i)),this.extraPersonaTooltipText(d.format(c.sharingMoreTitle,i)),this.infoPanePersonaTileCollection(t.slice(0,n)),this.totalFacePileCount(a),this._setFacepileContent()},t.prototype._setAccessSummary=function(){var e=this._totalNumberOfLinks()+" "+d.getLocalizedCountValue(c.sharinglocTextLink,c.sharingIntervals,this._totalNumberOfLinks());e+=" "+this.numberOfGroups()+" "+d.getLocalizedCountValue(c.sharinglocTextGroup,c.sharingIntervals,this.numberOfGroups());for(var t=0,n=this.infoPanePersonaTileCollection();t<n.length;t++)e+=" "+n[t].personaParams.person().name;return this.extraPersonaNumber()&&(e+=" "+d.format(c.sharingAccessSummaryMore,this.extraPersonaNumber())),this.hasGuest()?e+=" "+d.format(c.sharingAccessSummarySharedWithGuest,this.fileName()):this.privateDescription()&&(e+=" "+c.sharingAccessSummaryNotShared),e},t.prototype._setFacepileContent=function(){var e=0,t=[],n=this.infoPanePersonaTileCollection();if(this.shouldShowLinks()){var a=d.format(c.sharingLinksScreenRead,this.linksDetails(),this.fileName()),i=new b({key:e,linkNum:this._totalNumberOfLinks(),screenReadText:this.createObservable(a)});t.push(i),e++}if(this.numberOfGroups()){var r=d.format(c.sharingGroupsScreenRead,this.groupsDetails(),this.fileName()),o=new b({key:e,groupNum:this.numberOfGroups(),screenReadText:this.createObservable(r),personaTile:this.groupPersonaTileCollection()[0]});t.push(o),e++}for(var s=0,l=n;s<l.length;s++){var u=l[s],f=u.personaParams.person().name,p=d.format(c.sharingPersonaScreenRead,f,this.fileName()),m=new b({key:e,screenReadText:this.createObservable(p),personaTile:u});t.push(m),e++}if(this.extraPersonaNumber()){var _=d.format(c.sharingExtraPeopleScreenRead,this.extraPersonaNumber().toString()),h=new b({key:e,extraPersona:this.extraPersonaNumber(),screenReadText:this.createObservable(_)});t.push(h),e++}this.permissionsFacepileCollection(t)},t.prototype._computeShareComponentProps=function(){var e,t=this.resources.consume(C.e),n=this.resources.consume(O.resourceKey),a=this.resources.consume(w.resourceKey.optional),i=this.resources.consume(E.e);if(e=Object(U.isFeatureEnabled)(U.LivePersonaPickerEnabled)?new Y.e({},{dataSource:this.resources.consume(oe)}):this.resources.consume(x.t),this.item()){var r=this.item(),o=new R.e({item:this.item.peek(),accessChecked:!1,sharingInformation:null,defaultRecipients:[],mode:H.e.addPeople,sharingContextInformation:null},{sharingProvider:n,suiteNavProvider:a,peoplePickerProvider:e,policyTipProvider:i,graphPeoplePickerHelper:t});return{copyLinkShortcut:!1,item:r,peoplePickerProvider:e,graphPeoplePickerHelper:t,sharingInformation:null,sharingProvider:n,policyTipProvider:i,maxHeight:void 0,maxWidth:480,defaultRecipients:[],mode:H.e.addPeople,sharingStore:o}}},t.prototype._computeCalloutComponentProps=function(){var e=this;return{target:this.shareCalloutTarget(),directionalHint:T.e.leftTopEdge,gapSpace:6,onDismiss:function(){e.shareCalloutActive(!1)}}},t.prototype._computeShareCalloutComponentProps=function(){return{shareProps:this._computeShareComponentProps(),calloutProps:this._computeCalloutComponentProps()}},t.dependencies=Object(i.__assign)({},f.t.dependencies),t}(f.t),le=n(399),ue=n(179),fe=Object(le.e)({tagName:"ms-sharing-info-pane-section",template:a,viewModel:de,synchronous:!0}),pe=Object(ue.t)({automationName:"ms-sharing-info-pane-section",name:"SharingSection",template:a,viewModelType:de});t.e=fe},function(e,t,n){"use strict";n.d(t,"t",function(){return x});var a='<div class="InfoPane-section InfoPaneSection--location" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h2 class="InfoPane-sectionHeaderText InfoPane-locationSectionHeaderText" data-bind="text:sectionHeader"></h2></div><div class="InfoPane-sectionContent"><div class="InfoPane-location"><div class="InfoPane-location-area"><div data-bind="bingMap:bingMapOptions"></div><div class="InfoPane-location-text" data-bind="text:location"></div></div></div></div></div>',i=n(17);Object(i.n)([{rawString:".InfoPane-location-text{margin-top:10px}.od-DetailsPane-LegacySection .InfoPaneSection--location .InfoPane-sectionHeader{border-bottom:.5px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding-bottom:4px}.InfoPane-locationSectionHeaderText{display:contents}"}]);var r=n(0),o=n(196),s=n(1898),c=n(2110);Object(i.n)([{rawString:".BingMap-controls{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";box-sizing:border-box;width:213px;padding:3px}.BingMap-controls-icon{display:inline-block;cursor:pointer}.BingMap-controls-icon .ms-Icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:10px}[dir=ltr] .BingMap-controls-icon:first-child{margin-right:5px}[dir=rtl] .BingMap-controls-icon:first-child{margin-left:5px}.BingMap-controls-icon:last-child{display:inline-block;margin-top:2px}html[dir=ltr] .BingMap-controls-icon:last-child{float:right}html[dir=rtl] .BingMap-controls-icon:last-child{float:left}[dir=ltr] .BingMap-controls-icon:last-child{margin-right:5px}[dir=rtl] .BingMap-controls-icon:last-child{margin-left:5px}"}]);var d=n(24),l=n(164),u=n(61),f=n(21),p=function(){function e(){}return e.init=function(t,n){var a=this,i=d.utils.unwrapObservable(n())||{},r=new l.e(this),o=0,c=6,u=!1,f=function(){if(!u)if(Microsoft.Maps.Location){var n=i.height||140,l=i.width||213,p={credentials:"AkQiChx2gUgMUwPYSb1Vg15L-fSor6dm_tNjKDcpIN04-6qD2eu8OlYZXvPg0yfa",enableSearchLogo:!1,enableClickableLogo:!1,showDashboard:!1,showScalebar:!1,showMapTypeSelector:!1,center:new Microsoft.Maps.Location(i.latitude(),i.longitude()),disableKeyboardInput:!0,zoom:10,height:n,width:l},m=document.createElement("div");m.style.height=n+"px",m.style.width=l+"px",t.appendChild(m);var _=new Microsoft.Maps.Map(m,p);e._addMapControls(t,_,i),d.computed(function(){i.latitude(),i.longitude(),e._updateMap.call(a,_,i)},null,{disposeWhenNodeIsRemoved:t})}else c>0?(c--,o+=500,r.setTimeout(f,o)):t.innerHTML=s.locationMapFailedLoadLocationText};window.require(["bingmapsv8"],f.bind(this)),d.utils.domNodeDisposal.addDisposeCallback(t,function(){u=!0,r.dispose()})},e._addMapControls=function(t,n,a){var i=function(e){var t=n.getZoom()+e;n&&n.setView({zoom:t})},r=document.createElement("div");r.className="BingMap-controls",r.appendChild(e._getIcon("Remove",!0,function(e){return i(-1),!1}.bind(this))),r.appendChild(e._getIcon("Add",!0,function(e){return i(1),!1}.bind(this))),r.appendChild(e._getIcon("StackIndicator",!1,function(e){var t="http://www.bing.com/maps/?v=2&where1="+a.latitude()+", "+a.longitude();return window.open(t,"_blank"),!1}.bind(this))),t.appendChild(r)},e._getIcon=function(e,t,n){var a=document.createElement("div");a.className="BingMap-controls-icon",a.onclick=n;var i=document.createElement("i");return i.className=Object(f.O)(e)+(t?" "+Object(f.O)("Circle"):""),a.appendChild(i),a},e._updateMap=function(e,t){try{var n=t.latitude(),a=t.longitude(),i=new Microsoft.Maps.Location(n,a);e.setView({center:i}),e.entities.clear();var r=new Microsoft.Maps.Pushpin(i,null);e.entities.push(r)}catch(e){u.e.log(e)}},e}(),m=n(60),_=n(39),h=function(){function e(){}return e.fetch=function(t){return new m.n(function(n,a){var i=m.n.timeout(6e4).then(function(){a("JSONP call timeout, url: "+t)}),r="OneDrive_JSONPCallback_"+e._jsonpCallbackCounter++,o=document.createElement("script");window[r]=e._evalJSONP(n,a,o,r,i),t+=(-1===t.indexOf("?")?"?":"&")+"jsonp="+r,o.src=t,document.getElementsByTagName("head")[0].appendChild(o)})},e._evalJSONP=function(e,t,n,a,i){return function(r){if(n.parentElement.removeChild(n),delete window[a],i.cancel(),"string"==typeof r)try{JSON.parse(r)}catch(e){t(e)}else JSON.parse(JSON.stringify(r))?e(r):t("JSONP call returned invalid or empty JSON")}},e._jsonpCallbackCounter=0,e}(),b={},g=function(){function e(){}return e.prototype.getLocationName=function(e,t){var n=b[e+","+t]||"";if(n)return m.n.wrap(n);var a="https://dev.virtualearth.net/REST/v1/Locations/".concat(e,",").concat(t,"?entityType=adminDistrict&c=").concat(window.$Config&&$Config.mkt||"en-us","&key=").concat("AkQiChx2gUgMUwPYSb1Vg15L-fSor6dm_tNjKDcpIN04-6qD2eu8OlYZXvPg0yfa");return h.fetch(a).then(function(a){var i=a&&200===a.statusCode&&a.resourceSets,r=i&&i.length&&i[0].resources,o=r&&r.length&&r[0].address;if(o){var c=o.locality,d=o.adminDistrict,l=o.countryRegion;l&&(n=l,d?(n=_.format(s.locationMapLocationTextWithoutCity,d,l),c&&(n=_.format(s.locationMapLocationText,c,d,l))):c&&(n=_.format(s.locationMapLocationTextWithoutDistrict,c,l))),b[e+","+t]=n}return n})},e}(),v=n(2175),y=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({toggle:c.e,bingMap:p});var i=a.observables;return a._bingDataSource=new(a.managed(g)),a.sectionHelper=new(a.managed(v.e)),a.location=i.create(""),a.bingMapOptions={latitude:i.create(0),longitude:i.create(0)},a.sectionHeader=s.locationInfoPaneHeader,a._item=t.item,i.compute(a._computeItemChanged),a}return Object(r.__extends)(t,e),t.prototype._computeItemChanged=function(){var e=this,t=this._item().geoLocation;if(t){var n=t.latitude,a=t.longitude;this._bingDataSource.getLocationName(n,a).then(function(t){e.location(t)});var i=this.bingMapOptions;i.latitude(n),i.longitude(a)}},t.dependencies=Object(r.__assign)({},o.t.dependencies),t}(o.t),S=n(399),D=n(179),I=Object(S.e)({tagName:"ms-location-section",template:a,viewModel:y,synchronous:!0}),x=Object(D.t)({automationName:"ms-location-section",name:"LocationSection",template:a,viewModelType:y});t.e=I},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return g});var a='\x3c!--ko if:isSectionVisible--\x3e<div class="InfoPane-section InfoPaneSection--extractedText" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<span class="InfoPane-sectionHeaderText" data-bind="text:sectionHeader"></span></div><div class="InfoPane-sectionContent">\x3c!--ko if:currentExtractedEmail--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextEmailTypeName"></div><p class="InfoPane-extractedText-content" data-bind="text:extractedEmail"></p>\x3c!--/ko--\x3e\x3c!--ko if:currentExtractedUrl--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextUrlTypeName"></div><p class="InfoPane-extractedText-content" data-bind="text:extractedUrl"></p>\x3c!--/ko--\x3e\x3c!--ko if:currentExtractedPhone--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextPhoneTypeName"></div><p class="InfoPane-extractedText-content" data-bind="text:extractedPhone"></p>\x3c!--/ko--\x3e\x3c!--ko if:currentExtractedText--\x3e\x3c!--ko if:currentExtractedEmail()||currentExtractedUrl()||currentExtractedPhone()--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextTextTypeName"></div>\x3c!--/ko--\x3e<p class="InfoPane-extractedText-content" data-bind="text:extractedText"></p>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e',i=n(17);Object(i.n)([{rawString:".InfoPane-extractedText-content{margin-bottom:10px;display:block}.InfoPane-extractedText-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-DetailsPane-LegacySection .InfoPaneSection--extractedText .InfoPane-sectionHeader{border-bottom:.5px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding-bottom:4px}"}]);var r,o=n(0),s=n(196),c=n(1898),d=n(2110),l=n(1805);!function(e){e[e.email=0]="email",e[e.url=1]="url",e[e.phone=2]="phone",e[e.text=3]="text",e[e.other=4]="other"}(r||(r={}));var u=r,f=n(61),p=n(2175),m=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({toggle:d.e}),a.strings=c;var i=a.observables;return a._itemProvider=a.resources.consume(l.resourceKey),a.sectionHelper=new(a.managed(p.e)),a.extractedText=i.create(""),a.extractedEmail=i.create(""),a.extractedPhone=i.create(""),a.extractedUrl=i.create(""),a.currentExtractedText=i.create(""),a.currentExtractedEmail=i.create(""),a.currentExtractedPhone=i.create(""),a.currentExtractedUrl=i.create(""),a.sectionHeader=c.extractedTextHeader,a._item=t.item,i.compute(a._computeItemChanged),a.isSectionVisible=i.pureCompute(a._computeSectionVisible),a}return Object(o.__extends)(t,e),t.prototype._computeSectionVisible=function(){return!!(this.currentExtractedEmail()||this.currentExtractedPhone()||this.currentExtractedText()||this.currentExtractedUrl())},t.prototype._computeItemChanged=function(){var e=this,t=this._item();if(t){var n=t.ocr&&t.ocr.entityTags;if(n)for(var a=0,i=n;a<i.length;a++){var r=i[a],o=u[r.type];o===u.email?(this.currentExtractedEmail(r.content),this.extractedEmail(r.content)):o===u.url?(this.currentExtractedUrl(r.content),this.extractedUrl(r.content)):o===u.phone&&(this.currentExtractedPhone(r.content),this.extractedPhone(r.content))}this._itemProvider.getItemOcrTextContent(t).then(function(t){e.currentExtractedText(t),e.extractedText(t)},function(e){f.e.log(e)})}},t.dependencies=Object(o.__assign)({},s.t.dependencies),t}(s.t),_=n(399),h=n(179),b=Object(_.e)({tagName:"ms-extracted-text-section",template:a,viewModel:m,synchronous:!0}),g=Object(h.t)({automationName:"ms-extracted-text-section",name:"ExtractedTextSection",template:a,viewModelType:m});t.e=b},function(e,t,n){"use strict";n.d(t,"t",function(){return C});var a='<div class="InfoPane-section InfoPaneSection--tags" data-bind="visible:isSectionVisible,css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h2 class="InfoPane-sectionHeaderText InfoPane-tagSectionHeaderText" data-bind="text:sectionHeader"></h2>\x3c!--ko if:showTagsEditorAction.isAvailable()&&tags().length!==0--\x3e<a class="InfoPane-tag-manageTagButton" href="#" data-bind="automation:\'manageTagLink\',text:$component.manageTagLinkLabel,click:launchTagEditor"></a>\x3c!--/ko--\x3e</div><div class="od-TaggingSection-screenReaderOnly" aria-live="assertive" role="status" data-bind="attr:{\'aria-label\':liveUpdateAnnouncement}"></div>\x3c!--ko if:tags().length===0--\x3e<div class="od-TaggingSection-addTagIcon"><i class="ms-Icon ms-Icon--Tag" data-bind="icon:true"></i></div><a class="od-TaggingSection-addTagIconButton" href="#" data-bind="automation:\'addTagIconLabel\',text:$component.addTagIconLabel,click:launchTagEditor"></a>\x3c!--/ko--\x3e<div class="InfoPane-tags" data-bind="foreach:tags"><div class="InfoPane-tag"><button class="InfoPane-tagLink newTagStyling ms-font-m" data-bind="click:navigateAction.execute.bind(navigateAction),attr:{title:tooltip,\'aria-label\':tagLabel}"><div class="InfoPane-tagName" data-bind="text:name"></div></button>\x3c!--ko if:removeAction.isAvailable()&&!isDeleting()--\x3e<button class="InfoPane-removeTag newTagStyling ms-font-s" data-bind="click:removeAction.execute.bind(removeAction),attr:{\'aria-label\':deleteTagLabel}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e\x3c!--ko if:isDeleting--\x3e<span class="InfoPane-removeTag ms-font-s" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></span>\x3c!--/ko--\x3e</div></div><div class="od-tagsFeedback-component" data-bind="react:imageTagFeedbackControlParams"></div></div>',i=n(17);Object(i.n)([{rawString:".InfoPane-tags{margin-top:10px}.InfoPane-tag,.InfoPane-tag-old{font-size:12px;display:inline-block;margin:0 8px 8px 0;white-space:nowrap;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";height:28px;line-height:28px;vertical-align:top;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}html[dir=rtl] .InfoPane-tag,html[dir=rtl] .InfoPane-tag-old{margin:0 0 8px 8px}.isFluentVNext .InfoPane-tag,.isFluentVNext .InfoPane-tag-old{border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.InfoPane-tag{border:none;height:28px;line-height:28px}.InfoPane-tagLink{display:inline-block;overflow:hidden;cursor:pointer;height:100%;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";padding:4px 8px}.InfoPane-tagLink.newTagStyling{border:none;background-color:inherit}.InfoPane-tagLink:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.isFluentVNext .InfoPane-tagLink{border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.InfoPane-tagName{display:inline-block;max-width:180px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.InfoPane-removeTag{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";text-decoration:none;display:inline-block;vertical-align:top;text-align:center;width:28px;height:28px;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";padding:0 8px}.InfoPane-removeTag.newTagStyling{border:none;background-color:inherit}.InfoPane-removeTag:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.InfoPane-removeTag .od-LoadingSpinner-loadingGif{vertical-align:text-bottom}.isFluentVNext .InfoPane-removeTag{border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.InfoPane-removeTag:hover,.InfoPane-tagLink:hover,.od-Focus--enabled .InfoPane-removeTag:focus,.od-Focus--enabled .InfoPane-tagLink:focus{color:"},{theme:"black",defaultValue:"#000"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.InfoPane-tag-addTag{font-size:12px;display:inline-block;text-decoration:none;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:5px}.InfoPane-tag-manageTagButton,.od-TaggingSection-addTagIconButton{text-decoration:none;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;line-height:16px;display:block}.od-DetailsPane-LegacySection .InfoPaneSection--tags .InfoPane-sectionHeader{border-bottom:.5px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding-bottom:4px}.InfoPane-tagSectionHeaderText{display:contents}.od-TaggingSection-addTagIcon{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";width:32px;height:32px;border-radius:50%;position:relative;font-size:16px;box-sizing:border-box;align-content:center;border:1px solid transparent;display:inline-block;padding:7px;margin:10px 0 4px 0}html[dir=ltr] .InfoPane-tag-manageTagButton{float:right}html[dir=rtl] .InfoPane-tag-manageTagButton{float:left}.od-TaggingSection-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var r=n(1872),o=n(0),s=(n(813),n(196)),c=n(2110),d=n(2482),l=n(2435),u=n(29),f=n(347),p=n(67),m=n(24),_=function(e){function t(t){var n=e.call(this,t)||this;n._tag=t.tag,n.name="#"+(n._tag.localizedTag||n._tag.tag),n.tagLabel=n.name+" "+d.tagAriaLabel,n.deleteTagLabel=d.deleteTagAriaLabel;var a=n.resources.consume(u.e),i=n.resources.consume(p.Se);return n.removeAction=new(n.managed(a.RemoveTagAction))({tag:m.observable(n._tag)}),n.navigateAction=new(n.managed(a.NavigationAction))({url:i.getTagUrl(n._tag),target:"_blank"}),n.isDeleting=m.observable(!1),n.name.length>20?n.tooltip=n.name:n.tooltip=null,n.createComputed(function(){n.removeAction.isExecuting()&&n.isDeleting(!0)}),n}return Object(o.__extends)(t,e),t}(s.t),h=n(2175),b=n(39),g=n(592),v=n(8),y=n(2103),S=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.loadingSpinnerTagName=r.e.tagName;var i=a.resources.consume(u.e);a._engagement=a.resources.consume(f.e),a.addBindingHandlers({toggle:c.e,react:g.t}),a._item=t.item,a.sectionHelper=new(a.managed(h.e)),a._initializeTags();var o=v.e.isActivated("CC961357-6EBF-4906-9AA8-44C801F4CF86","10/21/2021","Edit Tags action consistency")?i.ShowTagsEditorAction:i.EditTagsAction;return a.showTagsEditorAction=new(a.managed(o)),a.addTagIconLabel=d.addTags,a.addTagLinkLabel=d.editTags,a.manageTagLinkLabel=d.editTags,a.addTagIconLabel=d.addTags,a.sectionHeader=d.sectionHeader,a}return Object(o.__extends)(t,e),t.prototype.launchTagEditor=function(e,t){this.showTagsEditorAction.execute(t),this._engagement.logData({name:"TagsSection.LaunchTagEditor",isIntentional:!0})},t.prototype._initializeTags=function(){var e=this,t=this.observables,n=t.createArray();t.compute(function(){n(e._item().tags||[])});var a=this.addDisposable(n.filter(function(e){var t=l.e[e.source];return t!==l.e.LocationAndEventsAPI&&t!==l.e.SystemDefined})),i=this.getTagsSet(a());this.liveUpdateAnnouncement=this.addDisposable(t.compute(function(){var t=e.getTagsSet(a()),n=e.getSetAMinusSetB(i,t),r=e.getSetAMinusSetB(t,i),o="";return r.size>0&&n.size>0?o=b.format(d.tagsUpdateAnnouncement,e.getStringFormTagsSet(r),e.getStringFormTagsSet(n)):r.size>0?o=b.format(d.tagsAddedAnnouncement,e.getStringFormTagsSet(r)):n.size>0&&(o=b.format(d.tagsRemovedAnnouncement,e.getStringFormTagsSet(n))),i=t,o})),this.isSectionVisible=t.pureCompute(function(){return a().length>0||e.showTagsEditorAction.isAvailable()}),this.imageTagFeedbackControlParams={componentType:y.e,props:{isDetailsPane:!0,isTagsPivot:!1,isResultsOptions:!1,tags:a().map(function(e,t,n){return e.tag})}},this.tags=this.addDisposable(a.map({mappingWithDisposeCallback:function(t){var n=new(e.resources.injected(_))({tag:t});return{mappedValue:n,dispose:function(){return n.dispose()}}}}))},t.prototype.getTagsSet=function(e){for(var t=new Set,n=0,a=e;n<a.length;n++){var i=a[n];t.add("#"+(i.localizedTag||i.tag))}return t},t.prototype.getSetAMinusSetB=function(e,t){for(var n=new Set(e),a=0,i=Array.from(t);a<i.length;a++){var r=i[a];n.delete(r)}return n},t.prototype.getStringFormTagsSet=function(e){for(var t="",n=0,a=Array.from(e);n<a.length;n++)t=t+" "+a[n];return t.trim(),t.replace(" #",", #"),t},t.dependencies=Object(o.__assign)({},s.t.dependencies),t}(s.t),D=n(399),I=n(179),x=Object(D.e)({tagName:"ms-tags-info-pane-section",template:a,viewModel:S,synchronous:!0}),C=Object(I.t)({automationName:"ms-tags-info-pane-section",name:"TagsSection",template:a,viewModelType:S});t.e=x}],Array(78),[function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(1),r=n(2775),o=n(2364),s=n(2363),c=n(476),d=n(1750),l=n(345),u=n(21),f=n(2326),p=n(1807),m=n(51),_=(n(2333),n(2045)),h=n(1673),b=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.charsWithinParenthesisRegex=/\(([^)]*)\)/gi,a.excludedCharactersRegex=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,a.multipleSpacesRegex=/\s+/gi,a._onRenderIcon=function(){var e=a.props.activity.getIconName();return i.createElement(c.e,{iconName:e})},a._onRenderActivityDescription=function(){return i.createElement("div",{className:"od-ItemActivity-item-textContent"},a.props.activity.getTitle({isCompact:a.props.isCompact,hideDate:a.props.hideDate}))},a._onRenderActivityTimeStamp=function(e,t){if(a.props.isCompact){var n=Object(o.e)(void 0,void 0),r=Object(s.e)(n,e.className,e.activityPersonas,e.isCompact);return i.createElement("div",{className:Object(m.e)(r.timeStamp,"od-ItemActivity-timeStamp")},e.timeStamp)}return t?t(e):null},a._onRenderHiddenTimeStamp=function(e,t){return null},a._onRenderActivityDescription=a._onRenderActivityDescription.bind(a),a._onRenderIcon=a._onRenderIcon.bind(a),a.state={isFirstLoad:!0},a._focusZoneElement=null,a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isFocusedOnFirstLoad&&this._focusZoneElement&&this.state.isFirstLoad&&this._focusZoneElement.focus()},t.prototype.componentDidUpdate=function(){this.props.isFocusedOnFirstLoad&&this._focusZoneElement&&this.state.isFirstLoad&&this._focusZoneElement.focus()},t.prototype.render=function(){var e=this,t=this.props,n=t.activity,a=t.isCompact,o=t.hideDate,s=t.isInGrid,c=t.isFocusedOnFirstLoad,f=n.getIconName(),p={root:{color:Object(u.L)().palette.neutralDark},activityTypeIcon:{color:Object(u.L)().palette.themePrimary,height:"16px",marginTop:"8px"}},_=n.getResponse(),h=n.getContextualMenu(),b=!!c&&!!this.state.isFirstLoad;return i.createElement(d.e,{className:Object(m.e)("od-ItemActivity-item-focusZone",{"activitycard-deeplink-animate":b}),direction:l.e.horizontal,handleTabKey:l.t.all,"data-is-focusable":!0,role:s?"row":void 0,onBlur:function(){e._onBlur()},allowFocusRoot:!0,ref:function(t){e._focusZoneElement=t}},i.createElement("div",{role:s?"gridcell":void 0,key:"activity_".concat(n.getKey()),className:Object(m.e)({"od-ItemActivityList-activity-withCommentResponse":!!_},{"od-ItemActivityList-activity-commentWithContent":"comment"===n.getActivityTypeString()&&void 0===f},"od-ItemActivityList-activity"),"aria-label":this._getAriaLabel()},i.createElement(r.e,{key:n.getKey(),className:"od-ItemActivity-item",onRenderActivityDescription:this._onRenderActivityDescription,onRenderIcon:f&&this._onRenderIcon||void 0,activityPersonas:this._getPersonaProperties(),timeStamp:this._onRenderDate(),onRenderTimeStamp:o?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp,isCompact:a,styles:p})),h,_)},t.prototype._onRenderDate=function(){var e=this.props.activity;return(f.e(e.getFriendlyDisplayTime()||"")||p.i(e.getDate())).toString()},t.prototype._getAriaLabel=function(){var e=this.props.activity.getDescription({stringOnly:!0});return"".concat(e.join("")," ").concat(this._onRenderDate())},t.prototype._onBlur=function(){this.setState({isFirstLoad:!1})},t.prototype._getInitial=function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(this.charsWithinParenthesisRegex,"")).replace(this.excludedCharactersRegex,"")).replace(this.multipleSpacesRegex," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!==n.length&&(t+=n[0].charAt(0).toUpperCase()),t},t.prototype._getPersonaProperties=function(){var e=this.props,t=e.activity,n=e.isNewCommentExperienceEnabled,a=t.getPersonaIconUrl();if(!n)return[{imageUrl:a}];var r=t.getCommentAuthorName(),o=t.getcommentAuthorEmail(),s=r||o,c=this._getInitial(s),d=i.createElement("div",{className:"od-ItemActivity-persona"},c,i.createElement("img",{className:"od-ItemActivity-personaIcon",src:a})),l=t.getenvironment();return[{imageInitials:c,initialsColor:Object(_.e)({text:s}),onRenderInitials:function(){return"consumer"===l?i.createElement(h.e,{content:o},d):d}}]},t}(i.Component);t.default=b}],Array(93),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n(1),r=n(1533),o=n(2495),s=n(1781),c=n(318),d=n(17);Object(d.n)([{rawString:".analyticsActionBarStats_7ea0fd50{min-height:28px;height:40px;padding:12px 4px;box-sizing:border-box}.analyticsActionBar_7ea0fd50{background-color:transparent;padding-left:0;padding-right:0;box-sizing:border-box;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:35px}.analyticsActionBar_7ea0fd50 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}.analyticsActionBar_7ea0fd50 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover .ms-Button-flexContainer{background-color:transparent}[dir=ltr] .analyticsActionBar_7ea0fd50 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-right:0}[dir=rtl] .analyticsActionBar_7ea0fd50 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-left:0}.analyticsActionBar_7ea0fd50 .ms-FocusZone.ms-CommandBar{height:34px}.analyticsActionBar_7ea0fd50 .ms-FocusZone.ms-CommandBar .ms-CommandBar-primaryCommand{height:34px}.analyticsActionBar_7ea0fd50 .ms-FocusZone.ms-CommandBar .ms-CommandBar-secondaryCommand{height:34px}.analyticsActionBar_7ea0fd50 .ms-FocusZone.ms-CommandBar{background-color:transparent;padding:0;height:36px}.analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{background-color:transparent;min-width:0;height:32px;margin-top:1px;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";padding:0}[dir=ltr] .analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-left:0}[dir=rtl] .analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-right:0}.analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}[dir=ltr] .analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:4px}[dir=rtl] .analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:4px}[dir=ltr] .analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:20px}[dir=rtl] .analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:20px}.analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{font-size:12px;font-weight:400}.analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon,.analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}.analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover .ms-Button-flexContainer{background-color:transparent}.analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover .ms-Button-textContainer{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}[dir=ltr] .analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:0}[dir=rtl] .analyticsActionBar_7ea0fd50 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:0}"}]);var l="analyticsActionBar_7ea0fd50",u=n(2331),f=n(1232),p=function(e){var t=e.items,n=e.farItems,d=e.analyticsStats,p=e.isLink,m=e.showActionBar,_=void 0===m||m,h=!(!d||!d.itemAnalytics&&!d.isNotSupported&&d.status!==u.e.unsupport&&d.status!==u.e.failed),b=e.itemKey?i.createElement(f.e,{className:l,commands:t,farCommands:n}):i.createElement(r.e,{className:l,items:t,farItems:n});return i.createElement("div",null,i.createElement("div",{className:"analyticsActionBarStats_7ea0fd50"},i.createElement(s.e,{width:"35%",isDataLoaded:h,shimmerElements:[{type:c.e.line,height:8}]},i.createElement(o.e,Object(a.__assign)({isLink:p,isCompact:!0},d)))),_&&(n.length>0||t.length>0)&&b)}}],Array(1401),[function(e,t,n){"use strict";n.r(t),n.d(t,"typeResourceKey",function(){return q});var a=n(0),i=n(2957),r=n(17);Object(r.n)([{rawString:".CaptionSection--caption{margin:8px 24px}"}]);var o=n(196);Object(r.n)([{rawString:".od-EditableText .od-TextField{display:none;min-height:32px;margin:0}.od-EditableText .od-TextField-field.od-EditableText-textArea{min-height:32px;outline-style:none;margin:0 0 -4px}.od-EditableText-textArea{resize:none;overflow:hidden;cursor:text}a.od-EditableText-readOnlyArea{width:100%;text-decoration:none;border:1px solid transparent;padding:4px 3px 5px 8px;min-height:32px;display:block;font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";outline:0;box-sizing:border-box;word-wrap:break-word;cursor:default;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";padding:8px;line-height:14px}html[dir=rtl] a.od-EditableText-readOnlyArea{padding:4px 8px 5px 3px}a.od-EditableText-readOnlyArea,a.od-EditableText-readOnlyArea:hover,a.od-EditableText-readOnlyArea:visited{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}a.od-EditableText-readOnlyArea--interactive:focus,a.od-EditableText-readOnlyArea--interactive:hover{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";cursor:text}a.od-EditableText-readOnlyArea--empty{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-EditableText--editMode .od-TextField{display:block}.od-EditableText--editMode .od-EditableText-readOnlyArea{display:none}"}]);var s,c=n(251),d=n(101),l=n(253),u=n(164),f=n(112),p=n(24),m="od-EditableText--editMode",_=function(){function e(){}return e.init=function(t,n,a,i,r){var o=n(),s=i,_='<div class="od-TextField od-TextField--multiline"><textarea data-bind="value: $data.text" class="od-TextField-field od-EditableText-textArea"'+(o.maxLength?' maxlength="'+o.maxLength+'" ':"")+"></textarea></div>";l.e.toggleClass(t,"od-EditableText",!0),t.innerHTML=_+'<a data-bind="text: $data.text" class="od-EditableText-readOnlyArea" href="javascript:void(0)"></a>';var h,b=t.querySelector("textarea"),g=t.querySelector("a"),v=new d.t(null),y=new u.e,S=function(n){if((void 0===o.isEditable||o.isEditable())&&(l.e.toggleClass(t,m,!0),e._updateTextAreaHeight(b),b.focus(),b.select))try{b.select()}catch(e){}},D=function(){o.onSubmitChange&&(o.onSubmitChange.call(s,b.value),l.e.toggleClass(t,m,!1))};return p.applyBindingsToDescendants(r,t),v.on(g,"click",S),v.on(b,"keydown",function(e){h=e.keyCode,o.onRevertChange&&h===f.e.escape&&(o.text(b.value),o.onRevertChange.call(s),l.e.toggleClass(t,m,!1)),h===f.e.enter&&(o.text(b.value),D()),e.stopPropagation()}),v.on(b,"keyup",function(e){o.text(b.value)}),v.on(b,"blur",function(e){h!==f.e.enter&&D()}),p.computed(function(){var t=!o.text(),n=void 0===o.isEditable||o.isEditable();o.placeholder&&(b.setAttribute("placeholder",o.placeholder()),t&&(g.innerHTML=o.placeholder())),b.value=o.text(),t||(g.innerHTML=c.e.encodeText(o.text())),l.e.toggleClass(g,"od-EditableText-readOnlyArea--empty",t),l.e.toggleClass(g,"od-EditableText-readOnlyArea--interactive",n),e._updateTextAreaHeight(b)},null,{disposeWhenNodeIsRemoved:t}),p.utils.domNodeDisposal.addDisposeCallback(t,function(){y.dispose(),v.dispose()}),p.unwrap(o.hasFocus)&&y.setTimeout(function(){S()},300),{controlsDescendantBindings:!0}},e._updateTextAreaHeight=function(e){e.offsetHeight<e.scrollHeight&&(e.style.height=e.scrollHeight+0+"px")},e}(),h=n(29),b=n(1898),g=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources.consume(h.e),i=n.observables,r=n._item=t.item,o=n._text=i.create(""),s=n._updateCaptionAction=new(n.resources.injected(a.UpdateCaptionAction))({caption:o,item:r}),c=n._isEditable=s.isAvailable;return n.bindingParams={text:o,hasFocus:t.hasFocus,maxLength:255,placeholder:i.pureCompute(n._computePlaceholder),isEditable:c,onRevertChange:n._onRevertChange.bind(n),onSubmitChange:n._onSubmitChange.bind(n)},n.addBindingHandlers({editableText:_}),i.compute(n._computeItemChanged),n}return Object(a.__extends)(t,e),t.prototype._onRevertChange=function(){var e=this._item.peek();this._text(e&&e.caption||"")},t.prototype._onSubmitChange=function(){var e=this._item.peek(),t=this._text.peek(),n=t.trim()&&t;this._text(n),this._isEditable.peek()&&e.caption!==n&&(e.caption=n,this._updateCaptionAction.execute(null))},t.prototype._computeItemChanged=function(){var e=this._item(),t=e&&e.caption||"";this._text(t)},t.prototype._computePlaceholder=function(){var e=this._item();return this._isEditable()?e&&e.photo?b.captionAddCaption:b.captionAddDescription:""},t}(o.t),v=n(399),y=Object(v.e)({tagName:"ms-caption-section",template:'<div class="InfoPaneSection--caption"><div data-bind="editableText:bindingParams" class="CaptionSection--caption"></div></div>',viewModel:g,synchronous:!0}),S=n(2952),D=n(2956),I=n(2813),x=n(1024),C=n(1022);!function(e){e[e.TagsOnly=0]="TagsOnly",e[e.Other=1]="Other"}(s||(s={}));var O=s,w=n(2951),E=n(2949),A=n(1875),L=n(67),k=n(1809),M=n(58),P=n(10),T=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.urlDataSource=n.urlDataSource,r=a.sections={},o=n.hidePreview;return r[16]=a.createSection(16,E.e,function(e){if(1!==e.length)return!1;var t=e[0],n=t.folder;return(!o||!o())&&((!!t.thumbnail||t.previewIFrameUrl)&&t.size&&t.size>0||!!n&&!!n.covers&&n.covers.length>0)}),r[11]=a.createSection(12,I.e,function(e){if(1!==e.length)return!1;var t=e[0];return t&&!t.isPlaceholder&&!t.isRootFolder&&!(x.e.isShortcutItem(t)&&Object(P.isFeatureEnabled)(P.ShortcutLink))}),r[8]=a.createSection(8,w.e,function(e){if(1!==e.length)return!1;var t=e[0];if(t&&!i.isRecycleBin(t.queryType)&&(!t.isRootFolder||t.list&&!t.list.isDocumentLibrary))switch(t.sharingRole){case A.e.Owner:case A.e.Edit:case A.e.CoOwner:return!0}return!1}),a}return Object(a.__extends)(t,e),t.prototype.createSection=function(e,t,n){return{type:e,legacyComponent:{name:t.tagName,params:{isScheduling:!1}},isAvailable:n}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},M.n.dependencies),{urlDataSource:L.Se,hidePreview:k.e.infoPane.hidePreview.optional}),t}(M.n),U=(n(2881),n(592)),F=n(2946),H=n(2175),R=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({react:U.t});var a=n.resources.consume(h.I.optional);return n.sectionHelper=new(n.managed(H.e))({shouldStartExpanded:!a||!a.peek()}),n.controlComponent=F.e,n.controlProps=n.observables.pureCompute(function(){return{item:t.item(),resources:n.resources}}),n}return Object(a.__extends)(t,e),t}(o.t),N=Object(v.e)({tagName:"ms-activities-feed-react",template:'<div class="od-DetailsPane-ItemActivityFeedSection" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="od-DetailsPane-ItemActivityFeedSection-content"><div data-bind="react:{componentType:controlComponent,props:controlProps}"></div></div></div>',viewModel:R,synchronous:!0}),B=n(377),j=n(36),V=n(810),z=n(119),G=n(2468),K=n(8),W=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._identityDataSource=n.identityDataSource;var i=new(a.scope.attached(n.itemSelectionHelperType))({canFallback:!0,ignoreSelection:!0});return a._currentItem=i.currentItem,a._isFilesTab=a.createPureComputed(a._checkIsFilesTab),a._isRecycleBin=a.createPureComputed(a._checkIsRecycleBin),a}return Object(a.__extends)(t,e),t.prototype.getSectionGroups=function(){var e=this,t=this.urlDataSource,n=this.sections,a=this._identityDataSource.getIdentity().type===B.e.anonymous,r=[n[16]],o=[];return r.push(this.createSection(1,y,function(e){if(1!==e.length)return!1;var t=e[0];return void 0!==t.caption&&!t.isRootFolder&&!t.isBundle})),a||this._isRecycleBin()||r.push(n[8]),a?r.push(this.createSection(9,N,function(t){return e._isDriveRootSelected(t)})):r.push(this.createSection(9,N,function(t){if(1!==t.length)return!1;var n=t[0],a=n.isRootFolder,i=n.sharingRole,r=n.vault,o=n.isPlaceholder,s=n.graph,c=s&&s.itemId&&(K.e.isActivated("E1B90D96-7497-4B95-8296-2C5D9BF02655","03/24/2022","ItemId and DriveId check for comments")?s.itemId.indexOf("!")>=0:s.itemId!==s.driveId);return!e._isRecycleBin()&&(a&&e._isFilesTab()||!a&&c)&&(i===G.e.Owner||i===G.e.Edit||i===G.e.View)&&!(r&&r.root)&&!o})),Object(P.isFeatureEnabled)(P.EnableTagsInODC)&&o.push(this.createSection(5,i.e,function(e){if(1!==e.length)return!1;var t=e[0];return!!t.tags&&!t.virtualItemType})),o.push(this.createSection(4,S.e,function(e){if(1!==e.length)return!1;var t=e[0],n=t.geoLocation;return!t.virtualItemType&&!!(n&&n.latitude&&n.longitude)}),this.createSection(6,D.e,function(e){if(1!==e.length)return!1;var n=e[0];return!(!n.photo||!n.urls||!n.urls[C.e[C.e.textContent]]||t.isRecycleBin(n.queryType)||n.ocr&&O[n.ocr.engineVersion]===O.TagsOnly)}),this.createSection(11,I.e,function(e){if(1!==e.length)return!1;var t=e[0];return t&&!t.isPlaceholder&&!t.isRootFolder&&!t.virtualItemType&&!(x.e.isShortcutItem(t)&&Object(P.isFeatureEnabled)(P.ShortcutLink))})),[{sections:r},{sections:o}]},t.prototype._isDriveRootSelected=function(e){return 1===e.length&&!!e[0].isRootFolder&&this._isFilesTab()},t.prototype._checkIsFilesTab=function(){var e=this._currentItem();return(e.queryType?e.queryType:this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(e.key)))===j.e.Files},t.prototype._checkIsRecycleBin=function(){var e=this._currentItem();return(e.queryType?e.queryType:this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(e.key)))===j.e.RecycleBin},t.dependencies=Object(a.__assign)(Object(a.__assign)({},T.dependencies),{itemSelectionHelperType:V.e,identityDataSource:L.D,itemCommentDataSource:L.L.optional,itemActivityFeedHelper:L.O.optional}),t}(T),q=Object(z.o)("InfoPaneManager",W);t.default=W}])]);