(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[150],{3270:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".ms-ContextualMenu-icon{font-size:1rem;width:1rem}.ms-ContextualMenu-icon.ms-Icon--Info{margin-top:2px}.ms-ContextualMenu-icon[data-icon-name=ExcelLogo]{color:"},{theme:"excelColor",defaultValue:"#217346"},{rawString:"}.ms-ContextualMenu-icon[data-icon-name=OneNoteLogo]{color:"},{theme:"onenoteColor",defaultValue:"#5c2d91"},{rawString:"}.ms-ContextualMenu-icon[data-icon-name=PowerPointLogo]{color:"},{theme:"powerpointColor",defaultValue:"#d24726"},{rawString:"}.ms-ContextualMenu-icon[data-icon-name=WordLogo]{color:"},{theme:"wordColor",defaultValue:"#2b579a"},{rawString:"}.ms-ContextualMenu-icon[data-icon-name=VisioLogo]{color:"},{theme:"visioColor",defaultValue:"#3854a2"},{rawString:"}.ms-ContextualMenu-icon.od-NeedsAttentionViewIcon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.ms-ContextualMenu-icon.ms-Icon--CustomIcon,.ms-ContextualMenu-icon.ms-Icon--custom{width:1rem;height:2.25rem;background-size:contain}.ms-ContextualMenu-link{font-size:.875rem;height:2.25rem;line-height:2.25rem}.ContextualMenu-uploadInput{position:absolute;top:0;bottom:0;left:0;right:0;opacity:.0001;cursor:pointer;overflow:hidden;z-index:9999999}.ContextualMenu-uploadInput input{position:absolute;top:0;font-size:200px;height:100px;cursor:pointer;margin:0;padding:0}[dir=ltr] .ContextualMenu-uploadInput input{right:0}[dir=rtl] .ContextualMenu-uploadInput input{left:0}.ContextualMenu-uploadInput-container{box-sizing:border-box;padding:0}.ContextualMenu-uploadInput-Text{display:block}"}])},4639:function(e,t,n){"use strict";n.r(t),n.d(t,"ReactContextualMenu",function(){return _});var a=n(0),i=n(1),r=n(24),o=n(1772),s=n(266),c=n(129),d=n(350),l=n(154),u=n(419),f=n(17);Object(f.n)([{rawString:".ms-ContextualMenu-uploader{font:inherit;color:inherit;background:0 0;border:none;width:100%;height:36px;display:block;cursor:pointer}html[dir=ltr] .ms-ContextualMenu-uploader{text-align:left}html[dir=rtl] .ms-ContextualMenu-uploader{text-align:right}.ms-ContextualMenu-uploader:hover:not([disabled]){background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.ms-ContextualMenu-uploader.is-disabled,.ms-ContextualMenu-uploader[disabled]{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";cursor:default;pointer-events:none}.ms-ContextualMenu-uploader .ContextualMenu-uploadInput-Text{padding:0 6px}"}]);var p=function(e){function t(t){var n=e.call(this,t)||this;return n._onInputClick=function(){n.props.currentStateCallback&&n.props.currentStateCallback(!0)},n._onChange=function(e){n.props.currentStateCallback&&n.props.currentStateCallback(!1),n.commandItem.onInputChange(e)},n.commandItem=t.commandItem,n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._inputElement&&this.props.commandItem.targetCommand().inputType()===u.e.folderUpload&&(this._inputElement.webkitdirectory=!0)},t.prototype.componentWillUnmount=function(){this.props.currentStateCallback&&this.props.currentStateCallback(!1)},t.prototype.render=function(){var e=this;return i.createElement("div",{className:"ms-ContextualMenu-uploader ContextualMenu-uploadInput-container"},i.createElement("div",{className:"ContextualMenu-uploadInput"},i.createElement("input",{type:"file",className:"ContextualMenu-fileInput",multiple:!0,onChange:this._onChange,onClick:this._onInputClick,ref:function(t){return e._inputElement=t},"data-is-focusable":!1})),i.createElement("button",{role:"menuitem",className:"ms-ContextualMenu-uploader",onClick:function(){return e._inputElement.click()}},i.createElement("span",{className:"ms-ContextualMenu-itemText ContextualMenu-uploadInput-Text"},this.commandItem.label())))},t}(i.Component),m=n(215),_=(n(3270),function(e){function t(t){var n=e.call(this,t)||this;return n._uploadInputClicked=!1,n._onDismiss=function(e){e&&!n._shouldDismissUploader(e)||(n.isOpen()&&n.isOpen(!1),n.props.close&&n.props.close())},n.isOpen=t.isOpen||r.observable(!0),n._disposables=[n._async,n._events],n._platform=t.resources.consume(m.e),n._isIOSMobileSafari=n._platform.isIOS&&n._platform.isMobile&&n._platform.isSafari,n.state={items:n._convertItemsToReact(t.items),isBeakVisible:!t.isBeakVisible||t.isBeakVisible(),alignment:n._convertAlignmentToDirectionalHint(t.alignment)},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t,n=this.props,a=n.target,s=n.anchorElement,c=n.launchEvent;if(this.props.left&&this.props.top){var l=parseInt(r.utils.unwrapObservable(this.props.left),10),u=parseInt(r.utils.unwrapObservable(this.props.top),10);isNaN(l)||isNaN(u)||(e=new d.t(l,u))}return t=e&&!s&&c&&c.clientX&&c.clientY?c:a,i.createElement(o.e,{items:this.state.items,target:t,isBeakVisible:!!this.props.anchorElement&&this.state.isBeakVisible,directionalHint:this.state.alignment,onDismiss:this._onDismiss,doNotLayer:!0,directionalHintFixed:this.props.hasExplicitAlignment})},t.prototype.componentWillUnmount=function(){this._disposables&&this._disposables.forEach(function(e){e&&e.dispose()})},t.prototype.componentDidMount=function(){var e=this;this.isOpen()||this.isOpen(!0),this._createComputed(function(){e.setState({items:e._convertItemsToReact(e.props.items),isBeakVisible:!e.props.isBeakVisible||e.props.isBeakVisible(),alignment:e._convertAlignmentToDirectionalHint(e.props.alignment)})}),this._createComputed(function(){e.isOpen&&!r.utils.unwrapObservable(e.isOpen)&&e._onDismiss()})},t.prototype._convertItemsToReact=function(e,t){void 0===t&&(t=!1);for(var n=new Array,a=r.utils.unwrapObservable(e).filter(function(e){return e.isVisible()}),i=0;i<a.length;i++){var o=a[i];o.hasLineBreakBefore()&&n.length>1&&"-"!==n[n.length-1].name&&n.push({name:"-",key:"breakBefore"+i.toString(),itemType:s.e.Divider}),n.push(this._convertCommandItemToMenuItem(o,t,i)),o.hasLineBreakAfter()&&a.length-1!==i&&n.push({name:"-",key:"breakAfter"+i.toString(),itemType:s.e.Divider})}return n},t.prototype._convertCommandItemToMenuItem=function(e,t,n){var a=this,o=null,s=e.targetCommand(),c=s.inputType(),d=r.unwrap(s.children);c!==u.e.htmlFileUpload&&c!==u.e.folderUpload||(o=function(){return i.createElement(p,{currentStateCallback:function(e){return a._uploadInputClicked=e},commandItem:e,key:n.toString()})});var l=d&&d.length>0?this._convertItemsToReact(d,!0):null;return{name:r.unwrap(e.label),key:n.toString(),iconProps:this._getIcon(e),onClick:function(t,n){return e.onClick(s,a.props.launchEvent||t)},subMenuProps:l&&{items:l,isSubMenu:t,onMenuOpened:e.callback?function(){return e.callback()}:null},onRender:o,"data-automationid":e.automationId,ariaLabel:r.unwrap(e.computedAccessibleLabel),canCheck:e.isToggleable,checked:e.isToggleable?r.unwrap(e.isToggled):null,title:r.unwrap(e.tooltip)}},t.prototype._getIcon=function(e){var t=void 0;return this.props.hideIcons||(r.unwrap(e.icon)&&""!==e.getIcon("")?t={iconName:r.unwrap(e.icon).toString(),className:r.unwrap(e.icon).getExtraClasses()}:r.unwrap(e.iconUrl)&&(t={iconName:"CustomIcon",style:{backgroundImage:"url(".concat(r.unwrap(e.iconUrl),")"),width:"16px",height:"16px",backgroundSize:"16px"}})),t},t.prototype._convertAlignmentToDirectionalHint=function(e){var t,n=(t="string"==typeof e?l.e[e]:r.utils.unwrapObservable(e))&l.e.Right,a=t&l.e.Bottom,i=t&(l.e.Center|l.e.VerticalCenter);return n?a?c.e.topRightEdge:c.e.bottomRightEdge:i?a?c.e.topCenter:c.e.bottomCenter:a?c.e.topLeftEdge:c.e.bottomLeftEdge},t.prototype._createComputed=function(e){var t=r.computed;this._disposables.push(t(e.bind(this)).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}))},t.prototype._shouldDismissUploader=function(e){return!(this._isIOSMobileSafari&&this._uploadInputClicked&&("resize"===e.type||"scroll"===e.type))},t}(i.Component));t.default=_}}]);