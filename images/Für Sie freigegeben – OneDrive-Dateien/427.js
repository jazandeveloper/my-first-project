(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[427],{2358:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(10),r=n(58),o=n(119),s=n(104),c=n(64),d=n(78),l=n(93),u=n(483),f=n(328),p=n(257),m="CoachmarkTearDropSeen",_={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._dataStore=new s.e("CoachmarkProvider",c.e.session),a._currentCampaign=a.createObservable(_),a._isVisible=a.createObservable(!1),a._navigation=n.navigation,a._firstRunExperienceStatus=n.firstRunExperienceStatus,a._currentTeachingBubble=a.createObservable({campaign:a._currentCampaign,isVisible:a._isVisible}),a._navigation.viewParams.resetAllBubbles&&a._dataStore.remove(m);var i=a.resources.consume(p.e);return a._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return a.resources.consume(l.w)}),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0}),t.prototype.hideCampaign=function(){this._isVisible(!1),this._currentCampaign(_)},t.prototype.setCampaign=function(e){var t=this;if(!e)return this._currentCampaign(_),void this._isVisible(!1);if(this._firstRunExperienceStatus.get()!==f.e.visible){var n="".concat(e.name).concat(m);this._dataStore.getValue(m)||this._teachingBubbleProviderPromise.then(function(a){a&&a.shouldBubbleBeAdded(e,!1).then(function(a){a&&(t._currentCampaign(e),t._isVisible(!0),t._dataStore.setValue(n,!0))})})}},t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{navigation:d.e,firstRunExperienceStatus:u.e}),t}(r.n),b=Object(o.r)("CoachmarkProvider",h)},4369:function(e,t,n){"use strict";n.r(t),n.d(t,"OpenInImageEditorHandler",function(){return E});var a=n(0),i=n(215),r=n(2566),o=n(58),s=n(60),c=n(67),d=n(810),l=n(1924),u=n(36),f=n(151),p=n(322),m=n(3151),_=n(2266),h=n(10),b=n(131),g=n(608),v=n(2358),y=n(94),S=n(1875),D=n(86),I=n(79),x={jpg:"image/jpg",jpeg:"image/jpeg"},C={png:"image/png"},O={heic:"image/heic",heif:"image/heif"},w={bmp:"image/bmp",emf:"image/emf",gif:"image/gif",tiff:"image/tiff",tif:"image/tif",webp:"image/webp",wmf:"image/wmf"},E=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._itemSelectionHelper=new(n.child(d.e))({allowMultiSelect:!1,canFallback:!0}),n._isOneDriveWinApp=Object(f.e)(),n._urlDataSource=n.resources.consume(c.Se),n._itemCommandHelper=n.resources.consume(l.t),n._platformDetection=n.resources.consume(i.e),n._identityDataSource=n.resources.consume(c.D),n._coachmarkProvider=n.resources.consume(v.e.optional),n._imageEditorDataSource=n.resources.consume(m.e.optional),n.state=n.createPureComputed(n._computeState),n}return Object(a.__extends)(t,e),t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})},t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}},t.prototype._isAvailable=function(){if(!Object(h.isFeatureEnabled)(h.HideEditPhoto)&&!0===Object(D.e)(I.l))return!1;if(!this._imageEditorDataSource)return!1;var e=this._itemSelectionHelper.firstItem();if(!e)return!1;if(e.video&&e.video.burstPhotoType)return!1;var t=this._itemCommandHelper.isCommandSupported(e,_.d),n=this._isSupportedFileType(e),a=this._itemSelectionHelper.currentItem(),i=this._urlDataSource.getKeyParams(a.key),r=this._urlDataSource.getQueryType(i),o=this._shouldEnableImageEditor()&&t&&n&&(!this._platformDetection.isIE||Object(h.isFeatureEnabled)(h.EnableEditUtilityControlIE))&&(!this._platformDetection.isSafari||Object(h.isFeatureEnabled)(h.EnableEditUtilityControlSafari))&&(!this._platformDetection.isMobile||Object(h.isFeatureEnabled)(h.EnableEditUtilityControlMobile))&&!!e&&e.sharingRole===S.e.Owner&&r!==u.e.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(r)&&e.itemStatus!==p.t.ConditionalAccessViewOnly&&e.itemStatus!==p.t.ConditionalAccessBlocked&&this._imageEditorDataSource.canSave({item:e});return o&&Object(h.isFeatureEnabled)(h.EnableEditControlTeachingBubble)&&!Object(h.isFeatureEnabled)(h.MentionTeachingUIAA)&&!Object(h.isFeatureEnabled)(h.EnableExpirationSectionForTMR)&&this._coachmarkProvider.setCampaign(g.PHOTO_EDIT),o},t.prototype._shouldEnableImageEditor=function(){if(Object(h.isFeatureEnabled)(h.EnableEditUtilityControl))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditControlExperimentAA)){if(this._identityDataSource){var e=this._identityDataSource.getIdentity();e&&b.t.init({userLoginName:e.email})}var t={name:"EnableEditControlExperiment",startDate:"2/09/2021",version:b.e.v2};return new b.t(t,h.EnableEditControlExperimentAB).isOn()}return!1},t.prototype._isSupportedFileType=function(e){if(!function(e){return Object(h.isFeatureEnabled)(h.EnableEditAllImageFormats)&&k.forEach(function(e){L.push(e),L.push(e.toUpperCase())}),Object(h.isFeatureEnabled)(h.EnableEditPNG)&&(L.push(".png"),L.push(".PNG")),Object(h.isFeatureEnabled)(h.EnableEditHEIC)&&(L.push(".heic"),L.push(".heif"),L.push(".HEIC"),L.push(".HEIF")),L.some(function(t){return e.toLowerCase()===t})}(e.extension||""))return!1;if(e&&e.extension&&(e.type===y.e.File||e.type===y.e.Media)){var t=e.extension;if(t=((t&&"."===t[0]?t.substring(1):t)||"").toLowerCase(),x.hasOwnProperty(t))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditPNG)&&C.hasOwnProperty(t))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditHEIC)&&O.hasOwnProperty(t))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditAllImageFormats)&&w.hasOwnProperty(t))return!0}return!1},t}(o.n),A=Object(r.e)({name:"OpenInImageEditor",source:{moduleDefinition:{path:"./OpenInImageEditorExecutor",getModule:function(){return s.n.resolve(n.e(121).then(n.bind(null,4182)))}}},handlerType:E}),L=[".jpg",".jpeg",".JPG",".JPEG"],k=[".bmp",".emf",".gif",".tiff",".tif",".webp",".wmf"];t.default=A}}]);