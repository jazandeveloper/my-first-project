(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[511],{1810:function(e,t,n){"use strict";var a=n(814);n.d(t,"e",function(){return a.t}),n.d(t,"t",function(){return a.n}),n.d(t,"n",function(){return a.a}),n.d(t,"a",function(){return a.r}),n.d(t,"i",function(){return a.o}),n.d(t,"r",function(){return a.s})},1845:function(e,t,n){"use strict";n.d(t,"s",function(){return v}),n.d(t,"c",function(){return S}),n.d(t,"a",function(){return I}),n.d(t,"i",function(){return x}),n.d(t,"t",function(){return O}),n.d(t,"o",function(){return w}),n(814);var a,i,r,o,s,c=n(290),d=n(26),l=n(1810);n.d(t,"e",function(){return l.e}),n.d(t,"n",function(){return l.t}),n.d(t,"r",function(){return l.n}),n.d(t,"d",function(){return l.a}),n.d(t,"l",function(){return l.i}),n.d(t,"u",function(){return l.r});var u="ms-word",f="onenote|UsePlain",p="ms-powerpoint",m="ms-excel",_="ms-visio",h="ms-publisher",b="ms-project",g=((a={})[u]=d.OpenInWordOnline,a[f]=d.OpenInOneNoteOnline,a[p]=d.OpenInPowerPointOnline,a[m]=d.OpenInExcelOnline,a[_]=d.OpenInVisioOnline,a);function v(e){return g[e]||""}var y=((i={})[u]=d.OpenInWord,i[f]=d.OpenInOneNote,i[p]=d.OpenInPowerPoint,i[m]=d.OpenInExcel,i[_]=d.OpenInVisio,i[h]=d.OpenInPublisher,i[b]=d.OpenInProject,i["ms-infopath"]=d.OpenInInfoPath,i);function S(e){return y[e]}var D=((r={})[u]="Word",r[f]="OneNote",r[p]="PowerPoint",r[b]="Project",r[_]="Visio",r[m]="Excel",r);function I(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":D[e.appMap]||"Word"}function x(e){return D[e]}(o={})[u]="WordLogo",o[f]="OneNoteLogo",o[p]="PowerPointLogo",o[m]="ExcelLogo",o[_]="VisioLogo",o[h]="Page";var C=((s={})[u]="svg/word_16x1.svg",s[f]="svg/onenote_16x1.svg",s[p]="svg/powerpoint_16x1.svg",s[m]="svg/excel_16x1.svg",s[_]="svg/visio_16x1.svg",s[h]="Page",s.Stream="svg/stream_16x1.svg",s),O={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function w(e){var t=C[e];return t&&new c.e(t)}},1877:function(e,t,n){"use strict";n.d(t,"e",function(){return Z}),n.d(t,"n",function(){return $});var a,i,r=n(0),o=n(94),s=n(31),c=n(36),d=n(474),l=n(445),u=n(262),f=n(2218),p=n(10),m=n(113),_=n(39),h=n(291),b=n(2091),g=n(1845),v=n(270),y=n(2092),S=n(412),D=n(123),I=n(7),x=n(119),C=n(101),O=n(78),w=n(375),E=n(12),A=n(1025),L=n(609),k=n(30),M=n(447),P=n(721),T=n(1027),U=n(1028),F=n(86),H=n(155),R=n(348),N=n(255),B=n(8),j=n(1177),V=n(68),z=window.$Config&&window.$Config.isINT,G=window.FilesConfig&&window.FilesConfig.skyApiDomain,K=window.FilesConfig&&window.FilesConfig.storageDomain,W=window.FilesConfig&&window.FilesConfig.mpcDomain;!function(e){e[e.DateCreated=0]="DateCreated",e[e.DateModified=1]="DateModified"}(i||(i={}));var q=B.e.isActivated("6CEBAB53-E3AA-4B32-A437-CEC98812ABB4","10/21/2021","Refactor URL DataSource"),Q=!B.e.isActivated("CA949581-487C-4A90-9D63-81958797F222","10/21/2021","Fast OneUp in ODC")&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive),Y=new I.t({name:"".concat("UrlDataSource",".useOneUpTextEditor"),factory:new I.e(Object(p.isFeatureEnabled)(p.UseOneUpTextEditor))}),J=new I.t({name:"".concat("UrlDataSource",".useRefactoredGetDefaultClickUrl"),factory:new I.e(!q)}),X=new I.t({name:"".concat("UrlDataSource",".enableFastOneUp"),factory:new I.e(Q)}),Z=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this,a=t.navigation,i=void 0===a?this.resources.consume(O.e):a,r=t.useOneUpTextEditor,o=void 0===r?this.resources.consume(Y):r,s=t.enableFastOneUp,c=void 0===s?this.resources.consume(X):s,d=t.useRefactoredDefaultClickUrl,l=void 0===d?this.resources.consume(J):d;this._navigation=i,this._useOneUpTextEditor=o,this._enableFastOneUp=c,this._useRefactoredDefaultClickUrl=l,this.getCurrentPageBaseUrl=e&&e._getCurrentPageBaseUrl||(this._useRefactoredDefaultClickUrl?E.c:this.getCurrentPageBaseUrl),this._getCurrentUrlPathName=e&&e._getCurrentUrlPathName||this._getCurrentUrlPathName,this._events=new C.t(this),(this._mayBeFastOneUp=this._enableFastOneUp&&Object(p.isFeatureEnabled)(p.UseItemsScopeInOneDrive)&&!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){n.getFocusItemKey(n._navigation.viewParams)||(n._mayBeFastOneUp=!1,n._events.off(n._navigation))})}return e.getKey=function(e){return void 0===e&&(e={}),Object(E.y)(e)},e.getKeyParams=function(e){return Object(E.S)(e)},e.getIsSyncUserBusiness=function(e){return"b"===e.pt},e.getWtMcIdParamKeyIsSync=function(e){var t=e.ocid||e["WT.mc_id"];return t&&t.toLowerCase().indexOf("sync")>=0},e.getRedeemCodeParam=function(e){var t=e.redeemCode;return"undefined"===t?"":t},e.getProfileImage=function(t){return e.storageBaseUrl+"/users/0x"+t+"/myprofile/expressionprofile/profilephoto:UserTileLarge,UserTileStatic/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"},e.getTermsUrl=function(){return"https://g.live.com/8seskydrive/tou"},e.getPrivacyUrl=function(){return"https://go.microsoft.com/fwlink/?LinkId=521839"},e.getImpressumUrl=function(){return Object(E._)()},e.getResourceRedirectUrl=function(e){return"https://onedrive.live.com/redir.aspx?"+m.n({resid:e})},e.encodeSharingUrl=function(e){return Object(k.e)(e)},e.getThumbnailUrl=function(t,n,a,i){return i=i||a,_.format(e.storageBaseUrl+"/Items/{1}:CustomThumbnailSource,HighRes,Default?{2}",t,n,m.n({width:a,height:i,cropmode:"center"}))},e.getVroomBaseUrl=function(e){return Object(k.u)(e)},e.getAutoRedeemRedirectUrl=function(t){var n="",a=t.viewParams,i=a.id,r=a.cid,o=a.action;return a.autoredeeem&&i&&r&&o&&(n=e.getAutoRedeemLoginUrl(i,r,o,t)),n},e.getAutoRedeemLoginUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!1,i.viewParams),s=((r={}).ru=o,r.wreply=o,r);return D.t.signInUrl+"&"+m.n(s,null,!0)},e.getAutoRedeemLogoutUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!0,i.viewParams),s=((r={}).lru=o,r);return D.t.autoRedeemSignOut+"&"+m.n(s,null,!0)},e.getCookieDomain=function(){return window.$Config.sd},e.getEnvironment=function(){return Object(P.e)()},e.areCidsEqual=function(e,t){return Object(L.e)(e,t)},e._getAutoRedeemUrl=function(e,t,n,a,i){var r,o=((r={}).id=e,r.cid=t,r.action=n,r.authkey=i.authkey,r);return a&&(o.autoredeeem="1"),window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.n(o,null,!0)},e.prototype.getDefaultRootItemId=function(){return"root"},e.prototype.getKey=function(t){return e.getKey(t)},e.prototype.getKeyParams=function(e){return Object(E.S)(e)},e.prototype.getRequestAccessLogoutUrl=function(e,t,n){var a,i,r=((a={resid:e,ithint:t}).challengeToken=n,a.v="requestaccess",a),o=window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+m.n(r,null,!0),s=((i={}).lru=o,i);return D.t.autoRedeemSignOut+"&"+m.n(s,null,!0)},e.prototype.getItemHintRedirectViewParams=function(e){return void 0===e&&(e={}),Object(E.h)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.L)(e)},e.prototype.getPhotoType=function(e){return Object(E.E)(e)},e.prototype.getPageType=function(e,t){return void 0===e&&(e=this._navigation.viewParams),Object(E.O)(e,this._mayBeFastOneUp||t)},e.prototype.getViewerType=function(e){return Object(A.e)(e)},e.prototype.saveViewerType=function(e){return Object(A.t)(e)},e.prototype.getFocusItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.p)(e)},e.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.s)(e)},e.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),a=this.getKeyParams(t);return delete n.u,delete a.u,this.getKey(n)===this.getKey(a)},e.prototype.getRootItemKey=function(e){return void 0===e&&(e=c.e.Files),Object(E.M)(e)},e.prototype.isRecycleBin=function(e){return this._useRefactoredDefaultClickUrl?Object(k.w)(e):e===c.e.RecycleBin},e.prototype.isCurrentQueryPhotoStream=function(e){return void 0===e&&(e=this._navigation.viewParams),"photostream"===e.qt},e.prototype.isCurrentQueryFiles=function(e){void 0===e&&(e=this._navigation.viewParams);var t=!B.e.isActivated("4B9ACAFF-DC04-4EA0-93FF-9439B92FD516","10/21/2021","Check is Search in Files pivot")&&(e.searchsessionid||"search"===e.parQt);return Object(E.j)(e)||0===Object.keys(e).length||!e.qt&&!e.v&&!t&&Object(E.a)(e)},e.prototype.isCurrentQueryRecent=function(e){return void 0===e&&(e=this._navigation.viewParams),"mru"===e.qt},e.prototype.isCurrentQuerySharedWithMe=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.N)(e)},e.prototype.isCurrentQuerySharedByMe=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt},e.prototype.isCurrentQuerySharedFilesRoot=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt||"sharedby"===e.qt},e.prototype.isCurrentQueryRecycleBin=function(e){return void 0===e&&(e=this._navigation.viewParams),"recyclebin"===e.qt},e.prototype.getDisableQueryAlteration=function(e){return void 0===e&&(e=this._navigation.viewParams),!1},e.prototype.isCurrentQuery=function(e,t){switch(void 0===t&&(t=this._navigation.viewParams),e){case c.e.Files:return this.isCurrentQueryFiles();case c.e.Recent:return this.isCurrentQueryRecent();case c.e.SharedWithMe:return this.isCurrentQuerySharedWithMe();case c.e.SharedByMe:return this.isCurrentQuerySharedByMe();case c.e.RecycleBin:return this.isCurrentQueryRecycleBin();case c.e.Photos:case c.e.AllMyPhotos:return Object(E.F)(t);case c.e.PhotoStream:return this.isCurrentQueryPhotoStream(t);default:return!!t.qt&&t.qt.toString().toLowerCase()===c.e[e].toString().toLowerCase()}},e.prototype.getFilesQueryUrl=function(){return this._requireAuthentication(this.getItemUrl(this.getKey({}),{page:s.e.Files}))},e.prototype.getRecycleBinQueryUrl=function(){var e;return Object(F.e)(E.K)&&!Object(p.isFeatureEnabled)(p.ApplyItemsScopeToRecycleBin)?"".concat(this.getMpcOneDriveUrl(),"?view=5"):this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="recyclebin",e)),{page:s.e.Files}))},e.prototype.getRecentQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="mru",e)),{page:s.e.Files}))},e.prototype.getPhotoStreamQueryUrl=function(e,t){var n;void 0===t&&(t=!1);var a=Object(r.__assign)({},this._navigation.viewParams);return t||delete a.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="photostream",n.v="photoStream",n.psId=e||"me",n.psShareId=a.psShareId,n.psPostId=a.psPostId,n.pssc=a.pssc,n)),{page:s.e.PhotoStream,viewParams:a}))},e.prototype.getPhotoStreamMyFeedQueryUrl=function(e){var t;void 0===e&&(e=!1);var n=Object(r.__assign)({},this._navigation.viewParams);return e||delete n.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="photostream",t.v="photoStream",t.psShareId=n.psShareId,t.psPostId=n.psPostId,t.pssc=n.pssc,t)),{page:s.e.PhotoStream,viewParams:n}))},e.prototype.getPhotoStreamShareIdUrl=function(e){var t,n=((t={}).id="root",t.qt="photostream",t.v="photoStream",t.psShareId=e,t);return this.getCurrentPageBaseUrl()+"?"+m.n(n,null,!0)},e.prototype.getPhotoStreamForMojsQueryUrl=function(e,t,n){var a,i=Object(r.__assign)({},this._navigation.viewParams);return delete i.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((a={}).qt="photostream",a.v="photoStream",a.mojDate=e,a.moj=t,a.psRIds=n.join(","),a)),{page:s.e.PhotoStream,viewParams:i}))},e.prototype.getAllMyPhotosQueryUrl=function(t){var n;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.id=t,n.cid=e.viewerId,n)),{page:s.e.Photos}))},e.prototype.getAlbumsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="albums",t)),{page:s.e.Photos}))},e.prototype.getTagsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="tags",t)),{page:s.e.Photos}))},e.prototype.getPlacesQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="places",t)),{page:s.e.Photos}))},e.prototype.getOnThisDayQueryUrl=function(e,t){var n,a;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:s.e.Photos,additionalViewParams:(a={},a.sc=e&&e.sc||"",a)}))},e.prototype.getOnThisMonthQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getLastWeekPreviousYearsQueryUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getRecentPhotoUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).parQt=e.parQt,t.id=e.id,t.cid=e.cid,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getAllPhotosForPlaceUrl=function(e,t){var n;return this.getItemUrl(this.getKey(((n={}).id=t,n.locationFilter=e,n.qt="allmyphotos",n)),{page:s.e.Photos})},e.prototype.getSharedByQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedby",e)),{page:s.e.Files}))},e.prototype.getSharedByYouQueryUrl=function(){var e,t=this.resources.consume(N.e);return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt=t?"sharedbyme":"sharedby",e)),{page:s.e.Files}))},e.prototype.getOneDriveAppsUrl=function(){return"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink"},e.prototype.getOptionsUrl=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getNewManageStorageUrl()},e.prototype.getManageStorageUrl=function(){return this.getCurrentPageBaseUrl()+"/options/ManageStorage"},e.prototype.getPhotoPreferencesUrl=function(){var e,t=((e={}).v="photopreferences",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getManageVaultUrl=function(){var e,t=((e={}).v="ManageVault",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getTagPreferencesUrl=function(){var e,t=((e={}).v="tagpreferences",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getOfficeFileOptionsUrl=function(){var e;if(Object(p.isFeatureEnabled)(p.EnableVroomDocFormatSettings)&&Object(F.e)(E.K)){var t=((e={}).v="documentoptions",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/DocumentOptions"},e.prototype.getPhotosOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/PeopleOptions"},e.prototype.getUpgradeOptionsUrl=function(e,t){return this.getNewUpgradeOptionsUrl(e,this._navigation.viewParams,t)},e.prototype.getNotificationOptionsUrl=function(){var e;if(Object(R.o)()){var t=((e={}).v="NotificationOptions",e),n="#"+m.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/NotificationOptions"},e.prototype.getDeviceBackupsOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/DeviceBackups"},e.prototype.getSearchOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/Search"},e.prototype.getNewManageStorageUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t),a="#"+m.n(n,null,!0);return this._requireAuthentication(a)},e.prototype.getNewUpgradeOptionsUrl=function(e,t,n){return void 0===t&&(t=this._navigation.viewParams),Object(E.C)({wtcParam:e,viewParams:t,hideLeftNav:n})},e.prototype.getNewRestoreOptionsUrl=function(e,t){var n;void 0===t&&(t=this._navigation.viewParams);var a=((n={}).ocid=t.ocid||t["WT.mc_id"]||e,n.v="restore",n),i="#"+m.n(a,null,!0);return this._requireAuthentication(i)},e.prototype.getTaggingOptionsUrl=function(){return"/options/PeopleOptions"},e.prototype.getPeopleApiUrl=function(t){var n={prefix:t};return e.peopleBaseUrl+"/directory/search?"+m.n(n)},e.prototype.getUserInfoApiUrl=function(){return Object(U.e)()},e.prototype.setUserInfoApiUrl=function(){return Object(U.t)()},e.prototype.getPublishToWalgreensUrl=function(){return e.skyApiBaseUrl+"PublishToWalgreens"},e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=e.ownerId,a=this.getAuthKeyParamValue(t),i=this.getTicketParamValue(t),r=D.t.canary,o={cid:n,authKey:a,ticket:i,resid:e.id,canary:r};if(e.video){var s=Math.ceil((1.25*e.video.duration||0)/6e4);o.duration=Math.min(Math.max(1,s)+60,1440)}return this.getCurrentPageBaseUrl()+"/GetDownloadUrl?"+m.n(o,null,!0)},e.prototype.getEmbedInfoUrl=function(t){var n={id:t.id};return e.skyApiBaseUrl+"GetEmbedInfo?"+m.n(n,null,!0)},e.prototype.getEmbedPageUrl=function(e){var t={cid:e.ownerId,resid:e.id};return this.getCurrentPageBaseUrl()+"/embed?"+m.n(t,null,!0)},e.prototype.getPermissionsUrl=function(t,n){var a;void 0===n&&(n=this._navigation.viewParams);var i=this.getAuthKeyParamValue(n),r=((a={}).id=t.id,a);return i&&(r.authkey=i),e.skyApiBaseUrl+"GetPermissions?"+m.n(r)},e.prototype.getSearchQueryUrl=function(e,t){var n,a=e.query,r=e.dateFilter,o=e.conversationId,s=e.largestSize,c=e.filter;c||(c=Object(E.F)(this._navigation.viewParams)?b.t.photos:b.t.all);var d=((n={}).qt="search",n.q=a,n.searchsessionid=o,n.ft=E.t[b.t[c]],n);if("number"==typeof r&&r!==b.e.anyDate){var l=new Date,u=this._getDateDuration(r,l);d.df=i[i.DateCreated],d.beginDate=u.toISOString(),d.endDate=l.toISOString()}return s&&(d.sp="size"),this.getItemUrl(this.getKey(d),t)},e.prototype.getSearchFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:e,dateFilter:this.getAppliedDateFilter()})},e.prototype.isSearchFilterApplied=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getContextualFilter(t)===String(E.t[b.t[e]])},e.prototype.getSearchByDateFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:b.t[String(E.t[this.getContextualFilter(t)])],dateFilter:e})},e.prototype.isSearchByDateFilterApplied=function(e){return this.getAppliedDateFilter()===e},e.prototype.getAutoActionType=function(e){if(this._useRefactoredDefaultClickUrl)return Object(E.o)(e);var t=e.action||"";return u.e[t.toLowerCase()]||u.t.none},e.prototype.getQueryParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.q},e.prototype.getCommentIdParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.commentId},e.prototype.getLayoutContentType=function(t){void 0===t&&(t=this._navigation.viewParams);var n=t.layout;return n&&e.contentTypeByLayoutType[n]},e.prototype.getItemTypeFilter=function(e){var t=[],n=Number(e.ft)||0;7==(7&n)&&t.push(S.e.folder),16==(16&n)&&t.push(S.e.document),8==(8&n)&&t.push(S.e.media);for(var a=0,i=(e.ext||"").split(";");a<i.length;a++){var r=i[a];t.push(r)}return{filters:t}},e.prototype.saveItemTypeFilter=function(e){return void 0===e&&(e={filters:[]}),Object(E.G)(e)},e.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")},e.prototype.saveUsersFilter=function(e){var t={};return t.userFilters=e&&e.join(";#"),t},e.prototype.saveDateDurationFilter=function(e){return{}},e.prototype.getDateDurationFilter=function(e){return""},e.prototype.getIAmValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getFeedbackUrl=function(){return e.skyApiBaseUrl+"GetFeedBackUrl"},e.prototype.getCidFromResourceId=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(k.a)(e)},e.prototype.getCreateTextDocumentUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i={};i.id=t,i.cid=n,i.iam=this.getIAmParamValue(a),i.action=e.createTextDocumentActionValue,i.v="TextFileEditor";var r=m.n(i,null,!0);return this._getCurrentPageUrl(2,r)},e.prototype.getCreateDocumentInTabUrl=function(e,t,n,a){var i;void 0===a&&(a=this._navigation.viewParams);var r,o=this.getAuthKeyParamValue(a),s=this.getTicketParamValue(a),c=this.getIAmParamValue(a),d=a.qt,l=1===e.documentFormat?"odf":"",f=((i={}).cid=e.ownerId,i.wacqt=d||"",i.wdo=1,i);if(n){r="?",f.id=e.id;var p=void 0;switch(t){case"w":p=u.t.createWord;break;case"x":p=u.t.createExcel;break;case"p":p=u.t.createPowerPoint;break;case"n":p=u.t.createOneNote}f.action=p&&u.t[p].toLowerCase()||""}else r="/create.aspx?",f.parId=e.id,f.nd=t+l;return o&&(f.authkey=o),s&&(f.ticket=s),c&&(f.iam=c),r+m.n(f)},e.prototype.getDownloadItemUrl=function(e,t,n,a){if(void 0===a&&(a=this._navigation.viewParams),e.processFilters)return e.processFilters.thumbnailUrl;var i=this.getAuthKeyParamValue(a),r=this.getTicketParamValue(a),o=this.getIAmParamValue(a),s={cid:e.ownerId,authKey:i,ticket:r,iam:o,resid:e.id,canary:t,ithint:e.extension&&e.extension.toLowerCase(),open:n||void 0};return this.getCurrentPageBaseUrl()+"/download.aspx?"+m.n(s,null,!0)},e.prototype.getPrintPdfUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=this.getAuthKeyParamValue(t),a=this.getTicketParamValue(t),i=this.getIAmParamValue(t),r=D.t.canary,o={cid:e.ownerId,authKey:n,ticket:a,iam:i,resid:e.id,canary:r,ithint:e.extension&&e.extension.toLowerCase(),open:1,serve:1};return this.getCurrentPageBaseUrl()+"/pdf?"+m.n(o,null,!0)},e.prototype.getVersionHistoryUrl=function(e,t,n){void 0===n&&(n=this._navigation.viewParams);var a=this.getIAmParamValue(n),i=this.getAuthKeyParamValue(n),o=Object(r.__assign)({cid:e,resid:t,iam:a},i?{authKey:i}:{});return"/versions.aspx?"+m.n(o,null,!0)},e.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var a,i=n.forceReadOnly,r=void 0!==i&&i,o=e.properties.commandsSupported,s=(void 0===o?{}:o).defc,c=e.openUrl;a=r?"view.aspx":"2"===s?"edit.aspx":"view.aspx";var d=(null==e?void 0:e.itemId)||(null==e?void 0:e.id);if(d){var l=new V.t("/".concat(a));l.setQueryParameter("resid",d);var u=this.getAuthKeyParamValue(t);if(u&&l.setQueryParameter("authkey",u),!E.e)for(var f in t)f.startsWith("wd")&&l.setQueryParameter(f,t[f]);return l.toString()}var p=Object(g.a)(e),_=c.indexOf("?")>0?"&":"?";return c.replace("redir.aspx",a).replace("download.aspx",a)+_+m.n({app:p,wdo:1,wacqt:t.qt},null,!0)},e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a,i,r;if(void 0===t&&(t=this._navigation.viewParams),!B.e.isActivated("C1567AF7-26C3-4CFC-A439-2A58F8558245","07/18/2022","open history file in office client")&&Object(F.e)(e.ownerId)){var o=null!==(i=null===(a=e.properties)||void 0===a?void 0:a.path)&&void 0!==i?i:null===(r=e.itemFromServer)||void 0===r?void 0:r.webDavUrl;return Object(j.t)(e.appMap,o,e.extension,!0,!1)}var s=this.getAuthKeyParamValue(t),c=this.getIAmParamValue(t),d={cid:n,resid:e.id,authKey:s,iam:c,autoRedirect:"false"};return this.getCurrentPageBaseUrl()+"/openinclient?"+m.n(d,null,!0)},e.prototype.getNewInOfficeClientUrl=function(e,t,n){return""},e.prototype.getDownloadAsZipIframeUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n={canary:e,iam:this.getIAmParamValue(t)};return this.getCurrentPageBaseUrl()+"/downloadasziplanding?"+m.n(n,null,!0)},e.prototype.getDownloadAsZipPostUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i=_.format(e.storageBaseUrl+"/downloadfiles/V1/Zip",t),r=a,o={authKey:r.authkey,ticket:r.ticket,iam:this.getIAmParamValue(r),application:n};return i+"?"+m.n(o,null,!0)},e.prototype.getOwnerId=function(t,n){return this.getKeyParams(t||this.getCurrentItemKey(n)).cid||e.viewerId},e.prototype.getSharedByUrl=function(e,t,n){var a,i;return this.getItemUrl(this.getKey(Object(r.__assign)(((a={}).qt="sharedby",a.id=e,a.cid=t,a),n?((i={}).groupId=n,i):{})))},e.prototype.getExternalUrl=function(t){var n=f.e[t];if(!n)throw new Error("Invalid external alias provided to fetch external url.");return this.getCurrentPageBaseUrl()+e.EXTERNAL_URL_FORMAT+n},e.prototype.getUploadStorageUrl=function(t,n){return"root"===t.id?_.format(e.storageBaseUrl,[t.ownerId])+"/MyCIDStuff/0x"+t.ownerId+"/LiveFolders/"+h.e.encodeURIComponent(n):_.format(e.storageBaseUrl,[t.uploadOwnerId])+"/items/"+t.id+"/"+h.e.encodeURIComponent(n)},e.prototype.getAppSubfolder=function(){return"odc"},e.prototype.getDefaultClickUrl=function(e,t){var n,a,i,s;void 0===t&&(t={});var c,d=t.viewParams,l=void 0===d?this._navigation.viewParams:d,f=t.itemSet,p=t.urlType,_=void 0===p?"default":p,h=t.preserveAction,b=void 0!==h&&h,g=t.action,v=void 0===g?b&&this.getAutoActionType(l)||void 0:g;if(!e||!e.key)return"";if(l.sb&&(!this.isCurrentQuery(e.queryType,l)||(e=Object(r.__assign)(Object(r.__assign)({},e),{key:m.n(Object(r.__assign)(Object(r.__assign)({},m.e(e.key)),(n={},n.sb=l.sb,n.sd=l.sd,n)))}))),l.mcid&&this.getKeyParams(e.key).cid===(l.cid||l.parCid)&&(e=Object(r.__assign)(Object(r.__assign)({},e),{key:m.n(Object(r.__assign)(Object(r.__assign)({},m.e(e.key)),(a={},a.mcid=l.mcid,a.mid=l.mid,a)))})),this._useRefactoredDefaultClickUrl){var y=null===(s=null===(i=null==e?void 0:e.properties)||void 0===i?void 0:i.commandsSupported)||void 0===s?void 0:s.defc,S=f&&f.item.peek(),D=S&&S.key!==e.key&&S||e.UNSAFE_parent,I=D&&D.key,x=void 0;y&&(x="1"===y);var C={itemInfo:{itemKey:e.key,itemIsStub:e.isStub,itemIsPlaceholder:e.isPlaceholder,itemIsPhoto:!!e.photo,itemIsVideo:!!e.video,itemVirtualItemType:e.virtualItemType,itemExtension:e.extension,itemType:e.type,itemOpenUrl:e.openUrl,itemErrorType:e.error&&e.error.type,openItemByDefault:x},parentItemInfo:D&&{itemKey:I,itemIsAlbum:D.isAlbum,itemIsPlaceholder:D.isPlaceholder,itemIsStub:D.isStub,itemVirtualItemType:D.virtualItemType,itemExtension:D.extension,itemType:D.type,itemOpenUrl:D.openUrl,itemErrorType:D.error&&D.error.type},preserveAction:b,action:v,viewParams:l,page:t.page,useOneUpTextEditor:this._useOneUpTextEditor,queryType:e.queryType,additionalViewParams:t.additionalViewParams,urlType:_};return Object(T.t)(C)}var O=this._getDefaultUrlFormat(e),w=!!B.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||e.type!==o.e.Media;return l.mid&&w&&(O=T.e.current),c=e.type===o.e.Error?T.e.external:"existing"===_?this._getCurrentUrlFormat(l):"focus"===_||v?v&&v!==u.t.locate&&O===T.e.current?O:T.e.focus:O,this._getItemClickUrl(e,f,c,t)},e.prototype.getTagUrl=function(e){var t,n;return n=e.localizedTag&&e.localizedTag!==e.tag?"".concat(e.localizedTag,";").concat(e.tag):e.tag,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.tagFilter=n,t)),{page:s.e.Photos}))},e.prototype.getAuthenticateUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(E.r)(e);var t=D.t.signInUrl;return window.location.href.indexOf("iam=")>-1?(t+="&redirect_uri={0}",e=this.getCurrentPageBaseUrl()+"/business"):t+="&ru={0}&wreply={0}",_.format(t,h.e.encodeURIComponent(e||window.location.href))},e.prototype.getLanguageWithAuthenRedirectUrl=function(){return Object(E.D)()},e.prototype.getRootUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return this.getCurrentPageBaseUrl()+"?"+m.n(n,null,!0)},e.prototype.getCurrentSiteUrl=function(){return window.location.href},e.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host},e.prototype.getMarketBlockedUrl=function(){return this._useRefactoredDefaultClickUrl?Object(E.I)():this.getCurrentPageBaseUrl()+"/marketblockerror.aspx"},e.prototype.getValidatePermissionUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(E.U)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="validatepermission",this.getCurrentPageBaseUrl()+"?"+m.n(e,null,!0)},e.prototype.getRequestAccessUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(E.k)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="requestaccess",this.getCurrentPageBaseUrl()+"?"+m.n(e,null,!0)},e.prototype.handleFatalErrorDuringViewLoad=function(){0===document.cookie.indexOf("sr=3")||document.cookie.indexOf("; sr=3")>-1?this._setFatalErrorCookie(0,!0):0===document.cookie.indexOf("sr=2")||document.cookie.indexOf("; sr=2")>-1?(this._setFatalErrorCookie(3,!1),window.top.location=document.location.href):0===document.cookie.indexOf("sr=")||document.cookie.indexOf("; sr=")>-1?(this._setFatalErrorCookie(2,!1),location.reload(!0)):(this._setFatalErrorCookie(1,!1),window.top.location=document.location.href)},e.prototype.getForceLoginDownloadUrl=function(e){var t="https://"+location.host+"?"+this.getDefaultClickUrl(e.UNSAFE_parent).substring(1);return this.getAuthenticateUrl(t)},e.prototype.getItemUrl=function(e,t){if(void 0===t&&(t={}),this._useRefactoredDefaultClickUrl){var n=t.viewParams,a=void 0===n?this._navigation.viewParams:n,i=t.item;return Object(E.v)(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:e,itemInfo:i&&{itemKey:i.key,itemIsPlaceholder:i.isPlaceholder,itemVirtualItemType:i.virtualItemType,itemExtension:i.extension,itemType:i.type},viewParams:a}))}var o=this._getItemQueryParams(e,t),s=t.additionalViewParams;return s&&s.sc?Object(H.e)(o,s):delete o.sc,"#"+m.n(o,null,!0)},e.prototype.getSuiteNavConfigUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return"/getsuitenavconfig?"+m.n(n,null,!0)},e.prototype.getApiName=function(){return"Vroom"},e.prototype.getApiBaseUrl=function(t){return e.getVroomBaseUrl(t)},e.prototype.getAppliedDateFilter=function(e){var t;if(void 0===e&&(e=this._navigation.viewParams),!e.df)return b.e.anyDate;var n=(Date.parse(e.endDate)-Date.parse(e.beginDate))/864e5;switch(Math.floor(n)){case 1:t=b.e.oneDay;break;case 30:t=b.e.oneMonth;break;case 7:t=b.e.oneWeek;break;case 365:t=b.e.oneYear}return t},e.prototype.getResourcePreloadUrl=function(){return"/preload?manifest=wac"},e.prototype.getHipCheckUrl=function(){return"https://mail.".concat(z?"live-int":"live",".com/?rru=hip")},e.prototype.getVerifyAccountUrl=function(){return"https://g.live.com/8SESkydrive/VerifyAccount"},e.prototype.isSearchPassThrough=function(e){return void 0===e&&(e=this._navigation.viewParams),!!e.sp},e.prototype.isLargestFilesView=function(e){return void 0===e&&(e=this._navigation.viewParams),"size"===e.sp},e.prototype.getNavLinkClickUrl=function(e){return""},e.prototype.qualifyUrl=function(e){return this._useRefactoredDefaultClickUrl?Object(E.V)(e):(0===e.indexOf("#")&&(e=this._getCurrentPageUrl(2,e.substring(1))),e)},e.prototype.getSignInUrlWithAction=function(e,t){var n=t||D.t.si;if(!n)return"";var a=v.t(n),i=m.e(a),r=i.wreply,o=v.t(r),s=m.e(o);return s.action=u.t[e],i.wreply="".concat(v.n(r),"?").concat(m.n(s)),"".concat(v.n(n),"?").concat(m.n(i))},e.prototype.getNewPlaceholderItemKey=function(){var t;return m.n(((t={}).id="placeHolder ".concat(e.placeholderId++),t))},e.prototype.getIAmParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getAuthKeyParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(E.i)(e)},e.prototype.getTicketParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.ticket},e.prototype.getReferrer=function(e){return void 0===e&&(e=this._navigation.viewParams),e.referrer},e.prototype.getContextualFilter=function(e){return void 0===e&&(e=this._navigation.viewParams),this._useRefactoredDefaultClickUrl?Object(k.i)(e):e.ft},e.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")},e.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,a=t.viewParams;if(this._useRefactoredDefaultClickUrl)return Object(T.a)({itemInfo:{itemKey:e.key,itemExtension:e.extension,itemType:e.type},parentItemInfo:n&&{itemKey:n.key},viewParams:a});var i=this._getItemQueryParams(e.key,{item:e,page:s.e.TextFileEditor,viewParams:a}),r=n||e.UNSAFE_parent,o=this.getKeyParams(r&&r.key||"");i.parId=o.id;var c=m.n(i,null,!0);return"TextFileEditor"!==a.v?this._getCurrentPageUrl(2,c):"#"+c},e.prototype.getQueryUrl=function(e,t){return this._requireAuthentication(this.getItemUrl(this.getRootItemKey(t),{page:e}))},e.prototype.getMpcOneDriveUrl=function(){return"".concat(W,"/personal/").concat(e.viewerId,"/_layouts/15/onedrive.aspx")},e.prototype._getItemQueryParams=function(e,t){var n=void 0===t?{}:t,a=n.item,i=n.page,o=n.action,s=n.preserveAction,f=void 0!==s&&s,p=n.viewParams,m=void 0===p?this._navigation.viewParams:p,_=this.getKeyParams(e),h=Object(r.__assign)({},_),b=Object(E.A)(m);void 0!==i&&(b.v=this._getPageParamValue(i,m));var g=!1,v=Object(w.a)(a);if(a&&!a.isPlaceholder)switch("TextFileEditor"===b.v&&(v||(b.v="")),a.virtualItemType){case l.e.Album:case l.e.AlbumRoot:case l.e.Tag:case l.e.TagsRoot:b.v="photos",g=!0}else switch(h.id){case"tags":case"places":case"albums":b.v="photos",g=!0}"allmyphotos"===_.qt&&(h.v="photos",g=!0,"true"!==_.onThisDay&&"true"!==_.onThisMonth&&"true"!==_.lastWeekPreviousYears||(m&&m.startDate&&(h.startDate=m.startDate),m&&m.cid&&(h.cid=m.cid))),"photostream"===_.qt&&(h.v="photoStream",h.psShareId=m.psShareId);var y=this.getQueryType(_);v||!a||g||y===c.e.Search||y===c.e.AllMyPhotos||y===c.e.PhotoStream||(h.v=""),v||!Object(d.e)(y)||"photos"===b.v&&"photoStream"===b.v&&this.getContextualFilter(_)===E.t.photos.toString()||(h.v=""),this._isFilePickerPage(b.v)&&(h.v=b.v),delete h.u;var S=this.getAutoActionType(m);return o?h.action=o&&u.t[o]&&u.t[o].toLowerCase()||"":f&&S&&(S===u.t.showProperties&&h.o||(h.action=u.t[S].toLowerCase())),Object(H.e)(b,h),b},e.prototype._getDateDuration=function(e,t){var n=new Date(t.toString())||new Date;switch(e){case b.e.oneDay:n.setDate(n.getDate()-1);break;case b.e.oneMonth:n.setDate(n.getDate()-30);break;case b.e.oneWeek:n.setDate(n.getDate()-7);break;case b.e.oneYear:n.setDate(n.getDate()-365)}return n},e.prototype._setFatalErrorCookie=function(e,t){var n="sr="+e+"requireDeps;path=/;domain="+window.$Config.urlHost+";";t&&(n+="expires="+new Date(2e3,1,1).toUTCString()+";"),document.cookie=n},e.prototype._getCurrentUrlFormat=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getFocusItemKey(e)?T.e.focus:T.e.current},e.prototype._getDefaultUrlFormat=function(e){var t;switch(e.type){case o.e.Media:t=T.e.focus;break;case o.e.Folder:case o.e.Error:t=T.e.current;break;default:t=T.e.external}return t},e.prototype._getItemClickUrl=function(e,t,n,a){var i=a.viewParams,r=void 0===i?this._navigation.viewParams:i,o=a.page,c=void 0===o?this.getPageType(r):o;if(n!==T.e.current&&c===s.e.FilePicker)return"";var d,l=this.getKeyParams(e.key);if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(l)))return"";if(Object(w.a)(e))n=this._useOneUpTextEditor&&c!==s.e.TextFileEditor?T.e.focus:T.e.external;else if(c===s.e.TextFileEditor&&this.getAutoActionType(r)===u.t.createTextDocument)return"#"+m.n(r,null,!0);switch(n){case T.e.current:d=this._getCurrentItemUrl(e,a);break;case T.e.focus:d=this._getFocusItemUrl(e,t,a);break;default:d=this._getDefaultItemUrl(e,{itemSet:t,viewParams:r})}return d},e.prototype._getCurrentItemUrl=function(e,t){var n=void 0===t?{}:t,a=n.preserveAction,i=n.action,r=n.viewParams,o=void 0===r?this._navigation.viewParams:r,s=n.page,c=n.additionalViewParams;if(e.isStub){var d=this.getFocusItemKey(o);if(d)return this.getAutoActionType(o)===u.t.locate?"":this._getFocusItemUrlFromKey(d,e,{action:u.t.locate,viewParams:o})}return this.getItemUrl(e.key,{item:e,preserveAction:a,action:i,viewParams:o,page:s,additionalViewParams:c})},e.prototype._getFocusItemUrl=function(t,n,a){var i,r=this._getParentItem(t,n),o=!!a.viewParams&&Boolean("photos"===a.viewParams.v&&(t.video||t.photo)&&"allmyphotos"!==a.viewParams.qt&&!a.viewParams.parId&&!a.viewParams.parQt&&r&&!r.isAlbum),s={key:this.getKey((i={},i.qt="allmyphotos",i.id="root",i.cid=e.viewerId,i))};return this._getFocusItemUrlFromKey(t.key,o?s:r,a)},e.prototype._getFocusItemUrlFromKey=function(t,n,a){var i=void 0===a?{}:a,r=i.preserveAction,o=void 0!==r&&r,s=i.action,c=i.viewParams,d=void 0===c?this._navigation.viewParams:c,l=i.additionalViewParams,u=n&&n.key||"",f=this.getKeyParams(t),p=this._getItemQueryParams(u,{item:n,preserveAction:o,action:s,viewParams:d});d&&d.commentId&&(f.commentId=d.commentId),f.parId=p.id,f.parQt=p.qt,f.cid!==p.cid&&(f.parCid=p.cid,delete p.cid),delete p.internalPath,delete p.qt,delete p.id,delete f.u;var _=p.action;return _?d&&d.commentId&&"showproperties"===_.toLowerCase()?(delete p.action,f.o=e.oneUpOverlayValue):(delete p.action,f.action=_):f.o=e.oneUpOverlayValue,l&&Object(H.e)(f,l),"#"+m.n(f,p,!0)},e.prototype._getPageParamValue=function(e,t){var n,a=t.v;switch(e){case s.e.FilePicker:n=this._isFilePickerPage(a)?a:"FilePickerView";break;case s.e.TextFileEditor:n="TextFileEditor";break;case s.e.Photos:n="photos";break;case s.e.RansomwareDetection:n="RansomwareDetection";default:case s.e.Files:}return n},e.prototype._getErrorItemUrl=function(t,n){var a;switch(void 0===n&&(n=this._navigation.viewParams),t&&t.error&&t.error.type||0){case 3:return this.getMarketBlockedUrl();case 5:return this.qualifyUrl(this.getItemUrl(t.key));case 2:var i=n.lor;return i&&i.toLowerCase()===e.linkOriginParamValue?"?".concat("v","=").concat("error","&").concat("type","=").concat(e.linkNotSupportedParamValue):this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,additionalViewParams:(a={},a.sc=n.sc||"",a)}));case 1:return this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n}),!0);case 4:var r=this.getAutoActionType(n)===u.t.feedback?u.t.feedback:void 0;return D.t.si?this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,action:r}),!0):this.getItemUrl(t.key,{action:r});case 6:return this.getValidatePermissionUrl();case 9:return this.getRequestAccessUrl()}return this.getItemUrl(t.key)},e.prototype._getDefaultItemUrl=function(e,t){var n,a,i=void 0===t?{}:t,r=i.itemSet,s=i.viewParams,c=void 0===s?this._navigation.viewParams:s,d=this._getParentItem(e,r);if(e.type===o.e.Error)a=this._getErrorItemUrl(e,c);else if(Object(w.a)(e))a=this.getTextEditorItemUrl(e,{parentItem:d,viewParams:c});else{var l=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.commandsSupported,f=(null==l?void 0:l.defc)||"";a=f&&"1"!==f?this._getFocusItemUrl(e,r,{action:u.t.defaultClick,viewParams:c}):"1"===f&&e.openUrl&&(-1===e.openUrl.indexOf("redir.aspx")||e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase()))?e.openUrl:this._getFocusItemUrl(e,r,{action:u.t.locate,viewParams:c})}return a},e.prototype._getCurrentPageUrl=function(t,n){if(this._useRefactoredDefaultClickUrl)return Object(E.d)(t,n);var a=[];switch(a.push(this.getCurrentPageBaseUrl()),t){case 0:a.push("/");break;case 1:a.push(e.nextSiteUrlPrefix);break;default:a.push(this._getCurrentUrlPathName())}return a.push("?"),a.push(n),a.join("")},e.prototype._getCurrentUrlPathName=function(){return this._useRefactoredDefaultClickUrl?Object(E.l)():window.location.pathname},e.prototype._isFilePickerPage=function(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t},e.prototype._requireAuthentication=function(e,t){return void 0===t&&(t=!1),this._useRefactoredDefaultClickUrl?Object(E.z)(e,t):t||D.t.si?this.getAuthenticateUrl(this.qualifyUrl(e)):e},e.prototype._getParentItem=function(e,t){var n=t&&t.item.peek();return n&&n.key!==e.key&&n||e.UNSAFE_parent},e.dependencies={navigation:O.e,useOneUpTextEditor:Y,useRefactoredDefaultClickUrl:J,enableFastOneUp:X},e.oneUpOverlayValue=M.i,e.EXTERNAL_URL_FORMAT="/externalredirector?alias=",e.skyApiBaseUrl=G+"/API/2/",e.viewerId=E.K,e.storageBaseUrl=K,e.feedbackBaseUrl="https://cid-{0}.users.storage.live.com",e.tagsFeedbackBaseUrl="https://storage.live.com",e.peopleBaseUrl="https://people.onedrive.com",e.nextSiteUrlPrefix=M.a,e.scenarioName="odweb",e.locateActionName="locate",e.linkOriginParamValue="shorturl",e.linkNotSupportedParamValue="linknotsupported",e.createTextDocumentActionValue="createTextDocument",e.contentTypeByLayoutType=((a={}).photo=y.i,a.list=y.a,a.grid=y.n,a),e.placeholderId=0,e}();t.t=Z;var $=Object(x.r)("UrlDataSource",Z)},1982:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(7),i=n(119),r=n(1161),o=n(2089),s=n(1121),c=n(2022),d=n(60),l=new a.t({name:"cookieOrigin",factory:new a.e(window.location.origin)}),u="VroomDataRequestor",f=new a.t({name:"".concat(u,".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:c.e},create:function(e){return{instance:function(){return d.n.resolve(e.isOfflineStateObservable.get())}}}}}),p=Object(i.r)(u,s.e,{sessionManagementProvider:o.e.optional,urlDataSource:r.e.optional,cookieOrigin:l,isOffline:f})},2022:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(7),i=n(1136),r=n(1166),o=n(1164),s=new a.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.e},create:function(e){var t=new r.e,n=new o.e(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}})},2078:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(119),i=n(2237),r=n(2238),o=n(1121),s=Object(a.r)("GraphDataRequestor",o.e,{sessionManagementProvider:i.resourceKey,urlDataSource:r.resourceKey});o.e},2089:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a,i=n(377),r=new(n(7).t)("".concat("MicroServiceDataSource.key",".microServiceDataSource")),o=n(60),s=n(1132),c=n(119),d=n(90),l=n(88);!function(e){e.unauthUser="unauthUser"}(a||(a={}));var u=n(477),f={ODB:n(1163).e.ODB?1651:60021},p=Object(u.e)(f)&&Object(u.e)({ODB:671}),m=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource}return e.prototype.getToken=function(e,t){var n=this._identityDataSource.getIdentity().type;if(n===i.e.aad){if(t&&p){var r=new l.e(t).authority;return this._identityDataSource.getSharePointToken(r)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return o.n.resolve()})}else if(n===i.e.msa)return this._identityDataSource.getSessionToken();return o.n.reject(new d.e({code:a.unauthUser,isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))},e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)},e.dependencies={identityDataSource:s.e,microServiceDataSource:r.optional},e}(),_=Object(c.r)("SessionManagementProvider",m)},2091:function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.all=0]="all",e[e.folders=1]="folders",e[e.photos=2]="photos",e[e.documents=3]="documents",e[e.music=4]="music"}(a||(a={})),function(e){e[e.anyDate=0]="anyDate",e[e.oneDay=1]="oneDay",e[e.oneWeek=2]="oneWeek",e[e.oneMonth=3]="oneMonth",e[e.oneYear=4]="oneYear"}(i||(i={}))},2092:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"e",function(){return s});var a="List",i="CompactList",r="Grid",o="Album",s="AllPhotos"},2218:function(e,t,n){"use strict";var a;!function(e){e[e.iosappstore=0]="iosappstore"}(a||(a={})),t.e=a},2219:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return s}),n.d(t,"n",function(){return d}),n.d(t,"a",function(){return l});var a,i,r,o=n(1819);!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.UNEXPECTED_FAILURE=1]="UNEXPECTED_FAILURE",e[e.COMMENT_NOT_FOUND=2]="COMMENT_NOT_FOUND",e[e.CREATE_COMMENT_FAILURE=3]="CREATE_COMMENT_FAILURE",e[e.CREATE_POST_FAILURE=4]="CREATE_POST_FAILURE",e[e.CREATE_REACTION_FAILURE=5]="CREATE_REACTION_FAILURE",e[e.CREATE_PHOTOSTORY_FAILURE=6]="CREATE_PHOTOSTORY_FAILURE",e[e.DUPLICATE_REACTION=7]="DUPLICATE_REACTION",e[e.EXCEEDED_COMMENT_COTNTENT_LENGTH=8]="EXCEEDED_COMMENT_COTNTENT_LENGTH",e[e.EXCEEDED_LOCATION_LENGTH=9]="EXCEEDED_LOCATION_LENGTH",e[e.EXCEEDED_PHOTOSTORY_NAME_LENGTH=10]="EXCEEDED_PHOTOSTORY_NAME_LENGTH",e[e.EXCEEDED_PHOTOSTORY_DESCRIPTION_LENGTH=11]="EXCEEDED_PHOTOSTORY_DESCRIPTION_LENGTH",e[e.EXCEEDED_POST_DESCRIPTION_LENGTH=12]="EXCEEDED_POST_DESCRIPTION_LENGTH",e[e.EXCEEDED_COMMENTS_PER_POST=13]="EXCEEDED_COMMENTS_PER_POST",e[e.EXCEEDED_ITEMS_PER_POST=14]="EXCEEDED_ITEMS_PER_POST",e[e.EXCEEDED_MEMBER_PHOTOSTORIES_PER_USER=15]="EXCEEDED_MEMBER_PHOTOSTORIES_PER_USER",e[e.EXCEEDED_MEMBERS_PER_PHOTOSTORY=16]="EXCEEDED_MEMBERS_PER_PHOTOSTORY",e[e.EXCEEDED_POSTS_PER_PHOTOSTORY=17]="EXCEEDED_POSTS_PER_PHOTOSTORY",e[e.INVITATION_NOT_FOUND=18]="INVITATION_NOT_FOUND",e[e.ACCESS_REQUEST_NOT_FOUND=19]="ACCESS_REQUEST_NOT_FOUND",e[e.MEMBERSHIP_NOT_FOUND=20]="MEMBERSHIP_NOT_FOUND",e[e.POST_NOT_FOUND=21]="POST_NOT_FOUND",e[e.PHOTOSTORY_ALREADY_EXIST=22]="PHOTOSTORY_ALREADY_EXIST",e[e.PHOTOSTORY_NOT_FOUND=23]="PHOTOSTORY_NOT_FOUND",e[e.REACTION_NOT_FOUND=24]="REACTION_NOT_FOUND",e[e.SHAREID_NOT_FOUND=25]="SHAREID_NOT_FOUND",e[e.SOUTH_KOREA_LAW=26]="SOUTH_KOREA_LAW",e[e.VIDEO_CONTENT_NOT_AVAILABLE=27]="VIDEO_CONTENT_NOT_AVAILABLE",e[e.USER_NOT_ACTIVE=28]="USER_NOT_ACTIVE",e[e.USER_UNAUTHENTICATED=29]="USER_UNAUTHENTICATED",e[e.UNDER_AGE=30]="UNDER_AGE",e[e.INVALID_SHARE_KEY=31]="INVALID_SHARE_KEY"}(r||(r={}));var s=((a={})[r.UNKNOWN]=o.Hr,a[r.UNEXPECTED_FAILURE]=o.Nr,a[r.COMMENT_NOT_FOUND]=o.W,a[r.CREATE_COMMENT_FAILURE]=o.$,a[r.CREATE_POST_FAILURE]=o.se,a[r.CREATE_REACTION_FAILURE]=o.me,a[r.CREATE_PHOTOSTORY_FAILURE]=o.ee,a[r.EXCEEDED_COMMENT_COTNTENT_LENGTH]=o.Ft,a[r.EXCEEDED_LOCATION_LENGTH]=o.Nt,a[r.EXCEEDED_PHOTOSTORY_NAME_LENGTH]=o.zt,a[r.EXCEEDED_PHOTOSTORY_DESCRIPTION_LENGTH]=o.Vt,a[r.EXCEEDED_POST_DESCRIPTION_LENGTH]=o.Gt,a[r.EXCEEDED_COMMENTS_PER_POST]=o.Ht,a[r.EXCEEDED_ITEMS_PER_POST]=o.Rt,a[r.EXCEEDED_MEMBER_PHOTOSTORIES_PER_USER]=o.Bt,a[r.EXCEEDED_MEMBERS_PER_PHOTOSTORY]=o.jt,a[r.EXCEEDED_POSTS_PER_PHOTOSTORY]=o.Kt,a[r.INVITATION_NOT_FOUND]=o.Sn,a[r.ACCESS_REQUEST_NOT_FOUND]=o.i,a[r.MEMBERSHIP_NOT_FOUND]=o.Qn,a[r.POST_NOT_FOUND]=o.ni,a[r.PHOTOSTORY_ALREADY_EXIST]=o.Wa,a[r.PHOTOSTORY_NOT_FOUND]=o.qa,a[r.REACTION_NOT_FOUND]=o.si,a[r.SHAREID_NOT_FOUND]=o.Qi,a[r.SOUTH_KOREA_LAW]=o.or,a[r.VIDEO_CONTENT_NOT_AVAILABLE]=o.Qa,a[r.INVALID_SHARE_KEY]=o.yn,a),c=((i={}).unexpectedfailure=r.UNKNOWN,i.commentnotfound=r.COMMENT_NOT_FOUND,i.createcommentfailure=r.CREATE_COMMENT_FAILURE,i.createpostfailure=r.CREATE_POST_FAILURE,i.createreactionfailure=r.CREATE_REACTION_FAILURE,i.createphotostoryfailure=r.CREATE_PHOTOSTORY_FAILURE,i.duplicatereaction=r.DUPLICATE_REACTION,i.exceededcommentcontentlength=r.EXCEEDED_COMMENT_COTNTENT_LENGTH,i.exceededlocationlength=r.EXCEEDED_LOCATION_LENGTH,i.exceededphotostorynamelength=r.EXCEEDED_PHOTOSTORY_NAME_LENGTH,i.exceededphotostorydescriptionlength=r.EXCEEDED_PHOTOSTORY_DESCRIPTION_LENGTH,i.exceededpostdescriptionlength=r.EXCEEDED_POST_DESCRIPTION_LENGTH,i.exceededcommentsperpost=r.EXCEEDED_COMMENTS_PER_POST,i.exceededitemsperpost=r.EXCEEDED_ITEMS_PER_POST,i.exceededmemberphotostoriesperuser=r.EXCEEDED_MEMBER_PHOTOSTORIES_PER_USER,i.exceededmembersperphotostory=r.EXCEEDED_MEMBERS_PER_PHOTOSTORY,i.exceededpostsperphotostory=r.EXCEEDED_POSTS_PER_PHOTOSTORY,i.invitationnotfound=r.INVITATION_NOT_FOUND,i.accessrequestnotfound=r.ACCESS_REQUEST_NOT_FOUND,i.membershipnotfound=r.MEMBERSHIP_NOT_FOUND,i.postnotfound=r.POST_NOT_FOUND,i.photostoryalreadyexist=r.PHOTOSTORY_ALREADY_EXIST,i.photostorynotfound=r.PHOTOSTORY_NOT_FOUND,i.reactionnotfound=r.REACTION_NOT_FOUND,i.shareidnotfound=r.SHAREID_NOT_FOUND,i.usernotactive=r.USER_NOT_ACTIVE,i.unauthenticated=r.USER_UNAUTHENTICATED,i.geolocinvalidrequest=r.SOUTH_KOREA_LAW,i.underageaccessdenied=r.UNDER_AGE,i.photostoryunderageaccessdenied=r.UNDER_AGE,i.invalidshareskey=r.INVALID_SHARE_KEY,i);function d(e){var t,n,a;return(null===(t=e.response)||void 0===t?void 0:t.error["@error.photoStreamErrorCode"])||(null===(a=null===(n=e.innerError)||void 0===n?void 0:n.response)||void 0===a?void 0:a.error["@error.photoStreamErrorCode"])||e.code||"UnexpectedFailure"}function l(e){var t=e?e.toLowerCase():"";return c[t]||r.UNKNOWN}},2237:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return c});var a=n(0),i=n(240),r=n(119),o=n(1132),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a}return Object(a.__extends)(t,e),t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{identityDataSource:o.e}),t}(i.e);t.default=s;var c=Object(r.r)("GraphTokenProvider",s)},2238:function(e,t,n){"use strict";n.r(t),n.d(t,"GraphUrlDataSource",function(){return r}),n.d(t,"resourceKey",function(){return o});var a=n(7),i=n(119),r=function(){function e(){}return e.prototype.getApiName=function(){return"Graph"},e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/beta"},e}(),o=new a.t({name:"GraphUrlDataSource",factory:new i.i(r)})},2421:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(30),i=n(163),r=n(599),o=n(1877),s=n(47),c=n(2219),d=n(12),l=n(140),u=n(348),f=function(){return f=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f.apply(this,arguments)},p=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},m=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},_=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},h=function(){function e(e,t){this.apiName="PhotoStream",this.defaultRequestorHeaders={"Accept-Language":i.t.language},this.vroomDataRequestor=e,this.endpoint=Object(a.u)({apiVersion:"v2.1",driveId:"me"}),this.driveId=d.K?Object(l.e)(d.K):"me"}return e.prototype.getPhotoStreamQuota=function(){return p(this,void 0,void 0,function(){var e,t;return m(this,function(n){return e=new r.e,t=o.t.skyApiBaseUrl+"GetStorageInfo",[2,e.send({apiName:"".concat(this.apiName,".get.quota"),url:t})]})})},e.prototype.getDriveId=function(){return this.driveId},e.prototype.getEndpoint=function(){return this.endpoint},e.prototype.getDriveItemDetails=function(e){return p(this,void 0,void 0,function(){var t,n;return m(this,function(i){return t=e.split("!")[0],n="/drives/".concat(t,"/items/").concat(e,"?expand=thumbnails&select=id,@content.downloadUrl,thumbnails,video"),[2,this.vroomDataRequestor.send({endpoint:Object(a.u)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.itemDetails"),headers:this.defaultRequestorHeaders,path:n,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.createPhotoStream=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(a){return n={name:e,description:t||""},[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.stream"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams"),requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(n)})]})})},e.prototype.deletePhotoStream=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.stream"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.updatePhotoStreamProperties=function(e,t,n,a,i){return void 0===n&&(n=""),void 0===a&&(a=""),void 0===i&&(i=""),p(this,void 0,void 0,function(){return m(this,function(r){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".update.properties"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e),requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify({description:a,name:i,photoStream:{coverPhotoResourceId:n,requireApproval:t}})})]})})},e.prototype.getPhotoStreamList=function(e,t,n){return void 0===e&&(e=20),p(this,void 0,void 0,function(){function a(e,t){if(t){var n=Object(c.n)(t),a=Object(c.a)(n);a!==c.t.USER_NOT_ACTIVE&&a!==c.t.UNDER_AGE||(e.resultType=s.e.ExpectedFailure)}return e}var i,r;return m(this,function(o){return i=t?"/drives/".concat(this.driveId,"/photostreams/").concat(t):"/drives/".concat(this.driveId,"/photostreams?$top=").concat(e),r=n?"&$skiptoken=".concat(n):"",i="".concat(i).concat(r),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.streamList"),headers:this.defaultRequestorHeaders,path:i,requestType:"GET",postProcessQos:a,useAuthorizationHeaders:!0})]})})},e.prototype.createPost=function(e,t){return p(this,void 0,void 0,function(){var n,a;return m(this,function(i){return n=null==e?void 0:e.photos.map(function(e){return{photoStreamPostItem:{resourceId:e.id}}}),a={description:null==e?void 0:e.description,location:{displayName:null==e?void 0:e.location},photoStreamPost:{items:n}},[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.createPost"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(t,"/posts"),requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(a)})]})})},e.prototype.editPost=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(a){return n={description:null==e?void 0:e.description,location:{displayName:null==e?void 0:e.location}},[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.editPost"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(t,"/posts/").concat(e.id),requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(n)})]})})},e.prototype.deletePost=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.post"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.getFeed=function(e,t,n,a){return p(this,void 0,void 0,function(){var i,r,o;return m(this,function(s){return i=t?"&$skiptoken=".concat(t):"",r=f({},this.defaultRequestorHeaders),a&&(r.Prefer="Include-PhotoStory-Quota"),o=n?"/drives/".concat(this.driveId,"/photostreams/").concat(n,"/posts?$top=").concat(e,"&$expand=photoStreamPost,photoStreamPostReactionByCaller"):"/drives/".concat(this.driveId,"/oneDrive.mediaFeed?$top=").concat(e,"&$expand=photoStreamPost,photoStreamPostReactionByCaller"),o+=i,[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,n?".get.story":".get.feed"),path:o,requestType:"GET",headers:r,useAuthorizationHeaders:!0})]})})},e.prototype.getThumbnail=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(i){return n="/drives/".concat(e,"/items/").concat(t,"/thumbnails/0/large"),[2,this.vroomDataRequestor.send({endpoint:Object(a.u)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.videoThumbnail"),path:n,requestType:"GET",headers:this.defaultRequestorHeaders,useAuthorizationHeaders:!0})]})})},e.prototype.getAlbumPhotos=function(e,t,n){return p(this,void 0,void 0,function(){var i,r;return m(this,function(o){return i=null!=t?t:100,r="/drives/".concat(this.driveId,"/items/").concat(e,"/children?orderby=createdDateTime+asc&top=").concat(i,"&select=id,name,thumbnails,video&expand=thumbnails"),n&&(r="".concat(r,"&skiptoken=").concat(n)),[2,this.vroomDataRequestor.send({endpoint:Object(a.u)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.album"),headers:this.defaultRequestorHeaders,path:r,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getAlbumCoverPhoto=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:Object(a.u)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.albumCoverPhoto"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/items/").concat(e,"?select=id,name,thumbnails&expand=thumbnails"),requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMyAlbums=function(e,t){return p(this,void 0,void 0,function(){var n,i;return m(this,function(r){return n=null!=e?e:6,i="/drives/".concat(this.driveId,"/bundles?filter=bundle/album+ne+null&orderby=createdDateTime+desc&top=").concat(n,"&select=bundle,id,name"),t&&(i="".concat(i,"&skiptoken=").concat(t)),[2,this.vroomDataRequestor.send({endpoint:Object(a.u)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.myAlbums"),headers:this.defaultRequestorHeaders,path:i,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMyPhotos=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(i){return e=e||100,n="/drives/".concat(this.driveId,"/items/root/items?filter=photo+ne+null&orderby=photo/takenDateTime+desc&expand=thumbnails&top=").concat(e),t&&(n+="&skiptoken=".concat(t)),[2,this.vroomDataRequestor.send({endpoint:Object(a.u)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.myPhotos"),headers:this.defaultRequestorHeaders,path:n,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMyMemories=function(e){return p(this,void 0,void 0,function(){var t,n,i,r,o;return m(this,function(s){return t="/drives/".concat(this.driveId,"/recommendedItems?expand=thumbnails"),e?t="".concat(t,"&targetDate=").concat(e):(n=new Date,i=n.getMonth()+1,r=n.getDate(),o=[n.getFullYear(),(i>9?"":"0")+i,(r>9?"":"0")+r].join("-"),t="".concat(t,"&targetDate=").concat(o)),[2,this.vroomDataRequestor.send({endpoint:Object(a.u)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.myMemories"),headers:this.defaultRequestorHeaders,path:t,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMemoryPhotos=function(e,t,n){return p(this,void 0,void 0,function(){var i,r;return m(this,function(o){return i=null!=t?t:100,r="/drives/".concat(this.driveId,"/recommendedItems/").concat(e,"/children?expand=thumbnails&top=").concat(i),n&&(r+="&skiptoken=".concat(n)),[2,this.vroomDataRequestor.send({endpoint:Object(a.u)({apiVersion:"v1.0",driveId:"me"}),apiName:"".concat(this.apiName,".get.memory"),headers:this.defaultRequestorHeaders,path:r,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.createComment=function(e,t,n){return p(this,void 0,void 0,function(){var a;return m(this,function(i){return a={text:n},[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.comment"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamComments"),requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(a)})]})})},e.prototype.getComments=function(e,t,n){return p(this,void 0,void 0,function(){var a;return m(this,function(i){return a=n?"&$skiptoken=".concat(n):"",[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.comments"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamComments?").concat(a),requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.deleteComment=function(e,t,n){return p(this,void 0,void 0,function(){return m(this,function(a){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.comment"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamComments/").concat(n),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.createLikeReaction=function(e,t){return this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.likeReaction"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamReactions"),requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify({type:"Like"})})},e.prototype.deleteLikeReaction=function(e,t,n){return this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.likeReaction"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamReactions/").concat(n),requestType:"DELETE",useAuthorizationHeaders:!0})},e.prototype.getReactions=function(e,t,n){var a=n?"&$skiptoken=".concat(n):"";return this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.likeReaction"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photostreams/").concat(e,"/posts/").concat(t,"/photoStreamReactions?").concat(a),requestType:"GET",useAuthorizationHeaders:!0})},e.prototype.getActivities=function(e,t,n,a,i,r){var o;return void 0===e&&(e=20),p(this,void 0,void 0,function(){var s,c,d,l,f,p,_,h;return m(this,function(m){return s="invite($expand=photoStream),accessRequest($expand=photoStream),post($expand=photoStreamPost)",c=[],n&&(s="".concat(n,"($expand=photoStream)"),c.push("Type in ('".concat(n,"')"))),i&&a?c.push("(activityDateTime ge ".concat(a," and activityDateTime le ").concat(i,")")):i?c.push("(activityDateTime le ".concat(i,")")):a&&c.push("(activityDateTime ge ".concat(a,")")),d="/drives/".concat(this.driveId,"/photostreams/oneDrive.psActivities?$expand=").concat(s,"&$top=").concat(e),l=c.join(" and "),d+=l&&"&$filter=".concat(l),f=t?"&$skiptoken=".concat(t):"",d="".concat(d).concat(f),p=r?"".concat(this.apiName,".get.activities.").concat(r):"".concat(this.apiName,".get.activities"),_=Object(u.t)()?Object(u.t)().toDateString():"",h=null!==(o=Object(u.e)())&&void 0!==o?o:"",[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:p,headers:this.defaultRequestorHeaders,path:d,requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{lastProvisionCheck:_,hasProvisionCheck:h}})]})})},e.prototype.acceptInvite=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.acceptInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/myPhotoStreamInvitation/oneDrive.psAccept?$expand=photoStream"),requestType:"POST",useAuthorizationHeaders:!0})]})})},e.prototype.getSentInvites=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.sentInvites"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamInvitations"),requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e.value})]})})},e.prototype.cancelPendingInvite=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.pendingInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamInvitations/").concat(t),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.dismissInvite=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.invite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/myPhotoStreamInvitation"),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.followByShareId=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.psFollow"),headers:this.defaultRequestorHeaders,path:"/shares/".concat(e,"/photoStream/myPhotoStreamInvitation/oneDrive.psAccept"),requestType:"POST",useAuthorizationHeaders:!0})]})})},e.prototype.getRecommendedInvitees=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.recommendedInvitees"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.recommendedInvitees?$top=50"),requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e.value})]})})},e.prototype.deleteMyMembership=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.myMembership"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/myPhotoStreamMembership"),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.deleteMembership=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.membership"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamMemberships/").concat(t),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.sendInvitesByEmail=function(e,t,n){return p(this,void 0,void 0,function(){var a,i;return m(this,function(r){return a=t.map(function(e){return{email:e}}),i=JSON.stringify({message:null!=n?n:"",recipients:a}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.sendInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psInvite"),requestType:"POST",postData:i,useAuthorizationHeaders:!0})]})})},e.prototype.sendInvitesById=function(e,t,n){return p(this,void 0,void 0,function(){var a,i;return m(this,function(r){return a=t.map(function(e){return{objectId:e}}),i=JSON.stringify({message:null!=n?n:"",recipients:a}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.sendInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psInvite"),requestType:"POST",postData:i,useAuthorizationHeaders:!0})]})})},e.prototype.sendInvitesByIdAndEmail=function(e,t,n,a){return p(this,void 0,void 0,function(){var i,r,o,s;return m(this,function(c){return i=t.map(function(e){return{objectId:e}}),r=n.map(function(e){return{email:e}}),o=_(_([],i,!0),r,!0),s=JSON.stringify({message:null!=a?a:"",recipients:o}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.sendInvite"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psInvite"),requestType:"POST",postData:s,useAuthorizationHeaders:!0})]})})},e.prototype.getPhotoStreamMembers=function(e,t,n){return void 0===t&&(t=100),p(this,void 0,void 0,function(){var a,i;return m(this,function(r){return a="/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamMemberships?$filter=state eq 'active'&$top=").concat(t),i=n?"&$skiptoken=".concat(n):"",a="".concat(a).concat(i),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.members"),headers:this.defaultRequestorHeaders,path:a,requestType:"GET",useAuthorizationHeaders:!0})]})})},e.prototype.getMembersStatus=function(e,t){return p(this,void 0,void 0,function(){var n;return m(this,function(a){return n=t.map(function(e){return"'".concat(e,"'")}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.members"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamMemberships?$filter=member/id in (").concat(n,") "),requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e.value})]})})},e.prototype.getAnonymousShareId=function(e){return p(this,void 0,void 0,function(){return m(this,function(t){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.anonymousShareId"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psGetAnonymousSharingBaseUri"),requestType:"POST",useAuthorizationHeaders:!0})]})})},e.prototype.revokeAnonymousShareLink=function(e){return p(this,void 0,void 0,function(){var t;return m(this,function(n){return t=JSON.stringify({regenerateLink:!0}),[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.anonymousShareId"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/oneDrive.psGetAnonymousSharingBaseUri"),requestType:"POST",postData:t,useAuthorizationHeaders:!0})]})})},e.prototype.getPhotoStreamDataFromShareId=function(e,t){return void 0===t&&(t=!0),p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.streamDataFromShareId"),headers:this.defaultRequestorHeaders,path:"/shares/".concat(e,"/photoStream"),requestType:"GET",useAuthorizationHeaders:!0,needsAuthorization:t})]})})},e.prototype.acceptJoinRequest=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".post.acceptJoinRequest"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamAccessRequests/").concat(t,"/oneDrive.psApprove"),requestType:"POST",useAuthorizationHeaders:!0})]})})},e.prototype.declineJoinRequest=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".delete.joinRequest"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/photoStreamAccessRequests/").concat(t),requestType:"DELETE",useAuthorizationHeaders:!0})]})})},e.prototype.getPost=function(e,t){return p(this,void 0,void 0,function(){return m(this,function(n){return[2,this.vroomDataRequestor.send({endpoint:this.endpoint,apiName:"".concat(this.apiName,".get.post"),headers:this.defaultRequestorHeaders,path:"/drives/".concat(this.driveId,"/photoStreams/").concat(e,"/posts/").concat(t,"?expand=photoStreamPost,photoStreamPostReactionByCaller"),requestType:"GET",useAuthorizationHeaders:!0})]})})},e}()},3716:function(e,t,n){"use strict";n.r(t),n.d(t,"photoStreamProvisionAddon",function(){return y}),n.d(t,"photoStreamInitAddon",function(){return S});var a=n(23),i=n(317),r=n(219),o=n(710),s=n(212),c=n(389),d=n(169),l=n(1982),u=n(2078),f=n(14),p=n(2421),m=n(2219),_=n(348),h=n(372),b=function(){return b=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b.apply(this,arguments)},g=Object(a.i)()(function(e){var t=this;return function(n){return a=t,void 0,r=function(){var t,a,i,r;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(s){switch(s.label){case 0:return t=new h.e,a=n(Object(d.e)(function(e){return e.demandItemFacet(f.o,f.i)})),i=a.consume(l.e),r=a.consume(u.e),[4,new p.e(i,r).getPhotoStreamList(10).then(function(n){var a;n&&(Object(_.a)(),t.resolveItems({items:(a={},a[e.itemKey]=b({},o.a.pack(!0)),a)}))}).catch(function(n){var a,i=Object(m.n)(n);if(Object(m.a)(i)===m.t.USER_NOT_ACTIVE){var r=new Date;Object(_.i)(r)}t.resolveItems({items:(a={},a[e.itemKey]=b({},o.a.pack(!1)),a)})})];case 1:return s.sent(),n(t.execute()),[2]}})},new((i=void 0)||(i=Promise))(function(e,t){function n(e){try{s(r.next(e))}catch(e){t(e)}}function o(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i(function(e){e(a)})).then(n,o)}s((r=r.apply(a,[])).next())});var a,i,r}}),v=n(1044),y=Object(a.t)(function(){return function(e){e(Object(s.t)({keyFacet:r.n,facets:[o.a]})),e(Object(i.a)(r.n,c.e)(g))}}),S=Object(a.t)(function(){return function(e){e(y),e(Object(v.e)(function(e){e.demandItemFacet(o.a,r.t)}))}})}}]);