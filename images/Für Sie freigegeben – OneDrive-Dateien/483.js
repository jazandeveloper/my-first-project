(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[483],{1930:function(e,t,n){"use strict";var a=n(0),i=n(58),r=n(24),o=n(171),s=function(e){function t(){var t=e.call(this)||this;return t._focusedIndex=-1,t._subscriptions=[],t._selectItemKeyToModel={},t.keyToIndexHash={},t.indexToKeyHash={},t.unresolvedSelectedIndices={},t._focusedIndex=-1,t._subscriptions=[],t._selectItemKeyToModel={},t.itemSet=r.observable(null),t.layout=r.observable(),t.selection=r.observableArray().extend({rateLimit:{timeout:200,method:"notifyWhenChangesStop"}}),t.selectionKeyHash=r.observable({}),t.focused=r.observable().extend({rateLimit:{timeout:50,method:"notifyWhenChangesStop"}}),t.items=r.observableArray(),t.focusedKeyHash=r.observable({}),t.isAllSelected=r.observable(!1),t.isActive=r.observable(!1),t.clearSelectionOnRemoval=!1,t.selectFirstItemOnActivate=!0,t}return Object(a.__extends)(t,e),t._set=function(e,t,n,a){(e=r.utils.unwrapObservable(e))&&e.hasOwnProperty(t)&&r.isObservable(e[t])&&e[t](n),e&&e.key&&(a()[e.key]=n,a.valueHasMutated())},t._setAll=function(e,n,a,i){for(var r=0;r<e.length;r++)t._set(e[r],n,a,i)},t._hasCssClass=function(e,t){return!!(e&&e.className&&-1!==e.className.indexOf(t)&&e.className.match("\\b"+t+"\\b"))},t._getParentElement=function(e){return e&&Object(o.e)(e)||null},t._insideElementWithClass=function(e,n,a){a=a||null;for(var i=e;i;){if(t._hasCssClass(i,n))return!0;if(i===a)return!1;i=t._getParentElement(i)}return!1},t.prototype.init=function(e){var n=this;if(!this.items)throw new Error("The selection binding can only be used together with `foreach`, `foreach: { data: ... }`, `template: { foreach: ... }` or like `selection: { data: ... }`.");if(!r.isObservable(this.selection))throw new Error("The selection binding should be bound to either an `observableArray` or a object containing a `selection` `observableArray`.");this.properties=e.properties,this._buildKeyIndexHash(),this.async.setTimeout(function(){n.cleanup(),n._updateFocused(e.properties.focused,!0)},0),this._subscriptions=[],this._subscriptions.push(this.focused.subscribe(function(e){var t;(t=(e=r.utils.unwrapObservable(e))?e.key:null)&&n._updateIsFocusedObservable(t,!1)},this,"beforeChange")),this._subscriptions.push(this.focused.subscribe(function(e){n._focusedIndex=e?n._findItemIndex(n.focused()):-1,n._focusedIndex>-1&&n._updateIsFocusedObservable(n.indexToKeyHash[n._focusedIndex],!0)})),this._subscriptions.push(this.selection.subscribe(function(a){t._setAll(n.selection(),e.properties.selected,!1,n.selectionKeyHash)},this,"beforeChange")),this._subscriptions.push(this.selection.subscribe(function(a){"single"===n.mode()&&a.length>1?n.selection([a.slice(-1)[0]]):t._setAll(a,e.properties.selected,!0,n.selectionKeyHash);var i=n.items().length,r=n.selection().length;n.isAllSelected(i>0&&i===r)})),this._subscriptions.push(this.items.subscribe(function(e){n._buildKeyIndexHash(),n.cleanup()})),t._setAll(this.selection.peek(),e.properties.selected,!0,this.selectionKeyHash),this._subscriptions.push(this.focused.subscribe(function(a){t._set(a,e.properties.focused,!1,n.focusedKeyHash)},this,"beforeChange")),this._subscriptions.push(this.focused.subscribe(function(a){t._set(a,e.properties.focused,!0,n.focusedKeyHash)})),this.focused()&&t._set(this.focused(),e.properties.focused,!0,this.focusedKeyHash)},t.prototype.cleanup=function(){var e=this;if(!this.itemSet.peek()||!this.itemSet.peek().isPlaceholder){var t=[];if(this.focused.peek()){var n=this._findItemIndex(this.focused.peek());-1===n?this.focused(null):this._focusedIndex=n}this.anchor.peek()&&-1===this._findItemIndex(this.anchor.peek())&&this.anchor(null),this.isAllSelected()?this.selectAll():(r.utils.arrayForEach(this.selection.peek(),function(n){-1!==e._findItemIndex(n)&&t.push(n)}),t.length!==this.selection.peek().length&&this.selection(t))}},t.prototype.clear=function(){this.focused&&this.focused(null),this.anchor&&this.anchor(null),this._focusedIndex=-1,this.removeSelection()},t.prototype.hasHorizontal=function(){return"horizontal"===this.direction.peek()},t.prototype.hasVertical=function(){return"vertical"===this.direction.peek()},t.prototype.hasCustom=function(){return"custom"===this.direction.peek()},t.prototype.toggleAllSelected=function(){this.selection.peek().length===this.items.peek().length?(this.selection([]),this._updateAllSelectItemViewModels(!1)):this.selectAll()},t.prototype.selectAll=function(){var e=this.items.peek().slice();this.unresolvedSelectedIndices={};for(var t=0;t<e.length;t++)e[t]||(this.unresolvedSelectedIndices[t]=!0);this.selection(this.items().slice()),this._updateAllSelectItemViewModels(!0)},t.prototype.selectItem=function(e){var t=[],n=r.utils.unwrapObservable(e);this._updateSelectItemViewModelInSelection(!1),e&&(t.push(e),this._updateIsSelectedObservable(n.key,!0)),this.selection(t),this.focused(e)},t.prototype.firstItem=function(){return this.items()[0]},t.prototype.lastItem=function(){return this.items()[this.items().length-1]},t.prototype.nextItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.min(t+1,this.items().length-1)]},t.prototype.previousItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.max(t-1,0)]},t.prototype.leftItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexLeft(t)]:this.hasHorizontal()?this.previousItem(e):null},t.prototype.aboveItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexAbove(t)]:this.hasVertical()?this.previousItem(e):null},t.prototype.rightItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexRight(t)]:this.hasHorizontal()?this.nextItem(e):null},t.prototype.belowItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexBelow(t)]:this.hasVertical()?this.nextItem(e):null},t.prototype.isAlreadySelected=function(e){var t=r.utils.unwrapObservable(e);return t.hasOwnProperty("key")?!0===this.selectionKeyHash()[t.key]:-1!==r.utils.arrayIndexOf(this.selection(),e)},t.prototype.toggleSelection=function(e,t){var n=r.utils.unwrapObservable(e);this.isAlreadySelected(e)?t||(this.selection.remove(e),this._updateIsSelectedObservable(n.key,!1)):!1!==t&&(this.selection.push(e),this._updateIsSelectedObservable(n.key,!0)),this.focused(e)},t.prototype.removeSelection=function(){this.unresolvedSelectedIndices={},this.selection([]),this._updateAllSelectItemViewModels(!1)},t.prototype.appendSelectionWithCurrentItem=function(e){if(e){if(this.anchor(e),!this.isAlreadySelected(e)){var t=r.utils.unwrapObservable(e);this.selection.push(e),this._updateIsSelectedObservable(t.key,!0)}this.focused(e)}},t.prototype.appendSelectionFromAnchor=function(e){if(e){var t=this.anchor.peek();t?this.selection.remove(t):this.anchor(e),this.selection.push.apply(this.selection,this._createRange(this.items,this.anchor(),e,!0)),this._updateSelectItemViewModelInSelection(!0),this.focused(e)}},t.prototype.replaceSelectionWithRangeFromAnchor=function(e){e&&(this.anchor.peek()||this.anchor(e),this._updateSelectItemViewModelInSelection(!1),this.selection(this._createRange(this.items,this.anchor.peek(),e)),this._updateSelectItemViewModelInSelection(!0),this.focused(e))},t.prototype.findItemData=function(e){var t=r.contextFor(e);if(!t||!t.$data)return null;for(var n=this._getItemFromContext(t)||t.$data;t;){if(n&&this._findItemIndex(n)>=0)return n;t=t.$parentContext,n=this._getItemFromContext(t)}return null},t.prototype.isClickOnToggleElement=function(e,n){var a=this.toggleClass;return!!a&&t._insideElementWithClass(n,a,e)},t.prototype.activate=function(){r.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!0),this.isActive(!0)},t.prototype.deactivate=function(){r.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!1),this.isActive(!1)},t.prototype.subscribeSelectItemViewModel=function(e,t){this._selectItemKeyToModel[e]?this._selectItemKeyToModel[e].push(t):this._selectItemKeyToModel[e]=[t]},t.prototype.disposeSelectItemViewModel=function(e,t){var n=this._selectItemKeyToModel[e],a=-1;n&&((a=n.indexOf(t))>-1&&n.splice(a,1),0===n.length&&delete this._selectItemKeyToModel[e])},t.prototype.getFocusedItemKey=function(){var e=null;return this._focusedIndex>-1&&(e=this.indexToKeyHash[this._focusedIndex]),e},t.prototype.ensureFocusedItemViewModel=function(){var e=this.getFocusedItemKey();this._updateIsFocusedObservable(e,!0)},t.prototype.setFocusItemByKey=function(e){var t=this.keyToIndexHash[e];void 0!==t&&this.focused(this.items.peek()[t])},t.prototype.getViewModelsForKey=function(e){return this._selectItemKeyToModel[e]},t.prototype._findItemIndex=function(e){var t=-1,n=r.utils.unwrapObservable(e);if(n)if(n.hasOwnProperty("key")){var a=this.keyToIndexHash[n.key];void 0!==a&&(t=a)}else t=r.utils.arrayIndexOf(this.items.peek(),e);return t},t.prototype._getKeyForItem=function(e){var t,n=r.utils.unwrapObservable(e);return n&&n.hasOwnProperty("key")&&(t=n.key),t},t.prototype._createRange=function(e,t,n,a){var i=this.selectionKeyHash(),r=e(),o=this._findItemIndex(t),s=this._findItemIndex(n),c=[];if(o>s){var d=o;o=s,s=d}for(var l=o;l<=s;l+=1){var u=this._getKeyForItem(r[l]);u?a&&i[u]||c.push(r[l]):this.unresolvedSelectedIndices[l]=!0}return c},t.prototype._updateFocused=function(e,t){for(var n=this.items.peek(),a=0;a<n.length;a++){var i=n[a];if(i&&i.hasOwnProperty(e)&&r.isObservable(i[e])&&i[e]()===t){this.focused(i);break}}},t.prototype._updateIsSelectedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isSelected(t)})},t.prototype._updateIsFocusedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isFocused(t)})},t.prototype._updateAllSelectItemViewModels=function(e){for(var t in this._selectItemKeyToModel)this._selectItemKeyToModel[t].forEach(function(t){t.isSelected(e)})},t.prototype._updateSelectItemViewModelInSelection=function(e){for(var t,n,a=this.selection.peek(),i=0;i<a.length;i++)(t=r.utils.unwrapObservable(a[i]))&&(n=t.key,this._updateIsSelectedObservable(n,e))},t.prototype._buildKeyIndexHash=function(){var e,t,n=this.items.peek();this.keyToIndexHash={},this.indexToKeyHash={};for(var a=0;a<n.length;a++)(t=r.utils.unwrapObservable(n[a]))&&t.hasOwnProperty("key")&&(e=t.key,this.keyToIndexHash[e]=a,this.indexToKeyHash[a]=e);this._checkUnresolvedIndicies()},t.prototype._checkUnresolvedIndicies=function(){var e,t=this.items.peek();for(var n in this.unresolvedSelectedIndices)t[Number(n)]&&(delete this.unresolvedSelectedIndices[n],(e=e||{})[n]=!0);if(e){for(var a=[],i=this.selectionKeyHash.peek(),r=0;r<t.length;r++){var o=t[r];(i[this._getKeyForItem(o)]||e[r]||this.unresolvedSelectedIndices[r])&&a.push(o)}this.selection(a)}},t.prototype._getItemFromContext=function(e){return e&&e.$data?"function"==typeof e.$data.getItem?e.$data.getItem():e.$data.isSelectable?e.$data:null:null},t}(i.n);t.e=s},1933:function(e,t,n){"use strict";var a=n(24),i=n(1930),r=function(){function e(){this.handlers=[]}return e.prototype.register=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length-1;n++)this.handlers.push({pattern:e[n],callback:e[e.length-1]})},e.prototype.match=function(e,t){for(var n=0;n<this.handlers.length;n++)if(this._compare(this.handlers[n].pattern,e)){var a=this.handlers[n].callback.call(this,e,t);return"boolean"!=typeof a||a}return!1},e.prototype._compare=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0},e}(),o=r,s=n(101),c=n(112),d=function(){function e(){}return e.init=function(t,n,r,o,c){var d,l=a.utils.unwrapObservable(n()),u=r(),f=new s.t(null),p={mode:"multi",direction:"custom",properties:{selected:"selected",focused:"focused",activeClass:"selection-active"}},m=l.selectionModel||new i.e;d=l.data?l.data:u.foreach&&u.foreach.data||u.foreach||u.template&&u.template.foreach,m.items=a.isObservable(d)?d:a.observableArray(d),m.rootElement=a.observable(t),l?(m.focused=l.focused||a.observable(null),m.anchor=l.anchor||a.observable(null),m.layout=l.layout||a.observable(null),m.toggleClass=m.layout()?m.layout().getToggleClass():l.toggleClass||null,m.clearSelectionOnRemoval=l.clearSelectionOnRemoval,m.selectFirstItemOnActivate="boolean"!=typeof l.selectFirstItemOnActivate||l.selectFirstItemOnActivate,a.isObservable(l.mode)?m.mode=l.mode:m.mode=a.observable(l.mode||p.mode),a.isObservable(l.direction)?m.direction=l.direction:m.direction=a.observable(l.direction||p.direction),a.utils.extend(p.properties,l.properties)):(m.selection=a.observableArray(l.data),m.focused=a.observable(null),m.anchor=a.observable(null),m.mode=a.observable(p.mode),m.direction=a.observable(p.direction),m.layout=null),m.init(p);var _=e.getMode(m.mode())(m,l.isReadyToBeSelected);e._registerEventHandlers(f,t,m,_,l.alwaysSelectFirst,l.isActive,l.allowInputEvents),a.utils.domNodeDisposal.addDisposeCallback(t,function(){m.clearSelectionOnRemoval&&m.clear(),f.dispose()})},e.getMode=function(t){var n=e.modes[t];if(!n)throw new Error('Unknown mode: "'+t+'"');return n},e._registerEventHandlers=function(e,t,n,a,i,r,o){function s(e){var t=e.target,i=t&&"A"===t.tagName,r=n.findItemData(e.target);e.hasItem=!!r,e.isClickOnToggleElement=n.isClickOnToggleElement(this,e.target),i||a.match(e,r)}e.on(t,"touchstart",s),e.on(t,"touchend",s),e.on(t,"touchmove",s),e.on(t,"click",s),e.on(t,"focusin",function(e){if(!(e.relatedTarget&&t.contains(e.relatedTarget)||n.isActive.peek())){if(i){var a=n.firstItem();n.focused(a),n.anchor(a)}else if(e.target===t){var r=n.focused.peek();0===n.selection.peek().length&&!r&&n.selectFirstItemOnActivate?(a=n.firstItem(),n.focused(a),n.anchor(a),n.selectItem(a)):r&&(n.selectItem(r),n.anchor(r))}n.activate()}}),e.on(t,"focusout",function(e){e.relatedTarget&&!t.contains(e.relatedTarget)&&n.deactivate()}),e.on(t,"keydown",function(e){var i=e.target,s=i&&("INPUT"===i.tagName||"TEXTAREA"===i.tagName);if(!o&&s||r&&!r())return!0;var d=n.focused.peek();e.hasItem=!!d,e.keyCode===c.e.tab&&e.shiftKey&&!e.ctrlKey&&t.focus(),a.match(e,d)&&(e.stopPropagation(),e.preventDefault())})},e._isItemReadyToBeSelected=function(e,t){var n=!1;return!e||t&&!t(e)||(n=!0),n},e._getSingleMatchers=function(t,n){t.focused()?t.selection([t.focused()]):t.selection.splice(1);var a=new o;return a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.end},function(e,n){var a=t.lastItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.space,hasItem:!0},function(e,t){}),(t.hasVertical()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.up,hasItem:!1},{type:"keydown",which:c.e.down,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.up,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),(t.hasHorizontal()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.left,hasItem:!1},{type:"keydown",which:c.e.right,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.left,hasItem:!0},{type:"keydown",which:c.e.tab,shiftKey:!0,hasItem:!0},function(a,i){var r=t.leftItem(i);if(i===t.firstItem())return!1;e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,hasItem:!0},{type:"keydown",which:c.e.tab,hasItem:!0},function(a,i){var r=t.rightItem(i);if(i===t.lastItem())return!1;e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),a},e._getMultiMatchers=function(t,n){var a=new o;return a.register({type:"click",which:1,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)}),a.register({type:"click",which:1,ctrlKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,hasItem:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"click",which:1,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)}),a.register({type:"click",which:1,hasItem:!1},function(e,n){t.removeSelection()}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.space,hasItem:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.end,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:c.e.end,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.lastItem())}),a.register({type:"keydown",which:c.e.end,ctrlKey:!0},{type:"keydown",which:c.e.end,metaKey:!0},function(e,n){var a=t.lastItem();t.focused(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.end,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.lastItem())}),a.register({type:"keydown",which:c.e.end},function(e,n){var a=t.lastItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:c.e.home,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.firstItem())}),a.register({type:"keydown",which:c.e.home,ctrlKey:!0},{type:"keydown",which:c.e.home,metaKey:!0},function(e,n){var a=t.firstItem();t.focused(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.firstItem())}),a.register({type:"keydown",which:c.e.home},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),(t.hasVertical()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.up,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.up,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.down,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.down,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.up,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.up,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(t.aboveItem(n))}),a.register({type:"keydown",which:c.e.up,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.up,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.up,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.aboveItem(n))}),a.register({type:"keydown",which:c.e.up,altKey:!1,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.down,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.down,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.down,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.down,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),(t.hasHorizontal()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.left,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.left,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.right,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.right,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.left,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.left,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.left,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.left,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.left,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.left,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.right,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.right,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.right,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.right,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),a.register({type:"keydown",which:c.e.a,ctrlKey:!0},{type:"keydown",which:c.e.a,metaKey:!0},function(e,n){t.selectAll()}),a},e.modes={single:e._getSingleMatchers,multi:e._getMultiMatchers},e}();t.e=d},2852:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a,i=n(0),r=n(1113),o=n(60),s=n(47),c=n(810),d=n(67),l=n(94),u=n(1022),f=n(36);!function(e){e[e.DefaultClick=0]="DefaultClick",e[e.OpenInOfficeOnline=1]="OpenInOfficeOnline",e[e.OpenFileLocation=2]="OpenFileLocation",e[e.OpenItemActivityItem=3]="OpenItemActivityItem",e[e.OpenPdfInBrowser=4]="OpenPdfInBrowser"}(a||(a={}));var p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.item,i=t.openRelation,r=void 0===i?0:i,o=t.actionType;return n.name="OpenInDesktop",n._itemSelectionHelper=new(n.child(c.e))({overrideItem:2===r?a:void 0,allowMultiSelect:!1,canFallback:0!==r,ignoreSelection:0!==r}),n._urlDataSource=n.resources.consume(d.Se),n._actionType=o,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem(),i={id:n.id,name:n.name,actionType:a[this._actionType],queryType:f.e[n.queryType],itemType:l.e[n.type],openUrl:n.openUrl,parentUrl:n.parentLink,shortcutUrl:n.urls[u.e.shortcutTarget],siteUrl:this._urlDataSource.getCurrentSiteUrl(),fullItemUrl:this._urlDataSource.getItemUrl(n.key),extension:n.extension};return window.external.notify(JSON.stringify(i)),o.n.wrap({resultType:s.e.Success})},t}(r.e);t.t=p},2950:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-ButtonBar{display:block;height:30px}[dir=ltr] .od-ButtonBar .od-Button{margin-right:10px}[dir=rtl] .od-ButtonBar .od-Button{margin-left:10px}[dir=ltr] .od-ButtonBar .od-Button:last-child{margin-right:0}[dir=rtl] .od-ButtonBar .od-Button:last-child{margin-left:0}.od-ButtonBar-main{display:block;height:30px;white-space:nowrap}html[dir=ltr] .od-ButtonBar-main{float:right}html[dir=rtl] .od-ButtonBar-main{float:left}.od-ButtonBarCommand{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:inline-block;box-sizing:border-box;border:1px solid transparent;padding:4px 20px 6px 20px;height:30px}html[dir=rtl] .od-ButtonBarCommand{padding:4px 20px 6px 20px}.od-ButtonBarCommand-icon{display:inline-block}.od-ButtonBarCommand-icon .ms-Icon{vertical-align:top}.od-ButtonBarCommand--failed{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}"}]);var i=n(399),r=n(0),o=n(196),s="od-button-bar-command-button",c="od-button-bar-command-text",d=n(727),l=n(24),u=function(e){function t(t){var n=e.call(this,t)||this;return n._index=t.index,n.command=t.command,n.focused=l.observable(!1),n.selected=l.observable(!1),n.templateName=n.createPureComputed(n._computeTemplateName),n.isPrimary=n.createPureComputed(n._computeIsPrimary),n.state=n.createPureComputed(n._computeState),n}return Object(r.__extends)(t,e),t.prototype._computeTemplateName=function(){return!this.command.action||!this.unwrapObservable(this.command.isPermanent)&&this.command.isDisabled()?c:s},t.prototype._computeIsPrimary=function(){return 0===this._index()},t.prototype._computeState=function(){return d.e[this.command.state()||d.e.initialized]},t}(o.t);i.e({tagName:"od-button-bar-command",template:"\x3c!--ko template:templateName--\x3e\x3c!--/ko--\x3e",viewModel:u,synchronous:!0}),i.t(s,'<button class="od-Button od-ButtonBarCommand od-ButtonBarCommand--button" data-bind="attr:{title:command.tooltip},css:{\'is-disabled\':command.isDisabled,\'is-focused\':command.focused,\'od-Button--primary\':isPrimary},hasFocus:command.isActive,disable:command.isDisabled,click:command.onClick.bind(command)">\x3c!--ko if:command.icon--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon" data-bind="component:{name:\'od-icon-glyph\',params:{icon:command.icon,badge:command.iconBadge}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon:true,style:{backgroundImage:\'url(\\\'\'+command.iconUrl()+\'\\\')\'}"></i></span>\x3c!--/ko--\x3e\x3c!--ko if:command.isLabelVisible--\x3e<span class="od-Button-label od-ButtonBarCommand-label" data-bind="text:command.label"></span>\x3c!--/ko--\x3e</button>'),i.t(c,'<span class="od-ButtonBarCommand od-ButtonBarCommand--text" data-bind="class:\'od-ButtonBarCommand--\'+state()">\x3c!--ko if:command.icon--\x3e<span class="od-ButtonBarCommand-icon" data-bind="component:{name:\'od-icon-glyph\',params:{icon:command.icon,badge:command.iconBadge}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon:true,style:{backgroundImage:\'url(\\\'\'+command.iconUrl()+\'\\\')\'}"></i></span>\x3c!--/ko--\x3e\x3c!--ko if:command.isLabelVisible--\x3e<span class="od-ButtonBarCommand-label" data-bind="text:command.label"></span>\x3c!--/ko--\x3e</span>');var f=n(1108),p=n(1933),m=n(101),_=function(){function e(){}return e.init=function(t,n,a){var i=l.observable();l.computed(function(){i();var r,o=l.utils.unwrapObservable(n()),s=a();r=o.data?o.data:s.foreach&&s.foreach.data||s.foreach||s.template&&s.template.foreach;var c=o.responsiveUI.formFactorSize(),d=l.utils.unwrapObservable(r),u=l.utils.unwrapObservable(o.alwaysVisibleItems);e._calculateElementVisibility(t,o,d,u,c)},null,{disposeWhenNodeIsRemoved:t}).extend({throttle:1});var r=new m.t(t);l.utils.domNodeDisposal.addDisposeCallback(t,function(){r.dispose()}),r.on(t,"layoutChange",function(e){i.notifySubscribers()}),r.on(window,"resize",function(e){i.notifySubscribers()}),r.on(document,"transitionend",function(e){i.notifySubscribers()})},e._calculateElementVisibility=function(t,n,a,i,r){if(a&&a.length){var o=t.getBoundingClientRect(),s=o.right-o.left,c=0,d=[],u=[];if(i&&a)for(var f=0,p=i.length;f<p;f++){var m=i[f],_=l.utils.arrayIndexOf(a,m);if(_>-1&&_<t.children.length){var h=t.children[_];s-=e._measureElement(h).width}}for(f=0,p=t.children.length;f<p;f++){h=t.children[f];var b="Small"===r&&f>0,g=void 0;a&&(g=a[f]),c+=e._measureElement(h).width;var v=i&&g&&l.utils.arrayIndexOf(i,g)>-1,y=!v&&(c>s||b);if(g&&l.isObservable(g.isClipped)&&g.isClipped(y),!v){var S="none"!==h.style.display;y||S?y&&S&&(h.style.display="none"):h.style.display=""}y&&(d.push(h),g&&u.push(g))}n&&(l.isObservable(n.overflowElements)&&n.overflowElements(d),l.isObservable(n.overflowItems)&&n.overflowItems(u))}},e._measureElement=function(e){var t=e.style.display;e.style.display="";var n=e.getBoundingClientRect(),a=window.getComputedStyle(e),i=parseFloat(a.marginLeft),r=parseFloat(a.marginRight),o=parseFloat(a.marginTop),s=parseFloat(a.marginBottom);return e.style.display=t,{left:n.left-i,right:n.right+r,top:n.top-o,bottom:n.bottom+s,width:n.right-n.left+i+r,height:n.bottom-n.top+o+s}},e}(),h=n(1109),b=n(1302),g=n(530),v=function(e){function t(t,n){void 0===n&&(n={});var i=e.call(this,t,n)||this;return Object(a.t)(),i._allCommands=l.observableArray(),i.overflowCommands=l.observableArray(),i.focusedCommand=l.observable(),i.fixedCommands=[],i._overflowCommandsSubscription=null,i._commandSetCommandsReplicationSubscription=null,i.responsiveUI=i.resources.consume(g.t),i.addBindingHandlers({selection:p.e,overflow:_,keyboard:f.e,element:h.e}),i._mainCommandsFirstTimeRendered=l.observable(!1),i.keyboardOptions=[{mappings:{Down:i.onNavigateDown,Enter:i.onEnter}},{target:document,mappings:{},allowButtonEvents:!0}],i._initializeCommandsObservables(),i._initializeFocusLogic(!!t.focusOnFirstCommand||!1),i._commandSet=i.wrapObservable(t.commandSet),i._initializeCommandSet(i._commandSet.peek()),i.subscribe(i._commandSet,function(e){i._initializeCommandSet(e)}),i}return Object(r.__extends)(t,e),t.prototype.getButtonBarItemParams=function(e,t){var n=this;return{command:e,index:4&e.location?this.observables.pureCompute(function(){return t()+n.mainCommands().length}):t}},t.prototype.onNavigateDown=function(e,t){var n=this.focusedCommand();return n&&n.openMenu()&&t.preventDefault(),!1},t.prototype.onEnter=function(e,t){var n=this.focusedCommand();if(!n)return!0;var a=t.target.getElementsByTagName("input");return a&&a.length?(a[0].click(),t.stopPropagation(),void t.preventDefault()):n.onClick(n,t)},t.prototype.animateIn=function(e,t,n){n.hasAnimation&&1===e.nodeType&&(l.utils.toggleDomNodeCssClass(e,"is-animatingIn",!0),this.async.setTimeout(function(){l.utils.toggleDomNodeCssClass(e,"is-animatingIn",!1)},1e3))},t.prototype.animateOut=function(e,t,n){n.hasAnimation&&1===e.nodeType?(l.utils.toggleDomNodeCssClass(e,"is-animatingOut",!0),this.async.setTimeout(function(){l.removeNode(e)},1e3)):l.removeNode(e)},t.prototype._updateCommandKeyboardShortcuts=function(e,t){for(var n=0;n<t.length;n++){var a=t[n];if(a.keys)for(var i=a.onClick.bind(a),r=0;r<a.keys.length;r++){var o=a.keys[r];e[o]||(e[o]=[]),e[o].push(i)}var s=a.children();s.length&&this._updateCommandKeyboardShortcuts(e,s)}},t.prototype._initializeCommandSet=function(e){var t=this;this._overflowCommandsSubscription&&(this._overflowCommandsSubscription.dispose(),this._overflowCommandsSubscription=null),this._commandSetCommandsReplicationSubscription&&(this._commandSetCommandsReplicationSubscription.dispose(),this._commandSetCommandsReplicationSubscription=null),this._allCommands([]),this.fixedCommands=[],this.keyboardOptions[1].mappings={},e&&(this._commandSetCommandsReplicationSubscription=b.e(e.commands,this._allCommands),this.addDisposable(this._commandSetCommandsReplicationSubscription),e.overflowHostCommand&&(this.fixedCommands.push(e.overflowHostCommand),this._overflowCommandsSubscription=this.createBackgroundComputed(function(){var n=t.overflowCommands().concat(t._overflowOnlyCommands());e.overflowHostCommand.children(n)})),this._mainCommandsFirstTimeRendered.peek()||this._mainCommandsFirstTimeRendered(!0))},t.prototype._initializeCommandsObservables=function(){var e=this,t=this._allCommands,n=this._visibleCommands=this.addDisposable(t.filter(function(e){return e.isVisible()&&function(e){return 0!=(23&e.location)}(e)}));this.mainCommands=this.addDisposable(n.filter(y)),this._overflowOnlyCommands=this.addDisposable(t.filter(D)),this.sideCommands=this.addDisposable(n.filter(S)),this.selectableCommands=this.addDisposable(n.filter(function(t){return!(D(t)||e._isOverflowEnabled()&&e.overflowCommands.indexOf(t)>=0||t.isDisabled())})),this.subscribe(t,function(t){var n={};e._updateCommandKeyboardShortcuts(n,t),e.keyboardOptions[1].mappings=n})},t.prototype._initializeFocusLogic=function(e){var t=this,n=this.addDisposable(this._visibleCommands.filter(function(e){return e.isOpen()})),a=this.createComputed(function(){return n().length>0});this.createComputed(function(){a()||l.computedContext.isInitial()||document.activeElement&&document.activeElement!==document.body||!t.topTab.peek()||t.topTab.peek().focus()}).extend({rateLimit:0}),this.topTab=l.observable(null),this.subscribe(this._mainCommandsFirstTimeRendered,function(n){t.async.setImmediate(function(){n&&e&&t._focusOnFirstCommand()})})},t.prototype._isOverflowEnabled=function(){return!!this._commandSet.peek()&&!!this._commandSet.peek().overflowHostCommand},t.prototype._focusOnFirstCommand=function(){if(this._visibleCommands()&&this._visibleCommands().length>0){var e=this._visibleCommands()[0];e.focused(!0),this.focusedCommand(e)}},t}(o.t);function y(e){return 3==(3&e.location)}function S(e){return 4==(4&e.location)}function D(e){return 2==(3&e.location)}var I=i.e({tagName:"od-button-bar",template:'<span class="od-ButtonBar" data-bind="keyboard:keyboardOptions,element:topTab"><span class="od-ButtonBar-main" data-bind="foreach:mainCommands">\x3c!--ko component:{name:\'od-button-bar-command\',params:{command:$data,index:$index}}--\x3e\x3c!--/ko--\x3e</span><span class="od-ButtonBar-side" data-bind="foreach:sideCommands">\x3c!--ko component:{name:\'od-button-bar-command\',params:{command:$data,index:$index}}--\x3e\x3c!--/ko--\x3e</span></span>',viewModel:v,synchronous:!0});t.e=I},3706:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return b});var a=n(0),i=n(196),r=n(2950),o=n(441),s=n(26),c=n(29),d=n(1988),l=n(151),u=n(2852),f=n(36),p=n(94),m=function(e){function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(c.e),n._isOneDriveWinApp=Object(l.e)();var a=n.observables,i=t.forceExternal,r=t.item,d=t.hideOpenCommand;return n._isOneDriveWinApp&&r().queryType===f.e.SharedWithMe?n.commands.push(new(n.managed(o.e))({text:s.Open,action:new(n.managed(n._actionMap.OpenInDesktopAction))({item:t.item,openRelation:2,actionType:u.e.DefaultClick})})):n._isOneDriveWinApp&&r().type===p.e.Unknown?n.commands.push(new(n.managed(o.e))({text:s.Open,action:new(n.managed(n._actionMap.DownloadAction))({item:t.item})})):!n._isOneDriveWinApp||r().type!==p.e.OneNote&&r().type!==p.e.File?i||n.commands.push(new(n.managed(o.e))({text:s.Open,action:new(n.managed(n._actionMap.DefaultClickAction))({sourceEngagement:"OneUpOther.Open.Click",userInvokedItem:!0,item:t.item,hideIfDefaultIsDownload:!0}),isHidden:a.pureCompute(function(){return a.unwrap(d)})})):n.commands.push(new(n.managed(o.e))({text:s.Open,action:new(n.managed(n._actionMap.OpenInOfficeOnlineAction))({item:t.item,openLocal:!1,useDefaultAction:!0})})),n.commands.push(new(n.managed(o.e))({text:s.Download,action:new(n.managed(n._actionMap.DownloadAction))({item:t.item})})),n}return Object(a.__extends)(t,e),t}(d.e),_=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.component={name:r.e.tagName,params:{commandSet:new(a.child(m))({forceExternal:t.forceExternal,item:t.item,hideOpenCommand:t.hideOpenCommand})}},a}return Object(a.__extends)(t,e),t}(i.t),h=n(179),b=Object(h.t)({automationName:"od-item-action-bar",name:"ItemActionBar",template:"\x3c!--ko component:component--\x3e\x3c!--/ko--\x3e",viewModelType:_});t.default=b}}]);