(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[261,232,260],{1803:function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return!1!==t.valueAccessor()&&n.element.setAttribute("data-is-scrollable","true"),n}return Object(a.__extends)(t,e),t}(n(178).t);function r(e){for(var t=e;t&&t!==document.body;){if(t.getAttribute&&"true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}return t&&t!==document.body||(t=window),t}t.e=i},1805:function(e,t,n){"use strict";n.r(t),n.d(t,"encodeItemSetParentKeyKey",function(){return M}),n.d(t,"resourceKey",function(){return T});var a=n(0),i=(n(813),n(58)),r=n(1118),o=n(473),s=n(1110),c=n(60),d=n(29),l=n(67),u=n(1133),f=n(138),p=n(815),m=n(471),_=n(1892),h=n(1893),b=n(1869),g=n(1434),v=n(7),y=n(119),S=n(1832),D=n(213),I=n(1867),x=n(24),C="__next__",O=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==C&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===C;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&b.e(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:C,startIndex:p,count:1,isPlaceholder:!0,state:x.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),w=n(1815),E=n(4),A=n(255),L=n(8),k=100,M=new v.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new v.e(Object(E.po)(E.Wr))}),P=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(a.__extends)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new o.e(n),s=e.queryType,c=void 0===s?r.queryType:s;r.queryType=c,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var d=a.peek(),l=d&&d.folder,u=l&&l.childCount||0;(i=new h.e(t,e,u)).item=a;var f=e.needSchema;if(void 0===f||f){var p=this._schemaDataSource,m=p&&p.getColumns(d);m&&m.length>0&&i.schema(m)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,r=void 0!==i&&i,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(a.__assign)(Object(a.__assign)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return c.n.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):c.n.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new S.e(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),c.n.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return this.invalidateItem(e.parentKey),this.resources.consume(A.e)?[4,this.resources.consumeAsync(l.k)]:[3,2];case 1:t.sent().invalidateItems(e.parentKey),t.label=2;case 2:return[2,n]}})})})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:m.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(f.e.started),n.progress.maximum(1),a.then(function(e){return n.state(f.e.completed),n.progress.current(1),e},function(e){return n.state(f.e.failed),n.error(new _.e({message:e})),c.n.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new p.e,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:m.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(f.e.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(f.e.completed)}var s=e.items[0].UNSAFE_parent;return s&&t.invalidateItem(s.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new _.e({message:e})),i.state(f.e.failed)}return c.n.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new S.e(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new h.e(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,i=this,r=g.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,d=void 0!==s&&s,u=this.getItemSetKey(e),f=e.itemSetProjections?this.getItemSetKey(e,!0):u,p=this._getItemSet(u,e),m=p&&p.content.peek().items,_=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,v=!d&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||b.e(m,{start:0,end:m.length})),y=e.startIndex,S=void 0===y?0:y,I=e.pageSize,x=void 0===I?k:I,C=e.endIndex||S+x;C=m&&m.length>0&&!_?Math.min(m.length,C):C,S=Math.max(0,Math.min(C,S));var E=L.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||p&&!p.isExpired?o.getNextRequestToken(f):void 0;e.requestToken="end"===E?"":E;var A=new O(e,o,_,t.TOKEN_BASED_API_EXTRA_ITEMS);A.initialize(p,S);var M=!1,P=p&&p.content.peek();if(!P||1!==P.partialResultStatus&&2!==P.partialResultStatus||(M=!0,1===P.partialResultStatus&&p.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})),v&&!M&&A.isResultSetValid(m,{start:S,end:C}))return c.n.wrap(p);if(n&&n.peek().isStub){var T=e.startKey;if(T&&o.getItem(T)){p.content.peek().items=[o.getItem(T)],p.isPlaceholder=!0,p.isExpired=!1;var U=this._schemaDataSource,F=U&&U.getColumns(n.peek());F&&F.length>0&&p.schema(F),p.content.valueHasMutated&&p.content.valueHasMutated()}return c.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0),this._normalizeContext(e,m,S,C,!v);var R=this._getRequestKey(e),N=this._pendingGetItemRequests[R];return N?e.itemSetProjections?N.getPromise().then(function(t){return i.computeProjectedItemSet(u,t,e)}):N.getPromise():(_&&!E&&(e.startIndex=0),this._pendingGetItemRequests[R]=N=new D.e,this.resources.consumeAsync(l.v.bypass).then(function(t){return t.getItem(Object(a.__assign)(Object(a.__assign)({},e),{itemSetKey:u}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),u=i.getItemSetKey(r));var a=e.itemSetProjections?i.getItemSetKey(e,!0):u;n=o.getItem(e.parentKey);var s=o.getItemSet(a);v=!(!n||!s);var c=A.computeNewChildren(t,e,s,a,!!v),d=c.allChildren,l=c.hasNextRequestToken;if(l&&(_=l),t.item&&!e.ignoreChildren&&!e.skipStoreResults){v||((s=new h.e(a,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=_,o.setItemSet(a,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;s.schema(m&&m.length>0&&m||[]),t.customViewRenderer?s.customViewRenderer=i.observables.create(t.customViewRenderer):s.customViewRenderer=i.observables.create(void 0)}var y=t.groupings;_&&e.mergeGroupings&&(y=A.computeNewGroupings(s.content.peek().groupings,t.groupings,d,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var S=s.content.peek(),D=S.partialResultStatus,I=S.partialResultRequestCount,x=void 0===I?0:I;if(!(y&&y.length&&y[0]))if(l&&(t.children&&t.children.length<30||!t.children)){var C=x+1;C<=5?x=C:D=1}else void 0===D||0===D||l?2===D&&t.children&&30===t.children.length&&(D=0):D=3;s.content({items:d,groupings:y,partialResultRequestCount:x,partialResultStatus:D});var O=s.version,w=void 0===O?0:O;s.version=w+1}if(delete i._pendingGetItemRequests[R],e.requestAllChildren&&!b.e(d,{start:0,end:t.totalChildren})){var E=g.e(e),L=E.startIndex,M=void 0===L?0:L;return E.startIndex=M+k,i._getItem(E)}return t.isFromBrowserCache?(r.skipCache=!0,i._getItem(r)):(e.itemSetProjections&&(s=i.computeProjectedItemSet(u,s,e)),s)},function(e){return delete i._pendingGetItemRequests[R],c.n.wrapError(e)}).then(function(e){N.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(w.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):N.error(t)}),N.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||k;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=k);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=k},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new p.e,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),s=n.call(this,e),c=0,d=o;c<d.length;c++)d[c].state(f.e.started);return s.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(l.k).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var s=i[n];s.progress.current(1),s.state(f.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(f.e.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return c.n.resolve(this.resources.consumeAsync(l.T))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{groupThrottle:d.h.optional,schemaDataSource:l.re.optional,itemsStore:s.e,operationProvider:r.resourceKey,smartFiltersStore:u.e.optional,updateQuota:I.e,encodeItemSetParentKey:M.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(i.n),T=(t.default=P,Object(y.r)("ItemProvider",P))},1812:function(e,t,n){"use strict";var a=n(0),i=n(178),r=n(1895),o=n(24),s=function(e){function t(t){var n=e.call(this,t)||this;new(n.managed(r.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}});var a=n._componentParentContent,i=n.valueAccessor(),s=function(e){return"object"==typeof e}(i)?i:{},c=s.data,d=void 0===c?n.bindingContext.$data:c,l=s.afterRender;return o.applyBindingsToNode(n.element,{template:{nodes:a.templateNodes,afterRender:l}},a.bindingContext.extend({$host:d,$hostContext:n.bindingContext})),n.controlsDescendantBindings=!0,n}return Object(a.__extends)(t,e),t.prototype._onReceiveComponentParentContext=function(e){this._componentParentContent=e},t.supportsVirtualElements=!0,t}(i.t);t.e=s},1815:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return h}),n.d(t,"i",function(){return _}),n.d(t,"t",function(){return b});var a={};n.r(a),n.d(a,"fileNotFound",function(){return o}),n.d(a,"invalidView",function(){return s}),n.d(a,"listNotFound",function(){return c}),n.d(a,"docAlreadyExists",function(){return d}),n.d(a,"queryThrottled",function(){return l}),n.d(a,"newExperieceRenderingNotSupported",function(){return u}),n.d(a,"onePageNavigationViewMismatch",function(){return f}),n.d(a,"onePageNavigationError",function(){return p}),n.d(a,"offline",function(){return m});var i,r,o=-2147024894,s=-2147024809,c=-1,d=-2130575257,l=-2147024860,u=-2,f=-3,p=-4,m=-5;!function(e){e[e.icon=16]="icon",e[e.iconMin=16]="iconMin",e[e.bigIcon=48]="bigIcon",e[e.bigIconMin=48]="bigIconMin",e[e.regularMin=90]="regularMin",e[e.regular=130]="regular",e[e.nameMin=220]="nameMin",e[e.nameODC=440]="nameODC",e[e.nameODB=280]="nameODB",e[e.originalLocation=300]="originalLocation",e[e.custom=900]="custom",e[e.sharedWith=150]="sharedWith",e[e.note=250]="note",e[e.dateModifiedMl=150]="dateModifiedMl",e[e.dotDotDot=32]="dotDotDot",e[e.ratingsMin=110]="ratingsMin"}(i||(i={})),function(e){e[e.none=0]="none",e[e.icon=1]="icon",e[e.name=2]="name",e[e.title=3]="title",e[e.calloutInvoker=4]="calloutInvoker",e[e.shareHeroCommand=5]="shareHeroCommand",e[e.modified=6]="modified",e[e.url=7]="url"}(r||(r={}));var _,h={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};!function(e){e[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed"}(_||(_={}));var b=a},1822:function(e,t,n){"use strict";var a=n(0),i=n(24),r=n(178),o=n(1124),s=n(1127),c=n(1803),d=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a._focusTracker=a.resources.consume(s.e),a._hasFocus=a.createObservable(!1),a._hasChildFocus=a.createObservable(!1),a._isBodyActive=a.createObservable(!1),a._value=a.createPureComputed(a._computeValue),a._isEnabled=a.createPureComputed(a._computeIsEnabled),a._onlyRecoverFromBody=a.createPureComputed(a._computeOnlyRecoverFromBody),a._shouldRecoverFocus=a.createPureComputed(a._computeShouldRecoverFocus);var r=n.ChildFocusBinding,d=void 0===r?o.e:r,l=n.applyBindingsToNode,u=void 0===l?i.applyBindingsToNode:l,f=n.recoverFocusExtenders,p=void 0===f?{rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}:f;return new(a.managed(d))({element:a.element,bindingContext:a.bindingContext,allBindingsAccessor:a.allBindingsAccessor,valueAccessor:function(){return{isDescendantOrSelfActive:a._hasChildFocus,isBodyActive:a._isBodyActive}}}),u(a.element,{hasFocus:a._hasFocus},a.bindingContext),a._scrollContainer=Object(c.t)(a.element),a.createBackgroundComputed(a._computeRecoverFocus).extend(p),a}return Object(a.__extends)(t,e),t.prototype._computeValue=function(){return this.valueAccessor()||{}},t.prototype._computeIsEnabled=function(){var e=this._value().isEnabled,t=void 0===e||e;return this.unwrapObservable(t)},t.prototype._computeOnlyRecoverFromBody=function(){var e=this._value().onlyRecoverFromBody,t=void 0!==e&&e;return this.unwrapObservable(t)},t.prototype._computeShouldRecoverFocus=function(){return this._isEnabled()&&!this._hasChildFocus()&&(!this._onlyRecoverFromBody()||this._isBodyActive())&&this._focusTracker.isWindowActive.peek()},t.prototype._computeRecoverFocus=function(){this._shouldRecoverFocus()&&this._recoverFocus()},t.prototype._recoverFocus=function(){var e=this._scrollContainer,t=e.scrollTop,n=e.scrollLeft;this._hasFocus(!0),e.scrollTop!==t&&(e.scrollTop=t),e.scrollLeft!==n&&(e.scrollLeft=n)},t}(r.t);t.e=d},1825:function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-Overlay{height:0;width:0;overflow:hidden}"}]);var i=n(1879),r=n(399),o=n(0),s=n(196),c=n(1976),d=n(1109),l=n(1812),u=n(58),f=n(24),p=function(e){function t(t){var n=e.call(this,{})||this,a=t.topTab,i=t.bottomTab,r=t.animation,o=void 0===r?{}:r,s=t.alignToParent,c=void 0===s?f.observable(!0):s,d=t.parentElement,l=t.isOpen;return n.topTab=a,n.bottomTab=i,n.animation=o,n.alignToParent=c,n.parentElement=d,n.isOpen=l,n}return Object(o.__extends)(t,e),t}(u.n),m=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.transclusionContentTagName=i.e.tagName;var r=n.overlayProvider,o=void 0===r?a.resources.consume(c.e):r,s=t.animation,u=t.alignToParent,f=void 0!==u&&u,m=t.parentElement,_=t.virtualParentElement;return a.addBindingHandlers({host:l.e,element:d.e}),a.overlayProvider=o,a.topTab=a.createObservable(null),a.bottomTab=a.createObservable(null),a.isOpen=a.createObservable(!1),a.virtualParentElement=_,a.overlay=new p({alignToParent:a.wrapObservable(f),parentElement:m,animation:s,topTab:a.topTab,bottomTab:a.bottomTab,isOpen:a.isOpen}),a}return Object(o.__extends)(t,e),t}(s.t),_=r.e({tagName:"od-overlay",template:'<a href="javascript:;" class="ms-accessible" aria-hidden="true" role="presentation" data-bind="element:topTab"></a><div class="od-Overlay ms-accessible" role="presentation" data-bind="component:{name:transclusionContentTagName,params:{provider:overlayProvider,parentElement:virtualParentElement||$element.parentElement,options:overlay}}">\x3c!--ko host:{}--\x3e\x3c!--/ko--\x3e</div><a href="javascript:;" class="ms-accessible" aria-hidden="true" role="presentation" data-bind="element:bottomTab"></a>',viewModel:m,synchronous:!0});t.e=_},1828:function(e,t,n){"use strict";var a=n(0),i=n(24),r=n(1887),o=n(178);function s(e){var t=document.createElement("div");return t.tabIndex=0,t.className="ms-accessible",t.setAttribute("role","presentation"),t.setAttribute("aria-hidden","true"),t.setAttribute("data-focus-trap",e),t}var c=r.t,d=r.n,l=i.virtualElements,u=i.applyBindingsToNode,f=i.applyBindingsToDescendants,p=function(e){function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var a=n,i=a.events,r=a.observables,o=a.bindingContext,c=a.element,d=t.valueAccessor()||{},p=d,m=p.isEnabled,_=p.invert,h=n._beforeHook=s("begin"),b=n._afterHook=s("end");n._invert=_,m&&(u(h,{visible:m},o),u(b,{visible:m},o));var g=l.childNodes(c);l.prepend(c,h),l.insertAfter(c,b,g[g.length-1]),f(o,c);var v=d,y=v.before,S=void 0===y?r.create(b):y,D=v.after,I=void 0===D?r.create(h):D;return n._before=r.wrap(S),n._after=r.wrap(I),i.on(h,"focus",n._onFocusBeforeHook),i.on(b,"focus",n._onFocusAfterHook),!_&&d.after&&n._initializeBeforeAndAfter(),n}return Object(a.__extends)(t,e),t.prototype._onFocusBeforeHook=function(){this._invert?c(this._afterHook):d(this._before.peek())},t.prototype._onFocusAfterHook=function(){this._invert?d(this._beforeHook):c(this._after.peek())},t.prototype._onFocusBefore=function(){c(this._beforeHook)},t.prototype._onFocusAfter=function(){d(this._afterHook)},t.prototype._initializeBeforeAndAfter=function(){var e,t,n=this,a=this.events;this.observables.backgroundCompute(function(){var i=n._before(),r=n._after();i!==e&&(e&&a.off(e),i&&a.on(i,"focus",n._onFocusBefore),e=i),r!==t&&(t&&a.off(t),r&&a.on(r,"focus",n._onFocusAfter),t=r)})},t.supportsVirtualElements=!0,t}(o.t);t.e=p},1832:function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},1841:function(e,t,n){"use strict";var a=n(0),i=n(1887),r=n(178),o=n(171),s=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i=n.wrapObservable(void 0===a||a);n._shouldRestoreFocus=i;var r=null;try{r=document.activeElement}catch(e){}for(n._activeElement=r,n._preserveActiveElementAncestors=[];r&&r!==document.body;)n._preserveActiveElementAncestors.push(r),r=Object(o.e)(r);return n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){if(this._shouldRestoreFocus.peek()){var t=null;try{t=document.activeElement}catch(e){}if(!t||t===document.body||this._isAncestorOrSelf(t,this.element))for(var n=0,a=this._preserveActiveElementAncestors;n<a.length;n++){var r=a[n];if(r&&r.focus&&(Object(i.a)(r,!0)||r===this._activeElement)&&document.body.contains(r)){r.focus();break}}}this._preserveActiveElementAncestors=[],delete this._activeElement,e.prototype.dispose.call(this)},t.prototype._isAncestorOrSelf=function(e,t){for(;e;){if(e===t)return!0;e=Object(o.e)(e)}return!1},t}(r.t);t.e=s},1864:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(58),i=n(7),r=n(1147),o=new i.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:r.e,observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},1867:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(58),i=new(n(7).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},1869:function(e,t,n){"use strict";function a(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}n.d(t,"e",function(){return a})},1871:function(e,t,n){"use strict";n.d(t,"t",function(){return m});var a='\x3c!--ko if:areCSS3TransitionsSupported--\x3e<div class="ProgressSpinnerFlat" role="progressbar"><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div></div>\x3c!--/ko--\x3e\x3c!--ko if:!areCSS3TransitionsSupported--\x3e<img data-bind="attr:{src:loadingUrl,alt:loadingString}">\x3c!--/ko--\x3e',i=n(17);Object(i.n)([{rawString:".ProgressSpinnerFlat{position:relative;box-sizing:border-box;padding:2px 0;overflow:hidden;height:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:15px}.ProgressSpinnerFlat>div{position:relative;line-height:0;cursor:default;animation:progress 3.4s infinite cubic-bezier(0,.75,1,.25)}[dir=ltr] .ProgressSpinnerFlat>div{left:-50px}[dir=rtl] .ProgressSpinnerFlat>div{right:-50px}[dir=rtl] .ProgressSpinnerFlat>div{animation:progressRtl 3.4s infinite cubic-bezier(0,.75,1,.25)}.ProgressSpinnerFlat>div:first-child{animation-delay:.1s}[dir=ltr] .ProgressSpinnerFlat>div:first-child{margin-left:40px}[dir=rtl] .ProgressSpinnerFlat>div:first-child{margin-right:40px}.ProgressSpinnerFlat>div:nth-child(2){animation-delay:.2s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(2){margin-left:30px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(2){margin-right:30px}.ProgressSpinnerFlat>div:nth-child(3){animation-delay:.3s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(3){margin-left:20px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(3){margin-right:20px}.ProgressSpinnerFlat>div:nth-child(4){animation-delay:.4s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(4){margin-left:10px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(4){margin-right:10px}.ProgressSpinnerFlat>div:nth-child(5){animation-delay:.5s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(5){margin-left:0}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(5){margin-right:0}@keyframes progress{from{left:-50px}25%{left:-50px}to{left:100%}}@keyframes progressRtl{from{right:-50px}25%{right:-50px}to{right:100%}}"}]);var r=n(0),o=n(196),s=n(67),c=n(1984),d=n(215),l=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.platformDetection,r=void 0===i?a.resources.consume(d.e):i;return a.areCSS3TransitionsSupported=r.areCSS3TransitionsSupported,a.loadingUrl=window.require.toUrl("odsp-media/images/loading/loadingdots.gif"),a.loadingString=c.e,a}return Object(r.__extends)(t,e),t.resources=Object(r.__assign)(Object(r.__assign)({},o.t.dependencies),{platformDetection:d.e,settingsDataSource:s.ce}),t}(o.t),u=n(399),f=n(179),p=Object(u.e)({tagName:"ms-progressSpinnerFlat",template:a,viewModel:l,synchronous:!0}),m=Object(f.t)({automationName:"ms-progressSpinnerFlat",name:"ProgressSpinnerFlat",template:a,viewModelType:l});t.e=p},1879:function(e,t,n){"use strict";var a=n(399),i=n(0),r=n(196),o=n(178),s=n(24),c=function(e){this.templateNodes=e.templateNodes,this.bindingContext=e.bindingContext,this.renderCount=e.renderCount||s.observable(0),this.parentElement=e.parentElement||null,this.options=e.options||null},d=n(1895),l=function(e){function t(t){var n=e.call(this,t)||this;return new(n.managed(d.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}}),n.controlsDescendantBindings=!0,n}return Object(i.__extends)(t,e),t.prototype._onReceiveComponentParentContext=function(e){var t=this.valueAccessor(),n=new c({parentElement:t.parentElement,templateNodes:e.templateNodes,bindingContext:e.bindingContext,renderCount:t.renderCount,options:t.options});t.context(n)},t.supportsVirtualElements=!0,t}(o.t),u=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({transclusionContent:l}),n._provider=t.provider,n.bindingParams={context:s.observable(),parentElement:t.parentElement,renderCount:t.renderCount,options:t.options},n.createComputed(function(){var e=n.bindingParams.context();n._transclusion&&(n._transclusion.dispose(),n._transclusion=null),e&&(n._transclusion=n.addDisposable(n._provider.transclude(e)))}),n}return Object(i.__extends)(t,e),t}(r.t),f=a.e({tagName:"od-transclusion-content",template:"\x3c!--ko transclusionContent:bindingParams--\x3e\x3c!--/ko--\x3e",viewModel:u,synchronous:!0});t.e=f},1884:function(e,t,n){"use strict";var a=n(0),i=n(178),r=n(24),o=function(e){function t(t){var n=e.call(this,t)||this;return n.controlsDescendantBindings=!0,n.createComputed(n._computeRefreshChildElements),n}return Object(a.__extends)(t,e),t.prototype._computeRefreshChildElements=function(){var e=r.unwrap(this.valueAccessor());r.virtualElements.emptyNode(this.element),this.element.innerHTML=e,r.applyBindingsToDescendants(this.bindingContext,this.element)},t}(i.t);t.e=o},1887:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"a",function(){return l});var a=n(171);function i(e,t){u(e,s,t)}function r(e,t){u(e,c,t)}function o(e,t){u(e,d,t)}function s(e,t){return e&&_(e,t)}function c(e,t){return e&&(m(e.firstElementChild,f,_)||b(e,f,_))}function d(e,t){return e&&b(e,p,h)}function l(e,t){return!(!e||!v(e,t))}function u(e,t,n){var a=t(e,n);a&&a.focus()}function f(e){return e.nextElementSibling}function p(e){return e.previousElementSibling}function m(e,t,n,a){for(;e;e=t(e)){var i=n(e);if(i)return i}}function _(e,t){return v(e,t)||m(e.firstElementChild,f,_)}function h(e,t){return m(e.lastElementChild,p,h)||v(e,t)}function b(e,t,n,i){for(;e;e=Object(a.e)(e)){var r=m(t(e),t,n);if(r)return r}}var g={a:1,input:1,area:1,button:1,select:1,textarea:1,object:1,iframe:1};function v(e,t){var n=e.tagName.toLowerCase();if((n in g||void 0!==e.attributes.tabindex)&&(-1!==e.tabIndex||t)&&"true"!==e.getAttribute("aria-hidden")&&"none"!==e.style.display.toLowerCase()&&"hidden"!==e.style.visibility.toLowerCase()&&!(0===e.offsetWidth&&0===e.offsetHeight||e.disabled||"input"===n&&"hidden"===e.type.toLowerCase()))return e}},1892:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(a.__extends)(t,e),t}(n(90).e);t.e=i},1893:function(e,t,n){"use strict";var a=n(1915),i=n(24),r=n(252);t.e=function(e,t,n){this.key=e||"",this.content=i.observable(new a.e(n)),this.content.equalityComparer=r.n,this.schema=i.observableArray([]),this.schema.equalityComparer=r.e,this.context=i.utils.extend({},t),this.contentTypes=i.observableArray([]),this.isPlaceholder=!0,this.version=0}},1895:function(e,t,n){"use strict";var a=n(0),i=n(178),r=n(24),o=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i=n._getComponentBindingContext(),o=i.$parentContext;return function(e){return"function"==typeof e}(a)?a({bindingContext:o,templateNodes:n.bindingContext.$componentTemplateNodes}):(r.applyBindingsToDescendants(n.bindingContext.extend({$componentParentContext:i}),n.element),n.controlsDescendantBindings=!0),n}return Object(a.__extends)(t,e),t.prototype._getComponentBindingContext=function(){for(var e=this.bindingContext.$component,t=this.bindingContext;t.$data!==e&&t.$parentContext;)t=t.$parentContext;return t},t.supportsVirtualElements=!0,t}(i.t);t.e=o},1915:function(e,t,n){"use strict";t.e=function(e){this.items=new Array(e||0),this.groupings=null,this.partialResultRequestCount=0,this.partialResultStatus=0}},1929:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(58),r=n(119),o=n(821),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a.contexts=a.observables.createArray(),a._additions=[],a._removals=[],a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.transclude=function(e){var t=this;return this._needsOverlayContent.needsOverlayContent.set(!0),this._transclude(e),{dispose:function(){t._dispose(e)}}},t.prototype._transclude=function(e){this._additions.push(e),this._updateContextsTimeoutId||this._updateContexts()},t.prototype._dispose=function(e){this._removals.push(e),this._updateContextsTimeoutId||this._updateContexts()},t.prototype._updateContexts=function(){this._updateContextsTimeoutId=this.async.requestAnimationFrame(this._onUpdateContextsTimeout);var e=this.contexts.peek(),t=this._additions.splice(0),n=this._removals.splice(0);this.contexts.valueWillMutate(),e.push.apply(e,t);for(var a=0,i=n;a<i.length;a++){var r=i[a],o=e.indexOf(r);o>-1&&e.splice(o,1)}this.contexts.valueHasMutated()},t.prototype._onUpdateContextsTimeout=function(){this.contexts.valueHasMutated(),this._updateContextsTimeoutId=void 0,(this._additions.length||this._removals.length)&&this._updateContexts()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{needsOverlayContent:o.e}),t}(i.n),c=new r.n(s,i.n.dependencies)},1976:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(1929),r=new a.t({name:"OverlayProvider.key",factory:i.e})},2147:function(e,t,n){"use strict";n.d(t,"t",function(){return C});var a='<div class="od-Error"><div class="od-Error-image"><img data-bind="attr:{src:imageUrl,alt:errorTitle,class:errorClassName}"></div><div class="od-Error-title" data-bind="text:errorTitle"></div>\x3c!--ko if:errorDetailedText--\x3e<div class="od-Error-subText" data-bind="text:errorDetailedText,css:{\'od-Error-subtext--accessremoved\':isAccessRemoved}"></div>\x3c!--/ko--\x3e\x3c!--ko if:errorHtml--\x3e<div class="od-Error-subText" data-bind="html:errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if:showAction--\x3e<form class="od-Error-button" data-bind="attr:{action:actionUrl}" method="get"><button class="od-Button" data-bind="click:onButtonClick" type="submit"><span class="od-Button-label" data-bind="text:actionText"></span></button></form>\x3c!--/ko--\x3e<div class="od-Error-code" data-bind="visible:correlationIdText,text:correlationIdText"></div><div class="od-Error-code" data-bind="visible:showErrorCode,text:errorCodeText"></div></div>',i=n(17);Object(i.n)([{rawString:".od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}]);var r=n(0),o=n(196),s=n(1947),c=n(61),d=n(96),l=n(39),u=n(1864),f=n(78),p=n(119),m=n(67),_=function(){function e(e,t){this._errorDataSource=t.errorDataSource,this._defaultErrorAction={text:s.n,url:t.urlDataSource.getRootUrl()}}return e.prototype.getAction=function(e){return this._errorDataSource?this._errorDataSource.getAction(e):this._defaultErrorAction},e}(),h=Object(p.r)("ErrorProvider",_,{errorDataSource:m.f.optional,urlDataSource:m.Se}),b=n(29),g=n(478),v=n(10),y=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.error;a._navigation=a.resources.consume(f.e),a._actionMap=a.resources.consume(b.e.optional);var r,o,p,m,_,g,y=a.resources.consume(h);a.errorClassName="od-Error-imageTag",S(i)?(r=i.errorTitle,o=i.errorCode,p=i.errorDetailedText,m=i.errorDetailedHtml,_=i.correlationId,g=y.getAction(i)):i.message&&(p=i.message),r||(r=s.i),a.errorTitle=r,a.errorDetailedText=p,a.errorHtml=m,a.errorCode=o;var D=Object(v.isFeatureEnabled)(v.EmbedAccessOnEmbedAspx)&&Object(v.isFeatureEnabled)(v.EmbedLinkSupportOnEmbedAspx)&&"403"===o;return D||p||m||(p=s.a),D&&d.e.logData({name:"Error.RequesAccess.Loaded"}),a.errorDetailedText=p,a.showAction=!!g&&!g.hideButton&&!t.hideAction,g&&(a.actionText=g.text,a.actionUrl=g.url),a.showErrorCode=o&&a.errorTitle===s.i,a.showErrorCode?(c.e.log(i,"ServerError","".concat(o)),a.errorCodeText=l.format(s.I,o)):a.errorCodeText="",a.correlationIdText=_?l.format(s.x,_):"","accessremoved"===o?(a.isAccessRemoved=!0,a.imageUrl=window.require.toUrl("odsp-media/images/error/error2.svg")):(a.isAccessRemoved=!1,a.imageUrl=a._getRandomImage()),S(i)&&i.actionUrl&&161===i.errorCode&&(a.resources.consume(u.resourceKey)(!1),a.actionText=s.g,a.errorDetailedText=s.v,a.errorCodeText="",a.errorTitle=s.y,a.imageUrl=window.require.toUrl("odsp-media/images/error/vault/vaultclosed.svg"),a.errorClassName="od-Error-vaultImage",d.e.logData({name:"Vault.Bookmarked.Loaded"})),a}return Object(r.__extends)(t,e),t.prototype.onButtonClick=function(){return this.showAction&&(161===this.errorCode&&this._actionMap?(d.e.logData({name:"Vault.Bookmarked.Unlock"}),new(this.managed(this._actionMap.VaultAction))({actionType:g.e.Unlock}).execute(null)):Object(v.isFeatureEnabled)(v.EmbedAccessOnEmbedAspx)&&Object(v.isFeatureEnabled)(v.EmbedLinkSupportOnEmbedAspx)&&self!==top&&this.actionUrl?(d.e.logData({name:"Error.RequesAccess.Click"}),this._popupCenter(this.actionUrl,"",860,500)):this._navigation.navigateTo(this.actionUrl)),!1},t.prototype._getRandomImage=function(){var e=Math.ceil(3*Math.random());return window.require.toUrl("odsp-media/images/error/error".concat(e,".svg"))},t.prototype._popupCenter=function(e,t,n,a){var i=void 0!==window.screenLeft?window.screenLeft:screen.left,r=void 0!==window.screenTop?window.screenTop:screen.top,o=(window.outerWidth?window.outerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-n/2+i,s=(window.outerHeight?window.outerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-a/2+r,c=window.open(e,t,"scrollbars=yes, width="+n+", height="+a+", top="+s+", left="+o);return window.focus&&c&&c.focus(),c},t}(o.t);function S(e){return!(!e||!e.errorTitle&&void 0===e.errorCode)}var D=n(399),I=n(179),x=D.e({tagName:"ms-error",template:a,viewModel:y,synchronous:!0}),C=Object(I.t)({name:"Error",automationName:"ms-error",template:a,viewModelType:y});t.e=x},2226:function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(7),i=n(119),r=new a.t({name:"OneUp.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(328)]).then(n.bind(null,2553)).then(function(e){return e.resourceKey.local})})});t.e=r},2625:function(e,t,n){"use strict";n.r(t);var a=n(17);Object(a.n)([{rawString:".od-unauthenticatedBanner{position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-unauthenticatedBanner-OneDrive{position:absolute;top:0;bottom:0;border:none;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";line-height:48px;display:inline-block;font-weight:300;font-size:14px;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:22px;-webkit-font-smoothing:antialiased;cursor:pointer}html[dir=ltr] .od-unauthenticatedBanner-OneDrive{left:10px}html[dir=rtl] .od-unauthenticatedBanner-OneDrive{right:10px}.od-unauthenticatedBanner-AccountBox{position:absolute;top:0;bottom:0}html[dir=ltr] .od-unauthenticatedBanner-AccountBox{right:0}html[dir=rtl] .od-unauthenticatedBanner-AccountBox{left:0}html[dir=ltr] .od-unauthenticatedBanner-AccountBox{padding-right:8px}html[dir=rtl] .od-unauthenticatedBanner-AccountBox{padding-left:8px}.od-unauthenticatedBanner-button{display:inline-block;padding:6px;font-weight:600;font-size:14px;border:none;margin:8px;padding-left:16px;padding-right:16px;cursor:pointer}.od-unauthenticatedBanner-SignIn{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";padding-bottom:6px;padding-top:6px}.od-unauthenticatedBanner-SignIn:hover{background-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-unauthenticatedBanner-SignUp{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding-bottom:7px;padding-top:7px;display:none}.od-unauthenticatedBanner-SignUp:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.lg .od-unauthenticatedBanner-SignUp,.md .od-unauthenticatedBanner-SignUp,.xlg .od-unauthenticatedBanner-SignUp,.xxlg .od-unauthenticatedBanner-SignUp,.xxxlg .od-unauthenticatedBanner-SignUp,.xxxxlg .od-unauthenticatedBanner-SignUp{display:inline}"}]);var i=n(399),r=n(0),o=n(196),s=n(78),c=n(29),d=n(2871),l=n(104),u=n(64);Object(a.n)([{rawString:".od-SignInDialog-modal{top:0;bottom:0;right:0;left:0;position:absolute;display:flex}.sm .od-SignInDialog-modal{display:none}.od-SignInDialog-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8)}.od-SignInDialogMSAVar{width:410px;height:315px;position:relative;align-self:center;margin:auto;outline:0;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SignInDialogMSAVar-header{height:65px;padding-top:22px;box-sizing:border-box}html[dir=ltr] .od-SignInDialogMSAVar-header{padding-left:32px}html[dir=rtl] .od-SignInDialogMSAVar-header{padding-right:32px}.od-SignInDialogMSAVar-header img{height:41px;display:inline-block;margin:0}.od-SignInDialogMSAVar-content{padding:5px 36px;height:135px;background-repeat:no-repeat;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SignInDialogMSAVar-upsell{font-size:21px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-SignInDialogMSAVar-useMSA{font-size:15px;margin:16px 0}.od-SignInDialogMSAVar-useMSA a{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-SignInDialogMSAVar-useMSA a:hover{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SignInDialogMSAVar-next{margin:auto;background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";height:34px;width:342px;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-weight:300;font-size:15px;border:2px;border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SignInDialogMSAVar-next:focus{border-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-SignInDialogMSAVar-next:hover{background-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-SignInDialogMSAVar-input{height:34px;width:342px;margin-bottom:12px;font-size:15px;padding:0 4px;box-sizing:border-box}.od-SignInDialogMSAVar-createMSA{font-size:13px;margin:16px 0}.od-SignInDialogMSAVar-createMSA a{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-SignInDialogMSAVar-createMSA a:hover{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SignInDialogMSAVar-line{width:410px;height:1px;background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";position:absolute;left:0;right:0}.od-SignInDialogMSAVar-dismiss{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:12px;font-weight:400;width:410px;height:35px;cursor:pointer;border:none;position:absolute;left:0;right:0;bottom:0}.od-SignInDialog-close{position:absolute;top:0;background:0 0;border:0;padding:16px;cursor:pointer}html[dir=ltr] .od-SignInDialog-close{right:0}html[dir=rtl] .od-SignInDialog-close{left:0}.od-SignInDialog-close .ms-Icon.ms-Icon--Cancel{font-size:16px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var f,p=n(204),m=n(1134),_=n(128),h=n(47),b=n(1825),g=n(812),v=n(1884),y=n(2685),S=n(1828),D=n(1822),I=n(39),x=n(1841),C=n(1108),O=n(811),w=n(67),E=n(347),A=n(10);!function(e){e.INVALID_EMAIL="Error.Invalid Email",e.API_TIMEOUT="Error.API Timeout",e.MS_ACCOUNT="MSAccount",e.ORG_ID_PLACEHOLDER="OrgId,Placeholder",e.NEITHER="Neither",e.BOTH="Both"}(f||(f={}));var L=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.addBindingHandlers({dismiss:g.e,focusTrap:S.e,bindableHtml:v.e,keyboard:C.e,recoverFocus:D.e,preserveFocus:x.e,interactionScope:O.t});var a=n.resources.consume(c.e);return n._identityDataSource=n.resources.consume(w.D),n._engagement=n.resources.consume(E.e),n._navigation=n.resources.consume(s.e),n._setUpDialogStrings(),n._setUpMSAVariation(),n._onClickSignUpAction=new(n.managed(a.NavigationAction))({url:n.signUpURL}),n._onClickSignInAction=new(n.managed(a.NavigationAction))({url:n._signInURL}),n._onCancel=t.onCancel,n.overlayComponent={name:b.e.tagName,params:{animation:{},alignToParent:!1}},n._engagement.logData({name:"Display.SignInDialog"}),n}return Object(r.__extends)(t,e),t.prototype.dismissedDialog=function(e,t){this._onCancel&&this._onCancel(t)},t.prototype.onClickOutCancel=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.OutsideDialog.Click",isIntentional:!0}),this.dismissedDialog(e,t)},t.prototype.onClickCancelX=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.XButton.Click",isIntentional:!0}),this.dismissedDialog(e,t)},t.prototype.onClickCancelFooter=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.CancelFooter.Click",isIntentional:!0}),this.dismissedDialog(e,t)},t.prototype.onClickSignUpDialog=function(e,t){this._onClickSignUpAction.execute(t),this._engagement.logData({name:"SignUp.SignInDialog.CreateOneLink.Click",isIntentional:!0})},t.prototype.onClickSignInDialog=function(e,t){var n=this,a=encodeURIComponent(this.username.peek());this._signInURL="".concat(this._signInURL,"&username=").concat(a);var i="1"===this._navigation.viewParams.expectsBusiness;if(Object(A.isFeatureEnabled)(A.SigninDialogSupportBusinessAccounts)||i){var r=new _.e({name:"SignInDialog.GetIdentityProvider"});m.e.start({url:"".concat("https://odc.officeapps.live.com/odc/emailhrd/getidp?hm=0","&emailAddress=").concat(a,"&_=").concat(Date.now()),method:"GET",requestTimeoutInMS:3e3}).then(function(e){if(e.status>=200&&e.status<400){var t=e.responseText;r.end({resultType:h.e.Success,extraData:{identityProviderResponse:t}}),t===f.ORG_ID_PLACEHOLDER?n._continueBusinessSignin(a):n._continueSignin()}else r.end({resultType:h.e.Failure,resultCode:"ErrorResponse",error:"".concat(e.status," - ").concat(e.responseText)}),n._continueSignin()},function(e){r.end({resultType:h.e.Failure,resultCode:"Generic",error:"".concat(e.status," - ").concat(e.responseText)}),n._continueSignin()})}else this._continueSignin();this._engagement.logData({name:"SignIn.SignInDialog.NextButton.Click",isIntentional:!0})},t.prototype._continueSignin=function(){var e=this.resources.consume(c.e);this._onClickSignInAction=new(this.managed(e.NavigationAction))({url:this._signInURL}),this._onClickSignInAction.execute(event)},t.prototype._continueBusinessSignin=function(e){p.set("aad_redirect_url",window.location.href),this._signInURL="".concat("https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47/oauth2/authorize?response_type=id_token+code&redirect_uri=https%3a%2f%2fonedrive.live.com%2fbusiness&client_id=6a9b9266-8161-4a7b-913a-a9eda19da220&scope=openid&response_mode=form_post&nonce=01F08DF7-CA7E-4BB6-A2D1-AAE2E2F1BF44&msafed=0&state=aad_redirect_url&domain_hint=organizations","&login_hint=").concat(e),this._continueSignin()},t.prototype._setUpDialogStrings=function(){this.logoLabelString=y.r,this.closeLabel=y.s,this.upsellText=y.u,this.signUpText=y.l,this.dismissText=y.d,this.logoURL=window.require.toUrl("odsp-media/images/signindialog/microsoft_logo.svg"),this.cloudsURL=window.require.toUrl("odsp-media/images/signindialog/clouds.png");var e=encodeURIComponent(window.location.href);this._signInURL=this._identityDataSource.getSignInUrl()+e,this.signUpText=y.l,this.signUpURL="https://go.microsoft.com/fwlink/?linkid=853248",this.username=this.createObservable(""),this.usernameLabel=y.f,this.usernameInputPlaceholder=y.t;var t=this.resources.consume(c.m);this.dialogLabel=this.createPureComputed(function(){return(t()().displayName||"")+". "+y.c}),this.MSAupsellText=y.i},t.prototype._setUpMSAVariation=function(){var e="<a href='".concat("https://go.microsoft.com/fwlink/?linkid=853223","'>");this.useMSAccount=I.format(y.o,e,"</a>");var t='<a data-bind="click: onClickSignUpDialog" href=\''.concat(this.signUpURL,"'>");this.createAccountString=I.format(y.e,t,"</a>"),this.nextString=y.n,this.nextLabel=y.a},t}(o.t),k=Object(i.e)({tagName:"od-SignInDialog",template:'\x3c!--ko component:overlayComponent--\x3e<div class="od-SignInDialog-modal"><div class="ms-ModalOverlay"></div>\x3c!--ko focusTrap:{}--\x3e<div tabindex="-1" role="dialog" class="od-SignInDialogMSAVar" data-bind="preserveFocus:true,interactionScope:{isScope:true},dismiss:{close:onClickOutCancel},recoverFocus:{isEnabled:true},attr:{\'aria-labelledby\':\'signInDialog\',\'aria-describedby\':\'od-SignInDialog-content\'}"><div id="signInDialog" class="ms-accessible" data-bind="text:dialogLabel"></div><div id="od-SignInDialog-content"><div class="od-SignInDialogMSAVar-header"><img data-bind="attr:{src:logoURL,alt:logoLabelString}"></div><div class="od-SignInDialogMSAVar-content"><div class="od-SignInDialogMSAVar-upsell" data-bind="text:MSAupsellText"></div><div class="od-SignInDialogMSAVar-useMSA" data-bind="bindableHtml:useMSAccount"></div><input type="text" class="od-SignInDialogMSAVar-input" data-bind="textInput:username,keyboard:{allowButtonEvents:true,mappings:{Enter:onClickSignInDialog}},attr:{\'aria-label\':usernameLabel,placeholder:usernameInputPlaceholder}"><div id="signInDialog" class="ms-accessible" data-bind="text:usernameLabel"></div><button class="od-SignInDialogMSAVar-next od-button" data-bind="text:nextString,click:onClickSignInDialog,attr:{\'aria-label\':nextLabel}"></button><div class="od-SignInDialogMSAVar-createMSA" data-bind="bindableHtml:createAccountString"></div><div class="od-SignInDialogMSAVar-line"></div><button class="od-Button od-SignInDialogMSAVar-dismiss" data-bind="text:dismissText,click:onClickCancelFooter"></button><button class="od-SignInDialog-close" data-bind="attr:{\'aria-label\':closeLabel,title:closeLabel},click:onClickCancelX"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e',viewModel:L,synchronous:!0}),M=n(530),P=n(1195),T=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.signUpURL="https://go.microsoft.com/fwlink/?linkid=853248";var a=encodeURIComponent(window.location.href);n.signInURL="https://login.live.com/login.srf?wa=wsignin1.0&wreply="+a,n.homePageURL="https://go.microsoft.com/fwlink/?linkid=853503",n.brandingString=d.e,n.signIn=d.t,n.signInDialogTagName=k.tagName,n.signUp=d.n,n._actionMap=n.resources.consume(c.e),n._responsiveUI=n.resources.consume(M.t),n._navigation=n.resources.consume(s.e),n._onClickSignUpAction=new(n.managed(n._actionMap.NavigationAction))({url:n.signUpURL}),n._onClickSignInAction=new(n.managed(n._actionMap.NavigationAction))({url:n.signInURL}),n._onClickOneDriveAction=new(n.managed(n._actionMap.NavigationAction))({url:n.homePageURL}),n.showCloseButton=n.createObservable(!0),n.onClickClose=n.onClickClose.bind(n),n._dataStore=new l.e("SignInDialogCounter",u.e.local);var i=n._dataStore.getValue(P.e),r=n._responsiveUI.compareSize(n._responsiveUI.formFactorSize.peek(),"Small")>0,o=n.resources.consume(c.l),f=!1;return Object(A.isFeatureEnabled)(A.EnableAnonymousSigninDialog)&&(f=r&&!o.peek(),i&&(f=f&&i+864e5<=Date.now()),f&&n._dataStore.setValue(P.e,Date.now())),n.showSignIn=n.createObservable(f),n}return Object(r.__extends)(t,e),t.prototype.onClickSignUp=function(e,t){this._onClickSignUpAction.execute(t)},t.prototype.onClickSignIn=function(e,t){var n="1"===this._navigation.viewParams.expectsBusiness;Object(A.isFeatureEnabled)(A.UnauthenticatedBannerUseSigninDialog)||n?this.showSignIn(!0):this._onClickSignInAction.execute(t)},t.prototype.onClickOneDrive=function(e,t){this._onClickOneDriveAction.execute(t)},t.prototype.onClickClose=function(e){this.showSignIn(!1)},t}(o.t),U=Object(i.e)({tagName:"od-unauthenticated-banner",template:'<div class="od-unauthenticatedBanner"><button class="od-unauthenticatedBanner-OneDrive" data-bind="text:brandingString,attr:{href:homePageURL,alt:brandingString},click:onClickOneDrive"></button><div class="od-unauthenticatedBanner-AccountBox"><button class="od-unauthenticatedBanner-button od-unauthenticatedBanner-SignIn" data-bind="attr:{href:signInURL},text:signIn,click:onClickSignIn"></button><button class="od-unauthenticatedBanner-button od-unauthenticatedBanner-SignUp" data-bind="attr:{href:signUpURL},text:signUp,click:onClickSignUp"></button></div></div>\x3c!--ko if:showSignIn--\x3e\x3c!--ko component:{name:signInDialogTagName,params:{onCancel:onClickClose}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:T,synchronous:!0});t.default=U},2686:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)({name:"".concat("IsOneUpResourceKey",".isOneUp"),factory:{dependencies:{},create:function(e){return{instance:{isOneUp:!1}}}}})},3010:function(e,t,n){"use strict";var a=n(0),i=n(60),r=n(58),o=n(4),s=Object(o.po)(o._a),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getBundles=function(){var e;return(e={})[1]={path:"../../../bundles/odc/DeferredControls",getModule:function(){return i.n.resolve(s?void 0:Promise.all([n.e("ondemand.resx-ondemand"),n.e(438)]).then(n.bind(null,3685)))},isLoaded:this.createObservable(!1)},e[2]={path:"../../../bundles/odc/Quota",getModule:function(){return i.n.resolve(s?void 0:n.e(456).then(n.bind(null,3696)))},isLoaded:this.createObservable(s)},e[3]={path:"../../../bundles/odc/PushChannel",getModule:function(){return i.n.resolve(s?void 0:n.e(455).then(n.bind(null,3536)))},isLoaded:this.createObservable(!1)},e[4]={path:"../../../bundles/odc/FirstRun",getModule:function(){return i.n.resolve(s?void 0:Promise.all([n.e("ondemand.resx-ondemand"),n.e(447)]).then(n.bind(null,3718)))},isLoaded:this.createObservable(s)},e},t}(r.n);t.e=c},3401:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(1),i=n(7),r=n(119),o=new i.t({name:"LegacyKnockoutEngagementHandlers.key",loader:new r.t(function(){return n.e(555).then(n.bind(null,4564)).then(function(e){return e.resourceKey})})}),s=n(67),c=n(347),d=n(40),l=Object(d.a)(function(e){e.exposeFactory(s.u,new r.e(o)),e.block(c.e)},{owner:"WithKnockoutEngagement"})(a.Fragment)},3694:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return F});var a='\x3c!--ko if:showUnauthBanner--\x3e<div class="od-Files-unauthBanner" data-bind="component:unauthenticatedBannerTagName"></div>\x3c!--/ko--\x3e<div class="od-Files-oneUp" data-overlay-parent="true" data-bind="control:controlBindingOptions,css:{\'od-Files-OneUp--showUnauthBanner\':showUnauthBanner()}"></div>',i=n(0),r=n(3010),o=n(67),s=n(2625),c=n(1199),d=n(196),l=n(179),u=n(2147),f=n(2226),p=n(1871),m=n(1947),_=n(31),h=n(1805),b=n(1893),g=n(1915),v=n(29),y=n(93),S=n(139),D=n(61),I=n(60),x=n(78),C=n(4),O=n(257),w=n(8),E=n(2686),A=!w.t.isActivated("4a7717f6-8297-4a39-8932-39dbb58dd041","12/8/2021","disable enhanced oneup telemetry"),L=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.addBindingHandlers({control:l.n});var i=a,r=i.observables,s=i.resources,c=s.consume(o.Se),d=s.consume(h.resourceKey),w=s.consume(x.e).viewParams,L=c.getCurrentItemKey(w),k=c.getFocusItemKey(w);if(!k)return a.controlBindingOptions={specification:Object(l.a)(u.t,{error:new Error(m.u)})},a;var M=function(e,n){var a=c.getKeyParams(e);return n&&delete a[t.queryParamKey],{parentKey:e,ownerId:c.getOwnerId(e),queryType:c.getQueryType(a),ignoreChildren:n}},P=M(k,!0),T=d.getItemSync(P).item,U=d.getItemSync(M(L,!1)),F=new b.e;F.item=U.item,r.compute(function(){var e=new g.e;e.items=[T],F.content(e)}),Object(C.po)(C.Wr)||(S.n.mark("DataManager.GetData.Started"),a.trackPromise(d.getItem(P).then(function(){S.n.mark("DataManager.GetData.Done")},function(e){e.errorTitle||I.n.isCanceled(e)||D.e.log(e)}))),s.expose(v.r,U.item),s.expose(v.o,r.create(U)),s.expose(v._,r.create(F)),s.expose(v.m,r.create(T));var H=s.consume(E.e);if(H.isOneUp=!!r.unwrap(T()),r.pureCompute(function(){var e=!!r.unwrap(T());return H.isOneUp=e,e}),A){var R=s.consume(O.e);a.controlBindingOptions={specification:Object(l.a)(f.e.bypass,{onSlideLoaded:function(){R.pageLoaded(_.e[_.e.OneUp])}}),placeholder:Object(l.a)(p.t,{})}}else{var N=s.consume(y.e);a.controlBindingOptions={specification:Object(l.a)(f.e,{}),placeholder:Object(l.a)(p.t,{}),afterRender:function(){N.pageLoaded(_.e[_.e.OneUp])}}}return a}return Object(i.__extends)(t,e),t}(d.t),k=n(35),M=function(e){function t(t,n){var a=this,d=Object(i.__assign)(Object(i.__assign)({},t),{queryParamKey:"qt"}),l=a=e.call(this,d,n)||this,u=l.observables,f=l.resources;a.unauthenticatedBannerTagName=s.default.tagName;var p=a.resources.consume(c.e);return a.showUnauthBanner=u.create(!p&&!k.e.isAuthenticated()),f.expose(o.i,new(a.managed(r.e))),a}return Object(i.__extends)(t,e),t}(L),P=n(399),T=n(17);Object(T.n)([{rawString:".od-Files-unauthBanner{position:absolute;top:0;left:0;right:0;height:50px}.od-Files-oneUp{position:absolute;top:0;left:0;right:0;bottom:0}.od-Files-oneUp.od-Files-OneUp--showUnauthBanner{top:50px}"}]);var U=Object(P.e)({tagName:"od-odc-oneup",template:a,viewModel:M,synchronous:!0}),F=Object(l.t)({automationName:"",name:"OneUp",template:a,viewModelType:M});t.default=U},4655:function(e,t,n){"use strict";n.r(t),n.d(t,"KnockoutOneUp",function(){return w});var a=n(1),i=n(55),r=n(410),o=n(179),s=n(3694),c=n(197),d=n(0),l=n(75),u=n(144),f=n(83),p=n(212),m=n(105),_=n(40),h=n(257),b=n(14);function g(e){var t=e.pageLoadContinueSignal,n=e.pageLoadReadySignal,i=Object(_.n)();n&&n.resolve();var r=Object(u.t)();return a.useEffect(function(){var e=i.consume(h.e);e&&e.pageLoaded(),r(Object(m.d)()).then(function(){var e;t&&t.resolve(),r(Object(p.e)({items:(e={},e[b.i]=Object(d.__assign)({},b.a.pack(!0)),e)}))})},[]),null}var v=Object(i.t)(function(e,t){var n=Object(f.e)(e,{pageLoadConfiguration:l.o}).pageLoadConfiguration||{},i=n.pageLoadReadySignal,r=void 0===i?void 0:i,o=n.pageLoadContinueSignal,s=void 0===o?void 0:o;return a.createElement(g,{pageLoadContinueSignal:s,pageLoadReadySignal:r})}),y=n(450),S=n(6),D=n(4),I=n(8),x=n(3401),C=!I.t.isActivated("4a7717f6-8297-4a39-8932-39dbb58dd041","12/8/2021","disable enhanced oneup telemetry");function O(e){var t=a.useState(function(){return Object(o.a)(s.resourceKey,{})})[0];return a.createElement(a.Fragment,null,a.createElement(c.e,{bypass:!0},a.createElement(x.e,null,a.createElement(r.e,{specification:t}))),C?null:a.createElement(v,null))}var w=Object(i.t)(function(e,t){var n;if(Object(D.po)(D.Wr)){var i=null===(n=Object(y.e)(e))||void 0===n?void 0:n.focusItemKey;if(e.demandItemFacet(S.u,i),!e.isItemFacetResolved(S.u,i))return null}return a.createElement(O,null)})}}]);