(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],{2350:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"t",function(){return s});var a=n(17);Object(a.n)([{rawString:".field_937c968c{display:inline-block;box-sizing:border-box;max-width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.field_937c968c.block_937c968c{display:block}.pathSection_937c968c{display:inline;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.pathSection_937c968c{color:WindowText}}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .pathSection_937c968c{color:HighlightText}}.chevron_937c968c{font-size:12px;margin:3px 1px;transform:scale(.5);vertical-align:middle;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.chevron_937c968c{color:WindowText}}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .chevron_937c968c{color:HighlightText}}"}]);var i="field_937c968c",r="block_937c968c",o="pathSection_937c968c",s="chevron_937c968c"},2506:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemPathField",{displayPathSegments:a.t,openUrl:a.t,action:a.t})},2507:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(1),i=n(476),r=n(1782),o=n(51),s=n(39),c=n(2350),d=n(80),l=function(e){var t=e.displayPathSegments,n=e.parentLink,i=e.target,l=e.onClick,p=e.className,m="",_=[];if(t){var h=t.join(" ".concat(d.w," "));m=s.format(d.E,h),_=function(e,t,n){var a=[];if(!e.length)return a;var i=0,r=60,o="â€¦",s=e.map(function(e){return e.trim()}),c=s[0],d=s.length>=2?s[1]:"",l=d?c.length+d.length+3+o.length-r:0,p=s[s.length-1],m=c.length+p.length+2*(3+o.length)-r;if(c.length>r){var _=c.substr(0,59).trim()+o;a.push(u(_,++i,t))}else if(1===e.length||c.length+3+o.length>r||s.length>2&&c.length+2*(3+o.length)>r)a.push(u(c,++i,t));else if(2===s.length&&l>1)a.push(u(c,++i,t)),a.push(f(++i,n)),a.push(u(o+d.substr(l).trim(),++i,t));else if(s.length>2&&m>1){var h=p.substr(m).trim();a.push(u(c,++i,t)),a.push(f(++i,n)),a.push(u(o,++i,t)),h.length>0&&(a.push(f(++i,n)),a.push(u(o+h,++i,t)))}else{var b=0;a.push(u(c,++i,t)),b+=c.length;for(var g=1;g<e.length;++g){a.push(f(++i,n));var v=s[g];a.push(u(v,++i,t)),b+=3+v.length}for(b>r&&(s.splice(1,1),a.splice(2,1,u(o,++i,t)),b-=d.length-o.length);b>r;){var y=s.splice(1,1)[0];a.splice(3,2),b-=y.length+3}}return a}(t)}return l||n?a.createElement(r.e,{dir:"auto",className:Object(o.e)(c.n,p),"aria-label":m,href:n,target:i,onClick:l,title:d.A},_):a.createElement("div",{dir:"auto","aria-label":m,className:Object(o.e)(c.n,p)},_)};function u(e,t,n){return a.createElement("div",{key:t,className:Object(o.e)(c.a,n)},e)}function f(e,t){return a.createElement(i.e,{key:e,className:Object(o.e)(c.t,t),iconName:"ChevronRightSmall"})}},2514:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("cancelProgress",{isAvailable:a.t})},2515:function(e,t,n){"use strict";n.d(t,"e",function(){return v});var a,i,r,o=n(0),s=n(537),c=n(153),d=n(45),l=n(6),u=n(100),f=n(152),p=n(39),m=n(298),_=[],h=((a={})[d.a.started]=function(e){return Object(p.format)(Object(p.getLocalizedCountValue)(m.f,m.a,e)||"",e)},a[d.a.completed]=function(e){return Object(p.format)(Object(p.getLocalizedCountValue)(m.n,m.a,e)||"",e)},a[d.a.failed]=function(e){return Object(p.format)(Object(p.getLocalizedCountValue)(m.s,m.c,e)||"",e)},a[d.a.canceled]=function(e){return Object(p.format)(Object(p.getLocalizedCountValue)(m.s,m.c,e)||"",e)},a),b=((i={})[d.a.started]=function(e){return Object(p.format)(m.p,e)},i[d.a.completed]=function(e){return Object(p.format)(m.i,e)},i[d.a.failed]=function(e){return Object(p.format)(m.d,e)},i[d.a.canceled]=function(e){return Object(p.format)(m.d,e)},i),g=((r={})[d.a.created]=m.r,r[d.a.canceled]=m.e,r[d.a.completed]=m.t,r);function v(e,t){var n=t.itemKey,a=t.progressFormat,i=e.demandItemFacet(d.v,n),r=i&&i.itemKey,p=e.demandItemFacet(l.u,n)||e.demandItemFacet(l.u,r),m=e.demandItemFacet(l.l,n),v=e.demandItemFacet(u.t,n),y=e.demandItemFacet(s.e,n),S=Object(c.t)(e,{itemKey:n}),D=Object(c.a)(e,{itemKey:n}),I=D.phase,x=D.count,C=Object(c.n)(e,{itemKey:n}),O=e.demandItemFacet(d.u,n),w=O?0!==O.total?O.current/O.total:void 0:I!==d.a.started?1:void 0,E=s.e.evaluate(y)(e,Object(o.__assign)(Object(o.__assign)({itemKey:n,title:1===x&&p&&b[I](p)||h[I](x),description:null!=m?m:v&&!Object(f.n)(v)?v.message:g[C]},w?{percentComplete:w}:{}),{itemCountsByPhase:S,format:a,commands:_,error:v}));return{itemKey:n,sourceItemKey:r,displayName:p,title:E.title,description:E.description,message:E.message,percentComplete:E.percentComplete,phase:I,commands:E.commands,error:E.error}}},2574:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(1),i=n(2507),r=n(2350),o=n(6),s=n(27),c=n(323),d=n(267),l=n(175),u=n(8),f=n(2506),p=u.e.isActivated("AB1B9B00-C482-451A-A5DA-500AC7533605","1/31/2022","Require Name to be clickable for parent path to be clickable"),m=[];function _(e,t){var n=t.itemKey,d=t.renderer,u=e.demandItemFacet(o.k,n),_=e.demandItemFacet(o.A,null==u?void 0:u.itemKey)||"",b=e.demandItemFacet(f.e,n),g=f.e.evaluate(b)(e,{itemKey:n,displayPathSegments:_?h(_):m,openUrl:_,action:u&&_?Object(l.a)(e,a.createElement(c.e,{itemKey:u.itemKey})):null}),v=g.displayPathSegments,y=void 0===v?m:v,S=g.action,D=g.openUrl;return{renderer:function(e,t,n){var o=d?d(e,t,n):null;return a.createElement(a.Fragment,null,o?a.createElement(a.Fragment,{key:"content"},o):null,y.length>0?a.createElement(s.n,{key:"path",action:S},function(t){var n=t.execute,o=t.isAvailable&&(p||e.isInvokable)?function(e){n({event:e}).catch(function(){}),e.preventDefault(),e.stopPropagation()}:void 0;return a.createElement(i.e,{className:r.e,displayPathSegments:y,parentLink:o?D:void 0,onClick:o})}):null)}}}function h(e){for(var t=[],n=0,a=new d.e(e).segments.slice(1);n<a.length;n++){var i=a[n];try{t.push(decodeURIComponent(i))}catch(e){t.push(i)}}return t}},2653:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(260),r=n(91),o=n(1224),s=n(383),c=n(8).t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function d(e){var t=this,n=e.itemKey,d=e.itemSetKeyFacet,l=e.getUrl,u=e.sortChildItems,f=e.qosName,p=e.preprocessResponse,m=e.expectedErrors,_=e.disableRemoteItem,h=void 0!==_&&_,b=e.scenarioInfo,g=d.deserialize(n),v=g.driveItemKey,y=v.endpoint,S=v.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,d,_,v,D,I;return Object(a.__generator)(this,function(x){switch(x.label){case 0:t=Object(i.n)(g.driveItemKey),x.label=1;case 1:return x.trys.push([1,4,,5]),[4,n(Object(r.n)({url:l(g),driveUrl:t,driveId:S,qosName:"getChildren".concat(f?".".concat(f):""),endpoint:y,headers:e.additionalHeaders,expectedErrors:m,timeout:c?void 0:6e4,scenarioInfo:b}))];case 2:return d=x.sent(),_=Object(a.__spreadArray)([],d.value,!0),v=p&&p(_)||d.value,D=u&&u(v)||v,[4,n(Object(o.e)(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:h,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},d),{value:D})})))];case 3:return[2,{itemResolver:x.sent().itemResolver}];case 4:throw I=x.sent(),new s.e(Object(a.__assign)({code:"UnknownError"},I instanceof Error?{innerError:I}:{message:JSON.stringify(I)}));case 5:return[2]}})})}}},2654:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(8).e.isActivated("EB854331-5340-42D0-8893-9E093DC56A47","03/10/2022","Use standard Open command for Office files")},2663:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(210);function i(e){switch(e){case a.e.Word:return".docx";case a.e.Excel:case a.e.ExcelSurvey:case a.e.ExcelForm:return".xlsx";case a.e.PowerPoint:return".pptx";case a.e.OneNote:return"";case a.e.Text:return".txt";case a.e.Visio:return".vsdx";case a.e.Bohemia:return".b";case a.e.Prague:return".prague"}}function r(e,t){var n="";switch(e){case a.e.Word:n=t.CreateWord;break;case a.e.Excel:n=t.CreateExcel;break;case a.e.PowerPoint:n=t.CreatePowerPoint;break;case a.e.OneNote:n=t.CreateOneNote;break;case a.e.ExcelSurvey:n=t.CreateExcelSurvey;break;case a.e.Text:n=t.CreateText;break;case a.e.ExcelForm:n=t.CreateFormForExcel;break;case a.e.Visio:n=t.CreateVisio;break;case a.e.Bohemia:n=t.CreateBohemia;break;case a.e.Prague:n=t.CreatePrague}return n}},2839:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemsView",{additionalLayouts:a.t,defaultLayout:a.t,enableDropZone:a.t,isLayoutResolved:a.t,onLoadItem:a.t,pinnedItemsView:a.t,setDefaultLayout:a.t,shouldShowEmptyFolder:a.t,shouldShowPinnedItems:a.t})},2840:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(302),r=n(2574),o=n(186),s=n(133),c=n(857),d=n(1238),l=n(1218),u=n(1219),f=n(1203),p=n(354),m=n(8).e.isActivated("A8ABE184-9647-42E8-BBAD-7AC7F51995D6","5/20/2022","Fix signals positioning in nameAndPathColumn")?[f.t,r.e]:[r.e,f.t],_=Object(c.e)({key:o.s,name:i.c,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:s.a,data:{facets:Object(a.__assign)({},p.e.pack("nameAndPath"))}},Object(a.__spreadArray)(Object(a.__spreadArray)([d.e],m,!0),[l.e,u.e],!1))},2969:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(1),i=n(18),r=n(55),o=n(6),s=n(323),c=Object(r.t)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.k,n);return i?a.createElement(s.e,{itemKey:i.itemKey}):null}),d=Object(i.r)()(Object(i.a)()(c)),l=n(617),u={key:"OpenFileLocation",name:l.c,title:l.c,action:d,iconProps:{iconName:"FabricFolder"}}},3125:function(e,t,n){"use strict";n.d(t,"e",function(){return S}),n.d(t,"t",function(){return C});var a=n(0),i=n(875),r=n(1293),o=n(619),s=n(877),c=n(894),d=n(231),l=n(261),u=n(488),f=n(186),p=n(302),m=n(2574),_=n(857),h=n(133),b=n(354),g=Object(_.e)({key:f.c,name:p.d,fieldName:"",isCollapsible:!1,minWidth:h.e.regularMin,maxWidth:h.e.displayNameMax,sortProps:void 0,isResizable:!0,data:{facets:Object(a.__assign)({},b.e.pack("path"))}},[m.e]),v=n(8),y=n(2991),S=v.e.isActivated("22B8A337-05E5-4246-A042-4589C0F3DF7A","11/30/2022","add location column"),D=Object(a.__assign)(Object(a.__assign)({},g),{name:y.e}),I=Object(a.__spreadArray)(Object(a.__spreadArray)([o.e,u.t,i.e,c.e],S?[]:[D],!0),[s.e],!1),x=Object(a.__spreadArray)(Object(a.__spreadArray)([o.e,u.t,i.e,r.e,c.e],S?[]:[D],!0),[s.e],!1);function C(e,t){var n,a=t.itemSetKey;if(a){var i=Object(l.e)(e,{itemKey:a}),r=e.demandItemFacet(d.e,i);if("photo"===(null===(n=null==r?void 0:r.folder)||void 0===n?void 0:n.folderType))return{columns:x}}return{columns:I}}},3399:function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(23),i=n(681),r=n(9),o=n(2506),s=n(267),c=n(8),d=n(39),l=n(873),u=n(6),f=n(2991),p=n(124),m=n(379),_=n(3125),h=n(85),b=n(327),g=c.e.isActivated("F0E9D1A9-2D93-4FEB-8870-CA6A2A2438B0","08/22/2022","Use the new item path field control handler for fetching paths for files or folders");function v(e,t){var n,a,i=t.itemKey,r=e.demandItemFacet(u.k,i),o=e.demandItemFacet(u.L,i),s=e.demandItemFacet(l.e,null==r?void 0:r.itemKey);if(o&&!g){var c=d.format(f.n,o);return s?{displayPathSegments:y("/".concat(c).concat(s.path)),openUrl:""}:r&&(D=e.demandItemFacet(u.u,null==r?void 0:r.itemKey))?{displayPathSegments:[c.concat(D)],openUrl:""}:{displayPathSegments:[c],openUrl:""}}var v=Object(h.e)(e),S=e.demandItemFacet(b.e,v);if(!_.e&&S)if(Object(p.c)(e,i)){var D;if(r&&(D=e.demandItemFacet(u.u,null==r?void 0:r.itemKey)))return{displayPathSegments:[D],openUrl:"",action:void 0}}else{var I=e.demandItemFacet(m.e,i),x=null===(a=null===(n=null==I?void 0:I.owner)||void 0===n?void 0:n.user)||void 0===a?void 0:a.displayName;if(x)return{displayPathSegments:[d.format(f.t,x)],openUrl:"",action:void 0}}return{}}function y(e){for(var t=[],n=0,a=new s.e(e).segments.slice(1);n<a.length;n++){var i=a[n];t.push(i)}return t}var S=Object(a.t)(function(){return function(e){e(Object(i.e)(r.e,o.e)(v)),e(Object(i.e)(l.e,o.e)(v))}})},3809:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(147);function i(e){var t=e.itemKey;return function(e){return e(Object(a.e)(function(e){return r(e,{itemKey:t})}))}}function r(e,t){var n,a=t.itemKey;return e.getItem(a).mappedKeys.forEach(function(e){void 0===n&&(n={}),e&&(n[e]=!0)}),n}},4526:function(e,t,n){"use strict";n.r(t),n.d(t,"graphRecentWebAddon",function(){return Re});var a=n(23),i=n(681),r=n(355),o=n(641),s=n(306),c=n(0),d=n(8),l=n(1123),u=n(619),f=n(133),p=n(302),m=n(2),_=n(1038),h=n(6),b=n(38),g=n(201),v=n(604),y=n(354),S=Object(f.i)({key:new m.e("dateAccessedColumn").id,name:p.e,fieldName:"",minWidth:f.e.regularMin,maxWidth:f.e.regularMax,isCollapsable:!0,data:{facets:Object(c.__assign)({},y.e.pack("dateAccessed"))}},_.e)(function(e,t){var n=e.demandItemFacet(h.o,t,{suppressGetItems:!0}),a=n&&new Date(n).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(b.O,g.e),r=i&&i.language||window.navigator.language;return r?{text:Object(v.n)(new Date(a),r)}:{dateValue:a}},function(e,t){return"".concat(e.demandItemFacet(h.o,t))}),D=n(2840),I=Object(c.__assign)(Object(c.__assign)({},D.e),{columnActionsMode:l.t.disabled}),x=Object(c.__assign)(Object(c.__assign)({},S),{columnActionsMode:l.t.disabled}),C=d.e.isActivated("E4DF8572-56CE-4708-A3CB-DB9720F1B163","09/19/2022","Disable column header action on Recent ItemSet since no action avaible")?[u.t,D.e,S]:[u.t,I,x];function O(e,t){return{columns:C}}var w=n(167),E=n(353),A=n(329),L=n(376),k=n(1179),M=n(1037),P=n(2969),T=[A.e,P.e,L.n,L.t,k.e];function U(e,t){var n=function(e,t){for(var n=[],a=0,i=t.defaultCommands;a<i.length;a++){var r=i[a];r.key===A.e.key?n.push(M.e):n.push(r)}return{overrideDefaultCommands:n}}(0,{defaultCommands:T}).overrideDefaultCommands;return{commands:n}}var F=n(266),H=n(2654),R={name:"-",key:"divider_1",itemType:F.e.Divider},N=[H.e?A.e:M.t,P.e,R,L.n,L.t,k.e];function B(e,t){return{commands:N}}var j=n(1150),V=n(409),z=n(32),G=n(426),K=new z.e("recentGroup",{recentItemSet:s.e.subKeyPart,relativeTime:Object(G.e)({today:"today",yesterday:"yesterday",thisWeek:"thisWeek",lastWeek:"lastWeek",twoWeeksAgo:"twoWeeksAgo",threeWeeksAgo:"threeWeeksAgo",thisMonth:"thisMonth",lastMonth:"thisMonth",twoMonthsAgo:"twoMonthsAgo",older:"older"})});function W(e,t){return{isAvailable:!1}}var q=n(1078),Q=n(1308),Y=n(74),J=n(1036),X=n(331),Z=n(392);function $(e,t){var n=e.demandItemFacet(s.e,t.itemKey),a=!!e.demandItemFacet(Y.s,t.itemKey)||(null==n?void 0:n.filters)&&Object(J.e)({extFilters:Object(J.t)(n.filters),allowedMediaTypes:[X.e.photo,X.e.video],fileTypeIconMap:Z.e});return Object(c.__assign)({},a?{defaultLayout:Q.t.layoutType,isLayoutResolved:!0}:{layouts:[q.t,q.e]})}var ee=n(317),te=n(1192),ne=n(1225),ae=n(417);function ie(e,t){var n=t.handlers,a=t.itemKey,i=e.demandItemFacet(s.e,a);if(n&&i){for(var r=[],o=0,d=n;o<d.length;o++){var l=d[o];if(l.key===ae.l.key)r.push("photo");else if(l.key===ae.u.key)r.push("video");else if(l.key===ae.a.key)r.push("folder");else if(l.key===ae.n.key)r.push("file");else if(l.key===ae.d.key)r.push("onenote");else if(l.key===ae.s.key)r.push("!photo");else if(l.key===ae.c.key)r.push("!video");else if(l.key===ae.r.key)r.push("!folder");else if(l.key===ae.o.key)r.push("!onenote");else{var u=Object(ne.e)(l);u&&r.push(u)}}return{itemKey:s.e.serialize(Object(c.__assign)(Object(c.__assign)({},i),{filters:r}))}}return{}}var re,oe=n(1304),se=n(2653),ce=n(372),de=864e5;function le(e,t){return e.toDateString()===t.toDateString()}!function(e){e.today="today",e.yesterday="testerday",e.thisWeek="thisWeek",e.lastWeek="lastWeek",e.twoWeeksAgo="twoWeeksAgo",e.threeWeeksAgo="threeWeeksAgo",e.thisMonth="thisMonth",e.lastMonth="lastMonth",e.twoMonthsAgo="twoMonthsAgo",e.older="older"}(re||(re={}));var ue=n(19),fe=n(9),pe=n(91),me=n(260),_e=n(52),he=n(280),be=n(274),ge=n(635),ve=n(603),ye=n(648),Se=n(872),De=n(3810),Ie=n(3145),xe=n(717),Ce=n(736),Oe=!d.t.isActivated("2477F975-39B5-47B9-AA5F-C02028225BCB","10/27/2021","Updates ODC itemsscope Recent to use prefer APIVersion 2.0 header (instead of 2.1) in the case the user has been migrated."),we=!d.e.isActivated("667B27A0-823E-489C-B1CF-3AA1F1E5C454","04/09/2022","Enable the Older grouping for list items in Recent pivot"),Ee=!d.e.isActivated("213A4632-291F-4C56-A70F-D16FF269A867","04/07/2022","Enforce maxmimum filter complexity for Graph Recent API"),Ae=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},Le=Object(a.i)()(function(e){var t=this,n=s.e.deserialize(e.itemKey),a=n.filters,i=void 0===a?[]:a,r=n.groupBy,o=void 0===r?"":r,l=Object(J.e)({extFilters:Object(J.t)(i),allowedMediaTypes:[X.e.photo,X.e.video],fileTypeIconMap:Z.e}),u=Object(J.e)({extFilters:Object(J.t)(i),allowedMediaTypes:[X.e.photo],fileTypeIconMap:Z.e}),f=Object(J.e)({extFilters:Object(J.t)(i),allowedMediaTypes:[X.e.video],fileTypeIconMap:Z.e});return function(a){return Object(c.__awaiter)(t,void 0,void 0,function(){var t,r,p,m,_,b,g,v,y,S,D,I,x,C,O,E,A,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,W,q,Q,J,X,Z,$;return Object(c.__generator)(this,function(ee){switch(ee.label){case 0:return t=a(Object(be.e)({graphRecentEndpoint:_e.D,enableOverflowRecentGroup:_e.l,convergenceConfiguration:he.e,enableRecentVroom21Takeover:_e.f})),r=t.graphRecentEndpoint,p=t.enableOverflowRecentGroup,m=void 0===p?we:p,_=t.convergenceConfiguration,b=t.enableRecentVroom21Takeover,g=n,r?(g=Object(c.__assign)(Object(c.__assign)({},g),{driveItemKey:Object(c.__assign)(Object(c.__assign)({},g.driveItemKey),{endpoint:r})}),[3,3]):[3,1];case 1:return[4,a(Object(Se.e)({endpoint:g.driveItemKey.endpoint}))];case 2:(v=ee.sent())!==g.driveItemKey.endpoint&&(g=Object(c.__assign)(Object(c.__assign)({},g),{driveItemKey:Object(c.__assign)(Object(c.__assign)({},g.driveItemKey),{endpoint:v})})),ee.label=3;case 3:return y=s.e.serialize(g),S=K.serialize({recentItemSet:g,relativeTime:"today"}),D=K.serialize({recentItemSet:g,relativeTime:"yesterday"}),I=K.serialize({recentItemSet:g,relativeTime:"thisWeek"}),x=K.serialize({recentItemSet:g,relativeTime:"lastWeek"}),C=K.serialize({recentItemSet:g,relativeTime:"twoWeeksAgo"}),O=K.serialize({recentItemSet:g,relativeTime:"threeWeeksAgo"}),E=K.serialize({recentItemSet:g,relativeTime:"lastMonth"}),A=K.serialize({recentItemSet:g,relativeTime:"twoMonthsAgo"}),L=K.serialize({recentItemSet:g,relativeTime:"older"}),k=[],M=[],P=[],T=[],U=[],F=[],H=[],R=[],N=[],B="",j="date"===o,V=function(e){var t,n=e.driveItemKey,a=e.item,i=new ce.e({publisher:V});if(a&&n){var r=a.remoteItem,o=r&&r.fileSystemInfo,s=o&&o.lastAccessedDateTime,d=fe.e.serialize(n);if(j&&s){var l=new Date(s);switch(function(e){var t=new Date;return function(e,t){return le(t,e)}(e,t)?re.today:function(e,t){return le(new Date(t.getTime()-de),e)}(e,t)?re.yesterday:function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*de;return e.getTime()>n}(e,t)?re.thisWeek:function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+7)*de;return e.getTime()>n}(e,t)?re.lastWeek:function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n}(e,t)?re.twoWeeksAgo:function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n}(e,t)?re.threeWeeksAgo:function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()}(e,t)?re.thisMonth:function(e,t){return t.getMonth()-e.getMonth()==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1}(e,t)?re.lastMonth:function(e,t){var n=t.getFullYear(),a=e.getFullYear(),i=t.getMonth(),r=e.getMonth();return n===a&&i-r==2||n-a==1&&i-r==-10}(e,t)?re.twoMonthsAgo:re.older}(l)){case re.today:k.push(d);break;case re.yesterday:M.push(d);break;case re.thisWeek:P.push(d);break;case re.lastWeek:T.push(d);break;case re.twoWeeksAgo:U.push(d);break;case re.threeWeeksAgo:F.push(d);break;case re.lastMonth:H.push(d);break;case re.twoMonthsAgo:R.push(d),B=Ie.e[l.getMonth()];break;case re.older:default:N.push(d)}}return i.resolveItems({items:(t={},t[d]=Object(c.__assign)({},h._.pack(void 0)),t)}),{itemResolver:i}}},z=!l&&j?function(t){var n,a,i=new ce.e({publisher:z});i.resolveItems({items:(n={},n[S]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},h.u.pack(De.r)),Y.r.pack(!0)),ue.e.pack({itemKeys:k})),n[D]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},h.u.pack(De.s)),Y.r.pack(!0)),ue.e.pack({itemKeys:M})),n[I]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},h.u.pack(De.a)),Y.r.pack(!0)),ue.e.pack({itemKeys:P})),n[x]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},h.u.pack(De.t)),Y.r.pack(!0)),ue.e.pack({itemKeys:T})),n[C]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},h.u.pack(De.o)),Y.r.pack(!0)),ue.e.pack({itemKeys:U})),n[O]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},h.u.pack(De.i)),Y.r.pack(!0)),ue.e.pack({itemKeys:F})),n[E]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},h.u.pack(De.e)),Y.r.pack(!0)),ue.e.pack({itemKeys:H})),n[A]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},h.u.pack(B)),Y.r.pack(!0)),ue.e.pack({itemKeys:R})),n[L]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},h.u.pack(De.n)),Y.r.pack(!0)),ue.e.pack({itemKeys:N})),n)});var r=[];return k.length>0&&r.push(S),M.length>0&&r.push(D),P.length>0&&r.push(I),T.length>0&&r.push(x),U.length>0&&r.push(C),F.length>0&&r.push(O),H.length>0&&r.push(E),R.length>0&&r.push(A),N.length>0&&m&&r.push(L),i.resolveItems({items:(a={},a[e.itemKey]=Object(c.__assign)({},ue.e.pack({itemKeys:r})),a)}),{itemResolver:i}}:void 0,G=a(Object(pe.i)(g.driveItemKey.endpoint)),W=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}],q=Oe&&(null==_?void 0:_.isUserMigrated)?"ApiVersion=2.0":"ApiVersion=2.1",Q=d.e.isActivated("ec806106-9a41-4826-810d-712db11fef90","22/7/2022","Use RecentExcludeMediaApp in Prefer Header"),J=Q?"RecentOnlyMediaApp":"RecentExcludeMediaApp",[4,a(Object(se.e)(Object(c.__assign)(Object(c.__assign)({},e),{qosName:l?"recentMedia":G?"ODC-recent":"recent",itemKey:y,itemSetKeyFacet:s.e,parentItemKeyFacet:w.e,getUrl:function(e){var t="".concat(Object(me.n)({endpoint:e.driveItemKey.endpoint,driveId:"me"}),"/recent?"),n=d.e.isActivated("022299AD-ACC7-4C1F-B2E8-010FBC126277","1/7/2022","Narrow filters for media queries");if(G)t="".concat(e.driveItemKey.endpoint,"/drive/view.recent?");else{if(u&&!n){var a="$filter=(remoteItem/image ne null)",r="$expand=thumbnails";return"".concat(t).concat(a,"&").concat(r)}if(f&&!n)return a="$filter=(remoteItem/image eq null or remoteItem/video ne null)",r="$expand=thumbnails","".concat(t).concat(a,"&").concat(r);if(l)return a="$filter=(remoteItem/image ne null or remoteItem/video ne null)",r="$expand=thumbnails","".concat(t).concat(a,"&").concat(r)}return"".concat(t).concat(function(e){if(!e||0===e.length||Ee&&e.length>8)return"";for(var t=[],n=[],a=0;a<e.length;a++){var i=e[a],r=!1,o=i;Object(Ce.e)(i)&&(o=Object(Ce.t)(i),r=!0),"folder"===o?!r&&t.push("folder ne null"):"onenote"===o?r?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==o[0]||!r&&t.push("(endsWith(name, '".concat(o.toLowerCase(),"') or endsWith(remoteItem/name, '").concat(o.toLowerCase(),"'))"))}return t.length>0||n.length>0?"&$filter=".concat(0===n.length?Object(ge.t)(t):0===t.length?Object(ge.e)(n):Object(ge.e)(Object(c.__spreadArray)([Object(ge.t)(t)],n,!0))):""}(i))},getDriveItemFacets:ke,expectedErrors:W,preprocessResponse:function(e){return q.indexOf("2.1")<0&&!b&&(u?e=Ae(e,"image"):f&&(e=Ae(e,"video|^application"))),(t=e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,a=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||a?n?a?n>a?-1:1:-1:1:0}))?t.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t}):t;var t},additionalHeaders:l?{Prefer:"".concat(q,",").concat(J,",NoPreAuthThumbnailUrls")}:{Prefer:"".concat(q,";ODC,returnparentresource,returnowner")},onProcessResponse:V,groupChildItems:z,scenarioInfo:{scenario:xe.e.PopulateRecentFiles,scenarioType:xe.t.ActiveUserOperation}})))];case 4:return X=ee.sent().itemResolver,l&&X.resolveItems({items:(Z={},Z[e.itemKey]=Object(c.__assign)({},Y.s.pack({})),Z)}),X.mapKeys({mappings:($={},$[y]=e.itemKey,$)}),a(X.execute()),[2]}})})}});function ke(e){return function(t){var n,a=new ce.e({publisher:ke});a.merge(t(Object(ve.e)(e)).itemResolver);var i=e.driveItem,r=i.thumbnails,o=i.remoteItem,s=r||o&&o.thumbnails;return a.resolveItems({items:(n={},n[e.itemKey]=Object(c.__assign)({},s?Object(c.__assign)({},ye.e.pack(!1)):{}),n)}),{itemResolver:a}}}var Me=n(212),Pe=n(389),Te=n(1426),Ue=Object(a.t)(function(){return function(e){e(Object(Me.t)({keyFacet:s.e,facets:[s.e,ue.e]})),e(oe.e),e(Object(ee.a)(s.e,Pe.e)(Le)),e(Object(i.e)(s.e,te.e)(ie)),e(Te.e)}}),Fe=n(2839),He=n(3399),Re=Object(a.t)(function(){return function(e){e(Ue),e(He.e),e(Object(i.e)(s.e,Fe.e)($)),e(Object(i.e)(s.e,o.e)($)),e(Object(i.e)(s.e,r.e)(O)),e(Object(i.e)(w.e,E.e)(U)),e(Object(i.e)(w.e,j.e)(B)),e(Object(i.e)(K,V.e)(W))}})}}]);